{"version":3,"file":"index.8e594465.js","sources":["../../vite/modulepreload-polyfill","../../src/peripleo/device/Device.ts","../../src/peripleo/device/DeviceStateProvider.tsx","../../src/peripleo/Peripleo.tsx","../../src/peripleo/store/hooks/useGraph.ts","../../src/peripleo/store/types/SearchTypes.ts","../../src/peripleo/store/state/searchState.ts","../../src/peripleo/store/hooks/useSearch.ts","../../src/peripleo/controls/Aggregations/components/AggregationsCarousel.tsx","../../src/peripleo/controls/Aggregations/components/AggregationValueList.tsx","../../src/peripleo/controls/Aggregations/AggregationsOverlay.tsx","../../src/peripleo/controls/Desktop.tsx","../../src/peripleo/controls/Info/InfoModal.tsx","../../src/peripleo/controls/Info/InfoControl.tsx","../../src/peripleo/controls/Mobile.tsx","../../src/peripleo/controls/MobileMenu/MobileMenu.tsx","../../src/peripleo/map/state/mapViewState.ts","../../src/peripleo/map/state/selectedState.ts","../../node_modules/@loaders.gl/loader-utils/dist/esm/lib/env-utils/assert.js","../../node_modules/@loaders.gl/loader-utils/dist/esm/lib/env-utils/globals.js","../../node_modules/@loaders.gl/worker-utils/dist/esm/lib/env-utils/version.js","../../node_modules/@loaders.gl/worker-utils/dist/esm/lib/env-utils/assert.js","../../node_modules/@loaders.gl/worker-utils/dist/esm/lib/env-utils/globals.js","../../node_modules/@babel/runtime/helpers/esm/typeof.js","../../node_modules/@babel/runtime/helpers/esm/toPrimitive.js","../../node_modules/@babel/runtime/helpers/esm/toPropertyKey.js","../../node_modules/@babel/runtime/helpers/esm/defineProperty.js","../../node_modules/@loaders.gl/worker-utils/dist/esm/lib/worker-farm/worker-job.js","../../node_modules/@loaders.gl/worker-utils/dist/esm/lib/node/worker_threads-browser.js","../../node_modules/@loaders.gl/worker-utils/dist/esm/lib/worker-utils/get-loadable-worker-url.js","../../node_modules/@loaders.gl/worker-utils/dist/esm/lib/worker-utils/get-transfer-list.js","../../node_modules/@loaders.gl/worker-utils/dist/esm/lib/worker-farm/worker-thread.js","../../node_modules/@loaders.gl/worker-utils/dist/esm/lib/worker-farm/worker-pool.js","../../node_modules/@loaders.gl/worker-utils/dist/esm/lib/worker-farm/worker-farm.js","../../node_modules/@loaders.gl/worker-utils/dist/esm/lib/worker-api/get-worker-url.js","../../node_modules/@loaders.gl/worker-utils/dist/esm/lib/worker-api/validate-worker-version.js","../../node_modules/@loaders.gl/loader-utils/dist/esm/lib/worker-loader-utils/parse-with-worker.js","../../node_modules/@loaders.gl/loader-utils/dist/esm/lib/binary-utils/array-buffer-utils.js","../../node_modules/@loaders.gl/loader-utils/dist/esm/lib/iterators/async-iteration.js","../../node_modules/@loaders.gl/loader-utils/dist/esm/lib/path-utils/file-aliases.js","../../node_modules/@loaders.gl/loader-utils/dist/esm/lib/binary-utils/memory-conversion-utils.js","../../node_modules/@loaders.gl/loader-utils/dist/esm/lib/path-utils/path.js","../../node_modules/@loaders.gl/core/dist/esm/javascript-utils/is-type.js","../../node_modules/@loaders.gl/core/dist/esm/lib/utils/mime-type-utils.js","../../node_modules/@loaders.gl/core/dist/esm/lib/utils/url-utils.js","../../node_modules/@loaders.gl/core/dist/esm/lib/utils/resource-utils.js","../../node_modules/@loaders.gl/core/dist/esm/lib/utils/response-utils.js","../../node_modules/@loaders.gl/core/dist/esm/lib/fetch/fetch-file.js","../../node_modules/@loaders.gl/core/node_modules/@probe.gl/env/dist/lib/is-electron.js","../../node_modules/@loaders.gl/core/node_modules/@probe.gl/env/dist/lib/is-browser.js","../../node_modules/@loaders.gl/core/node_modules/@probe.gl/env/dist/lib/globals.js","../../node_modules/@loaders.gl/core/node_modules/@probe.gl/env/dist/utils/globals.js","../../node_modules/@loaders.gl/core/node_modules/@probe.gl/log/dist/utils/local-storage.js","../../node_modules/@loaders.gl/core/node_modules/@probe.gl/log/dist/utils/formatters.js","../../node_modules/@loaders.gl/core/node_modules/@probe.gl/log/dist/utils/color.js","../../node_modules/@loaders.gl/core/node_modules/@probe.gl/log/dist/utils/autobind.js","../../node_modules/@loaders.gl/core/node_modules/@probe.gl/log/dist/utils/assert.js","../../node_modules/@loaders.gl/core/node_modules/@probe.gl/log/dist/utils/hi-res-timestamp.js","../../node_modules/@loaders.gl/core/node_modules/@probe.gl/log/dist/log.js","../../node_modules/@loaders.gl/core/dist/esm/lib/loader-utils/loggers.js","../../node_modules/@loaders.gl/core/dist/esm/lib/loader-utils/option-defaults.js","../../node_modules/@loaders.gl/core/dist/esm/lib/loader-utils/option-utils.js","../../node_modules/@loaders.gl/core/dist/esm/lib/loader-utils/normalize-loader.js","../../node_modules/@loaders.gl/core/dist/esm/lib/api/register-loaders.js","../../node_modules/@loaders.gl/core/dist/esm/lib/utils/log.js","../../node_modules/@loaders.gl/core/dist/esm/lib/api/select-loader.js","../../node_modules/@loaders.gl/core/dist/esm/iterators/make-iterator/make-string-iterator.js","../../node_modules/@loaders.gl/core/dist/esm/iterators/make-iterator/make-array-buffer-iterator.js","../../node_modules/@loaders.gl/core/dist/esm/iterators/make-iterator/make-blob-iterator.js","../../node_modules/@loaders.gl/core/dist/esm/iterators/make-iterator/make-stream-iterator.js","../../node_modules/@loaders.gl/core/dist/esm/iterators/make-iterator/make-iterator.js","../../node_modules/@loaders.gl/core/dist/esm/lib/loader-utils/get-data.js","../../node_modules/@loaders.gl/core/dist/esm/lib/loader-utils/get-fetch-function.js","../../node_modules/@loaders.gl/core/dist/esm/lib/loader-utils/loader-context.js","../../node_modules/@loaders.gl/core/dist/esm/lib/api/parse.js","../../node_modules/@loaders.gl/core/dist/esm/lib/api/load.js","../../node_modules/@loaders.gl/images/dist/esm/lib/utils/version.js","../../node_modules/@loaders.gl/images/dist/esm/lib/category-api/image-type.js","../../node_modules/@loaders.gl/images/dist/esm/lib/category-api/parsed-image-api.js","../../node_modules/@loaders.gl/images/dist/esm/lib/parsers/svg-utils.js","../../node_modules/@loaders.gl/images/dist/esm/lib/parsers/parse-to-image.js","../../node_modules/@loaders.gl/images/dist/esm/lib/parsers/parse-to-image-bitmap.js","../../node_modules/@loaders.gl/images/dist/esm/lib/category-api/parse-isobmff-binary.js","../../node_modules/@loaders.gl/images/dist/esm/lib/category-api/binary-image-api.js","../../node_modules/@loaders.gl/images/dist/esm/lib/parsers/parse-to-node-image.js","../../node_modules/@loaders.gl/images/dist/esm/lib/parsers/parse-image.js","../../node_modules/@loaders.gl/images/dist/esm/image-loader.js","../../node_modules/@probe.gl/env/dist/esm/lib/is-electron.js","../../node_modules/@probe.gl/env/dist/esm/lib/is-browser.js","../../node_modules/@probe.gl/env/dist/esm/lib/globals.js","../../node_modules/@probe.gl/env/dist/esm/utils/globals.js","../../node_modules/@probe.gl/env/dist/esm/lib/get-browser.js","../../node_modules/@probe.gl/log/dist/esm/utils/local-storage.js","../../node_modules/@probe.gl/log/dist/esm/utils/formatters.js","../../node_modules/@probe.gl/log/dist/esm/utils/color.js","../../node_modules/@probe.gl/log/dist/esm/utils/autobind.js","../../node_modules/@probe.gl/log/dist/esm/utils/assert.js","../../node_modules/@probe.gl/log/dist/esm/utils/hi-res-timestamp.js","../../node_modules/@probe.gl/log/dist/esm/log.js","../../node_modules/@deck.gl/core/dist/esm/utils/log.js","../../node_modules/@deck.gl/core/dist/esm/debug/index.js","../../node_modules/@deck.gl/core/dist/esm/utils/json-loader.js","../../node_modules/@deck.gl/core/dist/esm/lib/init.js","../../node_modules/@luma.gl/gltools/dist/esm/utils/log.js","../../node_modules/@luma.gl/gltools/dist/esm/utils/assert.js","../../node_modules/@luma.gl/gltools/dist/esm/utils/webgl-checks.js","../../node_modules/@luma.gl/gltools/dist/esm/polyfill/polyfill-vertex-array-object.js","../../node_modules/@luma.gl/gltools/dist/esm/polyfill/get-parameter-polyfill.js","../../node_modules/@luma.gl/gltools/dist/esm/polyfill/polyfill-table.js","../../node_modules/@luma.gl/gltools/dist/esm/polyfill/polyfill-context.js","../../node_modules/@luma.gl/gltools/dist/esm/state-tracker/webgl-parameter-tables.js","../../node_modules/@luma.gl/gltools/dist/esm/utils/utils.js","../../node_modules/@luma.gl/gltools/dist/esm/state-tracker/track-context-state.js","../../node_modules/@luma.gl/gltools/dist/esm/state-tracker/unified-parameter-api.js","../../node_modules/@luma.gl/gltools/dist/esm/utils/device-pixels.js","../../node_modules/@luma.gl/gltools/dist/esm/context/context.js","../../node_modules/@probe.gl/stats/dist/esm/utils/hi-res-timestamp.js","../../node_modules/@probe.gl/stats/dist/esm/lib/stat.js","../../node_modules/@probe.gl/stats/dist/esm/lib/stats.js","../../node_modules/@luma.gl/webgl/dist/esm/init.js","../../node_modules/@luma.gl/webgl/dist/esm/webgl-utils/request-animation-frame.js","../../node_modules/@luma.gl/webgl/dist/esm/utils/assert.js","../../node_modules/@luma.gl/webgl/dist/esm/webgl-utils/constants-to-keys.js","../../node_modules/@luma.gl/webgl/dist/esm/utils/utils.js","../../node_modules/@luma.gl/webgl/dist/esm/utils/stub-methods.js","../../node_modules/@luma.gl/webgl/dist/esm/classes/resource.js","../../node_modules/@luma.gl/webgl/dist/esm/webgl-utils/typed-array-utils.js","../../node_modules/@luma.gl/webgl/dist/esm/utils/check-props.js","../../node_modules/@luma.gl/webgl/dist/esm/classes/accessor.js","../../node_modules/@luma.gl/webgl/dist/esm/classes/buffer.js","../../node_modules/@luma.gl/webgl/dist/esm/classes/texture-formats.js","../../node_modules/@luma.gl/webgl/dist/esm/classes/texture.js","../../node_modules/@luma.gl/webgl/dist/esm/utils/load-file.js","../../node_modules/@luma.gl/webgl/dist/esm/classes/texture-2d.js","../../node_modules/@luma.gl/webgl/dist/esm/classes/texture-cube.js","../../node_modules/@luma.gl/webgl/dist/esm/classes/texture-3d.js","../../node_modules/@luma.gl/webgl/dist/esm/classes/renderbuffer-formats.js","../../node_modules/@luma.gl/webgl/dist/esm/classes/renderbuffer.js","../../node_modules/@luma.gl/webgl/dist/esm/classes/clear.js","../../node_modules/@luma.gl/webgl/dist/esm/webgl-utils/format-utils.js","../../node_modules/@luma.gl/webgl/dist/esm/classes/copy-and-blit.js","../../node_modules/@luma.gl/webgl/dist/esm/features/webgl-features-table.js","../../node_modules/@luma.gl/webgl/dist/esm/features/features.js","../../node_modules/@luma.gl/webgl/dist/esm/classes/framebuffer.js","../../node_modules/@luma.gl/webgl/dist/esm/webgl-utils/texture-utils.js","../../node_modules/@luma.gl/webgl/dist/esm/glsl-utils/get-shader-name.js","../../node_modules/@luma.gl/webgl/dist/esm/glsl-utils/get-shader-type-name.js","../../node_modules/@luma.gl/webgl/dist/esm/glsl-utils/format-glsl-error.js","../../node_modules/@luma.gl/webgl/dist/esm/glsl-utils/get-shader-version.js","../../node_modules/@luma.gl/webgl/dist/esm/classes/shader.js","../../node_modules/@luma.gl/webgl/dist/esm/classes/uniforms.js","../../node_modules/@luma.gl/webgl/dist/esm/webgl-utils/attribute-utils.js","../../node_modules/@luma.gl/webgl/dist/esm/classes/program-configuration.js","../../node_modules/@luma.gl/webgl/dist/esm/classes/program.js","../../node_modules/@luma.gl/webgl/dist/esm/classes/query.js","../../node_modules/@luma.gl/webgl/dist/esm/classes/transform-feedback.js","../../node_modules/@luma.gl/webgl/dist/esm/utils/array-utils-flat.js","../../node_modules/@luma.gl/webgl/dist/esm/classes/vertex-array-object.js","../../node_modules/@luma.gl/webgl/dist/esm/classes/vertex-array.js","../../node_modules/@luma.gl/webgl/dist/esm/utils/format-value.js","../../node_modules/@luma.gl/webgl/dist/esm/debug/debug-uniforms.js","../../node_modules/@luma.gl/webgl/dist/esm/debug/debug-vertex-array.js","../../node_modules/@luma.gl/webgl/dist/esm/debug/debug-program-configuration.js","../../node_modules/@luma.gl/engine/dist/esm/lib/animation-loop.js","../../node_modules/@luma.gl/shadertools/dist/esm/lib/constants.js","../../node_modules/@luma.gl/shadertools/dist/esm/utils/assert.js","../../node_modules/@luma.gl/shadertools/dist/esm/lib/filters/prop-types.js","../../node_modules/@luma.gl/shadertools/dist/esm/lib/shader-module.js","../../node_modules/@luma.gl/shadertools/dist/esm/lib/resolve-modules.js","../../node_modules/@luma.gl/shadertools/dist/esm/utils/is-old-ie.js","../../node_modules/@luma.gl/shadertools/dist/esm/utils/webgl-info.js","../../node_modules/@luma.gl/shadertools/dist/esm/lib/platform-defines.js","../../node_modules/@luma.gl/shadertools/dist/esm/modules/module-injectors.js","../../node_modules/@luma.gl/shadertools/dist/esm/lib/inject-shader.js","../../node_modules/@luma.gl/shadertools/dist/esm/lib/transpile-shader.js","../../node_modules/@luma.gl/shadertools/dist/esm/lib/assemble-shaders.js","../../node_modules/@luma.gl/shadertools/dist/esm/utils/shader-utils.js","../../node_modules/@luma.gl/shadertools/dist/esm/modules/fp32/fp32.js","../../node_modules/@math.gl/core/dist/esm/lib/assert.js","../../node_modules/@math.gl/core/dist/esm/lib/common.js","../../node_modules/@math.gl/core/dist/esm/classes/base/math-array.js","../../node_modules/@math.gl/core/dist/esm/lib/validators.js","../../node_modules/@math.gl/core/dist/esm/classes/base/vector.js","../../node_modules/gl-matrix/esm/common.js","../../node_modules/gl-matrix/esm/vec2.js","../../node_modules/@math.gl/core/dist/esm/lib/gl-matrix-extras.js","../../node_modules/gl-matrix/esm/vec3.js","../../node_modules/@math.gl/core/dist/esm/classes/vector3.js","../../node_modules/@math.gl/core/dist/esm/classes/base/matrix.js","../../node_modules/gl-matrix/esm/mat4.js","../../node_modules/gl-matrix/esm/vec4.js","../../node_modules/@math.gl/core/dist/esm/classes/matrix4.js","../../node_modules/@math.gl/core/dist/esm/classes/spherical-coordinates.js","../../node_modules/@luma.gl/shadertools/dist/esm/modules/picking/picking.js","../../node_modules/@luma.gl/shadertools/dist/esm/modules/transform/transform.js","../../node_modules/@luma.gl/engine/dist/esm/lib/program-manager.js","../../node_modules/@luma.gl/engine/dist/esm/lib/model-utils.js","../../node_modules/@luma.gl/engine/dist/esm/lib/model.js","../../node_modules/@luma.gl/engine/dist/esm/transform/buffer-transform.js","../../node_modules/@luma.gl/engine/dist/esm/transform/transform-shader-utils.js","../../node_modules/@luma.gl/engine/dist/esm/transform/texture-transform.js","../../node_modules/@luma.gl/engine/dist/esm/transform/transform.js","../../node_modules/@luma.gl/engine/dist/esm/animation/timeline.js","../../node_modules/@deck.gl/core/dist/esm/shaderlib/misc/geometry.js","../../node_modules/@deck.gl/core/dist/esm/lib/constants.js","../../node_modules/@deck.gl/core/dist/esm/shaderlib/project/project.glsl.js","../../node_modules/@deck.gl/core/dist/esm/utils/memoize.js","../../node_modules/@deck.gl/core/dist/esm/shaderlib/project/viewport-uniforms.js","../../node_modules/@deck.gl/core/dist/esm/shaderlib/project/project.js","../../node_modules/@math.gl/web-mercator/dist/esm/math-utils.js","../../node_modules/@math.gl/web-mercator/dist/esm/assert.js","../../node_modules/@math.gl/web-mercator/dist/esm/web-mercator-utils.js","../../node_modules/@math.gl/web-mercator/dist/esm/fit-bounds.js","../../node_modules/@math.gl/web-mercator/dist/esm/get-bounds.js","../../node_modules/@math.gl/web-mercator/dist/esm/normalize-viewport-props.js","../../node_modules/@deck.gl/core/dist/esm/shaderlib/shadow/shadow.js","../../node_modules/@deck.gl/core/dist/esm/shaderlib/picking/picking.js","../../node_modules/@deck.gl/core/dist/esm/shaderlib/index.js","../../node_modules/@deck.gl/core/dist/esm/effects/lighting/ambient-light.js","../../node_modules/@deck.gl/core/dist/esm/effects/lighting/directional-light.js","../../node_modules/@deck.gl/core/dist/esm/passes/pass.js","../../node_modules/@deck.gl/core/dist/esm/passes/layers-pass.js","../../node_modules/@deck.gl/core/dist/esm/passes/shadow-pass.js","../../node_modules/@deck.gl/core/dist/esm/effects/lighting/lighting-effect.js","../../node_modules/@deck.gl/core/dist/esm/utils/typed-array-manager.js","../../node_modules/@deck.gl/core/dist/esm/utils/math-utils.js","../../node_modules/@deck.gl/core/dist/esm/viewports/viewport.js","../../node_modules/@deck.gl/core/dist/esm/viewports/web-mercator-viewport.js","../../node_modules/@deck.gl/core/dist/esm/shaderlib/project/project-functions.js","../../node_modules/@deck.gl/core/dist/esm/lifecycle/constants.js","../../node_modules/@deck.gl/core/dist/esm/utils/flatten.js","../../node_modules/@deck.gl/core/dist/esm/lib/resource/resource.js","../../node_modules/@deck.gl/core/dist/esm/lib/resource/resource-manager.js","../../node_modules/@deck.gl/core/dist/esm/lib/layer-manager.js","../../node_modules/@deck.gl/core/dist/esm/utils/deep-equal.js","../../node_modules/@deck.gl/core/dist/esm/lib/view-manager.js","../../node_modules/@deck.gl/core/dist/esm/utils/positions.js","../../node_modules/@deck.gl/core/dist/esm/utils/assert.js","../../node_modules/@deck.gl/core/dist/esm/views/view.js","../../node_modules/@deck.gl/core/dist/esm/transitions/transition.js","../../node_modules/@deck.gl/core/dist/esm/controllers/transition-manager.js","../../node_modules/@deck.gl/core/dist/esm/transitions/transition-interpolator.js","../../node_modules/@deck.gl/core/dist/esm/transitions/linear-interpolator.js","../../node_modules/@deck.gl/core/dist/esm/controllers/controller.js","../../node_modules/@deck.gl/core/dist/esm/controllers/view-state.js","../../node_modules/@deck.gl/core/dist/esm/controllers/map-controller.js","../../node_modules/@deck.gl/core/dist/esm/views/map-view.js","../../node_modules/@deck.gl/core/dist/esm/passes/mask-pass.js","../../node_modules/@deck.gl/core/dist/esm/viewports/orthographic-viewport.js","../../node_modules/@deck.gl/core/dist/esm/controllers/orbit-controller.js","../../node_modules/@deck.gl/core/dist/esm/controllers/orthographic-controller.js","../../node_modules/@deck.gl/core/dist/esm/views/orthographic-view.js","../../node_modules/@deck.gl/core/dist/esm/effects/mask/utils.js","../../node_modules/@deck.gl/core/dist/esm/effects/mask/mask-effect.js","../../node_modules/@deck.gl/core/dist/esm/lib/effect-manager.js","../../node_modules/@deck.gl/core/dist/esm/passes/draw-layers-pass.js","../../node_modules/@deck.gl/core/dist/esm/passes/pick-layers-pass.js","../../node_modules/@deck.gl/core/dist/esm/lib/deck-renderer.js","../../node_modules/@deck.gl/core/dist/esm/lib/picking/query-object.js","../../node_modules/@deck.gl/core/dist/esm/lib/picking/pick-info.js","../../node_modules/@deck.gl/core/dist/esm/lib/deck-picker.js","../../node_modules/@deck.gl/core/dist/esm/lib/tooltip.js","../../node_modules/hammerjs/hammer.js","../../node_modules/mjolnir.js/dist/esm/utils/hammer-overrides.js","../../node_modules/mjolnir.js/dist/esm/utils/hammer.browser.js","../../node_modules/mjolnir.js/dist/esm/inputs/input.js","../../node_modules/mjolnir.js/dist/esm/constants.js","../../node_modules/mjolnir.js/dist/esm/utils/globals.js","../../node_modules/mjolnir.js/dist/esm/inputs/wheel-input.js","../../node_modules/mjolnir.js/dist/esm/inputs/move-input.js","../../node_modules/mjolnir.js/dist/esm/inputs/key-input.js","../../node_modules/mjolnir.js/dist/esm/inputs/contextmenu-input.js","../../node_modules/mjolnir.js/dist/esm/utils/event-utils.js","../../node_modules/mjolnir.js/dist/esm/utils/event-registrar.js","../../node_modules/mjolnir.js/dist/esm/event-manager.js","../../node_modules/@deck.gl/core/dist/esm/lib/deck.js","../../node_modules/@deck.gl/core/dist/esm/lib/attribute/shader-attribute.js","../../node_modules/@deck.gl/core/dist/esm/lib/attribute/gl-utils.js","../../node_modules/@deck.gl/core/dist/esm/lib/attribute/data-column.js","../../node_modules/@deck.gl/core/dist/esm/utils/iterable-utils.js","../../node_modules/@deck.gl/core/dist/esm/utils/range.js","../../node_modules/@deck.gl/core/dist/esm/utils/array-utils.js","../../node_modules/@deck.gl/core/dist/esm/lib/attribute/attribute-transition-utils.js","../../node_modules/@deck.gl/core/dist/esm/lib/attribute/attribute.js","../../node_modules/@deck.gl/core/dist/esm/transitions/gpu-interpolation-transition.js","../../node_modules/@deck.gl/core/dist/esm/transitions/gpu-spring-transition.js","../../node_modules/@deck.gl/core/dist/esm/lib/attribute/attribute-transition-manager.js","../../node_modules/@deck.gl/core/dist/esm/lib/attribute/attribute-manager.js","../../node_modules/@deck.gl/core/dist/esm/transitions/cpu-interpolation-transition.js","../../node_modules/@deck.gl/core/dist/esm/transitions/cpu-spring-transition.js","../../node_modules/@deck.gl/core/dist/esm/lib/uniform-transition-manager.js","../../node_modules/@deck.gl/core/dist/esm/lifecycle/props.js","../../node_modules/@deck.gl/core/dist/esm/utils/count.js","../../node_modules/@deck.gl/core/dist/esm/utils/shader.js","../../node_modules/@deck.gl/core/dist/esm/utils/texture.js","../../node_modules/@deck.gl/core/dist/esm/lifecycle/prop-types.js","../../node_modules/@deck.gl/core/dist/esm/lifecycle/create-props.js","../../node_modules/@deck.gl/core/dist/esm/lifecycle/component.js","../../node_modules/@deck.gl/core/dist/esm/lifecycle/component-state.js","../../node_modules/@deck.gl/core/dist/esm/lib/layer-state.js","../../node_modules/@deck.gl/core/dist/esm/lib/layer.js","../../node_modules/@deck.gl/core/dist/esm/lib/composite-layer.js","../../node_modules/@deck.gl/core/dist/esm/viewports/globe-viewport.js","../../node_modules/@deck.gl/core/dist/esm/viewports/orbit-viewport.js","../../node_modules/@deck.gl/core/dist/esm/viewports/first-person-viewport.js","../../node_modules/@deck.gl/core/dist/esm/controllers/first-person-controller.js","../../node_modules/@deck.gl/core/dist/esm/views/first-person-view.js","../../node_modules/@deck.gl/core/dist/esm/views/orbit-view.js","../../node_modules/@deck.gl/core/dist/esm/controllers/globe-controller.js","../../node_modules/@deck.gl/core/dist/esm/views/globe-view.js","../../node_modules/@deck.gl/core/dist/esm/lib/layer-extension.js","../../src/peripleo/map/components/Map/initialState.ts","../../src/peripleo/map/components/Map/MapLibre/MapLibre.tsx","../../node_modules/@deck.gl/react/dist/esm/utils/use-isomorphic-layout-effect.js","../../node_modules/@deck.gl/react/dist/esm/utils/inherits-from.js","../../node_modules/@deck.gl/react/dist/esm/utils/evaluate-children.js","../../node_modules/@deck.gl/react/dist/esm/utils/extract-jsx-layers.js","../../node_modules/@deck.gl/react/dist/esm/utils/position-children-under-views.js","../../node_modules/@deck.gl/react/dist/esm/utils/extract-styles.js","../../node_modules/@deck.gl/react/dist/esm/deckgl.js","../../src/peripleo/map/components/Map/MapLibreDeckGL/DeckGLMap.tsx","../../src/peripleo/map/components/Map/MapLibreDeckGL/DeckGLContainer.tsx","../../src/peripleo/map/components/Map/MapLibre/layers/HeatmapLayer.tsx","../../src/peripleo/map/components/Map/index.ts","../../src/peripleo/map/components/useAutoPosition.ts","../../src/peripleo/map/components/PopupContainer.tsx","../../src/peripleo/map/components/TooltipContainer.tsx","../../src/peripleo/map/hooks/useMap.ts","../../src/peripleo/map/hooks/useViewState.ts","../../src/peripleo/controls/MyLocation/MyLocationControl.tsx","../../src/peripleo/controls/Controls.tsx","../../src/peripleo/controls/Scrollable.tsx","../../src/peripleo/controls/Zoom/ZoomControl.tsx","../../src/Colors.js","../../src/components/KimaPopup/ListPreviewCard.jsx","../../src/components/KimaPopup/useAutoPosition.js","../../src/components/FullscreenImage/FullscreenImage.jsx","../../src/components/KimaPopup/utils.js","../../src/Icons.jsx","../../src/session.js","../../src/Config.js","../../src/components/KimaPopup/SelectedCard.jsx","../../src/components/KimaPopup/KimaPopup.jsx","../../src/components/KimaStore/KimaAPI.js","../../src/components/KimaStore/KimaSearchHandler.jsx","../../src/components/KimaStore/KimaGraphProvider.jsx","../../src/components/KimaStore/KimaStore.jsx","../../src/components/KimaTooltip/KimaTooltip.jsx","../../src/components/LoadIndicator/LoadIndicator.jsx","../../src/index.jsx"],"sourcesContent":["__VITE_IS_MODERN__&&(function polyfill() {\n    const relList = document.createElement('link').relList;\n    if (relList && relList.supports && relList.supports('modulepreload')) {\n        return;\n    }\n    for (const link of document.querySelectorAll('link[rel=\"modulepreload\"]')) {\n        processPreload(link);\n    }\n    new MutationObserver((mutations) => {\n        for (const mutation of mutations) {\n            if (mutation.type !== 'childList') {\n                continue;\n            }\n            for (const node of mutation.addedNodes) {\n                if (node.tagName === 'LINK' && node.rel === 'modulepreload')\n                    processPreload(node);\n            }\n        }\n    }).observe(document, { childList: true, subtree: true });\n    function getFetchOpts(script) {\n        const fetchOpts = {};\n        if (script.integrity)\n            fetchOpts.integrity = script.integrity;\n        if (script.referrerpolicy)\n            fetchOpts.referrerPolicy = script.referrerpolicy;\n        if (script.crossorigin === 'use-credentials')\n            fetchOpts.credentials = 'include';\n        else if (script.crossorigin === 'anonymous')\n            fetchOpts.credentials = 'omit';\n        else\n            fetchOpts.credentials = 'same-origin';\n        return fetchOpts;\n    }\n    function processPreload(link) {\n        if (link.ep)\n            // ep marker = processed\n            return;\n        link.ep = true;\n        // prepopulate the load record\n        const fetchOpts = getFetchOpts(link);\n        fetch(link.href, fetchOpts);\n    }\n}());","export interface Device {\r\n\r\n  size: Size\r\n\r\n  isTouchDevice: boolean\r\n\r\n}\r\n\r\nexport enum Size {\r\n\r\n  MOBILE = 'MOBILE',\r\n\r\n  DESKTOP = 'DESKTOP'\r\n\r\n}","import React, { createContext, useContext, useLayoutEffect, useState } from 'react';\r\nimport { Device, Size } from './Device';\r\n\r\nconst isTouchDevice = (('ontouchstart' in window) ||\r\n  (navigator.maxTouchPoints > 0) ||\r\n  // @ts-ignore\r\n  (navigator.msMaxTouchPoints > 0));\r\n\r\nconst DeviceStateContext = createContext<Device>({ size: Size.DESKTOP, isTouchDevice });\r\n\r\ntype DeviceStateContextProviderProps = {\r\n\r\n  children: React.ReactElement\r\n\r\n  breakPoint: number\r\n\r\n}\r\n\r\nexport const DeviceStateContextProvider = (props: DeviceStateContextProviderProps) => {\r\n\r\n  const [device, setDevice] = useState<Device>({\r\n    size: window.innerWidth > props.breakPoint ? Size.DESKTOP : Size.MOBILE, \r\n    isTouchDevice\r\n  });\r\n\r\n  useLayoutEffect(() => {\r\n    const onWindowResize = (evt: UIEvent) => {\r\n      const w = window.innerWidth;\r\n\r\n      if (w > props.breakPoint  && device.size === Size.MOBILE) {\r\n        setDevice({ ...device, size: Size.DESKTOP });\r\n      } else if (w < props.breakPoint && device.size === Size.DESKTOP) {\r\n        setDevice({ ...device, size: Size.MOBILE });\r\n      }\r\n    }\r\n\r\n    window.addEventListener('resize', onWindowResize);\r\n\r\n    return () => window.removeEventListener('resize', onWindowResize);\r\n  }, [ props.breakPoint, device ]);\r\n\r\n  return (\r\n    <DeviceStateContext.Provider value={device}>\r\n      {props.children}\r\n    </DeviceStateContext.Provider>\r\n  )\r\n  \r\n}\r\n\r\nexport const useDeviceState = () => {\r\n  \r\n  return useContext(DeviceStateContext);\r\n\r\n}","import React from 'react';\r\nimport { RecoilRoot } from 'recoil';\r\nimport { MapProvider } from 'react-map-gl';\r\nimport { DeviceStateContextProvider } from './device';\r\n\r\ntype PeripleoProps = {\r\n\r\n  children: React.ReactElement \r\n\r\n  breakPoint?: number\r\n\r\n}\r\n\r\n// Peripleo acts as a context provider. Every component\r\n// inside Peripleo:\r\n// \r\n// - has access to the map\r\n// - can access central Recoil state\r\n// - can use all Peripleo-specific hooks (which might depend on map or state)\r\nconst Peripleo = (props: PeripleoProps) => {\r\n\r\n  return (\r\n    <RecoilRoot>\r\n      <DeviceStateContextProvider breakPoint={props.breakPoint || 540}>\r\n        <MapProvider>\r\n          {props.children}\r\n        </MapProvider>\r\n      </DeviceStateContextProvider>\r\n    </RecoilRoot>\r\n  )\r\n\r\n}\r\n\r\nexport default Peripleo;","import { createContext, useContext } from 'react';\r\nimport { Graph } from '../types';\r\n\r\nexport const GraphContext = createContext<Graph>({} as Graph);\r\n\r\nexport const useGraph = () => {\r\n  \r\n  return useContext(GraphContext);\r\n\r\n}","export interface SearchState {\r\n  \r\n  args: SearchArgs;\r\n  \r\n  status: SearchStatus;\r\n    \r\n  result?: SearchResult | null;\r\n  \r\n}\r\n\r\n\r\nexport interface SearchArgs {\r\n\r\n  query?: string\r\n\r\n  filters?: Filter[]\r\n\r\n  activeAggregation?: string\r\n\r\n  fitMap?: boolean\r\n\r\n}\r\n\r\n\r\nexport interface Filter {\r\n\r\n  name: string\r\n\r\n  [key: string]: any;\r\n\r\n}\r\n\r\n\r\nexport enum SearchStatus {\r\n\r\n  PENDING = 'PENDING',\r\n\r\n  OK = 'OK',\r\n\r\n  FAILED = 'FAILED'\r\n\r\n}\r\n\r\n\r\nexport interface SearchResult {\r\n\r\n  total: number,\r\n\r\n  items: ResultItem[],\r\n\r\n  aggregations?: {\r\n\r\n    [key: string]: {\r\n\r\n      buckets: {\r\n\r\n        label: string,\r\n        \r\n        count: number\r\n        \r\n      }[]\r\n\r\n    }\r\n\r\n  }\r\n\r\n}\r\n\r\n\r\nexport interface ResultItem {\r\n\r\n  id: string;\r\n\r\n  [key: string]: any;\r\n\r\n}","import { atom } from 'recoil';\r\nimport { SearchState, SearchStatus } from '../types';\r\n\r\nexport const searchState = atom<SearchState>({\r\n  key: 'search',\r\n  default: { args: {}, status: SearchStatus.OK }\r\n});","import { useRecoilState } from 'recoil';\r\nimport { Filter, SearchArgs, SearchStatus  } from '../types';\r\nimport { searchState } from '../state';\r\n\r\nexport const useSearch = () => {\r\n\r\n  const [ search, setSearchState ] = useRecoilState(searchState);\r\n\r\n  const runSearch = (args: SearchArgs = {}) =>\r\n    setSearchState({ args, status: SearchStatus.PENDING, result: search.result });\r\n\r\n  const refreshSearch = () =>\r\n    runSearch({ ...search.args });\r\n\r\n  const changeSearchQuery = (query: string) => \r\n    runSearch({ ...search.args, query });\r\n\r\n  const clearSearchQuery = () => \r\n    runSearch({ ...search.args, query: undefined });\r\n\r\n  const setFilter = (filter: Filter) => {\r\n    const updatedFilters = [\r\n      ...(search.args.filters || []).filter(f => f.name !== filter.name),\r\n      filter\r\n    ];\r\n\r\n    runSearch({ ...search.args, filters: updatedFilters });\r\n  }\r\n\r\n  // Note that switching the facet does not require \r\n  // a new search run!\r\n  const setActiveAggregation = (name: string) => \r\n    setSearchState({ \r\n      args: {\r\n        ...search.args,\r\n        activeAggregation: name\r\n      }, \r\n      status: search.status,\r\n      result: search.result \r\n    });\r\n\r\n  return {\r\n    changeSearchQuery,\r\n    clearSearchQuery,\r\n    refreshSearch,\r\n    search,\r\n    setActiveAggregation,\r\n    setFilter,\r\n    setSearchState\r\n  };\r\n\r\n}","import React from 'react';\r\nimport { \r\n  HiOutlineChevronLeft, \r\n  HiOutlineChevronRight \r\n} from 'react-icons/hi';\r\n\r\ntype AggregationsCarouselProps = {\r\n\r\n  aggregations: string[]\r\n\r\n  labels?: string[]\r\n\r\n  activeAggregation?: string\r\n\r\n  onChangeAggregation: Function\r\n\r\n}\r\n\r\nexport const AggregationsCarousel = (props: AggregationsCarouselProps) => {\r\n\r\n  const activeAggregation = props.activeAggregation || props.aggregations[0] || '';\r\n\r\n  const label = props.labels ?\r\n    props.labels[props.aggregations.indexOf(activeAggregation)] : activeAggregation;\r\n\r\n  const onChangeAggregation = (inc: number) => () => {\r\n    const { length } = props.aggregations;\r\n    const currentIdx = props.aggregations.indexOf(activeAggregation);\r\n    const updatedIdx = (currentIdx + inc + length) % length;\r\n    props.onChangeAggregation(props.aggregations[updatedIdx]);\r\n  }\r\n\r\n  return (\r\n    <div className=\"p6o-aggs-carousel\">\r\n      <button \r\n        tabIndex={4}\r\n        aria-label=\"Previous filter category\"\r\n        onClick={onChangeAggregation(-1)}>\r\n        <HiOutlineChevronLeft />\r\n      </button>\r\n        \r\n      <h3 \r\n        aria-live=\"polite\"\r\n        aria-atomic={true}>\r\n        {label}\r\n      </h3>\r\n      \r\n      <button\r\n        tabIndex={5}\r\n        aria-label=\"Next filter category\"\r\n        onClick={onChangeAggregation(1)}>\r\n        <HiOutlineChevronRight />\r\n      </button>\r\n    </div>\r\n  )\r\n\r\n}","import React from 'react';\r\nimport chroma from 'chroma-js';\r\n\r\nconst formatNumber = (num: number) => {\r\n  if (num > 1000)\r\n    return (num / 1000).toFixed(1) + 'k';\r\n  else if (num > 1000000)\r\n    return (num / 1000000).toFixed(1) + 'M';\r\n  else \r\n    return num;\r\n}\r\n\r\ntype AggregationValueListProps = {\r\n\r\n  buckets: { label: string, count: number }[]\r\n\r\n  colors: { [ key: string ]: string }\r\n\r\n  filterValues: string[]\r\n\r\n  onToggleFilterValue: Function\r\n\r\n}\r\n\r\nexport const AggregationValueList = (props: AggregationValueListProps) => {\r\n\r\n  return (\r\n    <div className=\"p6o-aggs-values\">\r\n      <ul>\r\n        {props.buckets.map(({ label, count }) => (\r\n          <li \r\n            key={label} \r\n            className={props.filterValues.length > 0 && !props.filterValues.includes(label) ? 'p6o-value-unselected' : ''}\r\n            onClick={props.onToggleFilterValue(label)}>\r\n            \r\n            <div className=\"p6o-agg-value-wrapper\">\r\n              <div className=\"p6o-agg-value\">\r\n                <span \r\n                  className=\"p6o-agg-value-count\"\r\n                  style={{ \r\n                    backgroundColor: props.colors && props.colors[label],\r\n                    borderColor: props.colors && props.colors[label ] && chroma(props.colors[label]).alpha(0.8).hex()\r\n                  }}>\r\n\r\n                  {formatNumber(count)}\r\n                </span>\r\n\r\n                <span className=\"p6o-agg-value-label\">{label}</span>\r\n              </div>\r\n            </div>\r\n          </li>\r\n        ))}\r\n      </ul>\r\n    </div>\r\n  )\r\n\r\n}","import React from 'react';\r\nimport { useSearch } from '../../store';\r\nimport { AggregationsProps } from './AggregationsProps';\r\nimport { AggregationsCarousel, AggregationValueList } from './components';\r\n\r\nimport './AggregationsOverlay.css';\r\n\r\nexport const AggregationsOverlay = (props: AggregationsProps) => {\r\n\r\n  const { search, setFilter, setActiveAggregation } = useSearch();\r\n  \r\n  const aggregations: string[] = search.result?.aggregations ?\r\n    Object.keys(search.result.aggregations) : [];\r\n\r\n  const displayed = props.displayFacets || aggregations;\r\n\r\n  const activeAggregation = search.args.activeAggregation || displayed[0] || '';\r\n\r\n  const filterValues: string[] = search.args.filters?.find(f => f.name === activeAggregation)?.values || [];\r\n\r\n  const onToggleFilterValue = (value: string) => () => {\r\n    const updated = filterValues.includes(value) ?\r\n      { name: activeAggregation, values: filterValues.filter(str => str !== value) } :\r\n      { name: activeAggregation, values: [...filterValues, value ]};\r\n    \r\n    setFilter(updated);\r\n  }\r\n\r\n  return (\r\n    <div className={props.fullscreen ? \"p6o-aggs p6o-aggs-overlay fullscreen\" : \"p6o-aggs p6o-aggs-overlay\"}>\r\n      <AggregationsCarousel \r\n        aggregations={displayed} \r\n        labels={props.facetLabels}\r\n        activeAggregation={activeAggregation}\r\n        onChangeAggregation={setActiveAggregation} />\r\n\r\n      {search.result?.aggregations &&\r\n        <AggregationValueList\r\n          buckets={search.result.aggregations[activeAggregation].buckets} \r\n          colors={props.colors} \r\n          filterValues={filterValues} \r\n          onToggleFilterValue={onToggleFilterValue} />\r\n      }\r\n    </div>\r\n  )\r\n\r\n}","import React from 'react';\r\nimport { Size, useDeviceState } from '../device';\r\n\r\nexport const Desktop = (props: { children: React.ReactElement }) => {\r\n\r\n  const device = useDeviceState();\r\n\r\n  return device.size === Size.DESKTOP ? props.children : null;\r\n\r\n}","import React, { useEffect, useRef, EventHandler } from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { IoCloseOutline } from 'react-icons/io5';\r\nimport { Size, useDeviceState } from '../../device';\r\n\r\nexport type InfoModalProps = {\r\n\r\n  children: React.ReactElement\r\n\r\n  className?: string\r\n\r\n  onClose: EventHandler<any>\r\n  \r\n}\r\n\r\nexport const InfoModal = (props: InfoModalProps) => {\r\n\r\n  const el = useRef<HTMLDivElement>(null);\r\n\r\n  const device = useDeviceState();\r\n\r\n  useEffect(() => {\r\n    const onKeyDown = (evt: KeyboardEvent) => {\r\n      if (evt.key === 'Escape')\r\n        props.onClose(null);\r\n    }\r\n\r\n    document.addEventListener('keydown', onKeyDown);\r\n\r\n    return () => document.removeEventListener('keydown', onKeyDown);\r\n  }, []);\r\n\r\n  const onClick = (evt: React.MouseEvent) => {\r\n    if (evt.target === el.current)\r\n      props.onClose(evt);\r\n  }\r\n\r\n  return ReactDOM.createPortal(\r\n    <div \r\n      ref={el}\r\n      className={props.className ? `p6o-info-modal-bg ${props.className}` : 'p6o-info-modal-bg'} \r\n      onClick={onClick}>\r\n      <button\r\n        className={device.size === Size.DESKTOP ? 'p6o-info-modal-close' : 'p6o-info-modal-close mobile'}\r\n        onClick={props.onClose}>\r\n\r\n        <IoCloseOutline />\r\n\r\n      </button>\r\n      \r\n      <main className=\"p6o-info-modal-main\">\r\n        {props.children}\r\n      </main>\r\n    </div>,\r\n\r\n    document.body\r\n  )\r\n\r\n}","import React, { useState } from 'react';\r\nimport { IoInformation } from 'react-icons/io5';\r\nimport { InfoModal } from './InfoModal';\r\n\r\nimport './InfoControl.css';\r\n\r\nexport type InfoProps = {\r\n\r\n  children: React.ReactElement\r\n\r\n  className?: string\r\n\r\n}\r\n\r\nexport const InfoControl = (props: InfoProps) => {\r\n\r\n  const [modalOpen, setModalOpen] = useState(false);\r\n\r\n  return (\r\n    <>\r\n      <button \r\n        className=\"p6o-controls-btn p6o-info\"\r\n        tabIndex={41}\r\n        aria-label=\"Information\"\r\n        onClick={() => setModalOpen(true)}>\r\n        <IoInformation />\r\n      </button>\r\n\r\n      {modalOpen && (\r\n        <InfoModal\r\n          className={props.className}\r\n          onClose={() => setModalOpen(false)}>\r\n          {props.children}\r\n        </InfoModal>\r\n      )}\r\n    </>\r\n  )\r\n\r\n}","import React from 'react';\r\nimport { Size, useDeviceState } from '../device';\r\n\r\nexport const Mobile = (props: { children: React.ReactElement }) => {\r\n\r\n  const device = useDeviceState();\r\n\r\n  return device.size === Size.MOBILE ? props.children : null;\r\n\r\n}","import React, { useState } from 'react';\r\nimport { CSSTransition } from 'react-transition-group';\r\nimport { FiMenu } from 'react-icons/fi';\r\nimport { IoCloseOutline } from 'react-icons/io5';\r\n\r\nimport './MobileMenu.css';\r\n\r\ntype MobileMenuProps = {\r\n\r\n  items: React.ReactElement[]\r\n\r\n}\r\n\r\nexport const MobileMenu = (props: MobileMenuProps) => {\r\n\r\n  const [open, setOpen] = useState(false);\r\n\r\n  return (\r\n    <>\r\n      <button \r\n        className=\"p6o-controls-btn p6o-mobile-menu-btn\"\r\n        tabIndex={42}\r\n        aria-label=\"Open menu\"\r\n        onClick={() => setOpen(true)}>\r\n        <FiMenu />\r\n      </button>\r\n\r\n      <CSSTransition\r\n        in={open}\r\n        className=\"p6o-mobile-menu\"\r\n        classNames=\"p6o-mobile-menu\"\r\n        timeout={200}\r\n        unmountOnExit>\r\n\r\n        <div className=\"p6o-mobile-menu\">\r\n          <button\r\n            className=\"p6o-mobile-menu-close\"\r\n            onClick={() => setOpen(false)}>\r\n\r\n            <IoCloseOutline />\r\n          </button>\r\n\r\n          <main>\r\n            {props.items.length === 1  ? (\r\n              props.items[0]\r\n            ) : null}\r\n          </main>\r\n        </div>\r\n\r\n      </CSSTransition>\r\n    </>\r\n  )\r\n\r\n}","import { atom } from 'recoil';\r\nimport { ViewState } from '../types';\r\n\r\nexport const mapViewState = atom<ViewState>({\r\n  key: 'mapView',\r\n  default: {} as ViewState\r\n});\r\n\r\nexport const isValidViewState = (viewState: ViewState) => {\r\n  const { longitude, latitude, zoom } = viewState;\r\n\r\n  const def = x => x !== undefined;\r\n\r\n  return def(longitude) && def(latitude) && def(zoom);\r\n}","import { atom } from 'recoil';\r\nimport { MapSelection } from '../types';\r\n\r\nexport const selectedState = atom<MapSelection | null>({\r\n  key: 'selected',\r\n  default: null\r\n});","export function assert(condition, message) {\n  if (!condition) {\n    throw new Error(message || 'loader assertion failed.');\n  }\n}\n//# sourceMappingURL=assert.js.map","const globals = {\n  self: typeof self !== 'undefined' && self,\n  window: typeof window !== 'undefined' && window,\n  global: typeof global !== 'undefined' && global,\n  document: typeof document !== 'undefined' && document\n};\nconst self_ = globals.self || globals.window || globals.global || {};\nconst window_ = globals.window || globals.self || globals.global || {};\nconst global_ = globals.global || globals.self || globals.window || {};\nconst document_ = globals.document || {};\nexport { self_ as self, window_ as window, global_ as global, document_ as document };\nexport const isBrowser = Boolean(typeof process !== 'object' || String(process) !== '[object process]' || process.browser);\nexport const isWorker = typeof importScripts === 'function';\nconst matches = typeof process !== 'undefined' && process.version && /v([0-9]*)/.exec(process.version);\nexport const nodeVersion = matches && parseFloat(matches[1]) || 0;\n//# sourceMappingURL=globals.js.map","const DEFAULT_VERSION = 'latest';\nexport const VERSION = typeof \"3.4.14\" !== 'undefined' ? \"3.4.14\" : DEFAULT_VERSION;\nif (typeof \"3.4.14\" === 'undefined') {\n  console.error('loaders.gl: The __VERSION__ variable is not injected using babel plugin. Latest unstable workers would be fetched from the CDN.');\n}\n//# sourceMappingURL=version.js.map","export function assert(condition, message) {\n  if (!condition) {\n    throw new Error(message || 'loaders.gl assertion failed.');\n  }\n}\n//# sourceMappingURL=assert.js.map","const globals = {\n  self: typeof self !== 'undefined' && self,\n  window: typeof window !== 'undefined' && window,\n  global: typeof global !== 'undefined' && global,\n  document: typeof document !== 'undefined' && document\n};\nconst self_ = globals.self || globals.window || globals.global || {};\nconst window_ = globals.window || globals.self || globals.global || {};\nconst global_ = globals.global || globals.self || globals.window || {};\nconst document_ = globals.document || {};\nexport { self_ as self, window_ as window, global_ as global, document_ as document };\nexport const isBrowser = typeof process !== 'object' || String(process) !== '[object process]' || process.browser;\nexport const isWorker = typeof importScripts === 'function';\nexport const isMobile = typeof window !== 'undefined' && typeof window.orientation !== 'undefined';\nconst matches = typeof process !== 'undefined' && process.version && /v([0-9]*)/.exec(process.version);\nexport const nodeVersion = matches && parseFloat(matches[1]) || 0;\n//# sourceMappingURL=globals.js.map","export default function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, _typeof(o);\n}","import _typeof from \"./typeof.js\";\nexport default function toPrimitive(t, r) {\n  if (\"object\" != _typeof(t) || !t) return t;\n  var e = t[Symbol.toPrimitive];\n  if (void 0 !== e) {\n    var i = e.call(t, r || \"default\");\n    if (\"object\" != _typeof(i)) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (\"string\" === r ? String : Number)(t);\n}","import _typeof from \"./typeof.js\";\nimport toPrimitive from \"./toPrimitive.js\";\nexport default function toPropertyKey(t) {\n  var i = toPrimitive(t, \"string\");\n  return \"symbol\" == _typeof(i) ? i : String(i);\n}","import toPropertyKey from \"./toPropertyKey.js\";\nexport default function _defineProperty(obj, key, value) {\n  key = toPropertyKey(key);\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { assert } from '../env-utils/assert';\nexport default class WorkerJob {\n  constructor(jobName, workerThread) {\n    _defineProperty(this, \"name\", void 0);\n    _defineProperty(this, \"workerThread\", void 0);\n    _defineProperty(this, \"isRunning\", true);\n    _defineProperty(this, \"result\", void 0);\n    _defineProperty(this, \"_resolve\", () => {});\n    _defineProperty(this, \"_reject\", () => {});\n    this.name = jobName;\n    this.workerThread = workerThread;\n    this.result = new Promise((resolve, reject) => {\n      this._resolve = resolve;\n      this._reject = reject;\n    });\n  }\n  postMessage(type, payload) {\n    this.workerThread.postMessage({\n      source: 'loaders.gl',\n      type,\n      payload\n    });\n  }\n  done(value) {\n    assert(this.isRunning);\n    this.isRunning = false;\n    this._resolve(value);\n  }\n  error(error) {\n    assert(this.isRunning);\n    this.isRunning = false;\n    this._reject(error);\n  }\n}\n//# sourceMappingURL=worker-job.js.map","export class Worker {\n  terminate() {}\n}\nexport { Worker as NodeWorker };\nexport { Worker as NodeWorkerType };\nexport const parentPort = null;\n//# sourceMappingURL=worker_threads-browser.js.map","import { assert } from '../env-utils/assert';\nconst workerURLCache = new Map();\nexport function getLoadableWorkerURL(props) {\n  assert(props.source && !props.url || !props.source && props.url);\n  let workerURL = workerURLCache.get(props.source || props.url);\n  if (!workerURL) {\n    if (props.url) {\n      workerURL = getLoadableWorkerURLFromURL(props.url);\n      workerURLCache.set(props.url, workerURL);\n    }\n    if (props.source) {\n      workerURL = getLoadableWorkerURLFromSource(props.source);\n      workerURLCache.set(props.source, workerURL);\n    }\n  }\n  assert(workerURL);\n  return workerURL;\n}\nfunction getLoadableWorkerURLFromURL(url) {\n  if (!url.startsWith('http')) {\n    return url;\n  }\n  const workerSource = buildScriptSource(url);\n  return getLoadableWorkerURLFromSource(workerSource);\n}\nfunction getLoadableWorkerURLFromSource(workerSource) {\n  const blob = new Blob([workerSource], {\n    type: 'application/javascript'\n  });\n  return URL.createObjectURL(blob);\n}\nfunction buildScriptSource(workerUrl) {\n  return \"try {\\n  importScripts('\".concat(workerUrl, \"');\\n} catch (error) {\\n  console.error(error);\\n  throw error;\\n}\");\n}\n//# sourceMappingURL=get-loadable-worker-url.js.map","export function getTransferList(object) {\n  let recursive = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n  let transfers = arguments.length > 2 ? arguments[2] : undefined;\n  const transfersSet = transfers || new Set();\n  if (!object) {} else if (isTransferable(object)) {\n    transfersSet.add(object);\n  } else if (isTransferable(object.buffer)) {\n    transfersSet.add(object.buffer);\n  } else if (ArrayBuffer.isView(object)) {} else if (recursive && typeof object === 'object') {\n    for (const key in object) {\n      getTransferList(object[key], recursive, transfersSet);\n    }\n  }\n  return transfers === undefined ? Array.from(transfersSet) : [];\n}\nfunction isTransferable(object) {\n  if (!object) {\n    return false;\n  }\n  if (object instanceof ArrayBuffer) {\n    return true;\n  }\n  if (typeof MessagePort !== 'undefined' && object instanceof MessagePort) {\n    return true;\n  }\n  if (typeof ImageBitmap !== 'undefined' && object instanceof ImageBitmap) {\n    return true;\n  }\n  if (typeof OffscreenCanvas !== 'undefined' && object instanceof OffscreenCanvas) {\n    return true;\n  }\n  return false;\n}\nexport function getTransferListForWriter(object) {\n  if (object === null) {\n    return {};\n  }\n  const clone = Object.assign({}, object);\n  Object.keys(clone).forEach(key => {\n    if (typeof object[key] === 'object' && !ArrayBuffer.isView(object[key]) && !(object[key] instanceof Array)) {\n      clone[key] = getTransferListForWriter(object[key]);\n    } else if (typeof clone[key] === 'function' || clone[key] instanceof RegExp) {\n      clone[key] = {};\n    } else {\n      clone[key] = object[key];\n    }\n  });\n  return clone;\n}\n//# sourceMappingURL=get-transfer-list.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { NodeWorker } from '../node/worker_threads';\nimport { isBrowser } from '../env-utils/globals';\nimport { assert } from '../env-utils/assert';\nimport { getLoadableWorkerURL } from '../worker-utils/get-loadable-worker-url';\nimport { getTransferList } from '../worker-utils/get-transfer-list';\nconst NOOP = () => {};\nexport default class WorkerThread {\n  static isSupported() {\n    return typeof Worker !== 'undefined' && isBrowser || typeof NodeWorker !== 'undefined' && !isBrowser;\n  }\n  constructor(props) {\n    _defineProperty(this, \"name\", void 0);\n    _defineProperty(this, \"source\", void 0);\n    _defineProperty(this, \"url\", void 0);\n    _defineProperty(this, \"terminated\", false);\n    _defineProperty(this, \"worker\", void 0);\n    _defineProperty(this, \"onMessage\", void 0);\n    _defineProperty(this, \"onError\", void 0);\n    _defineProperty(this, \"_loadableURL\", '');\n    const {\n      name,\n      source,\n      url\n    } = props;\n    assert(source || url);\n    this.name = name;\n    this.source = source;\n    this.url = url;\n    this.onMessage = NOOP;\n    this.onError = error => console.log(error);\n    this.worker = isBrowser ? this._createBrowserWorker() : this._createNodeWorker();\n  }\n  destroy() {\n    this.onMessage = NOOP;\n    this.onError = NOOP;\n    this.worker.terminate();\n    this.terminated = true;\n  }\n  get isRunning() {\n    return Boolean(this.onMessage);\n  }\n  postMessage(data, transferList) {\n    transferList = transferList || getTransferList(data);\n    this.worker.postMessage(data, transferList);\n  }\n  _getErrorFromErrorEvent(event) {\n    let message = 'Failed to load ';\n    message += \"worker \".concat(this.name, \" from \").concat(this.url, \". \");\n    if (event.message) {\n      message += \"\".concat(event.message, \" in \");\n    }\n    if (event.lineno) {\n      message += \":\".concat(event.lineno, \":\").concat(event.colno);\n    }\n    return new Error(message);\n  }\n  _createBrowserWorker() {\n    this._loadableURL = getLoadableWorkerURL({\n      source: this.source,\n      url: this.url\n    });\n    const worker = new Worker(this._loadableURL, {\n      name: this.name\n    });\n    worker.onmessage = event => {\n      if (!event.data) {\n        this.onError(new Error('No data received'));\n      } else {\n        this.onMessage(event.data);\n      }\n    };\n    worker.onerror = error => {\n      this.onError(this._getErrorFromErrorEvent(error));\n      this.terminated = true;\n    };\n    worker.onmessageerror = event => console.error(event);\n    return worker;\n  }\n  _createNodeWorker() {\n    let worker;\n    if (this.url) {\n      const absolute = this.url.includes(':/') || this.url.startsWith('/');\n      const url = absolute ? this.url : \"./\".concat(this.url);\n      worker = new NodeWorker(url, {\n        eval: false\n      });\n    } else if (this.source) {\n      worker = new NodeWorker(this.source, {\n        eval: true\n      });\n    } else {\n      throw new Error('no worker');\n    }\n    worker.on('message', data => {\n      this.onMessage(data);\n    });\n    worker.on('error', error => {\n      this.onError(error);\n    });\n    worker.on('exit', code => {});\n    return worker;\n  }\n}\n//# sourceMappingURL=worker-thread.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { isMobile } from '../env-utils/globals';\nimport WorkerThread from './worker-thread';\nimport WorkerJob from './worker-job';\nexport default class WorkerPool {\n  static isSupported() {\n    return WorkerThread.isSupported();\n  }\n  constructor(props) {\n    _defineProperty(this, \"name\", 'unnamed');\n    _defineProperty(this, \"source\", void 0);\n    _defineProperty(this, \"url\", void 0);\n    _defineProperty(this, \"maxConcurrency\", 1);\n    _defineProperty(this, \"maxMobileConcurrency\", 1);\n    _defineProperty(this, \"onDebug\", () => {});\n    _defineProperty(this, \"reuseWorkers\", true);\n    _defineProperty(this, \"props\", {});\n    _defineProperty(this, \"jobQueue\", []);\n    _defineProperty(this, \"idleQueue\", []);\n    _defineProperty(this, \"count\", 0);\n    _defineProperty(this, \"isDestroyed\", false);\n    this.source = props.source;\n    this.url = props.url;\n    this.setProps(props);\n  }\n  destroy() {\n    this.idleQueue.forEach(worker => worker.destroy());\n    this.isDestroyed = true;\n  }\n  setProps(props) {\n    this.props = {\n      ...this.props,\n      ...props\n    };\n    if (props.name !== undefined) {\n      this.name = props.name;\n    }\n    if (props.maxConcurrency !== undefined) {\n      this.maxConcurrency = props.maxConcurrency;\n    }\n    if (props.maxMobileConcurrency !== undefined) {\n      this.maxMobileConcurrency = props.maxMobileConcurrency;\n    }\n    if (props.reuseWorkers !== undefined) {\n      this.reuseWorkers = props.reuseWorkers;\n    }\n    if (props.onDebug !== undefined) {\n      this.onDebug = props.onDebug;\n    }\n  }\n  async startJob(name) {\n    let onMessage = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : (job, type, data) => job.done(data);\n    let onError = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : (job, error) => job.error(error);\n    const startPromise = new Promise(onStart => {\n      this.jobQueue.push({\n        name,\n        onMessage,\n        onError,\n        onStart\n      });\n      return this;\n    });\n    this._startQueuedJob();\n    return await startPromise;\n  }\n  async _startQueuedJob() {\n    if (!this.jobQueue.length) {\n      return;\n    }\n    const workerThread = this._getAvailableWorker();\n    if (!workerThread) {\n      return;\n    }\n    const queuedJob = this.jobQueue.shift();\n    if (queuedJob) {\n      this.onDebug({\n        message: 'Starting job',\n        name: queuedJob.name,\n        workerThread,\n        backlog: this.jobQueue.length\n      });\n      const job = new WorkerJob(queuedJob.name, workerThread);\n      workerThread.onMessage = data => queuedJob.onMessage(job, data.type, data.payload);\n      workerThread.onError = error => queuedJob.onError(job, error);\n      queuedJob.onStart(job);\n      try {\n        await job.result;\n      } finally {\n        this.returnWorkerToQueue(workerThread);\n      }\n    }\n  }\n  returnWorkerToQueue(worker) {\n    const shouldDestroyWorker = this.isDestroyed || !this.reuseWorkers || this.count > this._getMaxConcurrency();\n    if (shouldDestroyWorker) {\n      worker.destroy();\n      this.count--;\n    } else {\n      this.idleQueue.push(worker);\n    }\n    if (!this.isDestroyed) {\n      this._startQueuedJob();\n    }\n  }\n  _getAvailableWorker() {\n    if (this.idleQueue.length > 0) {\n      return this.idleQueue.shift() || null;\n    }\n    if (this.count < this._getMaxConcurrency()) {\n      this.count++;\n      const name = \"\".concat(this.name.toLowerCase(), \" (#\").concat(this.count, \" of \").concat(this.maxConcurrency, \")\");\n      return new WorkerThread({\n        name,\n        source: this.source,\n        url: this.url\n      });\n    }\n    return null;\n  }\n  _getMaxConcurrency() {\n    return isMobile ? this.maxMobileConcurrency : this.maxConcurrency;\n  }\n}\n//# sourceMappingURL=worker-pool.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport WorkerPool from './worker-pool';\nimport WorkerThread from './worker-thread';\nconst DEFAULT_PROPS = {\n  maxConcurrency: 3,\n  maxMobileConcurrency: 1,\n  reuseWorkers: true,\n  onDebug: () => {}\n};\nexport default class WorkerFarm {\n  static isSupported() {\n    return WorkerThread.isSupported();\n  }\n  static getWorkerFarm() {\n    let props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    WorkerFarm._workerFarm = WorkerFarm._workerFarm || new WorkerFarm({});\n    WorkerFarm._workerFarm.setProps(props);\n    return WorkerFarm._workerFarm;\n  }\n  constructor(props) {\n    _defineProperty(this, \"props\", void 0);\n    _defineProperty(this, \"workerPools\", new Map());\n    this.props = {\n      ...DEFAULT_PROPS\n    };\n    this.setProps(props);\n    this.workerPools = new Map();\n  }\n  destroy() {\n    for (const workerPool of this.workerPools.values()) {\n      workerPool.destroy();\n    }\n    this.workerPools = new Map();\n  }\n  setProps(props) {\n    this.props = {\n      ...this.props,\n      ...props\n    };\n    for (const workerPool of this.workerPools.values()) {\n      workerPool.setProps(this._getWorkerPoolProps());\n    }\n  }\n  getWorkerPool(options) {\n    const {\n      name,\n      source,\n      url\n    } = options;\n    let workerPool = this.workerPools.get(name);\n    if (!workerPool) {\n      workerPool = new WorkerPool({\n        name,\n        source,\n        url\n      });\n      workerPool.setProps(this._getWorkerPoolProps());\n      this.workerPools.set(name, workerPool);\n    }\n    return workerPool;\n  }\n  _getWorkerPoolProps() {\n    return {\n      maxConcurrency: this.props.maxConcurrency,\n      maxMobileConcurrency: this.props.maxMobileConcurrency,\n      reuseWorkers: this.props.reuseWorkers,\n      onDebug: this.props.onDebug\n    };\n  }\n}\n_defineProperty(WorkerFarm, \"_workerFarm\", void 0);\n//# sourceMappingURL=worker-farm.js.map","import { assert } from '../env-utils/assert';\nimport { VERSION as __VERSION__ } from '../env-utils/version';\nconst NPM_TAG = 'latest';\nconst VERSION = typeof \"3.4.14\" !== 'undefined' ? \"3.4.14\" : NPM_TAG;\nexport function getWorkerName(worker) {\n  const warning = worker.version !== VERSION ? \" (worker-utils@\".concat(VERSION, \")\") : '';\n  return \"\".concat(worker.name, \"@\").concat(worker.version).concat(warning);\n}\nexport function getWorkerURL(worker) {\n  let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  const workerOptions = options[worker.id] || {};\n  const workerFile = \"\".concat(worker.id, \"-worker.js\");\n  let url = workerOptions.workerUrl;\n  if (!url && worker.id === 'compression') {\n    url = options.workerUrl;\n  }\n  if (options._workerType === 'test') {\n    url = \"modules/\".concat(worker.module, \"/dist/\").concat(workerFile);\n  }\n  if (!url) {\n    let version = worker.version;\n    if (version === 'latest') {\n      version = NPM_TAG;\n    }\n    const versionTag = version ? \"@\".concat(version) : '';\n    url = \"https://unpkg.com/@loaders.gl/\".concat(worker.module).concat(versionTag, \"/dist/\").concat(workerFile);\n  }\n  assert(url);\n  return url;\n}\n//# sourceMappingURL=get-worker-url.js.map","import { assert } from '../env-utils/assert';\nimport { VERSION } from '../env-utils/version';\nexport function validateWorkerVersion(worker) {\n  let coreVersion = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : VERSION;\n  assert(worker, 'no worker provided');\n  const workerVersion = worker.version;\n  if (!coreVersion || !workerVersion) {\n    return false;\n  }\n  return true;\n}\nfunction parseVersion(version) {\n  const parts = version.split('.').map(Number);\n  return {\n    major: parts[0],\n    minor: parts[1]\n  };\n}\n//# sourceMappingURL=validate-worker-version.js.map","import { isBrowser } from '@loaders.gl/worker-utils';\nimport { WorkerFarm, getWorkerURL } from '@loaders.gl/worker-utils';\nexport function canParseWithWorker(loader, options) {\n  if (!WorkerFarm.isSupported()) {\n    return false;\n  }\n  if (!isBrowser && !(options !== null && options !== void 0 && options._nodeWorkers)) {\n    return false;\n  }\n  return loader.worker && (options === null || options === void 0 ? void 0 : options.worker);\n}\nexport async function parseWithWorker(loader, data, options, context, parseOnMainThread) {\n  const name = loader.id;\n  const url = getWorkerURL(loader, options);\n  const workerFarm = WorkerFarm.getWorkerFarm(options);\n  const workerPool = workerFarm.getWorkerPool({\n    name,\n    url\n  });\n  options = JSON.parse(JSON.stringify(options));\n  context = JSON.parse(JSON.stringify(context || {}));\n  const job = await workerPool.startJob('process-on-worker', onMessage.bind(null, parseOnMainThread));\n  job.postMessage('process', {\n    input: data,\n    options,\n    context\n  });\n  const result = await job.result;\n  return await result.result;\n}\nasync function onMessage(parseOnMainThread, job, type, payload) {\n  switch (type) {\n    case 'done':\n      job.done(payload);\n      break;\n    case 'error':\n      job.error(new Error(payload.error));\n      break;\n    case 'process':\n      const {\n        id,\n        input,\n        options\n      } = payload;\n      try {\n        const result = await parseOnMainThread(input, options);\n        job.postMessage('done', {\n          id,\n          result\n        });\n      } catch (error) {\n        const message = error instanceof Error ? error.message : 'unknown error';\n        job.postMessage('error', {\n          id,\n          error: message\n        });\n      }\n      break;\n    default:\n      console.warn(\"parse-with-worker unknown message \".concat(type));\n  }\n}\n//# sourceMappingURL=parse-with-worker.js.map","export function compareArrayBuffers(arrayBuffer1, arrayBuffer2, byteLength) {\n  byteLength = byteLength || arrayBuffer1.byteLength;\n  if (arrayBuffer1.byteLength < byteLength || arrayBuffer2.byteLength < byteLength) {\n    return false;\n  }\n  const array1 = new Uint8Array(arrayBuffer1);\n  const array2 = new Uint8Array(arrayBuffer2);\n  for (let i = 0; i < array1.length; ++i) {\n    if (array1[i] !== array2[i]) {\n      return false;\n    }\n  }\n  return true;\n}\nexport function concatenateArrayBuffers() {\n  for (var _len = arguments.length, sources = new Array(_len), _key = 0; _key < _len; _key++) {\n    sources[_key] = arguments[_key];\n  }\n  const sourceArrays = sources.map(source2 => source2 instanceof ArrayBuffer ? new Uint8Array(source2) : source2);\n  const byteLength = sourceArrays.reduce((length, typedArray) => length + typedArray.byteLength, 0);\n  const result = new Uint8Array(byteLength);\n  let offset = 0;\n  for (const sourceArray of sourceArrays) {\n    result.set(sourceArray, offset);\n    offset += sourceArray.byteLength;\n  }\n  return result.buffer;\n}\nexport function concatenateTypedArrays() {\n  for (var _len2 = arguments.length, typedArrays = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n    typedArrays[_key2] = arguments[_key2];\n  }\n  const arrays = typedArrays;\n  const TypedArrayConstructor = arrays && arrays.length > 1 && arrays[0].constructor || null;\n  if (!TypedArrayConstructor) {\n    throw new Error('\"concatenateTypedArrays\" - incorrect quantity of arguments or arguments have incompatible data types');\n  }\n  const sumLength = arrays.reduce((acc, value) => acc + value.length, 0);\n  const result = new TypedArrayConstructor(sumLength);\n  let offset = 0;\n  for (const array of arrays) {\n    result.set(array, offset);\n    offset += array.length;\n  }\n  return result;\n}\nexport function sliceArrayBuffer(arrayBuffer, byteOffset, byteLength) {\n  const subArray = byteLength !== undefined ? new Uint8Array(arrayBuffer).subarray(byteOffset, byteOffset + byteLength) : new Uint8Array(arrayBuffer).subarray(byteOffset);\n  const arrayCopy = new Uint8Array(subArray);\n  return arrayCopy.buffer;\n}\n//# sourceMappingURL=array-buffer-utils.js.map","import { concatenateArrayBuffers } from '../binary-utils/array-buffer-utils';\nexport async function forEach(iterator, visitor) {\n  while (true) {\n    const {\n      done,\n      value\n    } = await iterator.next();\n    if (done) {\n      iterator.return();\n      return;\n    }\n    const cancel = visitor(value);\n    if (cancel) {\n      return;\n    }\n  }\n}\nexport async function concatenateArrayBuffersAsync(asyncIterator) {\n  const arrayBuffers = [];\n  for await (const chunk of asyncIterator) {\n    arrayBuffers.push(chunk);\n  }\n  return concatenateArrayBuffers(...arrayBuffers);\n}\nexport async function concatenateStringsAsync(asyncIterator) {\n  const strings = [];\n  for await (const chunk of asyncIterator) {\n    strings.push(chunk);\n  }\n  return strings.join('');\n}\n//# sourceMappingURL=async-iteration.js.map","let pathPrefix = '';\nconst fileAliases = {};\nexport function setPathPrefix(prefix) {\n  pathPrefix = prefix;\n}\nexport function getPathPrefix() {\n  return pathPrefix;\n}\nexport function addAliases(aliases) {\n  Object.assign(fileAliases, aliases);\n}\nexport function resolvePath(filename) {\n  for (const alias in fileAliases) {\n    if (filename.startsWith(alias)) {\n      const replacement = fileAliases[alias];\n      filename = filename.replace(alias, replacement);\n    }\n  }\n  if (!filename.startsWith('http://') && !filename.startsWith('https://')) {\n    filename = \"\".concat(pathPrefix).concat(filename);\n  }\n  return filename;\n}\n//# sourceMappingURL=file-aliases.js.map","import * as node from '../node/buffer';\nexport function isBuffer(value) {\n  return value && typeof value === 'object' && value.isBuffer;\n}\nexport function toBuffer(data) {\n  return node.toBuffer ? node.toBuffer(data) : data;\n}\nexport function toArrayBuffer(data) {\n  if (isBuffer(data)) {\n    return node.toArrayBuffer(data);\n  }\n  if (data instanceof ArrayBuffer) {\n    return data;\n  }\n  if (ArrayBuffer.isView(data)) {\n    if (data.byteOffset === 0 && data.byteLength === data.buffer.byteLength) {\n      return data.buffer;\n    }\n    return data.buffer.slice(data.byteOffset, data.byteOffset + data.byteLength);\n  }\n  if (typeof data === 'string') {\n    const text = data;\n    const uint8Array = new TextEncoder().encode(text);\n    return uint8Array.buffer;\n  }\n  if (data && typeof data === 'object' && data._toArrayBuffer) {\n    return data._toArrayBuffer();\n  }\n  throw new Error('toArrayBuffer');\n}\n//# sourceMappingURL=memory-conversion-utils.js.map","import { getCWD } from './get-cwd';\nexport function filename(url) {\n  const slashIndex = url ? url.lastIndexOf('/') : -1;\n  return slashIndex >= 0 ? url.substr(slashIndex + 1) : '';\n}\nexport function dirname(url) {\n  const slashIndex = url ? url.lastIndexOf('/') : -1;\n  return slashIndex >= 0 ? url.substr(0, slashIndex) : '';\n}\nexport function join() {\n  for (var _len = arguments.length, parts = new Array(_len), _key = 0; _key < _len; _key++) {\n    parts[_key] = arguments[_key];\n  }\n  const separator = '/';\n  parts = parts.map((part, index) => {\n    if (index) {\n      part = part.replace(new RegExp(\"^\".concat(separator)), '');\n    }\n    if (index !== parts.length - 1) {\n      part = part.replace(new RegExp(\"\".concat(separator, \"$\")), '');\n    }\n    return part;\n  });\n  return parts.join(separator);\n}\nexport function resolve() {\n  const paths = [];\n  for (let _i = 0; _i < arguments.length; _i++) {\n    paths[_i] = _i < 0 || arguments.length <= _i ? undefined : arguments[_i];\n  }\n  let resolvedPath = '';\n  let resolvedAbsolute = false;\n  let cwd;\n  for (let i = paths.length - 1; i >= -1 && !resolvedAbsolute; i--) {\n    let path;\n    if (i >= 0) {\n      path = paths[i];\n    } else {\n      if (cwd === undefined) {\n        cwd = getCWD();\n      }\n      path = cwd;\n    }\n    if (path.length === 0) {\n      continue;\n    }\n    resolvedPath = \"\".concat(path, \"/\").concat(resolvedPath);\n    resolvedAbsolute = path.charCodeAt(0) === SLASH;\n  }\n  resolvedPath = normalizeStringPosix(resolvedPath, !resolvedAbsolute);\n  if (resolvedAbsolute) {\n    return \"/\".concat(resolvedPath);\n  } else if (resolvedPath.length > 0) {\n    return resolvedPath;\n  }\n  return '.';\n}\nconst SLASH = 47;\nconst DOT = 46;\nfunction normalizeStringPosix(path, allowAboveRoot) {\n  let res = '';\n  let lastSlash = -1;\n  let dots = 0;\n  let code;\n  let isAboveRoot = false;\n  for (let i = 0; i <= path.length; ++i) {\n    if (i < path.length) {\n      code = path.charCodeAt(i);\n    } else if (code === SLASH) {\n      break;\n    } else {\n      code = SLASH;\n    }\n    if (code === SLASH) {\n      if (lastSlash === i - 1 || dots === 1) {} else if (lastSlash !== i - 1 && dots === 2) {\n        if (res.length < 2 || !isAboveRoot || res.charCodeAt(res.length - 1) !== DOT || res.charCodeAt(res.length - 2) !== DOT) {\n          if (res.length > 2) {\n            const start = res.length - 1;\n            let j = start;\n            for (; j >= 0; --j) {\n              if (res.charCodeAt(j) === SLASH) {\n                break;\n              }\n            }\n            if (j !== start) {\n              res = j === -1 ? '' : res.slice(0, j);\n              lastSlash = i;\n              dots = 0;\n              isAboveRoot = false;\n              continue;\n            }\n          } else if (res.length === 2 || res.length === 1) {\n            res = '';\n            lastSlash = i;\n            dots = 0;\n            isAboveRoot = false;\n            continue;\n          }\n        }\n        if (allowAboveRoot) {\n          if (res.length > 0) {\n            res += '/..';\n          } else {\n            res = '..';\n          }\n          isAboveRoot = true;\n        }\n      } else {\n        const slice = path.slice(lastSlash + 1, i);\n        if (res.length > 0) {\n          res += \"/\".concat(slice);\n        } else {\n          res = slice;\n        }\n        isAboveRoot = false;\n      }\n      lastSlash = i;\n      dots = 0;\n    } else if (code === DOT && dots !== -1) {\n      ++dots;\n    } else {\n      dots = -1;\n    }\n  }\n  return res;\n}\n//# sourceMappingURL=path.js.map","const isBoolean = x => typeof x === 'boolean';\nconst isFunction = x => typeof x === 'function';\nexport const isObject = x => x !== null && typeof x === 'object';\nexport const isPureObject = x => isObject(x) && x.constructor === {}.constructor;\nexport const isPromise = x => isObject(x) && isFunction(x.then);\nexport const isIterable = x => x && typeof x[Symbol.iterator] === 'function';\nexport const isAsyncIterable = x => x && typeof x[Symbol.asyncIterator] === 'function';\nexport const isIterator = x => x && isFunction(x.next);\nexport const isResponse = x => typeof Response !== 'undefined' && x instanceof Response || x && x.arrayBuffer && x.text && x.json;\nexport const isFile = x => typeof File !== 'undefined' && x instanceof File;\nexport const isBlob = x => typeof Blob !== 'undefined' && x instanceof Blob;\nexport const isBuffer = x => x && typeof x === 'object' && x.isBuffer;\nexport const isWritableDOMStream = x => isObject(x) && isFunction(x.abort) && isFunction(x.getWriter);\nexport const isReadableDOMStream = x => typeof ReadableStream !== 'undefined' && x instanceof ReadableStream || isObject(x) && isFunction(x.tee) && isFunction(x.cancel) && isFunction(x.getReader);\nexport const isWritableNodeStream = x => isObject(x) && isFunction(x.end) && isFunction(x.write) && isBoolean(x.writable);\nexport const isReadableNodeStream = x => isObject(x) && isFunction(x.read) && isFunction(x.pipe) && isBoolean(x.readable);\nexport const isReadableStream = x => isReadableDOMStream(x) || isReadableNodeStream(x);\nexport const isWritableStream = x => isWritableDOMStream(x) || isWritableNodeStream(x);\n//# sourceMappingURL=is-type.js.map","const DATA_URL_PATTERN = /^data:([-\\w.]+\\/[-\\w.+]+)(;|,)/;\nconst MIME_TYPE_PATTERN = /^([-\\w.]+\\/[-\\w.+]+)/;\nexport function parseMIMEType(mimeString) {\n  const matches = MIME_TYPE_PATTERN.exec(mimeString);\n  if (matches) {\n    return matches[1];\n  }\n  return mimeString;\n}\nexport function parseMIMETypeFromURL(url) {\n  const matches = DATA_URL_PATTERN.exec(url);\n  if (matches) {\n    return matches[1];\n  }\n  return '';\n}\n//# sourceMappingURL=mime-type-utils.js.map","const QUERY_STRING_PATTERN = /\\?.*/;\nexport function extractQueryString(url) {\n  const matches = url.match(QUERY_STRING_PATTERN);\n  return matches && matches[0];\n}\nexport function stripQueryString(url) {\n  return url.replace(QUERY_STRING_PATTERN, '');\n}\n//# sourceMappingURL=url-utils.js.map","import { isResponse, isBlob } from '../../javascript-utils/is-type';\nimport { parseMIMEType, parseMIMETypeFromURL } from './mime-type-utils';\nimport { stripQueryString } from './url-utils';\nexport function getResourceUrl(resource) {\n  if (isResponse(resource)) {\n    const response = resource;\n    return response.url;\n  }\n  if (isBlob(resource)) {\n    const blob = resource;\n    return blob.name || '';\n  }\n  if (typeof resource === 'string') {\n    return resource;\n  }\n  return '';\n}\nexport function getResourceMIMEType(resource) {\n  if (isResponse(resource)) {\n    const response = resource;\n    const contentTypeHeader = response.headers.get('content-type') || '';\n    const noQueryUrl = stripQueryString(response.url);\n    return parseMIMEType(contentTypeHeader) || parseMIMETypeFromURL(noQueryUrl);\n  }\n  if (isBlob(resource)) {\n    const blob = resource;\n    return blob.type || '';\n  }\n  if (typeof resource === 'string') {\n    return parseMIMETypeFromURL(resource);\n  }\n  return '';\n}\nexport function getResourceContentLength(resource) {\n  if (isResponse(resource)) {\n    const response = resource;\n    return response.headers['content-length'] || -1;\n  }\n  if (isBlob(resource)) {\n    const blob = resource;\n    return blob.size;\n  }\n  if (typeof resource === 'string') {\n    return resource.length;\n  }\n  if (resource instanceof ArrayBuffer) {\n    return resource.byteLength;\n  }\n  if (ArrayBuffer.isView(resource)) {\n    return resource.byteLength;\n  }\n  return -1;\n}\n//# sourceMappingURL=resource-utils.js.map","import { isResponse } from '../../javascript-utils/is-type';\nimport { getResourceContentLength, getResourceUrl, getResourceMIMEType } from './resource-utils';\nexport async function makeResponse(resource) {\n  if (isResponse(resource)) {\n    return resource;\n  }\n  const headers = {};\n  const contentLength = getResourceContentLength(resource);\n  if (contentLength >= 0) {\n    headers['content-length'] = String(contentLength);\n  }\n  const url = getResourceUrl(resource);\n  const type = getResourceMIMEType(resource);\n  if (type) {\n    headers['content-type'] = type;\n  }\n  const initialDataUrl = await getInitialDataUrl(resource);\n  if (initialDataUrl) {\n    headers['x-first-bytes'] = initialDataUrl;\n  }\n  if (typeof resource === 'string') {\n    resource = new TextEncoder().encode(resource);\n  }\n  const response = new Response(resource, {\n    headers\n  });\n  Object.defineProperty(response, 'url', {\n    value: url\n  });\n  return response;\n}\nexport async function checkResponse(response) {\n  if (!response.ok) {\n    const message = await getResponseError(response);\n    throw new Error(message);\n  }\n}\nexport function checkResponseSync(response) {\n  if (!response.ok) {\n    let message = \"\".concat(response.status, \" \").concat(response.statusText);\n    message = message.length > 60 ? \"\".concat(message.slice(0, 60), \"...\") : message;\n    throw new Error(message);\n  }\n}\nasync function getResponseError(response) {\n  let message = \"Failed to fetch resource \".concat(response.url, \" (\").concat(response.status, \"): \");\n  try {\n    const contentType = response.headers.get('Content-Type');\n    let text = response.statusText;\n    if (contentType.includes('application/json')) {\n      text += \" \".concat(await response.text());\n    }\n    message += text;\n    message = message.length > 60 ? \"\".concat(message.slice(0, 60), \"...\") : message;\n  } catch (error) {}\n  return message;\n}\nasync function getInitialDataUrl(resource) {\n  const INITIAL_DATA_LENGTH = 5;\n  if (typeof resource === 'string') {\n    return \"data:,\".concat(resource.slice(0, INITIAL_DATA_LENGTH));\n  }\n  if (resource instanceof Blob) {\n    const blobSlice = resource.slice(0, 5);\n    return await new Promise(resolve => {\n      const reader = new FileReader();\n      reader.onload = event => {\n        var _event$target;\n        return resolve(event === null || event === void 0 ? void 0 : (_event$target = event.target) === null || _event$target === void 0 ? void 0 : _event$target.result);\n      };\n      reader.readAsDataURL(blobSlice);\n    });\n  }\n  if (resource instanceof ArrayBuffer) {\n    const slice = resource.slice(0, INITIAL_DATA_LENGTH);\n    const base64 = arrayBufferToBase64(slice);\n    return \"data:base64,\".concat(base64);\n  }\n  return null;\n}\nfunction arrayBufferToBase64(buffer) {\n  let binary = '';\n  const bytes = new Uint8Array(buffer);\n  for (let i = 0; i < bytes.byteLength; i++) {\n    binary += String.fromCharCode(bytes[i]);\n  }\n  return btoa(binary);\n}\n//# sourceMappingURL=response-utils.js.map","import { resolvePath } from '@loaders.gl/loader-utils';\nimport { makeResponse } from '../utils/response-utils';\nexport async function fetchFile(url, options) {\n  if (typeof url === 'string') {\n    url = resolvePath(url);\n    let fetchOptions = options;\n    if (options !== null && options !== void 0 && options.fetch && typeof (options === null || options === void 0 ? void 0 : options.fetch) !== 'function') {\n      fetchOptions = options.fetch;\n    }\n    return await fetch(url, fetchOptions);\n  }\n  return await makeResponse(url);\n}\n//# sourceMappingURL=fetch-file.js.map","export default function isElectron(mockUserAgent) {\n  if (typeof window !== 'undefined' && typeof window.process === 'object' && window.process.type === 'renderer') {\n    return true;\n  }\n\n  if (typeof process !== 'undefined' && typeof process.versions === 'object' && Boolean(process.versions['electron'])) {\n    return true;\n  }\n\n  const realUserAgent = typeof navigator === 'object' && typeof navigator.userAgent === 'string' && navigator.userAgent;\n  const userAgent = mockUserAgent || realUserAgent;\n\n  if (userAgent && userAgent.indexOf('Electron') >= 0) {\n    return true;\n  }\n\n  return false;\n}\n//# sourceMappingURL=is-electron.js.map","import isElectron from \"./is-electron.js\";\nexport default function isBrowser() {\n  const isNode = typeof process === 'object' && String(process) === '[object process]' && !process.browser;\n  return !isNode || isElectron();\n}\nexport function isBrowserMainThread() {\n  return isBrowser() && typeof document !== 'undefined';\n}\n//# sourceMappingURL=is-browser.js.map","const global_ = globalThis;\nconst self_ = globalThis.self || globalThis.window || globalThis.global;\nconst window_ = globalThis.window || globalThis.self || globalThis.global;\nconst document_ = globalThis.document || {};\nconst process_ = globalThis.process || {};\nconst console_ = globalThis.console;\nconst navigator_ = globalThis.navigator || {};\nexport { global_ as global, self_ as self, window_ as window, document_ as document, process_ as process, console_ as console, navigator_ as navigator };\n//# sourceMappingURL=globals.js.map","import checkIfBrowser from \"../lib/is-browser.js\";\nexport { self, window, global, document, process, console } from \"../lib/globals.js\";\nexport const VERSION = typeof __VERSION__ !== 'undefined' ? __VERSION__ : 'untranspiled source';\nexport const isBrowser = checkIfBrowser();\n//# sourceMappingURL=globals.js.map","function getStorage(type) {\n  try {\n    const storage = window[type];\n    const x = '__storage_test__';\n    storage.setItem(x, x);\n    storage.removeItem(x);\n    return storage;\n  } catch (e) {\n    return null;\n  }\n}\n\nexport class LocalStorage {\n  constructor(id, defaultConfig) {\n    let type = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'sessionStorage';\n    this.storage = void 0;\n    this.id = void 0;\n    this.config = void 0;\n    this.storage = getStorage(type);\n    this.id = id;\n    this.config = defaultConfig;\n\n    this._loadConfiguration();\n  }\n\n  getConfiguration() {\n    return this.config;\n  }\n\n  setConfiguration(configuration) {\n    Object.assign(this.config, configuration);\n\n    if (this.storage) {\n      const serialized = JSON.stringify(this.config);\n      this.storage.setItem(this.id, serialized);\n    }\n  }\n\n  _loadConfiguration() {\n    let configuration = {};\n\n    if (this.storage) {\n      const serializedConfiguration = this.storage.getItem(this.id);\n      configuration = serializedConfiguration ? JSON.parse(serializedConfiguration) : {};\n    }\n\n    Object.assign(this.config, configuration);\n    return this;\n  }\n\n}\n//# sourceMappingURL=local-storage.js.map","export function formatTime(ms) {\n  let formatted;\n\n  if (ms < 10) {\n    formatted = \"\".concat(ms.toFixed(2), \"ms\");\n  } else if (ms < 100) {\n    formatted = \"\".concat(ms.toFixed(1), \"ms\");\n  } else if (ms < 1000) {\n    formatted = \"\".concat(ms.toFixed(0), \"ms\");\n  } else {\n    formatted = \"\".concat((ms / 1000).toFixed(2), \"s\");\n  }\n\n  return formatted;\n}\nexport function leftPad(string) {\n  let length = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 8;\n  const padLength = Math.max(length - string.length, 0);\n  return \"\".concat(' '.repeat(padLength)).concat(string);\n}\nexport function rightPad(string) {\n  let length = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 8;\n  const padLength = Math.max(length - string.length, 0);\n  return \"\".concat(string).concat(' '.repeat(padLength));\n}\nexport function formatValue(v) {\n  let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  const EPSILON = 1e-16;\n  const {\n    isInteger = false\n  } = options;\n\n  if (Array.isArray(v) || ArrayBuffer.isView(v)) {\n    return formatArrayValue(v, options);\n  }\n\n  if (!Number.isFinite(v)) {\n    return String(v);\n  }\n\n  if (Math.abs(v) < EPSILON) {\n    return isInteger ? '0' : '0.';\n  }\n\n  if (isInteger) {\n    return v.toFixed(0);\n  }\n\n  if (Math.abs(v) > 100 && Math.abs(v) < 10000) {\n    return v.toFixed(0);\n  }\n\n  const string = v.toPrecision(2);\n  const decimal = string.indexOf('.0');\n  return decimal === string.length - 2 ? string.slice(0, -1) : string;\n}\n\nfunction formatArrayValue(v, options) {\n  const {\n    maxElts = 16,\n    size = 1\n  } = options;\n  let string = '[';\n\n  for (let i = 0; i < v.length && i < maxElts; ++i) {\n    if (i > 0) {\n      string += \",\".concat(i % size === 0 ? ' ' : '');\n    }\n\n    string += formatValue(v[i], options);\n  }\n\n  const terminator = v.length > maxElts ? '...' : ']';\n  return \"\".concat(string).concat(terminator);\n}\n\nexport function formatImage(image, message, scale) {\n  let maxWidth = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 600;\n  const imageUrl = image.src.replace(/\\(/g, '%28').replace(/\\)/g, '%29');\n\n  if (image.width > maxWidth) {\n    scale = Math.min(scale, maxWidth / image.width);\n  }\n\n  const width = image.width * scale;\n  const height = image.height * scale;\n  const style = ['font-size:1px;', \"padding:\".concat(Math.floor(height / 2), \"px \").concat(Math.floor(width / 2), \"px;\"), \"line-height:\".concat(height, \"px;\"), \"background:url(\".concat(imageUrl, \");\"), \"background-size:\".concat(width, \"px \").concat(height, \"px;\"), 'color:transparent;'].join('');\n  return [\"\".concat(message, \" %c+\"), style];\n}\n//# sourceMappingURL=formatters.js.map","import { isBrowser } from '@probe.gl/env';\nexport let COLOR;\n\n(function (COLOR) {\n  COLOR[COLOR[\"BLACK\"] = 30] = \"BLACK\";\n  COLOR[COLOR[\"RED\"] = 31] = \"RED\";\n  COLOR[COLOR[\"GREEN\"] = 32] = \"GREEN\";\n  COLOR[COLOR[\"YELLOW\"] = 33] = \"YELLOW\";\n  COLOR[COLOR[\"BLUE\"] = 34] = \"BLUE\";\n  COLOR[COLOR[\"MAGENTA\"] = 35] = \"MAGENTA\";\n  COLOR[COLOR[\"CYAN\"] = 36] = \"CYAN\";\n  COLOR[COLOR[\"WHITE\"] = 37] = \"WHITE\";\n  COLOR[COLOR[\"BRIGHT_BLACK\"] = 90] = \"BRIGHT_BLACK\";\n  COLOR[COLOR[\"BRIGHT_RED\"] = 91] = \"BRIGHT_RED\";\n  COLOR[COLOR[\"BRIGHT_GREEN\"] = 92] = \"BRIGHT_GREEN\";\n  COLOR[COLOR[\"BRIGHT_YELLOW\"] = 93] = \"BRIGHT_YELLOW\";\n  COLOR[COLOR[\"BRIGHT_BLUE\"] = 94] = \"BRIGHT_BLUE\";\n  COLOR[COLOR[\"BRIGHT_MAGENTA\"] = 95] = \"BRIGHT_MAGENTA\";\n  COLOR[COLOR[\"BRIGHT_CYAN\"] = 96] = \"BRIGHT_CYAN\";\n  COLOR[COLOR[\"BRIGHT_WHITE\"] = 97] = \"BRIGHT_WHITE\";\n})(COLOR || (COLOR = {}));\n\nconst BACKGROUND_INCREMENT = 10;\n\nfunction getColor(color) {\n  if (typeof color !== 'string') {\n    return color;\n  }\n\n  color = color.toUpperCase();\n  return COLOR[color] || COLOR.WHITE;\n}\n\nexport function addColor(string, color, background) {\n  if (!isBrowser && typeof string === 'string') {\n    if (color) {\n      const colorCode = getColor(color);\n      string = \"\\x1B[\".concat(colorCode, \"m\").concat(string, \"\\x1B[39m\");\n    }\n\n    if (background) {\n      const colorCode = getColor(background);\n      string = \"\\x1B[\".concat(colorCode + BACKGROUND_INCREMENT, \"m\").concat(string, \"\\x1B[49m\");\n    }\n  }\n\n  return string;\n}\n//# sourceMappingURL=color.js.map","export function autobind(obj) {\n  let predefined = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : ['constructor'];\n  const proto = Object.getPrototypeOf(obj);\n  const propNames = Object.getOwnPropertyNames(proto);\n  const object = obj;\n\n  for (const key of propNames) {\n    const value = object[key];\n\n    if (typeof value === 'function') {\n      if (!predefined.find(name => key === name)) {\n        object[key] = value.bind(obj);\n      }\n    }\n  }\n}\n//# sourceMappingURL=autobind.js.map","export default function assert(condition, message) {\n  if (!condition) {\n    throw new Error(message || 'Assertion failed');\n  }\n}\n//# sourceMappingURL=assert.js.map","import { window, process, isBrowser } from '@probe.gl/env';\nexport function getHiResTimestamp() {\n  let timestamp;\n\n  if (isBrowser() && window.performance) {\n    var _window$performance, _window$performance$n;\n\n    timestamp = window === null || window === void 0 ? void 0 : (_window$performance = window.performance) === null || _window$performance === void 0 ? void 0 : (_window$performance$n = _window$performance.now) === null || _window$performance$n === void 0 ? void 0 : _window$performance$n.call(_window$performance);\n  } else if ('hrtime' in process) {\n    var _process$hrtime;\n\n    const timeParts = process === null || process === void 0 ? void 0 : (_process$hrtime = process.hrtime) === null || _process$hrtime === void 0 ? void 0 : _process$hrtime.call(process);\n    timestamp = timeParts[0] * 1000 + timeParts[1] / 1e6;\n  } else {\n    timestamp = Date.now();\n  }\n\n  return timestamp;\n}\n//# sourceMappingURL=hi-res-timestamp.js.map","import { VERSION, isBrowser } from '@probe.gl/env';\nimport { LocalStorage } from \"./utils/local-storage.js\";\nimport { formatImage, formatTime, leftPad } from \"./utils/formatters.js\";\nimport { addColor } from \"./utils/color.js\";\nimport { autobind } from \"./utils/autobind.js\";\nimport assert from \"./utils/assert.js\";\nimport { getHiResTimestamp } from \"./utils/hi-res-timestamp.js\";\nconst originalConsole = {\n  debug: isBrowser() ? console.debug || console.log : console.log,\n  log: console.log,\n  info: console.info,\n  warn: console.warn,\n  error: console.error\n};\nconst DEFAULT_LOG_CONFIGURATION = {\n  enabled: true,\n  level: 0\n};\n\nfunction noop() {}\n\nconst cache = {};\nconst ONCE = {\n  once: true\n};\nexport class Log {\n  constructor() {\n    let {\n      id\n    } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {\n      id: ''\n    };\n    this.id = void 0;\n    this.VERSION = VERSION;\n    this._startTs = getHiResTimestamp();\n    this._deltaTs = getHiResTimestamp();\n    this._storage = void 0;\n    this.userData = {};\n    this.LOG_THROTTLE_TIMEOUT = 0;\n    this.id = id;\n    this.userData = {};\n    this._storage = new LocalStorage(\"__probe-\".concat(this.id, \"__\"), DEFAULT_LOG_CONFIGURATION);\n    this.timeStamp(\"\".concat(this.id, \" started\"));\n    autobind(this);\n    Object.seal(this);\n  }\n\n  set level(newLevel) {\n    this.setLevel(newLevel);\n  }\n\n  get level() {\n    return this.getLevel();\n  }\n\n  isEnabled() {\n    return this._storage.config.enabled;\n  }\n\n  getLevel() {\n    return this._storage.config.level;\n  }\n\n  getTotal() {\n    return Number((getHiResTimestamp() - this._startTs).toPrecision(10));\n  }\n\n  getDelta() {\n    return Number((getHiResTimestamp() - this._deltaTs).toPrecision(10));\n  }\n\n  set priority(newPriority) {\n    this.level = newPriority;\n  }\n\n  get priority() {\n    return this.level;\n  }\n\n  getPriority() {\n    return this.level;\n  }\n\n  enable() {\n    let enabled = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n\n    this._storage.setConfiguration({\n      enabled\n    });\n\n    return this;\n  }\n\n  setLevel(level) {\n    this._storage.setConfiguration({\n      level\n    });\n\n    return this;\n  }\n\n  get(setting) {\n    return this._storage.config[setting];\n  }\n\n  set(setting, value) {\n    this._storage.setConfiguration({\n      [setting]: value\n    });\n  }\n\n  settings() {\n    if (console.table) {\n      console.table(this._storage.config);\n    } else {\n      console.log(this._storage.config);\n    }\n  }\n\n  assert(condition, message) {\n    assert(condition, message);\n  }\n\n  warn(message) {\n    return this._getLogFunction(0, message, originalConsole.warn, arguments, ONCE);\n  }\n\n  error(message) {\n    return this._getLogFunction(0, message, originalConsole.error, arguments);\n  }\n\n  deprecated(oldUsage, newUsage) {\n    return this.warn(\"`\".concat(oldUsage, \"` is deprecated and will be removed in a later version. Use `\").concat(newUsage, \"` instead\"));\n  }\n\n  removed(oldUsage, newUsage) {\n    return this.error(\"`\".concat(oldUsage, \"` has been removed. Use `\").concat(newUsage, \"` instead\"));\n  }\n\n  probe(logLevel, message) {\n    return this._getLogFunction(logLevel, message, originalConsole.log, arguments, {\n      time: true,\n      once: true\n    });\n  }\n\n  log(logLevel, message) {\n    return this._getLogFunction(logLevel, message, originalConsole.debug, arguments);\n  }\n\n  info(logLevel, message) {\n    return this._getLogFunction(logLevel, message, console.info, arguments);\n  }\n\n  once(logLevel, message) {\n    return this._getLogFunction(logLevel, message, originalConsole.debug || originalConsole.info, arguments, ONCE);\n  }\n\n  table(logLevel, table, columns) {\n    if (table) {\n      return this._getLogFunction(logLevel, table, console.table || noop, columns && [columns], {\n        tag: getTableHeader(table)\n      });\n    }\n\n    return noop;\n  }\n\n  image(_ref) {\n    let {\n      logLevel,\n      priority,\n      image,\n      message = '',\n      scale = 1\n    } = _ref;\n\n    if (!this._shouldLog(logLevel || priority)) {\n      return noop;\n    }\n\n    return isBrowser() ? logImageInBrowser({\n      image,\n      message,\n      scale\n    }) : logImageInNode({\n      image,\n      message,\n      scale\n    });\n  }\n\n  time(logLevel, message) {\n    return this._getLogFunction(logLevel, message, console.time ? console.time : console.info);\n  }\n\n  timeEnd(logLevel, message) {\n    return this._getLogFunction(logLevel, message, console.timeEnd ? console.timeEnd : console.info);\n  }\n\n  timeStamp(logLevel, message) {\n    return this._getLogFunction(logLevel, message, console.timeStamp || noop);\n  }\n\n  group(logLevel, message) {\n    let opts = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {\n      collapsed: false\n    };\n    const options = normalizeArguments({\n      logLevel,\n      message,\n      opts\n    });\n    const {\n      collapsed\n    } = opts;\n    options.method = (collapsed ? console.groupCollapsed : console.group) || console.info;\n    return this._getLogFunction(options);\n  }\n\n  groupCollapsed(logLevel, message) {\n    let opts = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    return this.group(logLevel, message, Object.assign({}, opts, {\n      collapsed: true\n    }));\n  }\n\n  groupEnd(logLevel) {\n    return this._getLogFunction(logLevel, '', console.groupEnd || noop);\n  }\n\n  withGroup(logLevel, message, func) {\n    this.group(logLevel, message)();\n\n    try {\n      func();\n    } finally {\n      this.groupEnd(logLevel)();\n    }\n  }\n\n  trace() {\n    if (console.trace) {\n      console.trace();\n    }\n  }\n\n  _shouldLog(logLevel) {\n    return this.isEnabled() && this.getLevel() >= normalizeLogLevel(logLevel);\n  }\n\n  _getLogFunction(logLevel, message, method, args, opts) {\n    if (this._shouldLog(logLevel)) {\n      opts = normalizeArguments({\n        logLevel,\n        message,\n        args,\n        opts\n      });\n      method = method || opts.method;\n      assert(method);\n      opts.total = this.getTotal();\n      opts.delta = this.getDelta();\n      this._deltaTs = getHiResTimestamp();\n      const tag = opts.tag || opts.message;\n\n      if (opts.once && tag) {\n        if (!cache[tag]) {\n          cache[tag] = getHiResTimestamp();\n        } else {\n          return noop;\n        }\n      }\n\n      message = decorateMessage(this.id, opts.message, opts);\n      return method.bind(console, message, ...opts.args);\n    }\n\n    return noop;\n  }\n\n}\nLog.VERSION = VERSION;\n\nfunction normalizeLogLevel(logLevel) {\n  if (!logLevel) {\n    return 0;\n  }\n\n  let resolvedLevel;\n\n  switch (typeof logLevel) {\n    case 'number':\n      resolvedLevel = logLevel;\n      break;\n\n    case 'object':\n      resolvedLevel = logLevel.logLevel || logLevel.priority || 0;\n      break;\n\n    default:\n      return 0;\n  }\n\n  assert(Number.isFinite(resolvedLevel) && resolvedLevel >= 0);\n  return resolvedLevel;\n}\n\nexport function normalizeArguments(opts) {\n  const {\n    logLevel,\n    message\n  } = opts;\n  opts.logLevel = normalizeLogLevel(logLevel);\n  const args = opts.args ? Array.from(opts.args) : [];\n\n  while (args.length && args.shift() !== message) {}\n\n  switch (typeof logLevel) {\n    case 'string':\n    case 'function':\n      if (message !== undefined) {\n        args.unshift(message);\n      }\n\n      opts.message = logLevel;\n      break;\n\n    case 'object':\n      Object.assign(opts, logLevel);\n      break;\n\n    default:\n  }\n\n  if (typeof opts.message === 'function') {\n    opts.message = opts.message();\n  }\n\n  const messageType = typeof opts.message;\n  assert(messageType === 'string' || messageType === 'object');\n  return Object.assign(opts, {\n    args\n  }, opts.opts);\n}\n\nfunction decorateMessage(id, message, opts) {\n  if (typeof message === 'string') {\n    const time = opts.time ? leftPad(formatTime(opts.total)) : '';\n    message = opts.time ? \"\".concat(id, \": \").concat(time, \"  \").concat(message) : \"\".concat(id, \": \").concat(message);\n    message = addColor(message, opts.color, opts.background);\n  }\n\n  return message;\n}\n\nfunction logImageInNode(_ref2) {\n  let {\n    image,\n    message = '',\n    scale = 1\n  } = _ref2;\n  console.warn('removed');\n  return noop;\n}\n\nfunction logImageInBrowser(_ref3) {\n  let {\n    image,\n    message = '',\n    scale = 1\n  } = _ref3;\n\n  if (typeof image === 'string') {\n    const img = new Image();\n\n    img.onload = () => {\n      const args = formatImage(img, message, scale);\n      console.log(...args);\n    };\n\n    img.src = image;\n    return noop;\n  }\n\n  const element = image.nodeName || '';\n\n  if (element.toLowerCase() === 'img') {\n    console.log(...formatImage(image, message, scale));\n    return noop;\n  }\n\n  if (element.toLowerCase() === 'canvas') {\n    const img = new Image();\n\n    img.onload = () => console.log(...formatImage(img, message, scale));\n\n    img.src = image.toDataURL();\n    return noop;\n  }\n\n  return noop;\n}\n\nfunction getTableHeader(table) {\n  for (const key in table) {\n    for (const title in table[key]) {\n      return title || 'untitled';\n    }\n  }\n\n  return 'empty';\n}\n//# sourceMappingURL=log.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { Log } from '@probe.gl/log';\nexport const probeLog = new Log({\n  id: 'loaders.gl'\n});\nexport class NullLog {\n  log() {\n    return () => {};\n  }\n  info() {\n    return () => {};\n  }\n  warn() {\n    return () => {};\n  }\n  error() {\n    return () => {};\n  }\n}\nexport class ConsoleLog {\n  constructor() {\n    _defineProperty(this, \"console\", void 0);\n    this.console = console;\n  }\n  log() {\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    return this.console.log.bind(this.console, ...args);\n  }\n  info() {\n    for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      args[_key2] = arguments[_key2];\n    }\n    return this.console.info.bind(this.console, ...args);\n  }\n  warn() {\n    for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n      args[_key3] = arguments[_key3];\n    }\n    return this.console.warn.bind(this.console, ...args);\n  }\n  error() {\n    for (var _len4 = arguments.length, args = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\n      args[_key4] = arguments[_key4];\n    }\n    return this.console.error.bind(this.console, ...args);\n  }\n}\n//# sourceMappingURL=loggers.js.map","import { isBrowser } from '@loaders.gl/loader-utils';\nimport { ConsoleLog } from './loggers';\nexport const DEFAULT_LOADER_OPTIONS = {\n  fetch: null,\n  mimeType: undefined,\n  nothrow: false,\n  log: new ConsoleLog(),\n  CDN: 'https://unpkg.com/@loaders.gl',\n  worker: true,\n  maxConcurrency: 3,\n  maxMobileConcurrency: 1,\n  reuseWorkers: isBrowser,\n  _nodeWorkers: false,\n  _workerType: '',\n  limit: 0,\n  _limitMB: 0,\n  batchSize: 'auto',\n  batchDebounceMs: 0,\n  metadata: false,\n  transforms: []\n};\nexport const REMOVED_LOADER_OPTIONS = {\n  throws: 'nothrow',\n  dataType: '(no longer used)',\n  uri: 'baseUri',\n  method: 'fetch.method',\n  headers: 'fetch.headers',\n  body: 'fetch.body',\n  mode: 'fetch.mode',\n  credentials: 'fetch.credentials',\n  cache: 'fetch.cache',\n  redirect: 'fetch.redirect',\n  referrer: 'fetch.referrer',\n  referrerPolicy: 'fetch.referrerPolicy',\n  integrity: 'fetch.integrity',\n  keepalive: 'fetch.keepalive',\n  signal: 'fetch.signal'\n};\n//# sourceMappingURL=option-defaults.js.map","import { isPureObject, isObject } from '../../javascript-utils/is-type';\nimport { probeLog, NullLog } from './loggers';\nimport { DEFAULT_LOADER_OPTIONS, REMOVED_LOADER_OPTIONS } from './option-defaults';\nexport function getGlobalLoaderState() {\n  globalThis.loaders = globalThis.loaders || {};\n  const {\n    loaders\n  } = globalThis;\n  loaders._state = loaders._state || {};\n  return loaders._state;\n}\nexport const getGlobalLoaderOptions = () => {\n  const state = getGlobalLoaderState();\n  state.globalOptions = state.globalOptions || {\n    ...DEFAULT_LOADER_OPTIONS\n  };\n  return state.globalOptions;\n};\nexport function setGlobalOptions(options) {\n  const state = getGlobalLoaderState();\n  const globalOptions = getGlobalLoaderOptions();\n  state.globalOptions = normalizeOptionsInternal(globalOptions, options);\n}\nexport function normalizeOptions(options, loader, loaders, url) {\n  loaders = loaders || [];\n  loaders = Array.isArray(loaders) ? loaders : [loaders];\n  validateOptions(options, loaders);\n  return normalizeOptionsInternal(loader, options, url);\n}\nfunction validateOptions(options, loaders) {\n  validateOptionsObject(options, null, DEFAULT_LOADER_OPTIONS, REMOVED_LOADER_OPTIONS, loaders);\n  for (const loader of loaders) {\n    const idOptions = options && options[loader.id] || {};\n    const loaderOptions = loader.options && loader.options[loader.id] || {};\n    const deprecatedOptions = loader.deprecatedOptions && loader.deprecatedOptions[loader.id] || {};\n    validateOptionsObject(idOptions, loader.id, loaderOptions, deprecatedOptions, loaders);\n  }\n}\nfunction validateOptionsObject(options, id, defaultOptions, deprecatedOptions, loaders) {\n  const loaderName = id || 'Top level';\n  const prefix = id ? \"\".concat(id, \".\") : '';\n  for (const key in options) {\n    const isSubOptions = !id && isObject(options[key]);\n    const isBaseUriOption = key === 'baseUri' && !id;\n    const isWorkerUrlOption = key === 'workerUrl' && id;\n    if (!(key in defaultOptions) && !isBaseUriOption && !isWorkerUrlOption) {\n      if (key in deprecatedOptions) {\n        probeLog.warn(\"\".concat(loaderName, \" loader option '\").concat(prefix).concat(key, \"' no longer supported, use '\").concat(deprecatedOptions[key], \"'\"))();\n      } else if (!isSubOptions) {\n        const suggestion = findSimilarOption(key, loaders);\n        probeLog.warn(\"\".concat(loaderName, \" loader option '\").concat(prefix).concat(key, \"' not recognized. \").concat(suggestion))();\n      }\n    }\n  }\n}\nfunction findSimilarOption(optionKey, loaders) {\n  const lowerCaseOptionKey = optionKey.toLowerCase();\n  let bestSuggestion = '';\n  for (const loader of loaders) {\n    for (const key in loader.options) {\n      if (optionKey === key) {\n        return \"Did you mean '\".concat(loader.id, \".\").concat(key, \"'?\");\n      }\n      const lowerCaseKey = key.toLowerCase();\n      const isPartialMatch = lowerCaseOptionKey.startsWith(lowerCaseKey) || lowerCaseKey.startsWith(lowerCaseOptionKey);\n      if (isPartialMatch) {\n        bestSuggestion = bestSuggestion || \"Did you mean '\".concat(loader.id, \".\").concat(key, \"'?\");\n      }\n    }\n  }\n  return bestSuggestion;\n}\nfunction normalizeOptionsInternal(loader, options, url) {\n  const loaderDefaultOptions = loader.options || {};\n  const mergedOptions = {\n    ...loaderDefaultOptions\n  };\n  addUrlOptions(mergedOptions, url);\n  if (mergedOptions.log === null) {\n    mergedOptions.log = new NullLog();\n  }\n  mergeNestedFields(mergedOptions, getGlobalLoaderOptions());\n  mergeNestedFields(mergedOptions, options);\n  return mergedOptions;\n}\nfunction mergeNestedFields(mergedOptions, options) {\n  for (const key in options) {\n    if (key in options) {\n      const value = options[key];\n      if (isPureObject(value) && isPureObject(mergedOptions[key])) {\n        mergedOptions[key] = {\n          ...mergedOptions[key],\n          ...options[key]\n        };\n      } else {\n        mergedOptions[key] = options[key];\n      }\n    }\n  }\n}\nfunction addUrlOptions(options, url) {\n  if (url && !('baseUri' in options)) {\n    options.baseUri = url;\n  }\n}\n//# sourceMappingURL=option-utils.js.map","import { assert } from '@loaders.gl/loader-utils';\nexport function isLoaderObject(loader) {\n  var _loader;\n  if (!loader) {\n    return false;\n  }\n  if (Array.isArray(loader)) {\n    loader = loader[0];\n  }\n  const hasExtensions = Array.isArray((_loader = loader) === null || _loader === void 0 ? void 0 : _loader.extensions);\n  return hasExtensions;\n}\nexport function normalizeLoader(loader) {\n  var _loader2, _loader3;\n  assert(loader, 'null loader');\n  assert(isLoaderObject(loader), 'invalid loader');\n  let options;\n  if (Array.isArray(loader)) {\n    options = loader[1];\n    loader = loader[0];\n    loader = {\n      ...loader,\n      options: {\n        ...loader.options,\n        ...options\n      }\n    };\n  }\n  if ((_loader2 = loader) !== null && _loader2 !== void 0 && _loader2.parseTextSync || (_loader3 = loader) !== null && _loader3 !== void 0 && _loader3.parseText) {\n    loader.text = true;\n  }\n  if (!loader.text) {\n    loader.binary = true;\n  }\n  return loader;\n}\n//# sourceMappingURL=normalize-loader.js.map","import { normalizeLoader } from '../loader-utils/normalize-loader';\nimport { getGlobalLoaderState } from '../loader-utils/option-utils';\nconst getGlobalLoaderRegistry = () => {\n  const state = getGlobalLoaderState();\n  state.loaderRegistry = state.loaderRegistry || [];\n  return state.loaderRegistry;\n};\nexport function registerLoaders(loaders) {\n  const loaderRegistry = getGlobalLoaderRegistry();\n  loaders = Array.isArray(loaders) ? loaders : [loaders];\n  for (const loader of loaders) {\n    const normalizedLoader = normalizeLoader(loader);\n    if (!loaderRegistry.find(registeredLoader => normalizedLoader === registeredLoader)) {\n      loaderRegistry.unshift(normalizedLoader);\n    }\n  }\n}\nexport function getRegisteredLoaders() {\n  return getGlobalLoaderRegistry();\n}\nexport function _unregisterLoaders() {\n  const state = getGlobalLoaderState();\n  state.loaderRegistry = [];\n}\n//# sourceMappingURL=register-loaders.js.map","import { Log } from '@probe.gl/log';\nexport const log = new Log({\n  id: 'loaders.gl'\n});\n//# sourceMappingURL=log.js.map","import { compareArrayBuffers, path } from '@loaders.gl/loader-utils';\nimport { normalizeLoader } from '../loader-utils/normalize-loader';\nimport { log } from '../utils/log';\nimport { getResourceUrl, getResourceMIMEType } from '../utils/resource-utils';\nimport { getRegisteredLoaders } from './register-loaders';\nimport { isBlob } from '../../javascript-utils/is-type';\nimport { stripQueryString } from '../utils/url-utils';\nconst EXT_PATTERN = /\\.([^.]+)$/;\nexport async function selectLoader(data) {\n  let loaders = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  let options = arguments.length > 2 ? arguments[2] : undefined;\n  let context = arguments.length > 3 ? arguments[3] : undefined;\n  if (!validHTTPResponse(data)) {\n    return null;\n  }\n  let loader = selectLoaderSync(data, loaders, {\n    ...options,\n    nothrow: true\n  }, context);\n  if (loader) {\n    return loader;\n  }\n  if (isBlob(data)) {\n    data = await data.slice(0, 10).arrayBuffer();\n    loader = selectLoaderSync(data, loaders, options, context);\n  }\n  if (!loader && !(options !== null && options !== void 0 && options.nothrow)) {\n    throw new Error(getNoValidLoaderMessage(data));\n  }\n  return loader;\n}\nexport function selectLoaderSync(data) {\n  let loaders = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  let options = arguments.length > 2 ? arguments[2] : undefined;\n  let context = arguments.length > 3 ? arguments[3] : undefined;\n  if (!validHTTPResponse(data)) {\n    return null;\n  }\n  if (loaders && !Array.isArray(loaders)) {\n    return normalizeLoader(loaders);\n  }\n  let candidateLoaders = [];\n  if (loaders) {\n    candidateLoaders = candidateLoaders.concat(loaders);\n  }\n  if (!(options !== null && options !== void 0 && options.ignoreRegisteredLoaders)) {\n    candidateLoaders.push(...getRegisteredLoaders());\n  }\n  normalizeLoaders(candidateLoaders);\n  const loader = selectLoaderInternal(data, candidateLoaders, options, context);\n  if (!loader && !(options !== null && options !== void 0 && options.nothrow)) {\n    throw new Error(getNoValidLoaderMessage(data));\n  }\n  return loader;\n}\nfunction selectLoaderInternal(data, loaders, options, context) {\n  const url = getResourceUrl(data);\n  const type = getResourceMIMEType(data);\n  const testUrl = stripQueryString(url) || (context === null || context === void 0 ? void 0 : context.url);\n  let loader = null;\n  let reason = '';\n  if (options !== null && options !== void 0 && options.mimeType) {\n    loader = findLoaderByMIMEType(loaders, options === null || options === void 0 ? void 0 : options.mimeType);\n    reason = \"match forced by supplied MIME type \".concat(options === null || options === void 0 ? void 0 : options.mimeType);\n  }\n  loader = loader || findLoaderByUrl(loaders, testUrl);\n  reason = reason || (loader ? \"matched url \".concat(testUrl) : '');\n  loader = loader || findLoaderByMIMEType(loaders, type);\n  reason = reason || (loader ? \"matched MIME type \".concat(type) : '');\n  loader = loader || findLoaderByInitialBytes(loaders, data);\n  reason = reason || (loader ? \"matched initial data \".concat(getFirstCharacters(data)) : '');\n  loader = loader || findLoaderByMIMEType(loaders, options === null || options === void 0 ? void 0 : options.fallbackMimeType);\n  reason = reason || (loader ? \"matched fallback MIME type \".concat(type) : '');\n  if (reason) {\n    var _loader;\n    log.log(1, \"selectLoader selected \".concat((_loader = loader) === null || _loader === void 0 ? void 0 : _loader.name, \": \").concat(reason, \".\"));\n  }\n  return loader;\n}\nfunction validHTTPResponse(data) {\n  if (data instanceof Response) {\n    if (data.status === 204) {\n      return false;\n    }\n  }\n  return true;\n}\nfunction getNoValidLoaderMessage(data) {\n  const url = getResourceUrl(data);\n  const type = getResourceMIMEType(data);\n  let message = 'No valid loader found (';\n  message += url ? \"\".concat(path.filename(url), \", \") : 'no url provided, ';\n  message += \"MIME type: \".concat(type ? \"\\\"\".concat(type, \"\\\"\") : 'not provided', \", \");\n  const firstCharacters = data ? getFirstCharacters(data) : '';\n  message += firstCharacters ? \" first bytes: \\\"\".concat(firstCharacters, \"\\\"\") : 'first bytes: not available';\n  message += ')';\n  return message;\n}\nfunction normalizeLoaders(loaders) {\n  for (const loader of loaders) {\n    normalizeLoader(loader);\n  }\n}\nfunction findLoaderByUrl(loaders, url) {\n  const match = url && EXT_PATTERN.exec(url);\n  const extension = match && match[1];\n  return extension ? findLoaderByExtension(loaders, extension) : null;\n}\nfunction findLoaderByExtension(loaders, extension) {\n  extension = extension.toLowerCase();\n  for (const loader of loaders) {\n    for (const loaderExtension of loader.extensions) {\n      if (loaderExtension.toLowerCase() === extension) {\n        return loader;\n      }\n    }\n  }\n  return null;\n}\nfunction findLoaderByMIMEType(loaders, mimeType) {\n  for (const loader of loaders) {\n    if (loader.mimeTypes && loader.mimeTypes.includes(mimeType)) {\n      return loader;\n    }\n    if (mimeType === \"application/x.\".concat(loader.id)) {\n      return loader;\n    }\n  }\n  return null;\n}\nfunction findLoaderByInitialBytes(loaders, data) {\n  if (!data) {\n    return null;\n  }\n  for (const loader of loaders) {\n    if (typeof data === 'string') {\n      if (testDataAgainstText(data, loader)) {\n        return loader;\n      }\n    } else if (ArrayBuffer.isView(data)) {\n      if (testDataAgainstBinary(data.buffer, data.byteOffset, loader)) {\n        return loader;\n      }\n    } else if (data instanceof ArrayBuffer) {\n      const byteOffset = 0;\n      if (testDataAgainstBinary(data, byteOffset, loader)) {\n        return loader;\n      }\n    }\n  }\n  return null;\n}\nfunction testDataAgainstText(data, loader) {\n  if (loader.testText) {\n    return loader.testText(data);\n  }\n  const tests = Array.isArray(loader.tests) ? loader.tests : [loader.tests];\n  return tests.some(test => data.startsWith(test));\n}\nfunction testDataAgainstBinary(data, byteOffset, loader) {\n  const tests = Array.isArray(loader.tests) ? loader.tests : [loader.tests];\n  return tests.some(test => testBinary(data, byteOffset, loader, test));\n}\nfunction testBinary(data, byteOffset, loader, test) {\n  if (test instanceof ArrayBuffer) {\n    return compareArrayBuffers(test, data, test.byteLength);\n  }\n  switch (typeof test) {\n    case 'function':\n      return test(data, loader);\n    case 'string':\n      const magic = getMagicString(data, byteOffset, test.length);\n      return test === magic;\n    default:\n      return false;\n  }\n}\nfunction getFirstCharacters(data) {\n  let length = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 5;\n  if (typeof data === 'string') {\n    return data.slice(0, length);\n  } else if (ArrayBuffer.isView(data)) {\n    return getMagicString(data.buffer, data.byteOffset, length);\n  } else if (data instanceof ArrayBuffer) {\n    const byteOffset = 0;\n    return getMagicString(data, byteOffset, length);\n  }\n  return '';\n}\nfunction getMagicString(arrayBuffer, byteOffset, length) {\n  if (arrayBuffer.byteLength < byteOffset + length) {\n    return '';\n  }\n  const dataView = new DataView(arrayBuffer);\n  let magic = '';\n  for (let i = 0; i < length; i++) {\n    magic += String.fromCharCode(dataView.getUint8(byteOffset + i));\n  }\n  return magic;\n}\n//# sourceMappingURL=select-loader.js.map","const DEFAULT_CHUNK_SIZE = 256 * 1024;\nexport function* makeStringIterator(string, options) {\n  const chunkSize = (options === null || options === void 0 ? void 0 : options.chunkSize) || DEFAULT_CHUNK_SIZE;\n  let offset = 0;\n  const textEncoder = new TextEncoder();\n  while (offset < string.length) {\n    const chunkLength = Math.min(string.length - offset, chunkSize);\n    const chunk = string.slice(offset, offset + chunkLength);\n    offset += chunkLength;\n    yield textEncoder.encode(chunk);\n  }\n}\n//# sourceMappingURL=make-string-iterator.js.map","const DEFAULT_CHUNK_SIZE = 256 * 1024;\nexport function makeArrayBufferIterator(arrayBuffer) {\n  let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  return function* () {\n    const {\n      chunkSize = DEFAULT_CHUNK_SIZE\n    } = options;\n    let byteOffset = 0;\n    while (byteOffset < arrayBuffer.byteLength) {\n      const chunkByteLength = Math.min(arrayBuffer.byteLength - byteOffset, chunkSize);\n      const chunk = new ArrayBuffer(chunkByteLength);\n      const sourceArray = new Uint8Array(arrayBuffer, byteOffset, chunkByteLength);\n      const chunkArray = new Uint8Array(chunk);\n      chunkArray.set(sourceArray);\n      byteOffset += chunkByteLength;\n      yield chunk;\n    }\n  }();\n}\n//# sourceMappingURL=make-array-buffer-iterator.js.map","const DEFAULT_CHUNK_SIZE = 1024 * 1024;\nexport async function* makeBlobIterator(blob, options) {\n  const chunkSize = (options === null || options === void 0 ? void 0 : options.chunkSize) || DEFAULT_CHUNK_SIZE;\n  let offset = 0;\n  while (offset < blob.size) {\n    const end = offset + chunkSize;\n    const chunk = await blob.slice(offset, end).arrayBuffer();\n    offset = end;\n    yield chunk;\n  }\n}\n//# sourceMappingURL=make-blob-iterator.js.map","import { isBrowser, toArrayBuffer } from '@loaders.gl/loader-utils';\nexport function makeStreamIterator(stream, options) {\n  return isBrowser ? makeBrowserStreamIterator(stream, options) : makeNodeStreamIterator(stream, options);\n}\nasync function* makeBrowserStreamIterator(stream, options) {\n  const reader = stream.getReader();\n  let nextBatchPromise;\n  try {\n    while (true) {\n      const currentBatchPromise = nextBatchPromise || reader.read();\n      if (options !== null && options !== void 0 && options._streamReadAhead) {\n        nextBatchPromise = reader.read();\n      }\n      const {\n        done,\n        value\n      } = await currentBatchPromise;\n      if (done) {\n        return;\n      }\n      yield toArrayBuffer(value);\n    }\n  } catch (error) {\n    reader.releaseLock();\n  }\n}\nasync function* makeNodeStreamIterator(stream, options) {\n  for await (const chunk of stream) {\n    yield toArrayBuffer(chunk);\n  }\n}\n//# sourceMappingURL=make-stream-iterator.js.map","import { makeStringIterator } from './make-string-iterator';\nimport { makeArrayBufferIterator } from './make-array-buffer-iterator';\nimport { makeBlobIterator } from './make-blob-iterator';\nimport { makeStreamIterator } from './make-stream-iterator';\nimport { isBlob, isReadableStream, isResponse } from '../../javascript-utils/is-type';\nexport function makeIterator(data, options) {\n  if (typeof data === 'string') {\n    return makeStringIterator(data, options);\n  }\n  if (data instanceof ArrayBuffer) {\n    return makeArrayBufferIterator(data, options);\n  }\n  if (isBlob(data)) {\n    return makeBlobIterator(data, options);\n  }\n  if (isReadableStream(data)) {\n    return makeStreamIterator(data, options);\n  }\n  if (isResponse(data)) {\n    const response = data;\n    return makeStreamIterator(response.body, options);\n  }\n  throw new Error('makeIterator');\n}\n//# sourceMappingURL=make-iterator.js.map","import { concatenateArrayBuffersAsync } from '@loaders.gl/loader-utils';\nimport { isResponse, isReadableStream, isAsyncIterable, isIterable, isIterator, isBlob, isBuffer } from '../../javascript-utils/is-type';\nimport { makeIterator } from '../../iterators/make-iterator/make-iterator';\nimport { checkResponse, makeResponse } from '../utils/response-utils';\nconst ERR_DATA = 'Cannot convert supplied data type';\nexport function getArrayBufferOrStringFromDataSync(data, loader, options) {\n  if (loader.text && typeof data === 'string') {\n    return data;\n  }\n  if (isBuffer(data)) {\n    data = data.buffer;\n  }\n  if (data instanceof ArrayBuffer) {\n    const arrayBuffer = data;\n    if (loader.text && !loader.binary) {\n      const textDecoder = new TextDecoder('utf8');\n      return textDecoder.decode(arrayBuffer);\n    }\n    return arrayBuffer;\n  }\n  if (ArrayBuffer.isView(data)) {\n    if (loader.text && !loader.binary) {\n      const textDecoder = new TextDecoder('utf8');\n      return textDecoder.decode(data);\n    }\n    let arrayBuffer = data.buffer;\n    const byteLength = data.byteLength || data.length;\n    if (data.byteOffset !== 0 || byteLength !== arrayBuffer.byteLength) {\n      arrayBuffer = arrayBuffer.slice(data.byteOffset, data.byteOffset + byteLength);\n    }\n    return arrayBuffer;\n  }\n  throw new Error(ERR_DATA);\n}\nexport async function getArrayBufferOrStringFromData(data, loader, options) {\n  const isArrayBuffer = data instanceof ArrayBuffer || ArrayBuffer.isView(data);\n  if (typeof data === 'string' || isArrayBuffer) {\n    return getArrayBufferOrStringFromDataSync(data, loader, options);\n  }\n  if (isBlob(data)) {\n    data = await makeResponse(data);\n  }\n  if (isResponse(data)) {\n    const response = data;\n    await checkResponse(response);\n    return loader.binary ? await response.arrayBuffer() : await response.text();\n  }\n  if (isReadableStream(data)) {\n    data = makeIterator(data, options);\n  }\n  if (isIterable(data) || isAsyncIterable(data)) {\n    return concatenateArrayBuffersAsync(data);\n  }\n  throw new Error(ERR_DATA);\n}\nexport async function getAsyncIterableFromData(data, options) {\n  if (isIterator(data)) {\n    return data;\n  }\n  if (isResponse(data)) {\n    const response = data;\n    await checkResponse(response);\n    const body = await response.body;\n    return makeIterator(body, options);\n  }\n  if (isBlob(data) || isReadableStream(data)) {\n    return makeIterator(data, options);\n  }\n  if (isAsyncIterable(data)) {\n    return data[Symbol.asyncIterator]();\n  }\n  return getIterableFromData(data);\n}\nexport async function getReadableStream(data) {\n  if (isReadableStream(data)) {\n    return data;\n  }\n  if (isResponse(data)) {\n    return data.body;\n  }\n  const response = await makeResponse(data);\n  return response.body;\n}\nfunction getIterableFromData(data) {\n  if (ArrayBuffer.isView(data)) {\n    return function* oneChunk() {\n      yield data.buffer;\n    }();\n  }\n  if (data instanceof ArrayBuffer) {\n    return function* oneChunk() {\n      yield data;\n    }();\n  }\n  if (isIterator(data)) {\n    return data;\n  }\n  if (isIterable(data)) {\n    return data[Symbol.iterator]();\n  }\n  throw new Error(ERR_DATA);\n}\n//# sourceMappingURL=get-data.js.map","import { isObject } from '../../javascript-utils/is-type';\nimport { fetchFile } from '../fetch/fetch-file';\nimport { getGlobalLoaderOptions } from './option-utils';\nexport function getFetchFunction(options, context) {\n  const globalOptions = getGlobalLoaderOptions();\n  const fetchOptions = options || globalOptions;\n  if (typeof fetchOptions.fetch === 'function') {\n    return fetchOptions.fetch;\n  }\n  if (isObject(fetchOptions.fetch)) {\n    return url => fetchFile(url, fetchOptions);\n  }\n  if (context !== null && context !== void 0 && context.fetch) {\n    return context === null || context === void 0 ? void 0 : context.fetch;\n  }\n  return fetchFile;\n}\n//# sourceMappingURL=get-fetch-function.js.map","import { getFetchFunction } from './get-fetch-function';\nimport { extractQueryString, stripQueryString } from '../utils/url-utils';\nimport { path } from '@loaders.gl/loader-utils';\nexport function getLoaderContext(context, options, parentContext) {\n  if (parentContext) {\n    return parentContext;\n  }\n  const newContext = {\n    fetch: getFetchFunction(options, context),\n    ...context\n  };\n  if (newContext.url) {\n    const baseUrl = stripQueryString(newContext.url);\n    newContext.baseUrl = baseUrl;\n    newContext.queryString = extractQueryString(newContext.url);\n    newContext.filename = path.filename(baseUrl);\n    newContext.baseUrl = path.dirname(baseUrl);\n  }\n  if (!Array.isArray(newContext.loaders)) {\n    newContext.loaders = null;\n  }\n  return newContext;\n}\nexport function getLoadersFromContext(loaders, context) {\n  if (!context && loaders && !Array.isArray(loaders)) {\n    return loaders;\n  }\n  let candidateLoaders;\n  if (loaders) {\n    candidateLoaders = Array.isArray(loaders) ? loaders : [loaders];\n  }\n  if (context && context.loaders) {\n    const contextLoaders = Array.isArray(context.loaders) ? context.loaders : [context.loaders];\n    candidateLoaders = candidateLoaders ? [...candidateLoaders, ...contextLoaders] : contextLoaders;\n  }\n  return candidateLoaders && candidateLoaders.length ? candidateLoaders : null;\n}\n//# sourceMappingURL=loader-context.js.map","import { assert, validateWorkerVersion } from '@loaders.gl/worker-utils';\nimport { parseWithWorker, canParseWithWorker } from '@loaders.gl/loader-utils';\nimport { isLoaderObject } from '../loader-utils/normalize-loader';\nimport { isResponse } from '../../javascript-utils/is-type';\nimport { normalizeOptions } from '../loader-utils/option-utils';\nimport { getArrayBufferOrStringFromData } from '../loader-utils/get-data';\nimport { getLoaderContext, getLoadersFromContext } from '../loader-utils/loader-context';\nimport { getResourceUrl } from '../utils/resource-utils';\nimport { selectLoader } from './select-loader';\nexport async function parse(data, loaders, options, context) {\n  assert(!context || typeof context === 'object');\n  if (loaders && !Array.isArray(loaders) && !isLoaderObject(loaders)) {\n    context = undefined;\n    options = loaders;\n    loaders = undefined;\n  }\n  data = await data;\n  options = options || {};\n  const url = getResourceUrl(data);\n  const typedLoaders = loaders;\n  const candidateLoaders = getLoadersFromContext(typedLoaders, context);\n  const loader = await selectLoader(data, candidateLoaders, options);\n  if (!loader) {\n    return null;\n  }\n  options = normalizeOptions(options, loader, candidateLoaders, url);\n  context = getLoaderContext({\n    url,\n    parse,\n    loaders: candidateLoaders\n  }, options, context || null);\n  return await parseWithLoader(loader, data, options, context);\n}\nasync function parseWithLoader(loader, data, options, context) {\n  validateWorkerVersion(loader);\n  if (isResponse(data)) {\n    const response = data;\n    const {\n      ok,\n      redirected,\n      status,\n      statusText,\n      type,\n      url\n    } = response;\n    const headers = Object.fromEntries(response.headers.entries());\n    context.response = {\n      headers,\n      ok,\n      redirected,\n      status,\n      statusText,\n      type,\n      url\n    };\n  }\n  data = await getArrayBufferOrStringFromData(data, loader, options);\n  if (loader.parseTextSync && typeof data === 'string') {\n    options.dataType = 'text';\n    return loader.parseTextSync(data, options, context, loader);\n  }\n  if (canParseWithWorker(loader, options)) {\n    return await parseWithWorker(loader, data, options, context, parse);\n  }\n  if (loader.parseText && typeof data === 'string') {\n    return await loader.parseText(data, options, context, loader);\n  }\n  if (loader.parse) {\n    return await loader.parse(data, options, context, loader);\n  }\n  assert(!loader.parseSync);\n  throw new Error(\"\".concat(loader.id, \" loader - no parser found and worker is disabled\"));\n}\n//# sourceMappingURL=parse.js.map","import { isBlob } from '../../javascript-utils/is-type';\nimport { isLoaderObject } from '../loader-utils/normalize-loader';\nimport { getFetchFunction } from '../loader-utils/get-fetch-function';\nimport { parse } from './parse';\nexport async function load(url, loaders, options, context) {\n  if (!Array.isArray(loaders) && !isLoaderObject(loaders)) {\n    context = undefined;\n    options = loaders;\n    loaders = undefined;\n  }\n  const fetch = getFetchFunction(options);\n  let data = url;\n  if (typeof url === 'string') {\n    data = await fetch(url);\n  }\n  if (isBlob(url)) {\n    data = await fetch(url);\n  }\n  return await parse(data, loaders, options);\n}\n//# sourceMappingURL=load.js.map","export const VERSION = typeof \"3.4.14\" !== 'undefined' ? \"3.4.14\" : 'latest';\n//# sourceMappingURL=version.js.map","import { isBrowser } from '@loaders.gl/loader-utils';\nconst {\n  _parseImageNode\n} = globalThis;\nconst IMAGE_SUPPORTED = typeof Image !== 'undefined';\nconst IMAGE_BITMAP_SUPPORTED = typeof ImageBitmap !== 'undefined';\nconst NODE_IMAGE_SUPPORTED = Boolean(_parseImageNode);\nconst DATA_SUPPORTED = isBrowser ? true : NODE_IMAGE_SUPPORTED;\nexport function isImageTypeSupported(type) {\n  switch (type) {\n    case 'auto':\n      return IMAGE_BITMAP_SUPPORTED || IMAGE_SUPPORTED || DATA_SUPPORTED;\n    case 'imagebitmap':\n      return IMAGE_BITMAP_SUPPORTED;\n    case 'image':\n      return IMAGE_SUPPORTED;\n    case 'data':\n      return DATA_SUPPORTED;\n    default:\n      throw new Error(\"@loaders.gl/images: image \".concat(type, \" not supported in this environment\"));\n  }\n}\nexport function getDefaultImageType() {\n  if (IMAGE_BITMAP_SUPPORTED) {\n    return 'imagebitmap';\n  }\n  if (IMAGE_SUPPORTED) {\n    return 'image';\n  }\n  if (DATA_SUPPORTED) {\n    return 'data';\n  }\n  throw new Error('Install \\'@loaders.gl/polyfills\\' to parse images under Node.js');\n}\n//# sourceMappingURL=image-type.js.map","export function isImage(image) {\n  return Boolean(getImageTypeOrNull(image));\n}\nexport function deleteImage(image) {\n  switch (getImageType(image)) {\n    case 'imagebitmap':\n      image.close();\n      break;\n    default:\n  }\n}\nexport function getImageType(image) {\n  const format = getImageTypeOrNull(image);\n  if (!format) {\n    throw new Error('Not an image');\n  }\n  return format;\n}\nexport function getImageSize(image) {\n  return getImageData(image);\n}\nexport function getImageData(image) {\n  switch (getImageType(image)) {\n    case 'data':\n      return image;\n    case 'image':\n    case 'imagebitmap':\n      const canvas = document.createElement('canvas');\n      const context = canvas.getContext('2d');\n      if (!context) {\n        throw new Error('getImageData');\n      }\n      canvas.width = image.width;\n      canvas.height = image.height;\n      context.drawImage(image, 0, 0);\n      return context.getImageData(0, 0, image.width, image.height);\n    default:\n      throw new Error('getImageData');\n  }\n}\nfunction getImageTypeOrNull(image) {\n  if (typeof ImageBitmap !== 'undefined' && image instanceof ImageBitmap) {\n    return 'imagebitmap';\n  }\n  if (typeof Image !== 'undefined' && image instanceof Image) {\n    return 'image';\n  }\n  if (image && typeof image === 'object' && image.data && image.width && image.height) {\n    return 'data';\n  }\n  return null;\n}\n//# sourceMappingURL=parsed-image-api.js.map","const SVG_DATA_URL_PATTERN = /^data:image\\/svg\\+xml/;\nconst SVG_URL_PATTERN = /\\.svg((\\?|#).*)?$/;\nexport function isSVG(url) {\n  return url && (SVG_DATA_URL_PATTERN.test(url) || SVG_URL_PATTERN.test(url));\n}\nexport function getBlobOrSVGDataUrl(arrayBuffer, url) {\n  if (isSVG(url)) {\n    const textDecoder = new TextDecoder();\n    let xmlText = textDecoder.decode(arrayBuffer);\n    try {\n      if (typeof unescape === 'function' && typeof encodeURIComponent === 'function') {\n        xmlText = unescape(encodeURIComponent(xmlText));\n      }\n    } catch (error) {\n      throw new Error(error.message);\n    }\n    const src = \"data:image/svg+xml;base64,\".concat(btoa(xmlText));\n    return src;\n  }\n  return getBlob(arrayBuffer, url);\n}\nexport function getBlob(arrayBuffer, url) {\n  if (isSVG(url)) {\n    throw new Error('SVG cannot be parsed directly to imagebitmap');\n  }\n  return new Blob([new Uint8Array(arrayBuffer)]);\n}\n//# sourceMappingURL=svg-utils.js.map","import { getBlobOrSVGDataUrl } from './svg-utils';\nexport async function parseToImage(arrayBuffer, options, url) {\n  const blobOrDataUrl = getBlobOrSVGDataUrl(arrayBuffer, url);\n  const URL = self.URL || self.webkitURL;\n  const objectUrl = typeof blobOrDataUrl !== 'string' && URL.createObjectURL(blobOrDataUrl);\n  try {\n    return await loadToImage(objectUrl || blobOrDataUrl, options);\n  } finally {\n    if (objectUrl) {\n      URL.revokeObjectURL(objectUrl);\n    }\n  }\n}\nexport async function loadToImage(url, options) {\n  const image = new Image();\n  image.src = url;\n  if (options.image && options.image.decode && image.decode) {\n    await image.decode();\n    return image;\n  }\n  return await new Promise((resolve, reject) => {\n    try {\n      image.onload = () => resolve(image);\n      image.onerror = err => reject(new Error(\"Could not load image \".concat(url, \": \").concat(err)));\n    } catch (error) {\n      reject(error);\n    }\n  });\n}\n//# sourceMappingURL=parse-to-image.js.map","import { isSVG, getBlob } from './svg-utils';\nimport { parseToImage } from './parse-to-image';\nconst EMPTY_OBJECT = {};\nlet imagebitmapOptionsSupported = true;\nexport async function parseToImageBitmap(arrayBuffer, options, url) {\n  let blob;\n  if (isSVG(url)) {\n    const image = await parseToImage(arrayBuffer, options, url);\n    blob = image;\n  } else {\n    blob = getBlob(arrayBuffer, url);\n  }\n  const imagebitmapOptions = options && options.imagebitmap;\n  return await safeCreateImageBitmap(blob, imagebitmapOptions);\n}\nasync function safeCreateImageBitmap(blob) {\n  let imagebitmapOptions = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n  if (isEmptyObject(imagebitmapOptions) || !imagebitmapOptionsSupported) {\n    imagebitmapOptions = null;\n  }\n  if (imagebitmapOptions) {\n    try {\n      return await createImageBitmap(blob, imagebitmapOptions);\n    } catch (error) {\n      console.warn(error);\n      imagebitmapOptionsSupported = false;\n    }\n  }\n  return await createImageBitmap(blob);\n}\nfunction isEmptyObject(object) {\n  for (const key in object || EMPTY_OBJECT) {\n    return false;\n  }\n  return true;\n}\n//# sourceMappingURL=parse-to-image-bitmap.js.map","export function getISOBMFFMediaType(buffer) {\n  if (!checkString(buffer, 'ftyp', 4)) {\n    return null;\n  }\n  if ((buffer[8] & 0x60) === 0x00) {\n    return null;\n  }\n  return decodeMajorBrand(buffer);\n}\nexport function decodeMajorBrand(buffer) {\n  const brandMajor = getUTF8String(buffer, 8, 12).replace('\\0', ' ').trim();\n  switch (brandMajor) {\n    case 'avif':\n    case 'avis':\n      return {\n        extension: 'avif',\n        mimeType: 'image/avif'\n      };\n    default:\n      return null;\n  }\n}\nfunction getUTF8String(array, start, end) {\n  return String.fromCharCode(...array.slice(start, end));\n}\nfunction stringToBytes(string) {\n  return [...string].map(character => character.charCodeAt(0));\n}\nfunction checkString(buffer, header) {\n  let offset = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n  const headerBytes = stringToBytes(header);\n  for (let i = 0; i < headerBytes.length; ++i) {\n    if (headerBytes[i] !== buffer[i + offset]) {\n      return false;\n    }\n  }\n  return true;\n}\n//# sourceMappingURL=parse-isobmff-binary.js.map","import { getISOBMFFMediaType } from './parse-isobmff-binary';\nconst BIG_ENDIAN = false;\nconst LITTLE_ENDIAN = true;\nexport function getBinaryImageMetadata(binaryData) {\n  const dataView = toDataView(binaryData);\n  return getPngMetadata(dataView) || getJpegMetadata(dataView) || getGifMetadata(dataView) || getBmpMetadata(dataView) || getISOBMFFMetadata(dataView);\n}\nfunction getISOBMFFMetadata(binaryData) {\n  const buffer = new Uint8Array(binaryData instanceof DataView ? binaryData.buffer : binaryData);\n  const mediaType = getISOBMFFMediaType(buffer);\n  if (!mediaType) {\n    return null;\n  }\n  return {\n    mimeType: mediaType.mimeType,\n    width: 0,\n    height: 0\n  };\n}\nfunction getPngMetadata(binaryData) {\n  const dataView = toDataView(binaryData);\n  const isPng = dataView.byteLength >= 24 && dataView.getUint32(0, BIG_ENDIAN) === 0x89504e47;\n  if (!isPng) {\n    return null;\n  }\n  return {\n    mimeType: 'image/png',\n    width: dataView.getUint32(16, BIG_ENDIAN),\n    height: dataView.getUint32(20, BIG_ENDIAN)\n  };\n}\nfunction getGifMetadata(binaryData) {\n  const dataView = toDataView(binaryData);\n  const isGif = dataView.byteLength >= 10 && dataView.getUint32(0, BIG_ENDIAN) === 0x47494638;\n  if (!isGif) {\n    return null;\n  }\n  return {\n    mimeType: 'image/gif',\n    width: dataView.getUint16(6, LITTLE_ENDIAN),\n    height: dataView.getUint16(8, LITTLE_ENDIAN)\n  };\n}\nexport function getBmpMetadata(binaryData) {\n  const dataView = toDataView(binaryData);\n  const isBmp = dataView.byteLength >= 14 && dataView.getUint16(0, BIG_ENDIAN) === 0x424d && dataView.getUint32(2, LITTLE_ENDIAN) === dataView.byteLength;\n  if (!isBmp) {\n    return null;\n  }\n  return {\n    mimeType: 'image/bmp',\n    width: dataView.getUint32(18, LITTLE_ENDIAN),\n    height: dataView.getUint32(22, LITTLE_ENDIAN)\n  };\n}\nfunction getJpegMetadata(binaryData) {\n  const dataView = toDataView(binaryData);\n  const isJpeg = dataView.byteLength >= 3 && dataView.getUint16(0, BIG_ENDIAN) === 0xffd8 && dataView.getUint8(2) === 0xff;\n  if (!isJpeg) {\n    return null;\n  }\n  const {\n    tableMarkers,\n    sofMarkers\n  } = getJpegMarkers();\n  let i = 2;\n  while (i + 9 < dataView.byteLength) {\n    const marker = dataView.getUint16(i, BIG_ENDIAN);\n    if (sofMarkers.has(marker)) {\n      return {\n        mimeType: 'image/jpeg',\n        height: dataView.getUint16(i + 5, BIG_ENDIAN),\n        width: dataView.getUint16(i + 7, BIG_ENDIAN)\n      };\n    }\n    if (!tableMarkers.has(marker)) {\n      return null;\n    }\n    i += 2;\n    i += dataView.getUint16(i, BIG_ENDIAN);\n  }\n  return null;\n}\nfunction getJpegMarkers() {\n  const tableMarkers = new Set([0xffdb, 0xffc4, 0xffcc, 0xffdd, 0xfffe]);\n  for (let i = 0xffe0; i < 0xfff0; ++i) {\n    tableMarkers.add(i);\n  }\n  const sofMarkers = new Set([0xffc0, 0xffc1, 0xffc2, 0xffc3, 0xffc5, 0xffc6, 0xffc7, 0xffc9, 0xffca, 0xffcb, 0xffcd, 0xffce, 0xffcf, 0xffde]);\n  return {\n    tableMarkers,\n    sofMarkers\n  };\n}\nfunction toDataView(data) {\n  if (data instanceof DataView) {\n    return data;\n  }\n  if (ArrayBuffer.isView(data)) {\n    return new DataView(data.buffer);\n  }\n  if (data instanceof ArrayBuffer) {\n    return new DataView(data);\n  }\n  throw new Error('toDataView');\n}\n//# sourceMappingURL=binary-image-api.js.map","import { assert } from '@loaders.gl/loader-utils';\nimport { getBinaryImageMetadata } from '../category-api/binary-image-api';\nexport async function parseToNodeImage(arrayBuffer, options) {\n  const {\n    mimeType\n  } = getBinaryImageMetadata(arrayBuffer) || {};\n  const _parseImageNode = globalThis._parseImageNode;\n  assert(_parseImageNode);\n  return await _parseImageNode(arrayBuffer, mimeType);\n}\n//# sourceMappingURL=parse-to-node-image.js.map","import { assert } from '@loaders.gl/loader-utils';\nimport { isImageTypeSupported, getDefaultImageType } from '../category-api/image-type';\nimport { getImageData } from '../category-api/parsed-image-api';\nimport { parseToImage } from './parse-to-image';\nimport { parseToImageBitmap } from './parse-to-image-bitmap';\nimport { parseToNodeImage } from './parse-to-node-image';\nexport async function parseImage(arrayBuffer, options, context) {\n  options = options || {};\n  const imageOptions = options.image || {};\n  const imageType = imageOptions.type || 'auto';\n  const {\n    url\n  } = context || {};\n  const loadType = getLoadableImageType(imageType);\n  let image;\n  switch (loadType) {\n    case 'imagebitmap':\n      image = await parseToImageBitmap(arrayBuffer, options, url);\n      break;\n    case 'image':\n      image = await parseToImage(arrayBuffer, options, url);\n      break;\n    case 'data':\n      image = await parseToNodeImage(arrayBuffer, options);\n      break;\n    default:\n      assert(false);\n  }\n  if (imageType === 'data') {\n    image = getImageData(image);\n  }\n  return image;\n}\nfunction getLoadableImageType(type) {\n  switch (type) {\n    case 'auto':\n    case 'data':\n      return getDefaultImageType();\n    default:\n      isImageTypeSupported(type);\n      return type;\n  }\n}\n//# sourceMappingURL=parse-image.js.map","import { VERSION } from './lib/utils/version';\nimport { parseImage } from './lib/parsers/parse-image';\nimport { getBinaryImageMetadata } from './lib/category-api/binary-image-api';\nconst EXTENSIONS = ['png', 'jpg', 'jpeg', 'gif', 'webp', 'bmp', 'ico', 'svg', 'avif'];\nconst MIME_TYPES = ['image/png', 'image/jpeg', 'image/gif', 'image/webp', 'image/avif', 'image/bmp', 'image/vnd.microsoft.icon', 'image/svg+xml'];\nconst DEFAULT_IMAGE_LOADER_OPTIONS = {\n  image: {\n    type: 'auto',\n    decode: true\n  }\n};\nexport const ImageLoader = {\n  id: 'image',\n  module: 'images',\n  name: 'Images',\n  version: VERSION,\n  mimeTypes: MIME_TYPES,\n  extensions: EXTENSIONS,\n  parse: parseImage,\n  tests: [arrayBuffer => Boolean(getBinaryImageMetadata(new DataView(arrayBuffer)))],\n  options: DEFAULT_IMAGE_LOADER_OPTIONS\n};\nexport const _typecheckImageLoader = ImageLoader;\n//# sourceMappingURL=image-loader.js.map","export default function isElectron(mockUserAgent) {\n  if (typeof window !== 'undefined' && typeof window.process === 'object' && window.process.type === 'renderer') {\n    return true;\n  }\n\n  if (typeof process !== 'undefined' && typeof process.versions === 'object' && Boolean(process.versions['electron'])) {\n    return true;\n  }\n\n  const realUserAgent = typeof navigator === 'object' && typeof navigator.userAgent === 'string' && navigator.userAgent;\n  const userAgent = mockUserAgent || realUserAgent;\n\n  if (userAgent && userAgent.indexOf('Electron') >= 0) {\n    return true;\n  }\n\n  return false;\n}\n//# sourceMappingURL=is-electron.js.map","import isElectron from './is-electron';\nexport default function isBrowser() {\n  const isNode = typeof process === 'object' && String(process) === '[object process]' && !process.browser;\n  return !isNode || isElectron();\n}\nexport function isBrowserMainThread() {\n  return isBrowser() && typeof document !== 'undefined';\n}\n//# sourceMappingURL=is-browser.js.map","const globals = {\n  self: typeof self !== 'undefined' && self,\n  window: typeof window !== 'undefined' && window,\n  global: typeof global !== 'undefined' && global,\n  document: typeof document !== 'undefined' && document,\n  process: typeof process === 'object' && process\n};\nconst global_ = globalThis;\nconst self_ = globals.self || globals.window || globals.global;\nconst window_ = globals.window || globals.self || globals.global;\nconst document_ = globals.document || {};\nconst process_ = globals.process || {};\nconst console_ = console;\nexport { self_ as self, window_ as window, global_ as global, document_ as document, process_ as process, console_ as console };\n//# sourceMappingURL=globals.js.map","import checkIfBrowser from '../lib/is-browser';\nexport { self, window, global, document, process, console } from '../lib/globals';\nexport const VERSION = typeof __VERSION__ !== 'undefined' ? __VERSION__ : 'untranspiled source';\nexport const isBrowser = checkIfBrowser();\n//# sourceMappingURL=globals.js.map","import isBrowser from './is-browser';\nimport isElectron from './is-electron';\nconst window = globalThis;\nexport function isMobile() {\n  return typeof window.orientation !== 'undefined';\n}\nexport default function getBrowser(mockUserAgent) {\n  if (!mockUserAgent && !isBrowser()) {\n    return 'Node';\n  }\n\n  if (isElectron(mockUserAgent)) {\n    return 'Electron';\n  }\n\n  const navigator_ = typeof navigator !== 'undefined' ? navigator : {};\n  const userAgent = mockUserAgent || navigator_.userAgent || '';\n\n  if (userAgent.indexOf('Edge') > -1) {\n    return 'Edge';\n  }\n\n  const isMSIE = userAgent.indexOf('MSIE ') !== -1;\n  const isTrident = userAgent.indexOf('Trident/') !== -1;\n\n  if (isMSIE || isTrident) {\n    return 'IE';\n  }\n\n  if (window.chrome) {\n    return 'Chrome';\n  }\n\n  if (window.safari) {\n    return 'Safari';\n  }\n\n  if (window.mozInnerScreenX) {\n    return 'Firefox';\n  }\n\n  return 'Unknown';\n}\n//# sourceMappingURL=get-browser.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\n\nfunction getStorage(type) {\n  try {\n    const storage = window[type];\n    const x = '__storage_test__';\n    storage.setItem(x, x);\n    storage.removeItem(x);\n    return storage;\n  } catch (e) {\n    return null;\n  }\n}\n\nexport class LocalStorage {\n  constructor(id, defaultConfig) {\n    let type = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'sessionStorage';\n\n    _defineProperty(this, \"storage\", void 0);\n\n    _defineProperty(this, \"id\", void 0);\n\n    _defineProperty(this, \"config\", void 0);\n\n    this.storage = getStorage(type);\n    this.id = id;\n    this.config = defaultConfig;\n\n    this._loadConfiguration();\n  }\n\n  getConfiguration() {\n    return this.config;\n  }\n\n  setConfiguration(configuration) {\n    Object.assign(this.config, configuration);\n\n    if (this.storage) {\n      const serialized = JSON.stringify(this.config);\n      this.storage.setItem(this.id, serialized);\n    }\n  }\n\n  _loadConfiguration() {\n    let configuration = {};\n\n    if (this.storage) {\n      const serializedConfiguration = this.storage.getItem(this.id);\n      configuration = serializedConfiguration ? JSON.parse(serializedConfiguration) : {};\n    }\n\n    Object.assign(this.config, configuration);\n    return this;\n  }\n\n}\n//# sourceMappingURL=local-storage.js.map","export function formatTime(ms) {\n  let formatted;\n\n  if (ms < 10) {\n    formatted = \"\".concat(ms.toFixed(2), \"ms\");\n  } else if (ms < 100) {\n    formatted = \"\".concat(ms.toFixed(1), \"ms\");\n  } else if (ms < 1000) {\n    formatted = \"\".concat(ms.toFixed(0), \"ms\");\n  } else {\n    formatted = \"\".concat((ms / 1000).toFixed(2), \"s\");\n  }\n\n  return formatted;\n}\nexport function leftPad(string) {\n  let length = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 8;\n  const padLength = Math.max(length - string.length, 0);\n  return \"\".concat(' '.repeat(padLength)).concat(string);\n}\nexport function rightPad(string) {\n  let length = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 8;\n  const padLength = Math.max(length - string.length, 0);\n  return \"\".concat(string).concat(' '.repeat(padLength));\n}\nexport function formatValue(v) {\n  let opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  const EPSILON = 1e-16;\n  const {\n    isInteger = false\n  } = opts;\n\n  if (Array.isArray(v) || ArrayBuffer.isView(v)) {\n    return formatArrayValue(v, opts);\n  }\n\n  if (!Number.isFinite(v)) {\n    return String(v);\n  }\n\n  if (Math.abs(v) < EPSILON) {\n    return isInteger ? '0' : '0.';\n  }\n\n  if (isInteger) {\n    return v.toFixed(0);\n  }\n\n  if (Math.abs(v) > 100 && Math.abs(v) < 10000) {\n    return v.toFixed(0);\n  }\n\n  const string = v.toPrecision(2);\n  const decimal = string.indexOf('.0');\n  return decimal === string.length - 2 ? string.slice(0, -1) : string;\n}\n\nfunction formatArrayValue(v, opts) {\n  const {\n    maxElts = 16,\n    size = 1\n  } = opts;\n  let string = '[';\n\n  for (let i = 0; i < v.length && i < maxElts; ++i) {\n    if (i > 0) {\n      string += \",\".concat(i % size === 0 ? ' ' : '');\n    }\n\n    string += formatValue(v[i], opts);\n  }\n\n  const terminator = v.length > maxElts ? '...' : ']';\n  return \"\".concat(string).concat(terminator);\n}\n\nexport function formatImage(image, message, scale) {\n  let maxWidth = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 600;\n  const imageUrl = image.src.replace(/\\(/g, '%28').replace(/\\)/g, '%29');\n\n  if (image.width > maxWidth) {\n    scale = Math.min(scale, maxWidth / image.width);\n  }\n\n  const width = image.width * scale;\n  const height = image.height * scale;\n  const style = ['font-size:1px;', \"padding:\".concat(Math.floor(height / 2), \"px \").concat(Math.floor(width / 2), \"px;\"), \"line-height:\".concat(height, \"px;\"), \"background:url(\".concat(imageUrl, \");\"), \"background-size:\".concat(width, \"px \").concat(height, \"px;\"), 'color:transparent;'].join('');\n  return [\"\".concat(message, \" %c+\"), style];\n}\n//# sourceMappingURL=formatters.js.map","import { isBrowser } from '@probe.gl/env';\nexport let COLOR;\n\n(function (COLOR) {\n  COLOR[COLOR[\"BLACK\"] = 30] = \"BLACK\";\n  COLOR[COLOR[\"RED\"] = 31] = \"RED\";\n  COLOR[COLOR[\"GREEN\"] = 32] = \"GREEN\";\n  COLOR[COLOR[\"YELLOW\"] = 33] = \"YELLOW\";\n  COLOR[COLOR[\"BLUE\"] = 34] = \"BLUE\";\n  COLOR[COLOR[\"MAGENTA\"] = 35] = \"MAGENTA\";\n  COLOR[COLOR[\"CYAN\"] = 36] = \"CYAN\";\n  COLOR[COLOR[\"WHITE\"] = 37] = \"WHITE\";\n  COLOR[COLOR[\"BRIGHT_BLACK\"] = 90] = \"BRIGHT_BLACK\";\n  COLOR[COLOR[\"BRIGHT_RED\"] = 91] = \"BRIGHT_RED\";\n  COLOR[COLOR[\"BRIGHT_GREEN\"] = 92] = \"BRIGHT_GREEN\";\n  COLOR[COLOR[\"BRIGHT_YELLOW\"] = 93] = \"BRIGHT_YELLOW\";\n  COLOR[COLOR[\"BRIGHT_BLUE\"] = 94] = \"BRIGHT_BLUE\";\n  COLOR[COLOR[\"BRIGHT_MAGENTA\"] = 95] = \"BRIGHT_MAGENTA\";\n  COLOR[COLOR[\"BRIGHT_CYAN\"] = 96] = \"BRIGHT_CYAN\";\n  COLOR[COLOR[\"BRIGHT_WHITE\"] = 97] = \"BRIGHT_WHITE\";\n})(COLOR || (COLOR = {}));\n\nfunction getColor(color) {\n  return typeof color === 'string' ? COLOR[color.toUpperCase()] || COLOR.WHITE : color;\n}\n\nexport function addColor(string, color, background) {\n  if (!isBrowser && typeof string === 'string') {\n    if (color) {\n      color = getColor(color);\n      string = \"\\x1B[\".concat(color, \"m\").concat(string, \"\\x1B[39m\");\n    }\n\n    if (background) {\n      color = getColor(background);\n      string = \"\\x1B[\".concat(background + 10, \"m\").concat(string, \"\\x1B[49m\");\n    }\n  }\n\n  return string;\n}\n//# sourceMappingURL=color.js.map","export function autobind(obj) {\n  let predefined = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : ['constructor'];\n  const proto = Object.getPrototypeOf(obj);\n  const propNames = Object.getOwnPropertyNames(proto);\n\n  for (const key of propNames) {\n    if (typeof obj[key] === 'function') {\n      if (!predefined.find(name => key === name)) {\n        obj[key] = obj[key].bind(obj);\n      }\n    }\n  }\n}\n//# sourceMappingURL=autobind.js.map","export default function assert(condition, message) {\n  if (!condition) {\n    throw new Error(message || 'Assertion failed');\n  }\n}\n//# sourceMappingURL=assert.js.map","import { window, process, isBrowser } from '@probe.gl/env';\nexport function getHiResTimestamp() {\n  let timestamp;\n\n  if (isBrowser && 'performance' in window) {\n    var _window$performance, _window$performance$n;\n\n    timestamp = window === null || window === void 0 ? void 0 : (_window$performance = window.performance) === null || _window$performance === void 0 ? void 0 : (_window$performance$n = _window$performance.now) === null || _window$performance$n === void 0 ? void 0 : _window$performance$n.call(_window$performance);\n  } else if ('hrtime' in process) {\n    var _process$hrtime;\n\n    const timeParts = process === null || process === void 0 ? void 0 : (_process$hrtime = process.hrtime) === null || _process$hrtime === void 0 ? void 0 : _process$hrtime.call(process);\n    timestamp = timeParts[0] * 1000 + timeParts[1] / 1e6;\n  } else {\n    timestamp = Date.now();\n  }\n\n  return timestamp;\n}\n//# sourceMappingURL=hi-res-timestamp.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { VERSION, isBrowser } from '@probe.gl/env';\nimport { LocalStorage } from './utils/local-storage';\nimport { formatImage, formatTime, leftPad } from './utils/formatters';\nimport { addColor } from './utils/color';\nimport { autobind } from './utils/autobind';\nimport assert from './utils/assert';\nimport { getHiResTimestamp } from './utils/hi-res-timestamp';\nconst originalConsole = {\n  debug: isBrowser ? console.debug || console.log : console.log,\n  log: console.log,\n  info: console.info,\n  warn: console.warn,\n  error: console.error\n};\nconst DEFAULT_SETTINGS = {\n  enabled: true,\n  level: 0\n};\n\nfunction noop() {}\n\nconst cache = {};\nconst ONCE = {\n  once: true\n};\nexport class Log {\n  constructor() {\n    let {\n      id\n    } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {\n      id: ''\n    };\n\n    _defineProperty(this, \"id\", void 0);\n\n    _defineProperty(this, \"VERSION\", VERSION);\n\n    _defineProperty(this, \"_startTs\", getHiResTimestamp());\n\n    _defineProperty(this, \"_deltaTs\", getHiResTimestamp());\n\n    _defineProperty(this, \"_storage\", void 0);\n\n    _defineProperty(this, \"userData\", {});\n\n    _defineProperty(this, \"LOG_THROTTLE_TIMEOUT\", 0);\n\n    this.id = id;\n    this.userData = {};\n    this._storage = new LocalStorage(\"__probe-\".concat(this.id, \"__\"), DEFAULT_SETTINGS);\n    this.timeStamp(\"\".concat(this.id, \" started\"));\n    autobind(this);\n    Object.seal(this);\n  }\n\n  set level(newLevel) {\n    this.setLevel(newLevel);\n  }\n\n  get level() {\n    return this.getLevel();\n  }\n\n  isEnabled() {\n    return this._storage.config.enabled;\n  }\n\n  getLevel() {\n    return this._storage.config.level;\n  }\n\n  getTotal() {\n    return Number((getHiResTimestamp() - this._startTs).toPrecision(10));\n  }\n\n  getDelta() {\n    return Number((getHiResTimestamp() - this._deltaTs).toPrecision(10));\n  }\n\n  set priority(newPriority) {\n    this.level = newPriority;\n  }\n\n  get priority() {\n    return this.level;\n  }\n\n  getPriority() {\n    return this.level;\n  }\n\n  enable() {\n    let enabled = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n\n    this._storage.setConfiguration({\n      enabled\n    });\n\n    return this;\n  }\n\n  setLevel(level) {\n    this._storage.setConfiguration({\n      level\n    });\n\n    return this;\n  }\n\n  get(setting) {\n    return this._storage.config[setting];\n  }\n\n  set(setting, value) {\n    this._storage.setConfiguration({\n      [setting]: value\n    });\n  }\n\n  settings() {\n    if (console.table) {\n      console.table(this._storage.config);\n    } else {\n      console.log(this._storage.config);\n    }\n  }\n\n  assert(condition, message) {\n    assert(condition, message);\n  }\n\n  warn(message) {\n    return this._getLogFunction(0, message, originalConsole.warn, arguments, ONCE);\n  }\n\n  error(message) {\n    return this._getLogFunction(0, message, originalConsole.error, arguments);\n  }\n\n  deprecated(oldUsage, newUsage) {\n    return this.warn(\"`\".concat(oldUsage, \"` is deprecated and will be removed in a later version. Use `\").concat(newUsage, \"` instead\"));\n  }\n\n  removed(oldUsage, newUsage) {\n    return this.error(\"`\".concat(oldUsage, \"` has been removed. Use `\").concat(newUsage, \"` instead\"));\n  }\n\n  probe(logLevel, message) {\n    return this._getLogFunction(logLevel, message, originalConsole.log, arguments, {\n      time: true,\n      once: true\n    });\n  }\n\n  log(logLevel, message) {\n    return this._getLogFunction(logLevel, message, originalConsole.debug, arguments);\n  }\n\n  info(logLevel, message) {\n    return this._getLogFunction(logLevel, message, console.info, arguments);\n  }\n\n  once(logLevel, message) {\n    for (var _len = arguments.length, args = new Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {\n      args[_key - 2] = arguments[_key];\n    }\n\n    return this._getLogFunction(logLevel, message, originalConsole.debug || originalConsole.info, arguments, ONCE);\n  }\n\n  table(logLevel, table, columns) {\n    if (table) {\n      return this._getLogFunction(logLevel, table, console.table || noop, columns && [columns], {\n        tag: getTableHeader(table)\n      });\n    }\n\n    return noop;\n  }\n\n  image(_ref) {\n    let {\n      logLevel,\n      priority,\n      image,\n      message = '',\n      scale = 1\n    } = _ref;\n\n    if (!this._shouldLog(logLevel || priority)) {\n      return noop;\n    }\n\n    return isBrowser ? logImageInBrowser({\n      image,\n      message,\n      scale\n    }) : logImageInNode({\n      image,\n      message,\n      scale\n    });\n  }\n\n  time(logLevel, message) {\n    return this._getLogFunction(logLevel, message, console.time ? console.time : console.info);\n  }\n\n  timeEnd(logLevel, message) {\n    return this._getLogFunction(logLevel, message, console.timeEnd ? console.timeEnd : console.info);\n  }\n\n  timeStamp(logLevel, message) {\n    return this._getLogFunction(logLevel, message, console.timeStamp || noop);\n  }\n\n  group(logLevel, message) {\n    let opts = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {\n      collapsed: false\n    };\n    const options = normalizeArguments({\n      logLevel,\n      message,\n      opts\n    });\n    const {\n      collapsed\n    } = opts;\n    options.method = (collapsed ? console.groupCollapsed : console.group) || console.info;\n    return this._getLogFunction(options);\n  }\n\n  groupCollapsed(logLevel, message) {\n    let opts = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    return this.group(logLevel, message, Object.assign({}, opts, {\n      collapsed: true\n    }));\n  }\n\n  groupEnd(logLevel) {\n    return this._getLogFunction(logLevel, '', console.groupEnd || noop);\n  }\n\n  withGroup(logLevel, message, func) {\n    this.group(logLevel, message)();\n\n    try {\n      func();\n    } finally {\n      this.groupEnd(logLevel)();\n    }\n  }\n\n  trace() {\n    if (console.trace) {\n      console.trace();\n    }\n  }\n\n  _shouldLog(logLevel) {\n    return this.isEnabled() && this.getLevel() >= normalizeLogLevel(logLevel);\n  }\n\n  _getLogFunction(logLevel, message, method, args, opts) {\n    if (this._shouldLog(logLevel)) {\n      opts = normalizeArguments({\n        logLevel,\n        message,\n        args,\n        opts\n      });\n      method = method || opts.method;\n      assert(method);\n      opts.total = this.getTotal();\n      opts.delta = this.getDelta();\n      this._deltaTs = getHiResTimestamp();\n      const tag = opts.tag || opts.message;\n\n      if (opts.once) {\n        if (!cache[tag]) {\n          cache[tag] = getHiResTimestamp();\n        } else {\n          return noop;\n        }\n      }\n\n      message = decorateMessage(this.id, opts.message, opts);\n      return method.bind(console, message, ...opts.args);\n    }\n\n    return noop;\n  }\n\n}\n\n_defineProperty(Log, \"VERSION\", VERSION);\n\nfunction normalizeLogLevel(logLevel) {\n  if (!logLevel) {\n    return 0;\n  }\n\n  let resolvedLevel;\n\n  switch (typeof logLevel) {\n    case 'number':\n      resolvedLevel = logLevel;\n      break;\n\n    case 'object':\n      resolvedLevel = logLevel.logLevel || logLevel.priority || 0;\n      break;\n\n    default:\n      return 0;\n  }\n\n  assert(Number.isFinite(resolvedLevel) && resolvedLevel >= 0);\n  return resolvedLevel;\n}\n\nexport function normalizeArguments(opts) {\n  const {\n    logLevel,\n    message\n  } = opts;\n  opts.logLevel = normalizeLogLevel(logLevel);\n  const args = opts.args ? Array.from(opts.args) : [];\n\n  while (args.length && args.shift() !== message) {}\n\n  switch (typeof logLevel) {\n    case 'string':\n    case 'function':\n      if (message !== undefined) {\n        args.unshift(message);\n      }\n\n      opts.message = logLevel;\n      break;\n\n    case 'object':\n      Object.assign(opts, logLevel);\n      break;\n\n    default:\n  }\n\n  if (typeof opts.message === 'function') {\n    opts.message = opts.message();\n  }\n\n  const messageType = typeof opts.message;\n  assert(messageType === 'string' || messageType === 'object');\n  return Object.assign(opts, {\n    args\n  }, opts.opts);\n}\n\nfunction decorateMessage(id, message, opts) {\n  if (typeof message === 'string') {\n    const time = opts.time ? leftPad(formatTime(opts.total)) : '';\n    message = opts.time ? \"\".concat(id, \": \").concat(time, \"  \").concat(message) : \"\".concat(id, \": \").concat(message);\n    message = addColor(message, opts.color, opts.background);\n  }\n\n  return message;\n}\n\nfunction logImageInNode(_ref2) {\n  let {\n    image,\n    message = '',\n    scale = 1\n  } = _ref2;\n  console.warn('removed');\n  return noop;\n}\n\nfunction logImageInBrowser(_ref3) {\n  let {\n    image,\n    message = '',\n    scale = 1\n  } = _ref3;\n\n  if (typeof image === 'string') {\n    const img = new Image();\n\n    img.onload = () => {\n      const args = formatImage(img, message, scale);\n      console.log(...args);\n    };\n\n    img.src = image;\n    return noop;\n  }\n\n  const element = image.nodeName || '';\n\n  if (element.toLowerCase() === 'img') {\n    console.log(...formatImage(image, message, scale));\n    return noop;\n  }\n\n  if (element.toLowerCase() === 'canvas') {\n    const img = new Image();\n\n    img.onload = () => console.log(...formatImage(img, message, scale));\n\n    img.src = image.toDataURL();\n    return noop;\n  }\n\n  return noop;\n}\n\nfunction getTableHeader(table) {\n  for (const key in table) {\n    for (const title in table[key]) {\n      return title || 'untitled';\n    }\n  }\n\n  return 'empty';\n}\n//# sourceMappingURL=log.js.map","import { Log } from '@probe.gl/log';\nexport default new Log({\n  id: 'deck'\n});\n//# sourceMappingURL=log.js.map","import deckLog from '../utils/log';\nimport { getLoggers } from './loggers';\nlet loggers = {};\n\nif (process.env.NODE_ENV !== 'production') {\n  loggers = getLoggers(deckLog);\n}\n\nexport function register(handlers) {\n  loggers = handlers;\n}\nexport default function debug(eventType, arg1, arg2, arg3) {\n  if (deckLog.level > 0 && loggers[eventType]) {\n    loggers[eventType].call(null, arg1, arg2, arg3);\n  }\n}\n//# sourceMappingURL=index.js.map","function isJSON(text) {\n  const firstChar = text[0];\n  const lastChar = text[text.length - 1];\n  return firstChar === '{' && lastChar === '}' || firstChar === '[' && lastChar === ']';\n}\n\nexport default {\n  id: 'JSON',\n  name: 'JSON',\n  module: '',\n  version: '',\n  options: {},\n  extensions: ['json', 'geojson'],\n  mimeTypes: ['application/json', 'application/geo+json'],\n  testText: isJSON,\n  parseTextSync: JSON.parse\n};\n//# sourceMappingURL=json-loader.js.map","import { registerLoaders } from '@loaders.gl/core';\nimport { ImageLoader } from '@loaders.gl/images';\nimport log from '../utils/log';\nimport { register } from '../debug';\nimport jsonLoader from '../utils/json-loader';\nconst version = typeof \"8.8.16\" !== 'undefined' ? \"8.8.16\" : globalThis.DECK_VERSION || 'untranspiled source';\nconst existingVersion = globalThis.deck && globalThis.deck.VERSION;\n\nif (existingVersion && existingVersion !== version) {\n  throw new Error(\"deck.gl - multiple versions detected: \".concat(existingVersion, \" vs \").concat(version));\n}\n\nif (!existingVersion) {\n  log.log(1, \"deck.gl \".concat(version))();\n  globalThis.deck = { ...globalThis.deck,\n    VERSION: version,\n    version,\n    log,\n    _registerLoggers: register\n  };\n  registerLoaders([jsonLoader, [ImageLoader, {\n    imagebitmap: {\n      premultiplyAlpha: 'none'\n    }\n  }]]);\n}\n\nexport default globalThis.deck;\n//# sourceMappingURL=init.js.map","import { Log } from '@probe.gl/log';\nexport const log = new Log({\n  id: 'luma.gl'\n});\n//# sourceMappingURL=log.js.map","export function assert(condition, message) {\n  if (!condition) {\n    throw new Error(message || 'luma.gl: assertion failed.');\n  }\n}\n//# sourceMappingURL=assert.js.map","import { assert } from './assert';\nconst ERR_CONTEXT = 'Invalid WebGLRenderingContext';\nexport const ERR_WEBGL = ERR_CONTEXT;\nexport const ERR_WEBGL2 = 'Requires WebGL2';\nexport function isWebGL(gl) {\n  if (typeof WebGLRenderingContext !== 'undefined' && gl instanceof WebGLRenderingContext) {\n    return true;\n  }\n\n  if (typeof WebGL2RenderingContext !== 'undefined' && gl instanceof WebGL2RenderingContext) {\n    return true;\n  }\n\n  return Boolean(gl && Number.isFinite(gl._version));\n}\nexport function isWebGL2(gl) {\n  if (typeof WebGL2RenderingContext !== 'undefined' && gl instanceof WebGL2RenderingContext) {\n    return true;\n  }\n\n  return Boolean(gl && gl._version === 2);\n}\nexport function getWebGL2Context(gl) {\n  return isWebGL2(gl) ? gl : null;\n}\nexport function assertWebGLContext(gl) {\n  assert(isWebGL(gl), ERR_CONTEXT);\n  return gl;\n}\nexport function assertWebGL2Context(gl) {\n  assert(isWebGL2(gl), ERR_WEBGL2);\n  return gl;\n}\n//# sourceMappingURL=webgl-checks.js.map","const glErrorShadow = {};\n\nfunction error(msg) {\n  if (globalThis.console && globalThis.console.error) {\n    globalThis.console.error(msg);\n  }\n}\n\nfunction log(msg) {\n  if (globalThis.console && globalThis.console.log) {\n    globalThis.console.log(msg);\n  }\n}\n\nfunction synthesizeGLError(err, opt_msg) {\n  glErrorShadow[err] = true;\n\n  if (opt_msg !== undefined) {\n    error(opt_msg);\n  }\n}\n\nfunction wrapGLError(gl) {\n  const f = gl.getError;\n\n  gl.getError = function getError() {\n    let err;\n\n    do {\n      err = f.apply(gl);\n\n      if (err !== 0) {\n        glErrorShadow[err] = true;\n      }\n    } while (err !== 0);\n\n    for (err in glErrorShadow) {\n      if (glErrorShadow[err]) {\n        delete glErrorShadow[err];\n        return parseInt(err, 10);\n      }\n    }\n\n    return 0;\n  };\n}\n\nconst WebGLVertexArrayObjectOES = function WebGLVertexArrayObjectOES(ext) {\n  const gl = ext.gl;\n  this.ext = ext;\n  this.isAlive = true;\n  this.hasBeenBound = false;\n  this.elementArrayBuffer = null;\n  this.attribs = new Array(ext.maxVertexAttribs);\n\n  for (let n = 0; n < this.attribs.length; n++) {\n    const attrib = new WebGLVertexArrayObjectOES.VertexAttrib(gl);\n    this.attribs[n] = attrib;\n  }\n\n  this.maxAttrib = 0;\n};\n\nWebGLVertexArrayObjectOES.VertexAttrib = function VertexAttrib(gl) {\n  this.enabled = false;\n  this.buffer = null;\n  this.size = 4;\n  this.type = 5126;\n  this.normalized = false;\n  this.stride = 16;\n  this.offset = 0;\n  this.cached = '';\n  this.recache();\n};\n\nWebGLVertexArrayObjectOES.VertexAttrib.prototype.recache = function recache() {\n  this.cached = [this.size, this.type, this.normalized, this.stride, this.offset].join(':');\n};\n\nconst OESVertexArrayObject = function OESVertexArrayObject(gl) {\n  const self = this;\n  this.gl = gl;\n  wrapGLError(gl);\n  const original = this.original = {\n    getParameter: gl.getParameter,\n    enableVertexAttribArray: gl.enableVertexAttribArray,\n    disableVertexAttribArray: gl.disableVertexAttribArray,\n    bindBuffer: gl.bindBuffer,\n    getVertexAttrib: gl.getVertexAttrib,\n    vertexAttribPointer: gl.vertexAttribPointer\n  };\n\n  gl.getParameter = function getParameter(pname) {\n    if (pname === self.VERTEX_ARRAY_BINDING_OES) {\n      if (self.currentVertexArrayObject === self.defaultVertexArrayObject) {\n        return null;\n      }\n\n      return self.currentVertexArrayObject;\n    }\n\n    return original.getParameter.apply(this, arguments);\n  };\n\n  gl.enableVertexAttribArray = function enableVertexAttribArray(index) {\n    const vao = self.currentVertexArrayObject;\n    vao.maxAttrib = Math.max(vao.maxAttrib, index);\n    const attrib = vao.attribs[index];\n    attrib.enabled = true;\n    return original.enableVertexAttribArray.apply(this, arguments);\n  };\n\n  gl.disableVertexAttribArray = function disableVertexAttribArray(index) {\n    const vao = self.currentVertexArrayObject;\n    vao.maxAttrib = Math.max(vao.maxAttrib, index);\n    const attrib = vao.attribs[index];\n    attrib.enabled = false;\n    return original.disableVertexAttribArray.apply(this, arguments);\n  };\n\n  gl.bindBuffer = function bindBuffer(target, buffer) {\n    switch (target) {\n      case 34962:\n        self.currentArrayBuffer = buffer;\n        break;\n\n      case 34963:\n        self.currentVertexArrayObject.elementArrayBuffer = buffer;\n        break;\n\n      default:\n    }\n\n    return original.bindBuffer.apply(this, arguments);\n  };\n\n  gl.getVertexAttrib = function getVertexAttrib(index, pname) {\n    const vao = self.currentVertexArrayObject;\n    const attrib = vao.attribs[index];\n\n    switch (pname) {\n      case 34975:\n        return attrib.buffer;\n\n      case 34338:\n        return attrib.enabled;\n\n      case 34339:\n        return attrib.size;\n\n      case 34340:\n        return attrib.stride;\n\n      case 34341:\n        return attrib.type;\n\n      case 34922:\n        return attrib.normalized;\n\n      default:\n        return original.getVertexAttrib.apply(this, arguments);\n    }\n  };\n\n  gl.vertexAttribPointer = function vertexAttribPointer(indx, size, type, normalized, stride, offset) {\n    const vao = self.currentVertexArrayObject;\n    vao.maxAttrib = Math.max(vao.maxAttrib, indx);\n    const attrib = vao.attribs[indx];\n    attrib.buffer = self.currentArrayBuffer;\n    attrib.size = size;\n    attrib.type = type;\n    attrib.normalized = normalized;\n    attrib.stride = stride;\n    attrib.offset = offset;\n    attrib.recache();\n    return original.vertexAttribPointer.apply(this, arguments);\n  };\n\n  if (gl.instrumentExtension) {\n    gl.instrumentExtension(this, 'OES_vertex_array_object');\n  }\n\n  if (gl.canvas) {\n    gl.canvas.addEventListener('webglcontextrestored', () => {\n      log('OESVertexArrayObject emulation library context restored');\n      self.reset_();\n    }, true);\n  }\n\n  this.reset_();\n};\n\nOESVertexArrayObject.prototype.VERTEX_ARRAY_BINDING_OES = 0x85b5;\n\nOESVertexArrayObject.prototype.reset_ = function reset_() {\n  const contextWasLost = this.vertexArrayObjects !== undefined;\n\n  if (contextWasLost) {\n    for (let ii = 0; ii < this.vertexArrayObjects.length; ++ii) {\n      this.vertexArrayObjects.isAlive = false;\n    }\n  }\n\n  const gl = this.gl;\n  this.maxVertexAttribs = gl.getParameter(34921);\n  this.defaultVertexArrayObject = new WebGLVertexArrayObjectOES(this);\n  this.currentVertexArrayObject = null;\n  this.currentArrayBuffer = null;\n  this.vertexArrayObjects = [this.defaultVertexArrayObject];\n  this.bindVertexArrayOES(null);\n};\n\nOESVertexArrayObject.prototype.createVertexArrayOES = function createVertexArrayOES() {\n  const arrayObject = new WebGLVertexArrayObjectOES(this);\n  this.vertexArrayObjects.push(arrayObject);\n  return arrayObject;\n};\n\nOESVertexArrayObject.prototype.deleteVertexArrayOES = function deleteVertexArrayOES(arrayObject) {\n  arrayObject.isAlive = false;\n  this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(arrayObject), 1);\n\n  if (this.currentVertexArrayObject === arrayObject) {\n    this.bindVertexArrayOES(null);\n  }\n};\n\nOESVertexArrayObject.prototype.isVertexArrayOES = function isVertexArrayOES(arrayObject) {\n  if (arrayObject && arrayObject instanceof WebGLVertexArrayObjectOES) {\n    if (arrayObject.hasBeenBound && arrayObject.ext === this) {\n      return true;\n    }\n  }\n\n  return false;\n};\n\nOESVertexArrayObject.prototype.bindVertexArrayOES = function bindVertexArrayOES(arrayObject) {\n  const gl = this.gl;\n\n  if (arrayObject && !arrayObject.isAlive) {\n    synthesizeGLError(1282, 'bindVertexArrayOES: attempt to bind deleted arrayObject');\n    return;\n  }\n\n  const original = this.original;\n  const oldVAO = this.currentVertexArrayObject;\n  this.currentVertexArrayObject = arrayObject || this.defaultVertexArrayObject;\n  this.currentVertexArrayObject.hasBeenBound = true;\n  const newVAO = this.currentVertexArrayObject;\n\n  if (oldVAO === newVAO) {\n    return;\n  }\n\n  if (!oldVAO || newVAO.elementArrayBuffer !== oldVAO.elementArrayBuffer) {\n    original.bindBuffer.call(gl, 34963, newVAO.elementArrayBuffer);\n  }\n\n  let currentBinding = this.currentArrayBuffer;\n  const maxAttrib = Math.max(oldVAO ? oldVAO.maxAttrib : 0, newVAO.maxAttrib);\n\n  for (let n = 0; n <= maxAttrib; n++) {\n    const attrib = newVAO.attribs[n];\n    const oldAttrib = oldVAO ? oldVAO.attribs[n] : null;\n\n    if (!oldVAO || attrib.enabled !== oldAttrib.enabled) {\n      if (attrib.enabled) {\n        original.enableVertexAttribArray.call(gl, n);\n      } else {\n        original.disableVertexAttribArray.call(gl, n);\n      }\n    }\n\n    if (attrib.enabled) {\n      let bufferChanged = false;\n\n      if (!oldVAO || attrib.buffer !== oldAttrib.buffer) {\n        if (currentBinding !== attrib.buffer) {\n          original.bindBuffer.call(gl, 34962, attrib.buffer);\n          currentBinding = attrib.buffer;\n        }\n\n        bufferChanged = true;\n      }\n\n      if (bufferChanged || attrib.cached !== oldAttrib.cached) {\n        original.vertexAttribPointer.call(gl, n, attrib.size, attrib.type, attrib.normalized, attrib.stride, attrib.offset);\n      }\n    }\n  }\n\n  if (this.currentArrayBuffer !== currentBinding) {\n    original.bindBuffer.call(gl, 34962, this.currentArrayBuffer);\n  }\n};\n\nexport function polyfillVertexArrayObject(gl) {\n  if (typeof gl.createVertexArray === 'function') {\n    return;\n  }\n\n  const original_getSupportedExtensions = gl.getSupportedExtensions;\n\n  gl.getSupportedExtensions = function getSupportedExtensions() {\n    const list = original_getSupportedExtensions.call(this) || [];\n\n    if (list.indexOf('OES_vertex_array_object') < 0) {\n      list.push('OES_vertex_array_object');\n    }\n\n    return list;\n  };\n\n  const original_getExtension = gl.getExtension;\n\n  gl.getExtension = function getExtension(name) {\n    const ext = original_getExtension.call(this, name);\n\n    if (ext) {\n      return ext;\n    }\n\n    if (name !== 'OES_vertex_array_object') {\n      return null;\n    }\n\n    if (!gl.__OESVertexArrayObject) {\n      this.__OESVertexArrayObject = new OESVertexArrayObject(this);\n    }\n\n    return this.__OESVertexArrayObject;\n  };\n}\n//# sourceMappingURL=polyfill-vertex-array-object.js.map","import { isWebGL2 } from '../utils/webgl-checks';\nconst OES_element_index = 'OES_element_index';\nconst WEBGL_draw_buffers = 'WEBGL_draw_buffers';\nconst EXT_disjoint_timer_query = 'EXT_disjoint_timer_query';\nconst EXT_disjoint_timer_query_webgl2 = 'EXT_disjoint_timer_query_webgl2';\nconst EXT_texture_filter_anisotropic = 'EXT_texture_filter_anisotropic';\nconst WEBGL_debug_renderer_info = 'WEBGL_debug_renderer_info';\nconst GL_FRAGMENT_SHADER_DERIVATIVE_HINT = 0x8b8b;\nconst GL_DONT_CARE = 0x1100;\nconst GL_GPU_DISJOINT_EXT = 0x8fbb;\nconst GL_MAX_TEXTURE_MAX_ANISOTROPY_EXT = 0x84ff;\nconst GL_UNMASKED_VENDOR_WEBGL = 0x9245;\nconst GL_UNMASKED_RENDERER_WEBGL = 0x9246;\n\nconst getWebGL2ValueOrZero = gl => !isWebGL2(gl) ? 0 : undefined;\n\nconst WEBGL_PARAMETERS = {\n  [3074]: gl => !isWebGL2(gl) ? 36064 : undefined,\n  [GL_FRAGMENT_SHADER_DERIVATIVE_HINT]: gl => !isWebGL2(gl) ? GL_DONT_CARE : undefined,\n  [35977]: getWebGL2ValueOrZero,\n  [32937]: getWebGL2ValueOrZero,\n  [GL_GPU_DISJOINT_EXT]: (gl, getParameter) => {\n    const ext = isWebGL2(gl) ? gl.getExtension(EXT_disjoint_timer_query_webgl2) : gl.getExtension(EXT_disjoint_timer_query);\n    return ext && ext.GPU_DISJOINT_EXT ? getParameter(ext.GPU_DISJOINT_EXT) : 0;\n  },\n  [GL_UNMASKED_VENDOR_WEBGL]: (gl, getParameter) => {\n    const ext = gl.getExtension(WEBGL_debug_renderer_info);\n    return getParameter(ext && ext.UNMASKED_VENDOR_WEBGL || 7936);\n  },\n  [GL_UNMASKED_RENDERER_WEBGL]: (gl, getParameter) => {\n    const ext = gl.getExtension(WEBGL_debug_renderer_info);\n    return getParameter(ext && ext.UNMASKED_RENDERER_WEBGL || 7937);\n  },\n  [GL_MAX_TEXTURE_MAX_ANISOTROPY_EXT]: (gl, getParameter) => {\n    const ext = gl.luma.extensions[EXT_texture_filter_anisotropic];\n    return ext ? getParameter(ext.MAX_TEXTURE_MAX_ANISOTROPY_EXT) : 1.0;\n  },\n  [32883]: getWebGL2ValueOrZero,\n  [35071]: getWebGL2ValueOrZero,\n  [37447]: getWebGL2ValueOrZero,\n  [36063]: (gl, getParameter) => {\n    if (!isWebGL2(gl)) {\n      const ext = gl.getExtension(WEBGL_draw_buffers);\n      return ext ? getParameter(ext.MAX_COLOR_ATTACHMENTS_WEBGL) : 0;\n    }\n\n    return undefined;\n  },\n  [35379]: getWebGL2ValueOrZero,\n  [35374]: getWebGL2ValueOrZero,\n  [35377]: getWebGL2ValueOrZero,\n  [34852]: gl => {\n    if (!isWebGL2(gl)) {\n      const ext = gl.getExtension(WEBGL_draw_buffers);\n      return ext ? ext.MAX_DRAW_BUFFERS_WEBGL : 0;\n    }\n\n    return undefined;\n  },\n  [36203]: gl => gl.getExtension(OES_element_index) ? 2147483647 : 65535,\n  [33001]: gl => gl.getExtension(OES_element_index) ? 16777216 : 65535,\n  [33000]: gl => 16777216,\n  [37157]: getWebGL2ValueOrZero,\n  [35373]: getWebGL2ValueOrZero,\n  [35657]: getWebGL2ValueOrZero,\n  [36183]: getWebGL2ValueOrZero,\n  [37137]: getWebGL2ValueOrZero,\n  [34045]: getWebGL2ValueOrZero,\n  [35978]: getWebGL2ValueOrZero,\n  [35979]: getWebGL2ValueOrZero,\n  [35968]: getWebGL2ValueOrZero,\n  [35376]: getWebGL2ValueOrZero,\n  [35375]: getWebGL2ValueOrZero,\n  [35659]: getWebGL2ValueOrZero,\n  [37154]: getWebGL2ValueOrZero,\n  [35371]: getWebGL2ValueOrZero,\n  [35658]: getWebGL2ValueOrZero,\n  [35076]: getWebGL2ValueOrZero,\n  [35077]: getWebGL2ValueOrZero,\n  [35380]: getWebGL2ValueOrZero\n};\nexport function getParameterPolyfill(gl, originalGetParameter, pname) {\n  const limit = WEBGL_PARAMETERS[pname];\n  const value = typeof limit === 'function' ? limit(gl, originalGetParameter, pname) : limit;\n  const result = value !== undefined ? value : originalGetParameter(pname);\n  return result;\n}\n//# sourceMappingURL=get-parameter-polyfill.js.map","import { assert } from '../utils/assert';\nimport { isWebGL2 } from '../utils/webgl-checks';\nimport { getParameterPolyfill } from './get-parameter-polyfill';\nconst OES_vertex_array_object = 'OES_vertex_array_object';\nconst ANGLE_instanced_arrays = 'ANGLE_instanced_arrays';\nconst WEBGL_draw_buffers = 'WEBGL_draw_buffers';\nconst EXT_disjoint_timer_query = 'EXT_disjoint_timer_query';\nconst EXT_texture_filter_anisotropic = 'EXT_texture_filter_anisotropic';\nconst ERR_VAO_NOT_SUPPORTED = 'VertexArray requires WebGL2 or OES_vertex_array_object extension';\n\nfunction getExtensionData(gl, extension) {\n  return {\n    webgl2: isWebGL2(gl),\n    ext: gl.getExtension(extension)\n  };\n}\n\nexport const WEBGL2_CONTEXT_POLYFILLS = {\n  [OES_vertex_array_object]: {\n    meta: {\n      suffix: 'OES'\n    },\n    createVertexArray: () => {\n      assert(false, ERR_VAO_NOT_SUPPORTED);\n    },\n    deleteVertexArray: () => {},\n    bindVertexArray: () => {},\n    isVertexArray: () => false\n  },\n  [ANGLE_instanced_arrays]: {\n    meta: {\n      suffix: 'ANGLE'\n    },\n\n    vertexAttribDivisor(location, divisor) {\n      assert(divisor === 0, 'WebGL instanced rendering not supported');\n    },\n\n    drawElementsInstanced: () => {},\n    drawArraysInstanced: () => {}\n  },\n  [WEBGL_draw_buffers]: {\n    meta: {\n      suffix: 'WEBGL'\n    },\n    drawBuffers: () => {\n      assert(false);\n    }\n  },\n  [EXT_disjoint_timer_query]: {\n    meta: {\n      suffix: 'EXT'\n    },\n    createQuery: () => {\n      assert(false);\n    },\n    deleteQuery: () => {\n      assert(false);\n    },\n    beginQuery: () => {\n      assert(false);\n    },\n    endQuery: () => {},\n\n    getQuery(handle, pname) {\n      return this.getQueryObject(handle, pname);\n    },\n\n    getQueryParameter(handle, pname) {\n      return this.getQueryObject(handle, pname);\n    },\n\n    getQueryObject: () => {}\n  }\n};\nexport const WEBGL2_CONTEXT_OVERRIDES = {\n  readBuffer: (gl, originalFunc, attachment) => {\n    if (isWebGL2(gl)) {\n      originalFunc(attachment);\n    } else {}\n  },\n  getVertexAttrib: (gl, originalFunc, location, pname) => {\n    const {\n      webgl2,\n      ext\n    } = getExtensionData(gl, ANGLE_instanced_arrays);\n    let result;\n\n    switch (pname) {\n      case 35069:\n        result = !webgl2 ? false : undefined;\n        break;\n\n      case 35070:\n        result = !webgl2 && !ext ? 0 : undefined;\n        break;\n\n      default:\n    }\n\n    return result !== undefined ? result : originalFunc(location, pname);\n  },\n  getProgramParameter: (gl, originalFunc, program, pname) => {\n    if (!isWebGL2(gl)) {\n      switch (pname) {\n        case 35967:\n          return 35981;\n\n        case 35971:\n          return 0;\n\n        case 35382:\n          return 0;\n\n        default:\n      }\n    }\n\n    return originalFunc(program, pname);\n  },\n  getInternalformatParameter: (gl, originalFunc, target, format, pname) => {\n    if (!isWebGL2(gl)) {\n      switch (pname) {\n        case 32937:\n          return new Int32Array([0]);\n\n        default:\n      }\n    }\n\n    return gl.getInternalformatParameter(target, format, pname);\n  },\n\n  getTexParameter(gl, originalFunc, target, pname) {\n    switch (pname) {\n      case 34046:\n        const {\n          extensions\n        } = gl.luma;\n        const ext = extensions[EXT_texture_filter_anisotropic];\n        pname = ext && ext.TEXTURE_MAX_ANISOTROPY_EXT || 34046;\n        break;\n\n      default:\n    }\n\n    return originalFunc(target, pname);\n  },\n\n  getParameter: getParameterPolyfill,\n\n  hint(gl, originalFunc, pname, value) {\n    return originalFunc(pname, value);\n  }\n\n};\n//# sourceMappingURL=polyfill-table.js.map","import { polyfillVertexArrayObject } from './polyfill-vertex-array-object';\nimport { assert } from '../utils/assert';\nimport { WEBGL2_CONTEXT_POLYFILLS, WEBGL2_CONTEXT_OVERRIDES } from './polyfill-table';\nexport function polyfillContext(gl) {\n  gl.luma = gl.luma || {};\n  const {\n    luma\n  } = gl;\n\n  if (!luma.polyfilled) {\n    polyfillVertexArrayObject(gl);\n    initializeExtensions(gl);\n    installPolyfills(gl, WEBGL2_CONTEXT_POLYFILLS);\n    installOverrides(gl, {\n      target: luma,\n      target2: gl\n    });\n    luma.polyfilled = true;\n  }\n\n  return gl;\n}\nglobalThis.polyfillContext = polyfillContext;\n\nfunction initializeExtensions(gl) {\n  gl.luma.extensions = {};\n  const EXTENSIONS = gl.getSupportedExtensions() || [];\n\n  for (const extension of EXTENSIONS) {\n    gl.luma[extension] = gl.getExtension(extension);\n  }\n}\n\nfunction installOverrides(gl, _ref) {\n  let {\n    target,\n    target2\n  } = _ref;\n  Object.keys(WEBGL2_CONTEXT_OVERRIDES).forEach(key => {\n    if (typeof WEBGL2_CONTEXT_OVERRIDES[key] === 'function') {\n      const originalFunc = gl[key] ? gl[key].bind(gl) : () => {};\n      const polyfill = WEBGL2_CONTEXT_OVERRIDES[key].bind(null, gl, originalFunc);\n      target[key] = polyfill;\n      target2[key] = polyfill;\n    }\n  });\n}\n\nfunction installPolyfills(gl, polyfills) {\n  for (const extension of Object.getOwnPropertyNames(polyfills)) {\n    if (extension !== 'overrides') {\n      polyfillExtension(gl, {\n        extension,\n        target: gl.luma,\n        target2: gl\n      });\n    }\n  }\n}\n\nfunction polyfillExtension(gl, _ref2) {\n  let {\n    extension,\n    target,\n    target2\n  } = _ref2;\n  const defaults = WEBGL2_CONTEXT_POLYFILLS[extension];\n  assert(defaults);\n  const {\n    meta = {}\n  } = defaults;\n  const {\n    suffix = ''\n  } = meta;\n  const ext = gl.getExtension(extension);\n\n  for (const key of Object.keys(defaults)) {\n    const extKey = \"\".concat(key).concat(suffix);\n    let polyfill = null;\n\n    if (key === 'meta') {} else if (typeof gl[key] === 'function') {} else if (ext && typeof ext[extKey] === 'function') {\n      polyfill = function () {\n        return ext[extKey](...arguments);\n      };\n    } else if (typeof defaults[key] === 'function') {\n      polyfill = defaults[key].bind(target);\n    }\n\n    if (polyfill) {\n      target[key] = polyfill;\n      target2[key] = polyfill;\n    }\n  }\n}\n//# sourceMappingURL=polyfill-context.js.map","import { isWebGL2 } from '../utils/webgl-checks';\nexport const GL_PARAMETER_DEFAULTS = {\n  [3042]: false,\n  [32773]: new Float32Array([0, 0, 0, 0]),\n  [32777]: 32774,\n  [34877]: 32774,\n  [32969]: 1,\n  [32968]: 0,\n  [32971]: 1,\n  [32970]: 0,\n  [3106]: new Float32Array([0, 0, 0, 0]),\n  [3107]: [true, true, true, true],\n  [2884]: false,\n  [2885]: 1029,\n  [2929]: false,\n  [2931]: 1,\n  [2932]: 513,\n  [2928]: new Float32Array([0, 1]),\n  [2930]: true,\n  [3024]: true,\n  [36006]: null,\n  [2886]: 2305,\n  [33170]: 4352,\n  [2849]: 1,\n  [32823]: false,\n  [32824]: 0,\n  [10752]: 0,\n  [32938]: 1.0,\n  [32939]: false,\n  [3089]: false,\n  [3088]: new Int32Array([0, 0, 1024, 1024]),\n  [2960]: false,\n  [2961]: 0,\n  [2968]: 0xffffffff,\n  [36005]: 0xffffffff,\n  [2962]: 519,\n  [2967]: 0,\n  [2963]: 0xffffffff,\n  [34816]: 519,\n  [36003]: 0,\n  [36004]: 0xffffffff,\n  [2964]: 7680,\n  [2965]: 7680,\n  [2966]: 7680,\n  [34817]: 7680,\n  [34818]: 7680,\n  [34819]: 7680,\n  [2978]: [0, 0, 1024, 1024],\n  [3333]: 4,\n  [3317]: 4,\n  [37440]: false,\n  [37441]: false,\n  [37443]: 37444,\n  [35723]: 4352,\n  [36010]: null,\n  [35977]: false,\n  [3330]: 0,\n  [3332]: 0,\n  [3331]: 0,\n  [3314]: 0,\n  [32878]: 0,\n  [3316]: 0,\n  [3315]: 0,\n  [32877]: 0\n};\n\nconst enable = (gl, value, key) => value ? gl.enable(key) : gl.disable(key);\n\nconst hint = (gl, value, key) => gl.hint(key, value);\n\nconst pixelStorei = (gl, value, key) => gl.pixelStorei(key, value);\n\nconst drawFramebuffer = (gl, value) => {\n  const target = isWebGL2(gl) ? 36009 : 36160;\n  return gl.bindFramebuffer(target, value);\n};\n\nconst readFramebuffer = (gl, value) => {\n  return gl.bindFramebuffer(36008, value);\n};\n\nfunction isArray(array) {\n  return Array.isArray(array) || ArrayBuffer.isView(array);\n}\n\nexport const GL_PARAMETER_SETTERS = {\n  [3042]: enable,\n  [32773]: (gl, value) => gl.blendColor(...value),\n  [32777]: 'blendEquation',\n  [34877]: 'blendEquation',\n  [32969]: 'blendFunc',\n  [32968]: 'blendFunc',\n  [32971]: 'blendFunc',\n  [32970]: 'blendFunc',\n  [3106]: (gl, value) => gl.clearColor(...value),\n  [3107]: (gl, value) => gl.colorMask(...value),\n  [2884]: enable,\n  [2885]: (gl, value) => gl.cullFace(value),\n  [2929]: enable,\n  [2931]: (gl, value) => gl.clearDepth(value),\n  [2932]: (gl, value) => gl.depthFunc(value),\n  [2928]: (gl, value) => gl.depthRange(...value),\n  [2930]: (gl, value) => gl.depthMask(value),\n  [3024]: enable,\n  [35723]: hint,\n  [36006]: drawFramebuffer,\n  [2886]: (gl, value) => gl.frontFace(value),\n  [33170]: hint,\n  [2849]: (gl, value) => gl.lineWidth(value),\n  [32823]: enable,\n  [32824]: 'polygonOffset',\n  [10752]: 'polygonOffset',\n  [35977]: enable,\n  [32938]: 'sampleCoverage',\n  [32939]: 'sampleCoverage',\n  [3089]: enable,\n  [3088]: (gl, value) => gl.scissor(...value),\n  [2960]: enable,\n  [2961]: (gl, value) => gl.clearStencil(value),\n  [2968]: (gl, value) => gl.stencilMaskSeparate(1028, value),\n  [36005]: (gl, value) => gl.stencilMaskSeparate(1029, value),\n  [2962]: 'stencilFuncFront',\n  [2967]: 'stencilFuncFront',\n  [2963]: 'stencilFuncFront',\n  [34816]: 'stencilFuncBack',\n  [36003]: 'stencilFuncBack',\n  [36004]: 'stencilFuncBack',\n  [2964]: 'stencilOpFront',\n  [2965]: 'stencilOpFront',\n  [2966]: 'stencilOpFront',\n  [34817]: 'stencilOpBack',\n  [34818]: 'stencilOpBack',\n  [34819]: 'stencilOpBack',\n  [2978]: (gl, value) => gl.viewport(...value),\n  [3333]: pixelStorei,\n  [3317]: pixelStorei,\n  [37440]: pixelStorei,\n  [37441]: pixelStorei,\n  [37443]: pixelStorei,\n  [3330]: pixelStorei,\n  [3332]: pixelStorei,\n  [3331]: pixelStorei,\n  [36010]: readFramebuffer,\n  [3314]: pixelStorei,\n  [32878]: pixelStorei,\n  [3316]: pixelStorei,\n  [3315]: pixelStorei,\n  [32877]: pixelStorei,\n  framebuffer: (gl, framebuffer) => {\n    const handle = framebuffer && 'handle' in framebuffer ? framebuffer.handle : framebuffer;\n    return gl.bindFramebuffer(36160, handle);\n  },\n  blend: (gl, value) => value ? gl.enable(3042) : gl.disable(3042),\n  blendColor: (gl, value) => gl.blendColor(...value),\n  blendEquation: (gl, args) => {\n    args = isArray(args) ? args : [args, args];\n    gl.blendEquationSeparate(...args);\n  },\n  blendFunc: (gl, args) => {\n    args = isArray(args) && args.length === 2 ? [...args, ...args] : args;\n    gl.blendFuncSeparate(...args);\n  },\n  clearColor: (gl, value) => gl.clearColor(...value),\n  clearDepth: (gl, value) => gl.clearDepth(value),\n  clearStencil: (gl, value) => gl.clearStencil(value),\n  colorMask: (gl, value) => gl.colorMask(...value),\n  cull: (gl, value) => value ? gl.enable(2884) : gl.disable(2884),\n  cullFace: (gl, value) => gl.cullFace(value),\n  depthTest: (gl, value) => value ? gl.enable(2929) : gl.disable(2929),\n  depthFunc: (gl, value) => gl.depthFunc(value),\n  depthMask: (gl, value) => gl.depthMask(value),\n  depthRange: (gl, value) => gl.depthRange(...value),\n  dither: (gl, value) => value ? gl.enable(3024) : gl.disable(3024),\n  derivativeHint: (gl, value) => {\n    gl.hint(35723, value);\n  },\n  frontFace: (gl, value) => gl.frontFace(value),\n  mipmapHint: (gl, value) => gl.hint(33170, value),\n  lineWidth: (gl, value) => gl.lineWidth(value),\n  polygonOffsetFill: (gl, value) => value ? gl.enable(32823) : gl.disable(32823),\n  polygonOffset: (gl, value) => gl.polygonOffset(...value),\n  sampleCoverage: (gl, value) => gl.sampleCoverage(...value),\n  scissorTest: (gl, value) => value ? gl.enable(3089) : gl.disable(3089),\n  scissor: (gl, value) => gl.scissor(...value),\n  stencilTest: (gl, value) => value ? gl.enable(2960) : gl.disable(2960),\n  stencilMask: (gl, value) => {\n    value = isArray(value) ? value : [value, value];\n    const [mask, backMask] = value;\n    gl.stencilMaskSeparate(1028, mask);\n    gl.stencilMaskSeparate(1029, backMask);\n  },\n  stencilFunc: (gl, args) => {\n    args = isArray(args) && args.length === 3 ? [...args, ...args] : args;\n    const [func, ref, mask, backFunc, backRef, backMask] = args;\n    gl.stencilFuncSeparate(1028, func, ref, mask);\n    gl.stencilFuncSeparate(1029, backFunc, backRef, backMask);\n  },\n  stencilOp: (gl, args) => {\n    args = isArray(args) && args.length === 3 ? [...args, ...args] : args;\n    const [sfail, dpfail, dppass, backSfail, backDpfail, backDppass] = args;\n    gl.stencilOpSeparate(1028, sfail, dpfail, dppass);\n    gl.stencilOpSeparate(1029, backSfail, backDpfail, backDppass);\n  },\n  viewport: (gl, value) => gl.viewport(...value)\n};\n\nfunction getValue(glEnum, values, cache) {\n  return values[glEnum] !== undefined ? values[glEnum] : cache[glEnum];\n}\n\nexport const GL_COMPOSITE_PARAMETER_SETTERS = {\n  blendEquation: (gl, values, cache) => gl.blendEquationSeparate(getValue(32777, values, cache), getValue(34877, values, cache)),\n  blendFunc: (gl, values, cache) => gl.blendFuncSeparate(getValue(32969, values, cache), getValue(32968, values, cache), getValue(32971, values, cache), getValue(32970, values, cache)),\n  polygonOffset: (gl, values, cache) => gl.polygonOffset(getValue(32824, values, cache), getValue(10752, values, cache)),\n  sampleCoverage: (gl, values, cache) => gl.sampleCoverage(getValue(32938, values, cache), getValue(32939, values, cache)),\n  stencilFuncFront: (gl, values, cache) => gl.stencilFuncSeparate(1028, getValue(2962, values, cache), getValue(2967, values, cache), getValue(2963, values, cache)),\n  stencilFuncBack: (gl, values, cache) => gl.stencilFuncSeparate(1029, getValue(34816, values, cache), getValue(36003, values, cache), getValue(36004, values, cache)),\n  stencilOpFront: (gl, values, cache) => gl.stencilOpSeparate(1028, getValue(2964, values, cache), getValue(2965, values, cache), getValue(2966, values, cache)),\n  stencilOpBack: (gl, values, cache) => gl.stencilOpSeparate(1029, getValue(34817, values, cache), getValue(34818, values, cache), getValue(34819, values, cache))\n};\nexport const GL_HOOKED_SETTERS = {\n  enable: (update, capability) => update({\n    [capability]: true\n  }),\n  disable: (update, capability) => update({\n    [capability]: false\n  }),\n  pixelStorei: (update, pname, value) => update({\n    [pname]: value\n  }),\n  hint: (update, pname, hint) => update({\n    [pname]: hint\n  }),\n  bindFramebuffer: (update, target, framebuffer) => {\n    switch (target) {\n      case 36160:\n        return update({\n          [36006]: framebuffer,\n          [36010]: framebuffer\n        });\n\n      case 36009:\n        return update({\n          [36006]: framebuffer\n        });\n\n      case 36008:\n        return update({\n          [36010]: framebuffer\n        });\n\n      default:\n        return null;\n    }\n  },\n  blendColor: (update, r, g, b, a) => update({\n    [32773]: new Float32Array([r, g, b, a])\n  }),\n  blendEquation: (update, mode) => update({\n    [32777]: mode,\n    [34877]: mode\n  }),\n  blendEquationSeparate: (update, modeRGB, modeAlpha) => update({\n    [32777]: modeRGB,\n    [34877]: modeAlpha\n  }),\n  blendFunc: (update, src, dst) => update({\n    [32969]: src,\n    [32968]: dst,\n    [32971]: src,\n    [32970]: dst\n  }),\n  blendFuncSeparate: (update, srcRGB, dstRGB, srcAlpha, dstAlpha) => update({\n    [32969]: srcRGB,\n    [32968]: dstRGB,\n    [32971]: srcAlpha,\n    [32970]: dstAlpha\n  }),\n  clearColor: (update, r, g, b, a) => update({\n    [3106]: new Float32Array([r, g, b, a])\n  }),\n  clearDepth: (update, depth) => update({\n    [2931]: depth\n  }),\n  clearStencil: (update, s) => update({\n    [2961]: s\n  }),\n  colorMask: (update, r, g, b, a) => update({\n    [3107]: [r, g, b, a]\n  }),\n  cullFace: (update, mode) => update({\n    [2885]: mode\n  }),\n  depthFunc: (update, func) => update({\n    [2932]: func\n  }),\n  depthRange: (update, zNear, zFar) => update({\n    [2928]: new Float32Array([zNear, zFar])\n  }),\n  depthMask: (update, mask) => update({\n    [2930]: mask\n  }),\n  frontFace: (update, face) => update({\n    [2886]: face\n  }),\n  lineWidth: (update, width) => update({\n    [2849]: width\n  }),\n  polygonOffset: (update, factor, units) => update({\n    [32824]: factor,\n    [10752]: units\n  }),\n  sampleCoverage: (update, value, invert) => update({\n    [32938]: value,\n    [32939]: invert\n  }),\n  scissor: (update, x, y, width, height) => update({\n    [3088]: new Int32Array([x, y, width, height])\n  }),\n  stencilMask: (update, mask) => update({\n    [2968]: mask,\n    [36005]: mask\n  }),\n  stencilMaskSeparate: (update, face, mask) => update({\n    [face === 1028 ? 2968 : 36005]: mask\n  }),\n  stencilFunc: (update, func, ref, mask) => update({\n    [2962]: func,\n    [2967]: ref,\n    [2963]: mask,\n    [34816]: func,\n    [36003]: ref,\n    [36004]: mask\n  }),\n  stencilFuncSeparate: (update, face, func, ref, mask) => update({\n    [face === 1028 ? 2962 : 34816]: func,\n    [face === 1028 ? 2967 : 36003]: ref,\n    [face === 1028 ? 2963 : 36004]: mask\n  }),\n  stencilOp: (update, fail, zfail, zpass) => update({\n    [2964]: fail,\n    [2965]: zfail,\n    [2966]: zpass,\n    [34817]: fail,\n    [34818]: zfail,\n    [34819]: zpass\n  }),\n  stencilOpSeparate: (update, face, fail, zfail, zpass) => update({\n    [face === 1028 ? 2964 : 34817]: fail,\n    [face === 1028 ? 2965 : 34818]: zfail,\n    [face === 1028 ? 2966 : 34819]: zpass\n  }),\n  viewport: (update, x, y, width, height) => update({\n    [2978]: [x, y, width, height]\n  })\n};\n\nconst isEnabled = (gl, key) => gl.isEnabled(key);\n\nexport const GL_PARAMETER_GETTERS = {\n  [3042]: isEnabled,\n  [2884]: isEnabled,\n  [2929]: isEnabled,\n  [3024]: isEnabled,\n  [32823]: isEnabled,\n  [32926]: isEnabled,\n  [32928]: isEnabled,\n  [3089]: isEnabled,\n  [2960]: isEnabled,\n  [35977]: isEnabled\n};\n//# sourceMappingURL=webgl-parameter-tables.js.map","export function isObjectEmpty(object) {\n  for (const key in object) {\n    return false;\n  }\n\n  return true;\n}\nexport function deepArrayEqual(x, y) {\n  if (x === y) {\n    return true;\n  }\n\n  const isArrayX = Array.isArray(x) || ArrayBuffer.isView(x);\n  const isArrayY = Array.isArray(y) || ArrayBuffer.isView(y);\n\n  if (isArrayX && isArrayY && x.length === y.length) {\n    for (let i = 0; i < x.length; ++i) {\n      if (x[i] !== y[i]) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  return false;\n}\n//# sourceMappingURL=utils.js.map","import { GL_PARAMETER_DEFAULTS, GL_HOOKED_SETTERS } from './webgl-parameter-tables';\nimport { setParameters, getParameters } from './unified-parameter-api';\nimport { assert } from '../utils/assert';\nimport { deepArrayEqual } from '../utils/utils';\n\nfunction installGetterOverride(gl, functionName) {\n  const originalGetterFunc = gl[functionName].bind(gl);\n\n  gl[functionName] = function get() {\n    const pname = arguments.length <= 0 ? undefined : arguments[0];\n\n    if (!(pname in gl.state.cache)) {\n      return originalGetterFunc(...arguments);\n    }\n\n    return gl.state.enable ? gl.state.cache[pname] : originalGetterFunc(...arguments);\n  };\n\n  Object.defineProperty(gl[functionName], 'name', {\n    value: \"\".concat(functionName, \"-from-cache\"),\n    configurable: false\n  });\n}\n\nfunction installSetterSpy(gl, functionName, setter) {\n  const originalSetterFunc = gl[functionName].bind(gl);\n\n  gl[functionName] = function set() {\n    for (var _len = arguments.length, params = new Array(_len), _key = 0; _key < _len; _key++) {\n      params[_key] = arguments[_key];\n    }\n\n    const {\n      valueChanged,\n      oldValue\n    } = setter(gl.state._updateCache, ...params);\n\n    if (valueChanged) {\n      originalSetterFunc(...params);\n    }\n\n    return oldValue;\n  };\n\n  Object.defineProperty(gl[functionName], 'name', {\n    value: \"\".concat(functionName, \"-to-cache\"),\n    configurable: false\n  });\n}\n\nfunction installProgramSpy(gl) {\n  const originalUseProgram = gl.useProgram.bind(gl);\n\n  gl.useProgram = function useProgramLuma(handle) {\n    if (gl.state.program !== handle) {\n      originalUseProgram(handle);\n      gl.state.program = handle;\n    }\n  };\n}\n\nclass GLState {\n  constructor(gl) {\n    let {\n      copyState = false,\n      log = () => {}\n    } = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    this.gl = gl;\n    this.program = null;\n    this.stateStack = [];\n    this.enable = true;\n    this.cache = copyState ? getParameters(gl) : Object.assign({}, GL_PARAMETER_DEFAULTS);\n    this.log = log;\n    this._updateCache = this._updateCache.bind(this);\n    Object.seal(this);\n  }\n\n  push() {\n    let values = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    this.stateStack.push({});\n  }\n\n  pop() {\n    assert(this.stateStack.length > 0);\n    const oldValues = this.stateStack[this.stateStack.length - 1];\n    setParameters(this.gl, oldValues);\n    this.stateStack.pop();\n  }\n\n  _updateCache(values) {\n    let valueChanged = false;\n    let oldValue;\n    const oldValues = this.stateStack.length > 0 && this.stateStack[this.stateStack.length - 1];\n\n    for (const key in values) {\n      assert(key !== undefined);\n      const value = values[key];\n      const cached = this.cache[key];\n\n      if (!deepArrayEqual(value, cached)) {\n        valueChanged = true;\n        oldValue = cached;\n\n        if (oldValues && !(key in oldValues)) {\n          oldValues[key] = cached;\n        }\n\n        this.cache[key] = value;\n      }\n    }\n\n    return {\n      valueChanged,\n      oldValue\n    };\n  }\n\n}\n\nexport function trackContextState(gl) {\n  let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  const {\n    enable = true,\n    copyState\n  } = options;\n  assert(copyState !== undefined);\n\n  if (!gl.state) {\n    const {\n      polyfillContext\n    } = globalThis;\n\n    if (polyfillContext) {\n      polyfillContext(gl);\n    }\n\n    gl.state = new GLState(gl, {\n      copyState\n    });\n    installProgramSpy(gl);\n\n    for (const key in GL_HOOKED_SETTERS) {\n      const setter = GL_HOOKED_SETTERS[key];\n      installSetterSpy(gl, key, setter);\n    }\n\n    installGetterOverride(gl, 'getParameter');\n    installGetterOverride(gl, 'isEnabled');\n  }\n\n  gl.state.enable = enable;\n  return gl;\n}\nexport function pushContextState(gl) {\n  if (!gl.state) {\n    trackContextState(gl, {\n      copyState: false\n    });\n  }\n\n  gl.state.push();\n}\nexport function popContextState(gl) {\n  assert(gl.state);\n  gl.state.pop();\n}\n//# sourceMappingURL=track-context-state.js.map","import { GL_PARAMETER_DEFAULTS, GL_PARAMETER_SETTERS, GL_COMPOSITE_PARAMETER_SETTERS, GL_PARAMETER_GETTERS } from './webgl-parameter-tables';\nimport { pushContextState, popContextState } from './track-context-state';\nimport { assert } from '../utils/assert';\nimport { isWebGL } from '../utils/webgl-checks';\nimport { isObjectEmpty } from '../utils/utils';\nexport function setParameters(gl, values) {\n  assert(isWebGL(gl), 'setParameters requires a WebGL context');\n\n  if (isObjectEmpty(values)) {\n    return;\n  }\n\n  const compositeSetters = {};\n\n  for (const key in values) {\n    const glConstant = Number(key);\n    const setter = GL_PARAMETER_SETTERS[key];\n\n    if (setter) {\n      if (typeof setter === 'string') {\n        compositeSetters[setter] = true;\n      } else {\n        setter(gl, values[key], glConstant);\n      }\n    }\n  }\n\n  const cache = gl.state && gl.state.cache;\n\n  if (cache) {\n    for (const key in compositeSetters) {\n      const compositeSetter = GL_COMPOSITE_PARAMETER_SETTERS[key];\n      compositeSetter(gl, values, cache);\n    }\n  }\n}\nexport function getParameters(gl, parameters) {\n  parameters = parameters || GL_PARAMETER_DEFAULTS;\n\n  if (typeof parameters === 'number') {\n    const key = parameters;\n    const getter = GL_PARAMETER_GETTERS[key];\n    return getter ? getter(gl, key) : gl.getParameter(key);\n  }\n\n  const parameterKeys = Array.isArray(parameters) ? parameters : Object.keys(parameters);\n  const state = {};\n\n  for (const key of parameterKeys) {\n    const getter = GL_PARAMETER_GETTERS[key];\n    state[key] = getter ? getter(gl, Number(key)) : gl.getParameter(Number(key));\n  }\n\n  return state;\n}\nexport function resetParameters(gl) {\n  setParameters(gl, GL_PARAMETER_DEFAULTS);\n}\nexport function withParameters(gl, parameters, func) {\n  if (isObjectEmpty(parameters)) {\n    return func(gl);\n  }\n\n  const {\n    nocatch = true\n  } = parameters;\n  pushContextState(gl);\n  setParameters(gl, parameters);\n  let value;\n\n  if (nocatch) {\n    value = func(gl);\n    popContextState(gl);\n  } else {\n    try {\n      value = func(gl);\n    } finally {\n      popContextState(gl);\n    }\n  }\n\n  return value;\n}\n//# sourceMappingURL=unified-parameter-api.js.map","export function cssToDeviceRatio(gl) {\n  const {\n    luma\n  } = gl;\n\n  if (gl.canvas && luma) {\n    const cachedSize = luma.canvasSizeInfo;\n    const clientWidth = 'clientWidth' in cachedSize ? cachedSize.clientWidth : gl.canvas.clientWidth;\n    return clientWidth ? gl.drawingBufferWidth / clientWidth : 1;\n  }\n\n  return 1;\n}\nexport function cssToDevicePixels(gl, cssPixel) {\n  let yInvert = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n  const ratio = cssToDeviceRatio(gl);\n  const width = gl.drawingBufferWidth;\n  const height = gl.drawingBufferHeight;\n  return scalePixels(cssPixel, ratio, width, height, yInvert);\n}\nexport function getDevicePixelRatio(useDevicePixels) {\n  const windowRatio = typeof window === 'undefined' ? 1 : window.devicePixelRatio || 1;\n\n  if (Number.isFinite(useDevicePixels)) {\n    return useDevicePixels <= 0 ? 1 : useDevicePixels;\n  }\n\n  return useDevicePixels ? windowRatio : 1;\n}\n\nfunction scalePixels(pixel, ratio, width, height, yInvert) {\n  const x = scaleX(pixel[0], ratio, width);\n  let y = scaleY(pixel[1], ratio, height, yInvert);\n  let t = scaleX(pixel[0] + 1, ratio, width);\n  const xHigh = t === width - 1 ? t : t - 1;\n  t = scaleY(pixel[1] + 1, ratio, height, yInvert);\n  let yHigh;\n\n  if (yInvert) {\n    t = t === 0 ? t : t + 1;\n    yHigh = y;\n    y = t;\n  } else {\n    yHigh = t === height - 1 ? t : t - 1;\n  }\n\n  return {\n    x,\n    y,\n    width: Math.max(xHigh - x + 1, 1),\n    height: Math.max(yHigh - y + 1, 1)\n  };\n}\n\nfunction scaleX(x, ratio, width) {\n  const r = Math.min(Math.round(x * ratio), width - 1);\n  return r;\n}\n\nfunction scaleY(y, ratio, height, yInvert) {\n  return yInvert ? Math.max(0, height - 1 - Math.round(y * ratio)) : Math.min(Math.round(y * ratio), height - 1);\n}\n//# sourceMappingURL=device-pixels.js.map","import { isBrowser as getIsBrowser } from '@probe.gl/env';\nimport { trackContextState } from '../state-tracker/track-context-state';\nimport { log } from '../utils/log';\nimport { assert } from '../utils/assert';\nimport { getDevicePixelRatio } from '../utils/device-pixels';\nimport { isWebGL2 } from '../utils/webgl-checks';\nconst isBrowser = getIsBrowser();\nconst isPage = isBrowser && typeof document !== 'undefined';\nconst CONTEXT_DEFAULTS = {\n  webgl2: true,\n  webgl1: true,\n  throwOnError: true,\n  manageState: true,\n  canvas: null,\n  debug: false,\n  width: 800,\n  height: 600\n};\nexport function createGLContext() {\n  let options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  assert(isBrowser, \"createGLContext only available in the browser.\\nCreate your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils\");\n  options = Object.assign({}, CONTEXT_DEFAULTS, options);\n  const {\n    width,\n    height\n  } = options;\n\n  function onError(message) {\n    if (options.throwOnError) {\n      throw new Error(message);\n    }\n\n    console.error(message);\n    return null;\n  }\n\n  options.onError = onError;\n  let gl;\n  const {\n    canvas\n  } = options;\n  const targetCanvas = getCanvas({\n    canvas,\n    width,\n    height,\n    onError\n  });\n  gl = createBrowserContext(targetCanvas, options);\n\n  if (!gl) {\n    return null;\n  }\n\n  gl = instrumentGLContext(gl, options);\n  logInfo(gl);\n  return gl;\n}\nexport function instrumentGLContext(gl) {\n  let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n  if (!gl || gl._instrumented) {\n    return gl;\n  }\n\n  gl._version = gl._version || getVersion(gl);\n  gl.luma = gl.luma || {};\n  gl.luma.canvasSizeInfo = gl.luma.canvasSizeInfo || {};\n  options = Object.assign({}, CONTEXT_DEFAULTS, options);\n  const {\n    manageState,\n    debug\n  } = options;\n\n  if (manageState) {\n    trackContextState(gl, {\n      copyState: false,\n      log: function () {\n        for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n          args[_key] = arguments[_key];\n        }\n\n        return log.log(1, ...args)();\n      }\n    });\n  }\n\n  if (isBrowser && debug) {\n    if (!globalThis.makeDebugContext) {\n      log.warn('WebGL debug mode not activated. import \"@luma.gl/debug\" to enable.')();\n    } else {\n      gl = globalThis.makeDebugContext(gl, options);\n      log.level = Math.max(log.level, 1);\n    }\n  }\n\n  gl._instrumented = true;\n  return gl;\n}\nexport function getContextDebugInfo(gl) {\n  const vendorMasked = gl.getParameter(7936);\n  const rendererMasked = gl.getParameter(7937);\n  const ext = gl.getExtension('WEBGL_debug_renderer_info');\n  const vendorUnmasked = ext && gl.getParameter(ext.UNMASKED_VENDOR_WEBGL || 7936);\n  const rendererUnmasked = ext && gl.getParameter(ext.UNMASKED_RENDERER_WEBGL || 7937);\n  return {\n    vendor: vendorUnmasked || vendorMasked,\n    renderer: rendererUnmasked || rendererMasked,\n    vendorMasked,\n    rendererMasked,\n    version: gl.getParameter(7938),\n    shadingLanguageVersion: gl.getParameter(35724)\n  };\n}\nexport function resizeGLContext(gl) {\n  let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n  if (gl.canvas) {\n    const devicePixelRatio = getDevicePixelRatio(options.useDevicePixels);\n    setDevicePixelRatio(gl, devicePixelRatio, options);\n    return;\n  }\n\n  const ext = gl.getExtension('STACKGL_resize_drawingbuffer');\n\n  if (ext && \"width\" in options && \"height\" in options) {\n    ext.resize(options.width, options.height);\n  }\n}\n\nfunction createBrowserContext(canvas, options) {\n  const {\n    onError\n  } = options;\n  let errorMessage = null;\n\n  const onCreateError = error => errorMessage = error.statusMessage || errorMessage;\n\n  canvas.addEventListener('webglcontextcreationerror', onCreateError, false);\n  const {\n    webgl1 = true,\n    webgl2 = true\n  } = options;\n  let gl = null;\n\n  if (webgl2) {\n    gl = gl || canvas.getContext('webgl2', options);\n    gl = gl || canvas.getContext('experimental-webgl2', options);\n  }\n\n  if (webgl1) {\n    gl = gl || canvas.getContext('webgl', options);\n    gl = gl || canvas.getContext('experimental-webgl', options);\n  }\n\n  canvas.removeEventListener('webglcontextcreationerror', onCreateError, false);\n\n  if (!gl) {\n    return onError(\"Failed to create \".concat(webgl2 && !webgl1 ? 'WebGL2' : 'WebGL', \" context: \").concat(errorMessage || 'Unknown error'));\n  }\n\n  if (options.onContextLost) {\n    canvas.addEventListener('webglcontextlost', options.onContextLost, false);\n  }\n\n  if (options.onContextRestored) {\n    canvas.addEventListener('webglcontextrestored', options.onContextRestored, false);\n  }\n\n  return gl;\n}\n\nfunction getCanvas(_ref) {\n  let {\n    canvas,\n    width = 800,\n    height = 600,\n    onError\n  } = _ref;\n  let targetCanvas;\n\n  if (typeof canvas === 'string') {\n    const isPageLoaded = isPage && document.readyState === 'complete';\n\n    if (!isPageLoaded) {\n      onError(\"createGLContext called on canvas '\".concat(canvas, \"' before page was loaded\"));\n    }\n\n    targetCanvas = document.getElementById(canvas);\n  } else if (canvas) {\n    targetCanvas = canvas;\n  } else {\n    targetCanvas = document.createElement('canvas');\n    targetCanvas.id = 'lumagl-canvas';\n    targetCanvas.style.width = Number.isFinite(width) ? \"\".concat(width, \"px\") : '100%';\n    targetCanvas.style.height = Number.isFinite(height) ? \"\".concat(height, \"px\") : '100%';\n    document.body.insertBefore(targetCanvas, document.body.firstChild);\n  }\n\n  return targetCanvas;\n}\n\nfunction logInfo(gl) {\n  const webGL = isWebGL2(gl) ? 'WebGL2' : 'WebGL1';\n  const info = getContextDebugInfo(gl);\n  const driver = info ? \"(\".concat(info.vendor, \",\").concat(info.renderer, \")\") : '';\n  const debug = gl.debug ? ' debug' : '';\n  log.info(1, \"\".concat(webGL).concat(debug, \" context \").concat(driver))();\n}\n\nfunction getVersion(gl) {\n  if (typeof WebGL2RenderingContext !== 'undefined' && gl instanceof WebGL2RenderingContext) {\n    return 2;\n  }\n\n  return 1;\n}\n\nfunction setDevicePixelRatio(gl, devicePixelRatio, options) {\n  let clientWidth = 'width' in options ? options.width : gl.canvas.clientWidth;\n  let clientHeight = 'height' in options ? options.height : gl.canvas.clientHeight;\n\n  if (!clientWidth || !clientHeight) {\n    log.log(1, 'Canvas clientWidth/clientHeight is 0')();\n    devicePixelRatio = 1;\n    clientWidth = gl.canvas.width || 1;\n    clientHeight = gl.canvas.height || 1;\n  }\n\n  gl.luma = gl.luma || {};\n  gl.luma.canvasSizeInfo = gl.luma.canvasSizeInfo || {};\n  const cachedSize = gl.luma.canvasSizeInfo;\n\n  if (cachedSize.clientWidth !== clientWidth || cachedSize.clientHeight !== clientHeight || cachedSize.devicePixelRatio !== devicePixelRatio) {\n    let clampedPixelRatio = devicePixelRatio;\n    const canvasWidth = Math.floor(clientWidth * clampedPixelRatio);\n    const canvasHeight = Math.floor(clientHeight * clampedPixelRatio);\n    gl.canvas.width = canvasWidth;\n    gl.canvas.height = canvasHeight;\n\n    if (gl.drawingBufferWidth !== canvasWidth || gl.drawingBufferHeight !== canvasHeight) {\n      log.warn(\"Device pixel ratio clamped\")();\n      clampedPixelRatio = Math.min(gl.drawingBufferWidth / clientWidth, gl.drawingBufferHeight / clientHeight);\n      gl.canvas.width = Math.floor(clientWidth * clampedPixelRatio);\n      gl.canvas.height = Math.floor(clientHeight * clampedPixelRatio);\n    }\n\n    Object.assign(gl.luma.canvasSizeInfo, {\n      clientWidth,\n      clientHeight,\n      devicePixelRatio\n    });\n  }\n}\n//# sourceMappingURL=context.js.map","export default function getHiResTimestamp() {\n  let timestamp;\n\n  if (typeof window !== 'undefined' && window.performance) {\n    timestamp = window.performance.now();\n  } else if (typeof process !== 'undefined' && process.hrtime) {\n    const timeParts = process.hrtime();\n    timestamp = timeParts[0] * 1000 + timeParts[1] / 1e6;\n  } else {\n    timestamp = Date.now();\n  }\n\n  return timestamp;\n}\n//# sourceMappingURL=hi-res-timestamp.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport getHiResTimestamp from '../utils/hi-res-timestamp';\nexport default class Stat {\n  constructor(name, type) {\n    _defineProperty(this, \"name\", void 0);\n\n    _defineProperty(this, \"type\", void 0);\n\n    _defineProperty(this, \"sampleSize\", 1);\n\n    _defineProperty(this, \"time\", void 0);\n\n    _defineProperty(this, \"count\", void 0);\n\n    _defineProperty(this, \"samples\", void 0);\n\n    _defineProperty(this, \"lastTiming\", void 0);\n\n    _defineProperty(this, \"lastSampleTime\", void 0);\n\n    _defineProperty(this, \"lastSampleCount\", void 0);\n\n    _defineProperty(this, \"_count\", 0);\n\n    _defineProperty(this, \"_time\", 0);\n\n    _defineProperty(this, \"_samples\", 0);\n\n    _defineProperty(this, \"_startTime\", 0);\n\n    _defineProperty(this, \"_timerPending\", false);\n\n    this.name = name;\n    this.type = type;\n    this.reset();\n  }\n\n  setSampleSize(samples) {\n    this.sampleSize = samples;\n    return this;\n  }\n\n  incrementCount() {\n    this.addCount(1);\n    return this;\n  }\n\n  decrementCount() {\n    this.subtractCount(1);\n    return this;\n  }\n\n  addCount(value) {\n    this._count += value;\n    this._samples++;\n\n    this._checkSampling();\n\n    return this;\n  }\n\n  subtractCount(value) {\n    this._count -= value;\n    this._samples++;\n\n    this._checkSampling();\n\n    return this;\n  }\n\n  addTime(time) {\n    this._time += time;\n    this.lastTiming = time;\n    this._samples++;\n\n    this._checkSampling();\n\n    return this;\n  }\n\n  timeStart() {\n    this._startTime = getHiResTimestamp();\n    this._timerPending = true;\n    return this;\n  }\n\n  timeEnd() {\n    if (!this._timerPending) {\n      return this;\n    }\n\n    this.addTime(getHiResTimestamp() - this._startTime);\n    this._timerPending = false;\n\n    this._checkSampling();\n\n    return this;\n  }\n\n  getSampleAverageCount() {\n    return this.sampleSize > 0 ? this.lastSampleCount / this.sampleSize : 0;\n  }\n\n  getSampleAverageTime() {\n    return this.sampleSize > 0 ? this.lastSampleTime / this.sampleSize : 0;\n  }\n\n  getSampleHz() {\n    return this.lastSampleTime > 0 ? this.sampleSize / (this.lastSampleTime / 1000) : 0;\n  }\n\n  getAverageCount() {\n    return this.samples > 0 ? this.count / this.samples : 0;\n  }\n\n  getAverageTime() {\n    return this.samples > 0 ? this.time / this.samples : 0;\n  }\n\n  getHz() {\n    return this.time > 0 ? this.samples / (this.time / 1000) : 0;\n  }\n\n  reset() {\n    this.time = 0;\n    this.count = 0;\n    this.samples = 0;\n    this.lastTiming = 0;\n    this.lastSampleTime = 0;\n    this.lastSampleCount = 0;\n    this._count = 0;\n    this._time = 0;\n    this._samples = 0;\n    this._startTime = 0;\n    this._timerPending = false;\n    return this;\n  }\n\n  _checkSampling() {\n    if (this._samples === this.sampleSize) {\n      this.lastSampleTime = this._time;\n      this.lastSampleCount = this._count;\n      this.count += this._count;\n      this.time += this._time;\n      this.samples += this._samples;\n      this._time = 0;\n      this._count = 0;\n      this._samples = 0;\n    }\n  }\n\n}\n//# sourceMappingURL=stat.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport Stat from './stat';\nexport default class Stats {\n  constructor(options) {\n    _defineProperty(this, \"id\", void 0);\n\n    _defineProperty(this, \"stats\", {});\n\n    this.id = options.id;\n    this.stats = {};\n\n    this._initializeStats(options.stats);\n\n    Object.seal(this);\n  }\n\n  get(name) {\n    let type = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'count';\n    return this._getOrCreate({\n      name,\n      type\n    });\n  }\n\n  get size() {\n    return Object.keys(this.stats).length;\n  }\n\n  reset() {\n    for (const key in this.stats) {\n      this.stats[key].reset();\n    }\n\n    return this;\n  }\n\n  forEach(fn) {\n    for (const key in this.stats) {\n      fn(this.stats[key]);\n    }\n  }\n\n  getTable() {\n    const table = {};\n    this.forEach(stat => {\n      table[stat.name] = {\n        time: stat.time || 0,\n        count: stat.count || 0,\n        average: stat.getAverageTime() || 0,\n        hz: stat.getHz() || 0\n      };\n    });\n    return table;\n  }\n\n  _initializeStats() {\n    let stats = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n    stats.forEach(stat => this._getOrCreate(stat));\n  }\n\n  _getOrCreate(stat) {\n    if (!stat || !stat.name) {\n      return null;\n    }\n\n    const {\n      name,\n      type\n    } = stat;\n\n    if (!this.stats[name]) {\n      if (stat instanceof Stat) {\n        this.stats[name] = stat;\n      } else {\n        this.stats[name] = new Stat(name, type);\n      }\n    }\n\n    return this.stats[name];\n  }\n\n}\n//# sourceMappingURL=stats.js.map","import { log } from '@luma.gl/gltools';\nimport { Stats } from '@probe.gl/stats';\nimport { isBrowser } from '@probe.gl/env';\nconst VERSION = typeof \"8.5.21\" !== 'undefined' ? \"8.5.21\" : 'untranspiled source';\nconst STARTUP_MESSAGE = 'set luma.log.level=1 (or higher) to trace rendering';\nexport class StatsManager {\n  constructor() {\n    this.stats = new Map();\n  }\n\n  get(name) {\n    if (!this.stats.has(name)) {\n      this.stats.set(name, new Stats({\n        id: name\n      }));\n    }\n\n    return this.stats.get(name);\n  }\n\n}\nconst lumaStats = new StatsManager();\n\nif (globalThis.luma && globalThis.luma.VERSION !== VERSION) {\n  throw new Error(\"luma.gl - multiple VERSIONs detected: \".concat(globalThis.luma.VERSION, \" vs \").concat(VERSION));\n}\n\nif (!globalThis.luma) {\n  if (isBrowser()) {\n    log.log(1, \"luma.gl \".concat(VERSION, \" - \").concat(STARTUP_MESSAGE))();\n  }\n\n  globalThis.luma = globalThis.luma || {\n    VERSION,\n    version: VERSION,\n    log,\n    stats: lumaStats,\n    globals: {\n      modules: {},\n      nodeIO: {}\n    }\n  };\n}\n\nexport { lumaStats };\nexport default globalThis.luma;\n//# sourceMappingURL=init.js.map","export function requestAnimationFrame(callback) {\n  return typeof window !== 'undefined' && window.requestAnimationFrame ? window.requestAnimationFrame(callback) : setTimeout(callback, 1000 / 60);\n}\nexport function cancelAnimationFrame(timerId) {\n  return typeof window !== 'undefined' && window.cancelAnimationFrame ? window.cancelAnimationFrame(timerId) : clearTimeout(timerId);\n}\n//# sourceMappingURL=request-animation-frame.js.map","export function assert(condition, message) {\n  if (!condition) {\n    throw new Error(message || 'luma.gl: assertion failed.');\n  }\n}\n//# sourceMappingURL=assert.js.map","import { assert } from '../utils/assert';\nexport function getKeyValue(gl, name) {\n  if (typeof name !== 'string') {\n    return name;\n  }\n\n  const number = Number(name);\n\n  if (!isNaN(number)) {\n    return number;\n  }\n\n  name = name.replace(/^.*\\./, '');\n  const value = gl[name];\n  assert(value !== undefined, \"Accessing undefined constant GL.\".concat(name));\n  return value;\n}\nexport function getKey(gl, value) {\n  value = Number(value);\n\n  for (const key in gl) {\n    if (gl[key] === value) {\n      return \"GL.\".concat(key);\n    }\n  }\n\n  return String(value);\n}\nexport function getKeyType(gl, value) {\n  assert(value !== undefined, 'undefined key');\n  value = Number(value);\n\n  for (const key in gl) {\n    if (gl[key] === value) {\n      return \"GL.\".concat(key);\n    }\n  }\n\n  return String(value);\n}\n//# sourceMappingURL=constants-to-keys.js.map","import { assert } from './assert';\nconst uidCounters = {};\nexport function uid() {\n  let id = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'id';\n  uidCounters[id] = uidCounters[id] || 1;\n  const count = uidCounters[id]++;\n  return \"\".concat(id, \"-\").concat(count);\n}\nexport function isPowerOfTwo(n) {\n  assert(typeof n === 'number', 'Input must be a number');\n  return n && (n & n - 1) === 0;\n}\nexport function isObjectEmpty(obj) {\n  let isEmpty = true;\n\n  for (const key in obj) {\n    isEmpty = false;\n    break;\n  }\n\n  return isEmpty;\n}\n//# sourceMappingURL=utils.js.map","import { log } from '@luma.gl/gltools';\nexport function stubRemovedMethods(instance, className, version, methodNames) {\n  const upgradeMessage = \"See luma.gl \".concat(version, \" Upgrade Guide at https://luma.gl/docs/upgrade-guide\");\n  const prototype = Object.getPrototypeOf(instance);\n  methodNames.forEach(methodName => {\n    if (prototype.methodName) {\n      return;\n    }\n\n    prototype[methodName] = () => {\n      log.removed(\"Calling removed method \".concat(className, \".\").concat(methodName, \": \"), upgradeMessage)();\n      throw new Error(methodName);\n    };\n  });\n}\n//# sourceMappingURL=stub-methods.js.map","import { isWebGL2, assertWebGLContext } from '@luma.gl/gltools';\nimport { lumaStats } from '../init';\nimport { getKey, getKeyValue } from '../webgl-utils/constants-to-keys';\nimport { assert } from '../utils/assert';\nimport { uid } from '../utils/utils';\nimport { stubRemovedMethods } from '../utils/stub-methods';\nconst ERR_RESOURCE_METHOD_UNDEFINED = 'Resource subclass must define virtual methods';\nexport default class Resource {\n  get [Symbol.toStringTag]() {\n    return 'Resource';\n  }\n\n  constructor(gl) {\n    let opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    assertWebGLContext(gl);\n    const {\n      id,\n      userData = {}\n    } = opts;\n    this.gl = gl;\n    this.gl2 = gl;\n    this.id = id || uid(this[Symbol.toStringTag]);\n    this.userData = userData;\n    this._bound = false;\n    this._handle = opts.handle;\n\n    if (this._handle === undefined) {\n      this._handle = this._createHandle();\n    }\n\n    this.byteLength = 0;\n\n    this._addStats();\n  }\n\n  toString() {\n    return \"\".concat(this[Symbol.toStringTag] || this.constructor.name, \"(\").concat(this.id, \")\");\n  }\n\n  get handle() {\n    return this._handle;\n  }\n\n  delete() {\n    let {\n      deleteChildren = false\n    } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    const children = this._handle && this._deleteHandle(this._handle);\n\n    if (this._handle) {\n      this._removeStats();\n    }\n\n    this._handle = null;\n\n    if (children && deleteChildren) {\n      children.filter(Boolean).forEach(child => child.delete());\n    }\n\n    return this;\n  }\n\n  bind() {\n    let funcOrHandle = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.handle;\n\n    if (typeof funcOrHandle !== 'function') {\n      this._bindHandle(funcOrHandle);\n\n      return this;\n    }\n\n    let value;\n\n    if (!this._bound) {\n      this._bindHandle(this.handle);\n\n      this._bound = true;\n      value = funcOrHandle();\n      this._bound = false;\n\n      this._bindHandle(null);\n    } else {\n      value = funcOrHandle();\n    }\n\n    return value;\n  }\n\n  unbind() {\n    this.bind(null);\n  }\n\n  getParameter(pname) {\n    let opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    pname = getKeyValue(this.gl, pname);\n    assert(pname);\n    const parameters = this.constructor.PARAMETERS || {};\n    const parameter = parameters[pname];\n\n    if (parameter) {\n      const isWebgl2 = isWebGL2(this.gl);\n      const parameterAvailable = (!('webgl2' in parameter) || isWebgl2) && (!('extension' in parameter) || this.gl.getExtension(parameter.extension));\n\n      if (!parameterAvailable) {\n        const webgl1Default = parameter.webgl1;\n        const webgl2Default = 'webgl2' in parameter ? parameter.webgl2 : parameter.webgl1;\n        const defaultValue = isWebgl2 ? webgl2Default : webgl1Default;\n        return defaultValue;\n      }\n    }\n\n    return this._getParameter(pname, opts);\n  }\n\n  getParameters() {\n    let options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    const {\n      parameters,\n      keys\n    } = options;\n    const PARAMETERS = this.constructor.PARAMETERS || {};\n    const isWebgl2 = isWebGL2(this.gl);\n    const values = {};\n    const parameterKeys = parameters || Object.keys(PARAMETERS);\n\n    for (const pname of parameterKeys) {\n      const parameter = PARAMETERS[pname];\n      const parameterAvailable = parameter && (!('webgl2' in parameter) || isWebgl2) && (!('extension' in parameter) || this.gl.getExtension(parameter.extension));\n\n      if (parameterAvailable) {\n        const key = keys ? getKey(this.gl, pname) : pname;\n        values[key] = this.getParameter(pname, options);\n\n        if (keys && parameter.type === 'GLenum') {\n          values[key] = getKey(this.gl, values[key]);\n        }\n      }\n    }\n\n    return values;\n  }\n\n  setParameter(pname, value) {\n    pname = getKeyValue(this.gl, pname);\n    assert(pname);\n    const parameters = this.constructor.PARAMETERS || {};\n    const parameter = parameters[pname];\n\n    if (parameter) {\n      const isWebgl2 = isWebGL2(this.gl);\n      const parameterAvailable = (!('webgl2' in parameter) || isWebgl2) && (!('extension' in parameter) || this.gl.getExtension(parameter.extension));\n\n      if (!parameterAvailable) {\n        throw new Error('Parameter not available on this platform');\n      }\n\n      if (parameter.type === 'GLenum') {\n        value = getKeyValue(value);\n      }\n    }\n\n    this._setParameter(pname, value);\n\n    return this;\n  }\n\n  setParameters(parameters) {\n    for (const pname in parameters) {\n      this.setParameter(pname, parameters[pname]);\n    }\n\n    return this;\n  }\n\n  stubRemovedMethods(className, version, methodNames) {\n    return stubRemovedMethods(this, className, version, methodNames);\n  }\n\n  initialize(opts) {}\n\n  _createHandle() {\n    throw new Error(ERR_RESOURCE_METHOD_UNDEFINED);\n  }\n\n  _deleteHandle() {\n    throw new Error(ERR_RESOURCE_METHOD_UNDEFINED);\n  }\n\n  _bindHandle(handle) {\n    throw new Error(ERR_RESOURCE_METHOD_UNDEFINED);\n  }\n\n  _getOptsFromHandle() {\n    throw new Error(ERR_RESOURCE_METHOD_UNDEFINED);\n  }\n\n  _getParameter(pname, opts) {\n    throw new Error(ERR_RESOURCE_METHOD_UNDEFINED);\n  }\n\n  _setParameter(pname, value) {\n    throw new Error(ERR_RESOURCE_METHOD_UNDEFINED);\n  }\n\n  _context() {\n    this.gl.luma = this.gl.luma || {};\n    return this.gl.luma;\n  }\n\n  _addStats() {\n    const name = this[Symbol.toStringTag];\n    const stats = lumaStats.get('Resource Counts');\n    stats.get('Resources Created').incrementCount();\n    stats.get(\"\".concat(name, \"s Created\")).incrementCount();\n    stats.get(\"\".concat(name, \"s Active\")).incrementCount();\n  }\n\n  _removeStats() {\n    const name = this[Symbol.toStringTag];\n    const stats = lumaStats.get('Resource Counts');\n    stats.get(\"\".concat(name, \"s Active\")).decrementCount();\n  }\n\n  _trackAllocatedMemory(bytes) {\n    let name = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this[Symbol.toStringTag];\n\n    this._trackAllocatedMemoryForContext(bytes, name);\n\n    this._trackAllocatedMemoryForContext(bytes, name, this.gl.canvas && this.gl.canvas.id);\n\n    this.byteLength = bytes;\n  }\n\n  _trackAllocatedMemoryForContext(bytes) {\n    let name = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this[Symbol.toStringTag];\n    let id = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : '';\n    const stats = lumaStats.get(\"Memory Usage\".concat(id));\n    stats.get('GPU Memory').addCount(bytes);\n    stats.get(\"\".concat(name, \" Memory\")).addCount(bytes);\n  }\n\n  _trackDeallocatedMemory() {\n    let name = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this[Symbol.toStringTag];\n\n    this._trackDeallocatedMemoryForContext(name);\n\n    this._trackDeallocatedMemoryForContext(name, this.gl.canvas && this.gl.canvas.id);\n\n    this.byteLength = 0;\n  }\n\n  _trackDeallocatedMemoryForContext() {\n    let name = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this[Symbol.toStringTag];\n    let id = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n    const stats = lumaStats.get(\"Memory Usage\".concat(id));\n    stats.get('GPU Memory').subtractCount(this.byteLength);\n    stats.get(\"\".concat(name, \" Memory\")).subtractCount(this.byteLength);\n  }\n\n}\n//# sourceMappingURL=resource.js.map","const ERR_TYPE_DEDUCTION = 'Failed to deduce GL constant from typed array';\nexport function getGLTypeFromTypedArray(arrayOrType) {\n  const type = ArrayBuffer.isView(arrayOrType) ? arrayOrType.constructor : arrayOrType;\n\n  switch (type) {\n    case Float32Array:\n      return 5126;\n\n    case Uint16Array:\n      return 5123;\n\n    case Uint32Array:\n      return 5125;\n\n    case Uint8Array:\n      return 5121;\n\n    case Uint8ClampedArray:\n      return 5121;\n\n    case Int8Array:\n      return 5120;\n\n    case Int16Array:\n      return 5122;\n\n    case Int32Array:\n      return 5124;\n\n    default:\n      throw new Error(ERR_TYPE_DEDUCTION);\n  }\n}\nexport function getTypedArrayFromGLType(glType) {\n  let {\n    clamped = true\n  } = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n  switch (glType) {\n    case 5126:\n      return Float32Array;\n\n    case 5123:\n    case 33635:\n    case 32819:\n    case 32820:\n      return Uint16Array;\n\n    case 5125:\n      return Uint32Array;\n\n    case 5121:\n      return clamped ? Uint8ClampedArray : Uint8Array;\n\n    case 5120:\n      return Int8Array;\n\n    case 5122:\n      return Int16Array;\n\n    case 5124:\n      return Int32Array;\n\n    default:\n      throw new Error('Failed to deduce typed array type from GL constant');\n  }\n}\nexport function flipRows(_ref) {\n  let {\n    data,\n    width,\n    height,\n    bytesPerPixel = 4,\n    temp\n  } = _ref;\n  const bytesPerRow = width * bytesPerPixel;\n  temp = temp || new Uint8Array(bytesPerRow);\n\n  for (let y = 0; y < height / 2; ++y) {\n    const topOffset = y * bytesPerRow;\n    const bottomOffset = (height - y - 1) * bytesPerRow;\n    temp.set(data.subarray(topOffset, topOffset + bytesPerRow));\n    data.copyWithin(topOffset, bottomOffset, bottomOffset + bytesPerRow);\n    data.set(temp, bottomOffset);\n  }\n}\nexport function scalePixels(_ref2) {\n  let {\n    data,\n    width,\n    height\n  } = _ref2;\n  const newWidth = Math.round(width / 2);\n  const newHeight = Math.round(height / 2);\n  const newData = new Uint8Array(newWidth * newHeight * 4);\n\n  for (let y = 0; y < newHeight; y++) {\n    for (let x = 0; x < newWidth; x++) {\n      for (let c = 0; c < 4; c++) {\n        newData[(y * newWidth + x) * 4 + c] = data[(y * 2 * width + x * 2) * 4 + c];\n      }\n    }\n  }\n\n  return {\n    data: newData,\n    width: newWidth,\n    height: newHeight\n  };\n}\n//# sourceMappingURL=typed-array-utils.js.map","import { log } from '@luma.gl/gltools';\nexport function checkProps(className, props, propChecks) {\n  const {\n    removedProps = {},\n    deprecatedProps = {},\n    replacedProps = {}\n  } = propChecks;\n\n  for (const propName in removedProps) {\n    if (propName in props) {\n      const replacementProp = removedProps[propName];\n      const replacement = replacementProp ? \"\".concat(className, \".\").concat(removedProps[propName]) : 'N/A';\n      log.removed(\"\".concat(className, \".\").concat(propName), replacement)();\n    }\n  }\n\n  for (const propName in deprecatedProps) {\n    if (propName in props) {\n      const replacementProp = deprecatedProps[propName];\n      log.deprecated(\"\".concat(className, \".\").concat(propName), \"\".concat(className, \".\").concat(replacementProp))();\n    }\n  }\n\n  let newProps = null;\n\n  for (const propName in replacedProps) {\n    if (propName in props) {\n      const replacementProp = replacedProps[propName];\n      log.deprecated(\"\".concat(className, \".\").concat(propName), \"\".concat(className, \".\").concat(replacementProp))();\n      newProps = newProps || Object.assign({}, props);\n      newProps[replacementProp] = props[propName];\n      delete newProps[propName];\n    }\n  }\n\n  return newProps || props;\n}\n//# sourceMappingURL=check-props.js.map","import { getTypedArrayFromGLType } from '../webgl-utils/typed-array-utils';\nimport { assert } from '../utils/assert';\nimport { checkProps } from '../utils/check-props';\nconst DEFAULT_ACCESSOR_VALUES = {\n  offset: 0,\n  stride: 0,\n  type: 5126,\n  size: 1,\n  divisor: 0,\n  normalized: false,\n  integer: false\n};\nconst PROP_CHECKS = {\n  deprecatedProps: {\n    instanced: 'divisor',\n    isInstanced: 'divisor'\n  }\n};\nexport default class Accessor {\n  static getBytesPerElement(accessor) {\n    const ArrayType = getTypedArrayFromGLType(accessor.type || 5126);\n    return ArrayType.BYTES_PER_ELEMENT;\n  }\n\n  static getBytesPerVertex(accessor) {\n    assert(accessor.size);\n    const ArrayType = getTypedArrayFromGLType(accessor.type || 5126);\n    return ArrayType.BYTES_PER_ELEMENT * accessor.size;\n  }\n\n  static resolve() {\n    for (var _len = arguments.length, accessors = new Array(_len), _key = 0; _key < _len; _key++) {\n      accessors[_key] = arguments[_key];\n    }\n\n    return new Accessor(...[DEFAULT_ACCESSOR_VALUES, ...accessors]);\n  }\n\n  constructor() {\n    for (var _len2 = arguments.length, accessors = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      accessors[_key2] = arguments[_key2];\n    }\n\n    accessors.forEach(accessor => this._assign(accessor));\n    Object.freeze(this);\n  }\n\n  toString() {\n    return JSON.stringify(this);\n  }\n\n  get BYTES_PER_ELEMENT() {\n    return Accessor.getBytesPerElement(this);\n  }\n\n  get BYTES_PER_VERTEX() {\n    return Accessor.getBytesPerVertex(this);\n  }\n\n  _assign() {\n    let props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    props = checkProps('Accessor', props, PROP_CHECKS);\n\n    if (props.type !== undefined) {\n      this.type = props.type;\n\n      if (props.type === 5124 || props.type === 5125) {\n        this.integer = true;\n      }\n    }\n\n    if (props.size !== undefined) {\n      this.size = props.size;\n    }\n\n    if (props.offset !== undefined) {\n      this.offset = props.offset;\n    }\n\n    if (props.stride !== undefined) {\n      this.stride = props.stride;\n    }\n\n    if (props.normalized !== undefined) {\n      this.normalized = props.normalized;\n    }\n\n    if (props.integer !== undefined) {\n      this.integer = props.integer;\n    }\n\n    if (props.divisor !== undefined) {\n      this.divisor = props.divisor;\n    }\n\n    if (props.buffer !== undefined) {\n      this.buffer = props.buffer;\n    }\n\n    if (props.index !== undefined) {\n      if (typeof props.index === 'boolean') {\n        this.index = props.index ? 1 : 0;\n      } else {\n        this.index = props.index;\n      }\n    }\n\n    if (props.instanced !== undefined) {\n      this.divisor = props.instanced ? 1 : 0;\n    }\n\n    if (props.isInstanced !== undefined) {\n      this.divisor = props.isInstanced ? 1 : 0;\n    }\n\n    return this;\n  }\n\n}\nexport { DEFAULT_ACCESSOR_VALUES };\n//# sourceMappingURL=accessor.js.map","import Resource from './resource';\nimport Accessor from './accessor';\nimport { getGLTypeFromTypedArray, getTypedArrayFromGLType } from '../webgl-utils/typed-array-utils';\nimport { assertWebGL2Context, log } from '@luma.gl/gltools';\nimport { assert } from '../utils/assert';\nimport { checkProps } from '../utils/check-props';\nconst DEBUG_DATA_LENGTH = 10;\nconst DEPRECATED_PROPS = {\n  offset: 'accessor.offset',\n  stride: 'accessor.stride',\n  type: 'accessor.type',\n  size: 'accessor.size',\n  divisor: 'accessor.divisor',\n  normalized: 'accessor.normalized',\n  integer: 'accessor.integer',\n  instanced: 'accessor.divisor',\n  isInstanced: 'accessor.divisor'\n};\nconst PROP_CHECKS_INITIALIZE = {\n  removedProps: {},\n  replacedProps: {\n    bytes: 'byteLength'\n  },\n  deprecatedProps: DEPRECATED_PROPS\n};\nconst PROP_CHECKS_SET_PROPS = {\n  removedProps: DEPRECATED_PROPS\n};\nexport default class Buffer extends Resource {\n  get [Symbol.toStringTag]() {\n    return 'Buffer';\n  }\n\n  constructor(gl) {\n    let props = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    super(gl, props);\n    this.stubRemovedMethods('Buffer', 'v6.0', ['layout', 'setLayout', 'getIndexedParameter']);\n    this.target = props.target || (this.gl.webgl2 ? 36662 : 34962);\n    this.initialize(props);\n    Object.seal(this);\n  }\n\n  getElementCount() {\n    let accessor = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.accessor;\n    return Math.round(this.byteLength / Accessor.getBytesPerElement(accessor));\n  }\n\n  getVertexCount() {\n    let accessor = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.accessor;\n    return Math.round(this.byteLength / Accessor.getBytesPerVertex(accessor));\n  }\n\n  initialize() {\n    let props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    if (ArrayBuffer.isView(props)) {\n      props = {\n        data: props\n      };\n    }\n\n    if (Number.isFinite(props)) {\n      props = {\n        byteLength: props\n      };\n    }\n\n    props = checkProps('Buffer', props, PROP_CHECKS_INITIALIZE);\n    this.usage = props.usage || 35044;\n    this.debugData = null;\n    this.setAccessor(Object.assign({}, props, props.accessor));\n\n    if (props.data) {\n      this._setData(props.data, props.offset, props.byteLength);\n    } else {\n      this._setByteLength(props.byteLength || 0);\n    }\n\n    return this;\n  }\n\n  setProps(props) {\n    props = checkProps('Buffer', props, PROP_CHECKS_SET_PROPS);\n\n    if ('accessor' in props) {\n      this.setAccessor(props.accessor);\n    }\n\n    return this;\n  }\n\n  setAccessor(accessor) {\n    accessor = Object.assign({}, accessor);\n    delete accessor.buffer;\n    this.accessor = new Accessor(accessor);\n    return this;\n  }\n\n  reallocate(byteLength) {\n    if (byteLength > this.byteLength) {\n      this._setByteLength(byteLength);\n\n      return true;\n    }\n\n    this.bytesUsed = byteLength;\n    return false;\n  }\n\n  setData(props) {\n    return this.initialize(props);\n  }\n\n  subData(props) {\n    if (ArrayBuffer.isView(props)) {\n      props = {\n        data: props\n      };\n    }\n\n    const {\n      data,\n      offset = 0,\n      srcOffset = 0\n    } = props;\n    const byteLength = props.byteLength || props.length;\n    assert(data);\n    const target = this.gl.webgl2 ? 36663 : this.target;\n    this.gl.bindBuffer(target, this.handle);\n\n    if (srcOffset !== 0 || byteLength !== undefined) {\n      assertWebGL2Context(this.gl);\n      this.gl.bufferSubData(this.target, offset, data, srcOffset, byteLength);\n    } else {\n      this.gl.bufferSubData(target, offset, data);\n    }\n\n    this.gl.bindBuffer(target, null);\n    this.debugData = null;\n\n    this._inferType(data);\n\n    return this;\n  }\n\n  copyData(_ref) {\n    let {\n      sourceBuffer,\n      readOffset = 0,\n      writeOffset = 0,\n      size\n    } = _ref;\n    const {\n      gl\n    } = this;\n    assertWebGL2Context(gl);\n    gl.bindBuffer(36662, sourceBuffer.handle);\n    gl.bindBuffer(36663, this.handle);\n    gl.copyBufferSubData(36662, 36663, readOffset, writeOffset, size);\n    gl.bindBuffer(36662, null);\n    gl.bindBuffer(36663, null);\n    this.debugData = null;\n    return this;\n  }\n\n  getData() {\n    let {\n      dstData = null,\n      srcByteOffset = 0,\n      dstOffset = 0,\n      length = 0\n    } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    assertWebGL2Context(this.gl);\n    const ArrayType = getTypedArrayFromGLType(this.accessor.type || 5126, {\n      clamped: false\n    });\n\n    const sourceAvailableElementCount = this._getAvailableElementCount(srcByteOffset);\n\n    const dstElementOffset = dstOffset;\n    let dstAvailableElementCount;\n    let dstElementCount;\n\n    if (dstData) {\n      dstElementCount = dstData.length;\n      dstAvailableElementCount = dstElementCount - dstElementOffset;\n    } else {\n      dstAvailableElementCount = Math.min(sourceAvailableElementCount, length || sourceAvailableElementCount);\n      dstElementCount = dstElementOffset + dstAvailableElementCount;\n    }\n\n    const copyElementCount = Math.min(sourceAvailableElementCount, dstAvailableElementCount);\n    length = length || copyElementCount;\n    assert(length <= copyElementCount);\n    dstData = dstData || new ArrayType(dstElementCount);\n    this.gl.bindBuffer(36662, this.handle);\n    this.gl.getBufferSubData(36662, srcByteOffset, dstData, dstOffset, length);\n    this.gl.bindBuffer(36662, null);\n    return dstData;\n  }\n\n  bind() {\n    let {\n      target = this.target,\n      index = this.accessor && this.accessor.index,\n      offset = 0,\n      size\n    } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    if (target === 35345 || target === 35982) {\n      if (size !== undefined) {\n        this.gl.bindBufferRange(target, index, this.handle, offset, size);\n      } else {\n        assert(offset === 0);\n        this.gl.bindBufferBase(target, index, this.handle);\n      }\n    } else {\n      this.gl.bindBuffer(target, this.handle);\n    }\n\n    return this;\n  }\n\n  unbind() {\n    let {\n      target = this.target,\n      index = this.accessor && this.accessor.index\n    } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    const isIndexedBuffer = target === 35345 || target === 35982;\n\n    if (isIndexedBuffer) {\n      this.gl.bindBufferBase(target, index, null);\n    } else {\n      this.gl.bindBuffer(target, null);\n    }\n\n    return this;\n  }\n\n  getDebugData() {\n    if (!this.debugData) {\n      this.debugData = this.getData({\n        length: Math.min(DEBUG_DATA_LENGTH, this.byteLength)\n      });\n      return {\n        data: this.debugData,\n        changed: true\n      };\n    }\n\n    return {\n      data: this.debugData,\n      changed: false\n    };\n  }\n\n  invalidateDebugData() {\n    this.debugData = null;\n  }\n\n  _setData(data) {\n    let offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n    let byteLength = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : data.byteLength + offset;\n    assert(ArrayBuffer.isView(data));\n\n    this._trackDeallocatedMemory();\n\n    const target = this._getTarget();\n\n    this.gl.bindBuffer(target, this.handle);\n    this.gl.bufferData(target, byteLength, this.usage);\n    this.gl.bufferSubData(target, offset, data);\n    this.gl.bindBuffer(target, null);\n    this.debugData = data.slice(0, DEBUG_DATA_LENGTH);\n    this.bytesUsed = byteLength;\n\n    this._trackAllocatedMemory(byteLength);\n\n    const type = getGLTypeFromTypedArray(data);\n    assert(type);\n    this.setAccessor(new Accessor(this.accessor, {\n      type\n    }));\n    return this;\n  }\n\n  _setByteLength(byteLength) {\n    let usage = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.usage;\n    assert(byteLength >= 0);\n\n    this._trackDeallocatedMemory();\n\n    let data = byteLength;\n\n    if (byteLength === 0) {\n      data = new Float32Array(0);\n    }\n\n    const target = this._getTarget();\n\n    this.gl.bindBuffer(target, this.handle);\n    this.gl.bufferData(target, data, usage);\n    this.gl.bindBuffer(target, null);\n    this.usage = usage;\n    this.debugData = null;\n    this.bytesUsed = byteLength;\n\n    this._trackAllocatedMemory(byteLength);\n\n    return this;\n  }\n\n  _getTarget() {\n    return this.gl.webgl2 ? 36663 : this.target;\n  }\n\n  _getAvailableElementCount(srcByteOffset) {\n    const ArrayType = getTypedArrayFromGLType(this.accessor.type || 5126, {\n      clamped: false\n    });\n    const sourceElementOffset = srcByteOffset / ArrayType.BYTES_PER_ELEMENT;\n    return this.getElementCount() - sourceElementOffset;\n  }\n\n  _inferType(data) {\n    if (!this.accessor.type) {\n      this.setAccessor(new Accessor(this.accessor, {\n        type: getGLTypeFromTypedArray(data)\n      }));\n    }\n  }\n\n  _createHandle() {\n    return this.gl.createBuffer();\n  }\n\n  _deleteHandle() {\n    this.gl.deleteBuffer(this.handle);\n\n    this._trackDeallocatedMemory();\n  }\n\n  _getParameter(pname) {\n    this.gl.bindBuffer(this.target, this.handle);\n    const value = this.gl.getBufferParameter(this.target, pname);\n    this.gl.bindBuffer(this.target, null);\n    return value;\n  }\n\n  get type() {\n    log.deprecated('Buffer.type', 'Buffer.accessor.type')();\n    return this.accessor.type;\n  }\n\n  get bytes() {\n    log.deprecated('Buffer.bytes', 'Buffer.byteLength')();\n    return this.byteLength;\n  }\n\n  setByteLength(byteLength) {\n    log.deprecated('setByteLength', 'reallocate')();\n    return this.reallocate(byteLength);\n  }\n\n  updateAccessor(opts) {\n    log.deprecated('updateAccessor(...)', 'setAccessor(new Accessor(buffer.accessor, ...)')();\n    this.accessor = new Accessor(this.accessor, opts);\n    return this;\n  }\n\n}\n//# sourceMappingURL=buffer.js.map","import { isWebGL2 } from '@luma.gl/gltools';\nexport const TEXTURE_FORMATS = {\n  [6407]: {\n    dataFormat: 6407,\n    types: [5121, 33635]\n  },\n  [6408]: {\n    dataFormat: 6408,\n    types: [5121, 32819, 32820]\n  },\n  [6406]: {\n    dataFormat: 6406,\n    types: [5121]\n  },\n  [6409]: {\n    dataFormat: 6409,\n    types: [5121]\n  },\n  [6410]: {\n    dataFormat: 6410,\n    types: [5121]\n  },\n  [33326]: {\n    dataFormat: 6403,\n    types: [5126],\n    gl2: true\n  },\n  [33328]: {\n    dataFormat: 33319,\n    types: [5126],\n    gl2: true\n  },\n  [34837]: {\n    dataFormat: 6407,\n    types: [5126],\n    gl2: true\n  },\n  [34836]: {\n    dataFormat: 6408,\n    types: [5126],\n    gl2: true\n  }\n};\nexport const DATA_FORMAT_CHANNELS = {\n  [6403]: 1,\n  [36244]: 1,\n  [33319]: 2,\n  [33320]: 2,\n  [6407]: 3,\n  [36248]: 3,\n  [6408]: 4,\n  [36249]: 4,\n  [6402]: 1,\n  [34041]: 1,\n  [6406]: 1,\n  [6409]: 1,\n  [6410]: 2\n};\nexport const TYPE_SIZES = {\n  [5126]: 4,\n  [5125]: 4,\n  [5124]: 4,\n  [5123]: 2,\n  [5122]: 2,\n  [5131]: 2,\n  [5120]: 1,\n  [5121]: 1\n};\nexport function isFormatSupported(gl, format) {\n  const info = TEXTURE_FORMATS[format];\n\n  if (!info) {\n    return false;\n  }\n\n  if (info.gl1 === undefined && info.gl2 === undefined) {\n    return true;\n  }\n\n  const value = isWebGL2(gl) ? info.gl2 || info.gl1 : info.gl1;\n  return typeof value === 'string' ? gl.getExtension(value) : value;\n}\nexport function isLinearFilteringSupported(gl, format) {\n  const info = TEXTURE_FORMATS[format];\n\n  switch (info && info.types[0]) {\n    case 5126:\n      return gl.getExtension('OES_texture_float_linear');\n\n    case 5131:\n      return gl.getExtension('OES_texture_half_float_linear');\n\n    default:\n      return true;\n  }\n}\n//# sourceMappingURL=texture-formats.js.map","import { isWebGL2, assertWebGL2Context, withParameters, log } from '@luma.gl/gltools';\nimport Resource from './resource';\nimport Buffer from './buffer';\nimport { TEXTURE_FORMATS, DATA_FORMAT_CHANNELS, TYPE_SIZES, isFormatSupported, isLinearFilteringSupported } from './texture-formats';\nimport { assert } from '../utils/assert';\nimport { uid, isPowerOfTwo } from '../utils/utils';\nconst NPOT_MIN_FILTERS = [9729, 9728];\n\nconst WebGLBuffer = globalThis.WebGLBuffer || function WebGLBuffer() {};\n\nexport default class Texture extends Resource {\n  get [Symbol.toStringTag]() {\n    return 'Texture';\n  }\n\n  static isSupported(gl) {\n    let opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    const {\n      format,\n      linearFiltering\n    } = opts;\n    let supported = true;\n\n    if (format) {\n      supported = supported && isFormatSupported(gl, format);\n      supported = supported && (!linearFiltering || isLinearFilteringSupported(gl, format));\n    }\n\n    return supported;\n  }\n\n  constructor(gl, props) {\n    const {\n      id = uid('texture'),\n      handle,\n      target\n    } = props;\n    super(gl, {\n      id,\n      handle\n    });\n    this.target = target;\n    this.textureUnit = undefined;\n    this.loaded = false;\n    this.width = undefined;\n    this.height = undefined;\n    this.depth = undefined;\n    this.format = undefined;\n    this.type = undefined;\n    this.dataFormat = undefined;\n    this.border = undefined;\n    this.textureUnit = undefined;\n    this.mipmaps = undefined;\n  }\n\n  toString() {\n    return \"Texture(\".concat(this.id, \",\").concat(this.width, \"x\").concat(this.height, \")\");\n  }\n\n  initialize() {\n    let props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    let data = props.data;\n\n    if (data instanceof Promise) {\n      data.then(resolvedImageData => this.initialize(Object.assign({}, props, {\n        pixels: resolvedImageData,\n        data: resolvedImageData\n      })));\n      return this;\n    }\n\n    const isVideo = typeof HTMLVideoElement !== 'undefined' && data instanceof HTMLVideoElement;\n\n    if (isVideo && data.readyState < HTMLVideoElement.HAVE_METADATA) {\n      this._video = null;\n      data.addEventListener('loadeddata', () => this.initialize(props));\n      return this;\n    }\n\n    const {\n      pixels = null,\n      format = 6408,\n      border = 0,\n      recreate = false,\n      parameters = {},\n      pixelStore = {},\n      textureUnit = undefined\n    } = props;\n\n    if (!data) {\n      data = pixels;\n    }\n\n    let {\n      width,\n      height,\n      dataFormat,\n      type,\n      compressed = false,\n      mipmaps = true\n    } = props;\n    const {\n      depth = 0\n    } = props;\n    ({\n      width,\n      height,\n      compressed,\n      dataFormat,\n      type\n    } = this._deduceParameters({\n      format,\n      type,\n      dataFormat,\n      compressed,\n      data,\n      width,\n      height\n    }));\n    this.width = width;\n    this.height = height;\n    this.depth = depth;\n    this.format = format;\n    this.type = type;\n    this.dataFormat = dataFormat;\n    this.border = border;\n    this.textureUnit = textureUnit;\n\n    if (Number.isFinite(this.textureUnit)) {\n      this.gl.activeTexture(33984 + this.textureUnit);\n      this.gl.bindTexture(this.target, this.handle);\n    }\n\n    if (mipmaps && this._isNPOT()) {\n      log.warn(\"texture: \".concat(this, \" is Non-Power-Of-Two, disabling mipmaping\"))();\n      mipmaps = false;\n\n      this._updateForNPOT(parameters);\n    }\n\n    this.mipmaps = mipmaps;\n    this.setImageData({\n      data,\n      width,\n      height,\n      depth,\n      format,\n      type,\n      dataFormat,\n      border,\n      mipmaps,\n      parameters: pixelStore,\n      compressed\n    });\n\n    if (mipmaps) {\n      this.generateMipmap();\n    }\n\n    this.setParameters(parameters);\n\n    if (recreate) {\n      this.data = data;\n    }\n\n    if (isVideo) {\n      this._video = {\n        video: data,\n        parameters,\n        lastTime: data.readyState >= HTMLVideoElement.HAVE_CURRENT_DATA ? data.currentTime : -1\n      };\n    }\n\n    return this;\n  }\n\n  update() {\n    if (this._video) {\n      const {\n        video,\n        parameters,\n        lastTime\n      } = this._video;\n\n      if (lastTime === video.currentTime || video.readyState < HTMLVideoElement.HAVE_CURRENT_DATA) {\n        return;\n      }\n\n      this.setSubImageData({\n        data: video,\n        parameters\n      });\n\n      if (this.mipmaps) {\n        this.generateMipmap();\n      }\n\n      this._video.lastTime = video.currentTime;\n    }\n  }\n\n  resize(_ref) {\n    let {\n      height,\n      width,\n      mipmaps = false\n    } = _ref;\n\n    if (width !== this.width || height !== this.height) {\n      return this.initialize({\n        width,\n        height,\n        format: this.format,\n        type: this.type,\n        dataFormat: this.dataFormat,\n        border: this.border,\n        mipmaps\n      });\n    }\n\n    return this;\n  }\n\n  generateMipmap() {\n    let params = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    if (this._isNPOT()) {\n      log.warn(\"texture: \".concat(this, \" is Non-Power-Of-Two, disabling mipmaping\"))();\n      return this;\n    }\n\n    this.mipmaps = true;\n    this.gl.bindTexture(this.target, this.handle);\n    withParameters(this.gl, params, () => {\n      this.gl.generateMipmap(this.target);\n    });\n    this.gl.bindTexture(this.target, null);\n    return this;\n  }\n\n  setImageData(options) {\n    this._trackDeallocatedMemory('Texture');\n\n    const {\n      target = this.target,\n      pixels = null,\n      level = 0,\n      format = this.format,\n      border = this.border,\n      offset = 0,\n      parameters = {}\n    } = options;\n    let {\n      data = null,\n      type = this.type,\n      width = this.width,\n      height = this.height,\n      dataFormat = this.dataFormat,\n      compressed = false\n    } = options;\n\n    if (!data) {\n      data = pixels;\n    }\n\n    ({\n      type,\n      dataFormat,\n      compressed,\n      width,\n      height\n    } = this._deduceParameters({\n      format,\n      type,\n      dataFormat,\n      compressed,\n      data,\n      width,\n      height\n    }));\n    const {\n      gl\n    } = this;\n    gl.bindTexture(this.target, this.handle);\n    let dataType = null;\n    ({\n      data,\n      dataType\n    } = this._getDataType({\n      data,\n      compressed\n    }));\n    let gl2;\n    let compressedTextureSize = 0;\n    withParameters(this.gl, parameters, () => {\n      switch (dataType) {\n        case 'null':\n          gl.texImage2D(target, level, format, width, height, border, dataFormat, type, data);\n          break;\n\n        case 'typed-array':\n          gl.texImage2D(target, level, format, width, height, border, dataFormat, type, data, offset);\n          break;\n\n        case 'buffer':\n          gl2 = assertWebGL2Context(gl);\n          gl2.bindBuffer(35052, data.handle || data);\n          gl2.texImage2D(target, level, format, width, height, border, dataFormat, type, offset);\n          gl2.bindBuffer(35052, null);\n          break;\n\n        case 'browser-object':\n          if (isWebGL2(gl)) {\n            gl.texImage2D(target, level, format, width, height, border, dataFormat, type, data);\n          } else {\n            gl.texImage2D(target, level, format, dataFormat, type, data);\n          }\n\n          break;\n\n        case 'compressed':\n          for (const [levelIndex, levelData] of data.entries()) {\n            gl.compressedTexImage2D(target, levelIndex, levelData.format, levelData.width, levelData.height, border, levelData.data);\n            compressedTextureSize += levelData.levelSize;\n          }\n\n          break;\n\n        default:\n          assert(false, 'Unknown image data type');\n      }\n    });\n\n    if (dataType === 'compressed') {\n      this._trackAllocatedMemory(compressedTextureSize, 'Texture');\n    } else if (data && data.byteLength) {\n      this._trackAllocatedMemory(data.byteLength, 'Texture');\n    } else {\n      const channels = DATA_FORMAT_CHANNELS[this.dataFormat] || 4;\n      const channelSize = TYPE_SIZES[this.type] || 1;\n\n      this._trackAllocatedMemory(this.width * this.height * channels * channelSize, 'Texture');\n    }\n\n    this.loaded = true;\n    return this;\n  }\n\n  setSubImageData(_ref2) {\n    let {\n      target = this.target,\n      pixels = null,\n      data = null,\n      x = 0,\n      y = 0,\n      width = this.width,\n      height = this.height,\n      level = 0,\n      format = this.format,\n      type = this.type,\n      dataFormat = this.dataFormat,\n      compressed = false,\n      offset = 0,\n      border = this.border,\n      parameters = {}\n    } = _ref2;\n    ({\n      type,\n      dataFormat,\n      compressed,\n      width,\n      height\n    } = this._deduceParameters({\n      format,\n      type,\n      dataFormat,\n      compressed,\n      data,\n      width,\n      height\n    }));\n    assert(this.depth === 0, 'texSubImage not supported for 3D textures');\n\n    if (!data) {\n      data = pixels;\n    }\n\n    if (data && data.data) {\n      const ndarray = data;\n      data = ndarray.data;\n      width = ndarray.shape[0];\n      height = ndarray.shape[1];\n    }\n\n    if (data instanceof Buffer) {\n      data = data.handle;\n    }\n\n    this.gl.bindTexture(this.target, this.handle);\n    withParameters(this.gl, parameters, () => {\n      if (compressed) {\n        this.gl.compressedTexSubImage2D(target, level, x, y, width, height, format, data);\n      } else if (data === null) {\n        this.gl.texSubImage2D(target, level, x, y, width, height, dataFormat, type, null);\n      } else if (ArrayBuffer.isView(data)) {\n        this.gl.texSubImage2D(target, level, x, y, width, height, dataFormat, type, data, offset);\n      } else if (data instanceof WebGLBuffer) {\n        const gl2 = assertWebGL2Context(this.gl);\n        gl2.bindBuffer(35052, data);\n        gl2.texSubImage2D(target, level, x, y, width, height, dataFormat, type, offset);\n        gl2.bindBuffer(35052, null);\n      } else if (isWebGL2(this.gl)) {\n        const gl2 = assertWebGL2Context(this.gl);\n        gl2.texSubImage2D(target, level, x, y, width, height, dataFormat, type, data);\n      } else {\n        this.gl.texSubImage2D(target, level, x, y, dataFormat, type, data);\n      }\n    });\n    this.gl.bindTexture(this.target, null);\n  }\n\n  copyFramebuffer() {\n    let opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    log.error('Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})')();\n    return null;\n  }\n\n  getActiveUnit() {\n    return this.gl.getParameter(34016) - 33984;\n  }\n\n  bind() {\n    let textureUnit = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.textureUnit;\n    const {\n      gl\n    } = this;\n\n    if (textureUnit !== undefined) {\n      this.textureUnit = textureUnit;\n      gl.activeTexture(33984 + textureUnit);\n    }\n\n    gl.bindTexture(this.target, this.handle);\n    return textureUnit;\n  }\n\n  unbind() {\n    let textureUnit = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.textureUnit;\n    const {\n      gl\n    } = this;\n\n    if (textureUnit !== undefined) {\n      this.textureUnit = textureUnit;\n      gl.activeTexture(33984 + textureUnit);\n    }\n\n    gl.bindTexture(this.target, null);\n    return textureUnit;\n  }\n\n  _getDataType(_ref3) {\n    let {\n      data,\n      compressed = false\n    } = _ref3;\n\n    if (compressed) {\n      return {\n        data,\n        dataType: 'compressed'\n      };\n    }\n\n    if (data === null) {\n      return {\n        data,\n        dataType: 'null'\n      };\n    }\n\n    if (ArrayBuffer.isView(data)) {\n      return {\n        data,\n        dataType: 'typed-array'\n      };\n    }\n\n    if (data instanceof Buffer) {\n      return {\n        data: data.handle,\n        dataType: 'buffer'\n      };\n    }\n\n    if (data instanceof WebGLBuffer) {\n      return {\n        data,\n        dataType: 'buffer'\n      };\n    }\n\n    return {\n      data,\n      dataType: 'browser-object'\n    };\n  }\n\n  _deduceParameters(opts) {\n    const {\n      format,\n      data\n    } = opts;\n    let {\n      width,\n      height,\n      dataFormat,\n      type,\n      compressed\n    } = opts;\n    const textureFormat = TEXTURE_FORMATS[format];\n    dataFormat = dataFormat || textureFormat && textureFormat.dataFormat;\n    type = type || textureFormat && textureFormat.types[0];\n    compressed = compressed || textureFormat && textureFormat.compressed;\n    ({\n      width,\n      height\n    } = this._deduceImageSize(data, width, height));\n    return {\n      dataFormat,\n      type,\n      compressed,\n      width,\n      height,\n      format,\n      data\n    };\n  }\n\n  _deduceImageSize(data, width, height) {\n    let size;\n\n    if (typeof ImageData !== 'undefined' && data instanceof ImageData) {\n      size = {\n        width: data.width,\n        height: data.height\n      };\n    } else if (typeof HTMLImageElement !== 'undefined' && data instanceof HTMLImageElement) {\n      size = {\n        width: data.naturalWidth,\n        height: data.naturalHeight\n      };\n    } else if (typeof HTMLCanvasElement !== 'undefined' && data instanceof HTMLCanvasElement) {\n      size = {\n        width: data.width,\n        height: data.height\n      };\n    } else if (typeof ImageBitmap !== 'undefined' && data instanceof ImageBitmap) {\n      size = {\n        width: data.width,\n        height: data.height\n      };\n    } else if (typeof HTMLVideoElement !== 'undefined' && data instanceof HTMLVideoElement) {\n      size = {\n        width: data.videoWidth,\n        height: data.videoHeight\n      };\n    } else if (!data) {\n      size = {\n        width: width >= 0 ? width : 1,\n        height: height >= 0 ? height : 1\n      };\n    } else {\n      size = {\n        width,\n        height\n      };\n    }\n\n    assert(size, 'Could not deduced texture size');\n    assert(width === undefined || size.width === width, 'Deduced texture width does not match supplied width');\n    assert(height === undefined || size.height === height, 'Deduced texture height does not match supplied height');\n    return size;\n  }\n\n  _createHandle() {\n    return this.gl.createTexture();\n  }\n\n  _deleteHandle() {\n    this.gl.deleteTexture(this.handle);\n\n    this._trackDeallocatedMemory('Texture');\n  }\n\n  _getParameter(pname) {\n    switch (pname) {\n      case 4096:\n        return this.width;\n\n      case 4097:\n        return this.height;\n\n      default:\n        this.gl.bindTexture(this.target, this.handle);\n        const value = this.gl.getTexParameter(this.target, pname);\n        this.gl.bindTexture(this.target, null);\n        return value;\n    }\n  }\n\n  _setParameter(pname, param) {\n    this.gl.bindTexture(this.target, this.handle);\n    param = this._getNPOTParam(pname, param);\n\n    switch (pname) {\n      case 33082:\n      case 33083:\n        this.gl.texParameterf(this.handle, pname, param);\n        break;\n\n      case 4096:\n      case 4097:\n        assert(false);\n        break;\n\n      default:\n        this.gl.texParameteri(this.target, pname, param);\n        break;\n    }\n\n    this.gl.bindTexture(this.target, null);\n    return this;\n  }\n\n  _isNPOT() {\n    if (isWebGL2(this.gl)) {\n      return false;\n    }\n\n    if (!this.width || !this.height) {\n      return false;\n    }\n\n    return !isPowerOfTwo(this.width) || !isPowerOfTwo(this.height);\n  }\n\n  _updateForNPOT(parameters) {\n    if (parameters[this.gl.TEXTURE_MIN_FILTER] === undefined) {\n      parameters[this.gl.TEXTURE_MIN_FILTER] = this.gl.LINEAR;\n    }\n\n    if (parameters[this.gl.TEXTURE_WRAP_S] === undefined) {\n      parameters[this.gl.TEXTURE_WRAP_S] = this.gl.CLAMP_TO_EDGE;\n    }\n\n    if (parameters[this.gl.TEXTURE_WRAP_T] === undefined) {\n      parameters[this.gl.TEXTURE_WRAP_T] = this.gl.CLAMP_TO_EDGE;\n    }\n  }\n\n  _getNPOTParam(pname, param) {\n    if (this._isNPOT()) {\n      switch (pname) {\n        case 10241:\n          if (NPOT_MIN_FILTERS.indexOf(param) === -1) {\n            param = 9729;\n          }\n\n          break;\n\n        case 10242:\n        case 10243:\n          if (param !== 33071) {\n            param = 33071;\n          }\n\n          break;\n\n        default:\n          break;\n      }\n    }\n\n    return param;\n  }\n\n}\n//# sourceMappingURL=texture.js.map","import { assert } from '../utils/assert';\nlet pathPrefix = '';\nexport function setPathPrefix(prefix) {\n  pathPrefix = prefix;\n}\nexport function loadFile(url) {\n  let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  assert(typeof url === 'string');\n  url = pathPrefix + url;\n  const dataType = options.dataType || 'text';\n  return fetch(url, options).then(res => res[dataType]());\n}\nexport function loadImage(url, opts) {\n  assert(typeof url === 'string');\n  url = pathPrefix + url;\n  return new Promise((resolve, reject) => {\n    try {\n      const image = new Image();\n\n      image.onload = () => resolve(image);\n\n      image.onerror = () => reject(new Error(\"Could not load image \".concat(url, \".\")));\n\n      image.crossOrigin = opts && opts.crossOrigin || 'anonymous';\n      image.src = url;\n    } catch (error) {\n      reject(error);\n    }\n  });\n}\n//# sourceMappingURL=load-file.js.map","import { assertWebGLContext } from '@luma.gl/gltools';\nimport Texture from './texture';\nimport { loadImage } from '../utils/load-file';\nexport default class Texture2D extends Texture {\n  get [Symbol.toStringTag]() {\n    return 'Texture2D';\n  }\n\n  static isSupported(gl, opts) {\n    return Texture.isSupported(gl, opts);\n  }\n\n  constructor(gl) {\n    let props = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    assertWebGLContext(gl);\n\n    if (props instanceof Promise || typeof props === 'string') {\n      props = {\n        data: props\n      };\n    }\n\n    if (typeof props.data === 'string') {\n      props = Object.assign({}, props, {\n        data: loadImage(props.data)\n      });\n    }\n\n    super(gl, Object.assign({}, props, {\n      target: 3553\n    }));\n    this.initialize(props);\n    Object.seal(this);\n  }\n\n}\n//# sourceMappingURL=texture-2d.js.map","import { log, assertWebGLContext } from '@luma.gl/gltools';\nimport Texture from './texture';\nconst FACES = [34069, 34070, 34071, 34072, 34073, 34074];\nexport default class TextureCube extends Texture {\n  get [Symbol.toStringTag]() {\n    return 'TextureCube';\n  }\n\n  constructor(gl) {\n    let props = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    assertWebGLContext(gl);\n    super(gl, Object.assign({}, props, {\n      target: 34067\n    }));\n    this.initialize(props);\n    Object.seal(this);\n  }\n\n  initialize() {\n    let props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    const {\n      mipmaps = true,\n      parameters = {}\n    } = props;\n    this.opts = props;\n    this.setCubeMapImageData(props).then(() => {\n      this.loaded = true;\n\n      if (mipmaps) {\n        this.generateMipmap(props);\n      }\n\n      this.setParameters(parameters);\n    });\n    return this;\n  }\n\n  subImage(_ref) {\n    let {\n      face,\n      data,\n      x = 0,\n      y = 0,\n      mipmapLevel = 0\n    } = _ref;\n    return this._subImage({\n      target: face,\n      data,\n      x,\n      y,\n      mipmapLevel\n    });\n  }\n\n  async setCubeMapImageData(_ref2) {\n    let {\n      width,\n      height,\n      pixels,\n      data,\n      border = 0,\n      format = 6408,\n      type = 5121\n    } = _ref2;\n    const {\n      gl\n    } = this;\n    const imageDataMap = pixels || data;\n    const resolvedFaces = await Promise.all(FACES.map(face => {\n      const facePixels = imageDataMap[face];\n      return Promise.all(Array.isArray(facePixels) ? facePixels : [facePixels]);\n    }));\n    this.bind();\n    FACES.forEach((face, index) => {\n      if (resolvedFaces[index].length > 1 && this.opts.mipmaps !== false) {\n        log.warn(\"\".concat(this.id, \" has mipmap and multiple LODs.\"))();\n      }\n\n      resolvedFaces[index].forEach((image, lodLevel) => {\n        if (width && height) {\n          gl.texImage2D(face, lodLevel, format, width, height, border, format, type, image);\n        } else {\n          gl.texImage2D(face, lodLevel, format, format, type, image);\n        }\n      });\n    });\n    this.unbind();\n  }\n\n  setImageDataForFace(options) {\n    const {\n      face,\n      width,\n      height,\n      pixels,\n      data,\n      border = 0,\n      format = 6408,\n      type = 5121\n    } = options;\n    const {\n      gl\n    } = this;\n    const imageData = pixels || data;\n    this.bind();\n\n    if (imageData instanceof Promise) {\n      imageData.then(resolvedImageData => this.setImageDataForFace(Object.assign({}, options, {\n        face,\n        data: resolvedImageData,\n        pixels: resolvedImageData\n      })));\n    } else if (this.width || this.height) {\n      gl.texImage2D(face, 0, format, width, height, border, format, type, imageData);\n    } else {\n      gl.texImage2D(face, 0, format, format, type, imageData);\n    }\n\n    return this;\n  }\n\n}\nTextureCube.FACES = FACES;\n//# sourceMappingURL=texture-cube.js.map","import { isWebGL2, assertWebGL2Context, withParameters } from '@luma.gl/gltools';\nimport Texture from './texture';\nimport { DATA_FORMAT_CHANNELS, TYPE_SIZES } from './texture-formats';\nimport Buffer from './buffer';\nexport default class Texture3D extends Texture {\n  get [Symbol.toStringTag]() {\n    return 'Texture3D';\n  }\n\n  static isSupported(gl) {\n    return isWebGL2(gl);\n  }\n\n  constructor(gl) {\n    let props = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    assertWebGL2Context(gl);\n    props = Object.assign({\n      depth: 1\n    }, props, {\n      target: 32879,\n      unpackFlipY: false\n    });\n    super(gl, props);\n    this.initialize(props);\n    Object.seal(this);\n  }\n\n  setImageData(_ref) {\n    let {\n      level = 0,\n      dataFormat = 6408,\n      width,\n      height,\n      depth = 1,\n      border = 0,\n      format,\n      type = 5121,\n      offset = 0,\n      data,\n      parameters = {}\n    } = _ref;\n\n    this._trackDeallocatedMemory('Texture');\n\n    this.gl.bindTexture(this.target, this.handle);\n    withParameters(this.gl, parameters, () => {\n      if (ArrayBuffer.isView(data)) {\n        this.gl.texImage3D(this.target, level, dataFormat, width, height, depth, border, format, type, data);\n      }\n\n      if (data instanceof Buffer) {\n        this.gl.bindBuffer(35052, data.handle);\n        this.gl.texImage3D(this.target, level, dataFormat, width, height, depth, border, format, type, offset);\n      }\n    });\n\n    if (data && data.byteLength) {\n      this._trackAllocatedMemory(data.byteLength, 'Texture');\n    } else {\n      const channels = DATA_FORMAT_CHANNELS[this.dataFormat] || 4;\n      const channelSize = TYPE_SIZES[this.type] || 1;\n\n      this._trackAllocatedMemory(this.width * this.height * this.depth * channels * channelSize, 'Texture');\n    }\n\n    this.loaded = true;\n    return this;\n  }\n\n}\n//# sourceMappingURL=texture-3d.js.map","const EXT_FLOAT_WEBGL2 = 'EXT_color_buffer_float';\nexport default {\n  [33189]: {\n    bpp: 2\n  },\n  [33190]: {\n    gl2: true,\n    bpp: 3\n  },\n  [36012]: {\n    gl2: true,\n    bpp: 4\n  },\n  [36168]: {\n    bpp: 1\n  },\n  [34041]: {\n    bpp: 4\n  },\n  [35056]: {\n    gl2: true,\n    bpp: 4\n  },\n  [36013]: {\n    gl2: true,\n    bpp: 5\n  },\n  [32854]: {\n    bpp: 2\n  },\n  [36194]: {\n    bpp: 2\n  },\n  [32855]: {\n    bpp: 2\n  },\n  [33321]: {\n    gl2: true,\n    bpp: 1\n  },\n  [33330]: {\n    gl2: true,\n    bpp: 1\n  },\n  [33329]: {\n    gl2: true,\n    bpp: 1\n  },\n  [33332]: {\n    gl2: true,\n    bpp: 2\n  },\n  [33331]: {\n    gl2: true,\n    bpp: 2\n  },\n  [33334]: {\n    gl2: true,\n    bpp: 4\n  },\n  [33333]: {\n    gl2: true,\n    bpp: 4\n  },\n  [33323]: {\n    gl2: true,\n    bpp: 2\n  },\n  [33336]: {\n    gl2: true,\n    bpp: 2\n  },\n  [33335]: {\n    gl2: true,\n    bpp: 2\n  },\n  [33338]: {\n    gl2: true,\n    bpp: 4\n  },\n  [33337]: {\n    gl2: true,\n    bpp: 4\n  },\n  [33340]: {\n    gl2: true,\n    bpp: 8\n  },\n  [33339]: {\n    gl2: true,\n    bpp: 8\n  },\n  [32849]: {\n    gl2: true,\n    bpp: 3\n  },\n  [32856]: {\n    gl2: true,\n    bpp: 4\n  },\n  [32857]: {\n    gl2: true,\n    bpp: 4\n  },\n  [36220]: {\n    gl2: true,\n    bpp: 4\n  },\n  [36238]: {\n    gl2: true,\n    bpp: 4\n  },\n  [36975]: {\n    gl2: true,\n    bpp: 4\n  },\n  [36214]: {\n    gl2: true,\n    bpp: 8\n  },\n  [36232]: {\n    gl2: true,\n    bpp: 8\n  },\n  [36226]: {\n    gl2: true,\n    bpp: 16\n  },\n  [36208]: {\n    gl2: true,\n    bpp: 16\n  },\n  [33325]: {\n    gl2: EXT_FLOAT_WEBGL2,\n    bpp: 2\n  },\n  [33327]: {\n    gl2: EXT_FLOAT_WEBGL2,\n    bpp: 4\n  },\n  [34842]: {\n    gl2: EXT_FLOAT_WEBGL2,\n    bpp: 8\n  },\n  [33326]: {\n    gl2: EXT_FLOAT_WEBGL2,\n    bpp: 4\n  },\n  [33328]: {\n    gl2: EXT_FLOAT_WEBGL2,\n    bpp: 8\n  },\n  [34836]: {\n    gl2: EXT_FLOAT_WEBGL2,\n    bpp: 16\n  },\n  [35898]: {\n    gl2: EXT_FLOAT_WEBGL2,\n    bpp: 4\n  }\n};\n//# sourceMappingURL=renderbuffer-formats.js.map","import Resource from './resource';\nimport RENDERBUFFER_FORMATS from './renderbuffer-formats';\nimport { isWebGL2 } from '@luma.gl/gltools';\nimport { assert } from '../utils/assert';\n\nfunction isFormatSupported(gl, format, formats) {\n  const info = formats[format];\n\n  if (!info) {\n    return false;\n  }\n\n  const value = isWebGL2(gl) ? info.gl2 || info.gl1 : info.gl1;\n\n  if (typeof value === 'string') {\n    return gl.getExtension(value);\n  }\n\n  return value;\n}\n\nexport default class Renderbuffer extends Resource {\n  get [Symbol.toStringTag]() {\n    return 'Renderbuffer';\n  }\n\n  static isSupported(gl) {\n    let {\n      format\n    } = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {\n      format: null\n    };\n    return !format || isFormatSupported(gl, format, RENDERBUFFER_FORMATS);\n  }\n\n  static getSamplesForFormat(gl, _ref) {\n    let {\n      format\n    } = _ref;\n    return gl.getInternalformatParameter(36161, format, 32937);\n  }\n\n  constructor(gl) {\n    let opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    super(gl, opts);\n    this.initialize(opts);\n    Object.seal(this);\n  }\n\n  initialize(_ref2) {\n    let {\n      format,\n      width = 1,\n      height = 1,\n      samples = 0\n    } = _ref2;\n    assert(format, 'Needs format');\n\n    this._trackDeallocatedMemory();\n\n    this.gl.bindRenderbuffer(36161, this.handle);\n\n    if (samples !== 0 && isWebGL2(this.gl)) {\n      this.gl.renderbufferStorageMultisample(36161, samples, format, width, height);\n    } else {\n      this.gl.renderbufferStorage(36161, format, width, height);\n    }\n\n    this.format = format;\n    this.width = width;\n    this.height = height;\n    this.samples = samples;\n\n    this._trackAllocatedMemory(this.width * this.height * (this.samples || 1) * RENDERBUFFER_FORMATS[this.format].bpp);\n\n    return this;\n  }\n\n  resize(_ref3) {\n    let {\n      width,\n      height\n    } = _ref3;\n\n    if (width !== this.width || height !== this.height) {\n      return this.initialize({\n        width,\n        height,\n        format: this.format,\n        samples: this.samples\n      });\n    }\n\n    return this;\n  }\n\n  _createHandle() {\n    return this.gl.createRenderbuffer();\n  }\n\n  _deleteHandle() {\n    this.gl.deleteRenderbuffer(this.handle);\n\n    this._trackDeallocatedMemory();\n  }\n\n  _bindHandle(handle) {\n    this.gl.bindRenderbuffer(36161, handle);\n  }\n\n  _syncHandle(handle) {\n    this.format = this.getParameter(36164);\n    this.width = this.getParameter(36162);\n    this.height = this.getParameter(36163);\n    this.samples = this.getParameter(36011);\n  }\n\n  _getParameter(pname) {\n    this.gl.bindRenderbuffer(36161, this.handle);\n    const value = this.gl.getRenderbufferParameter(36161, pname);\n    return value;\n  }\n\n}\n//# sourceMappingURL=renderbuffer.js.map","import { assertWebGL2Context, withParameters } from '@luma.gl/gltools';\nimport { assert } from '../utils/assert';\nconst GL_DEPTH_BUFFER_BIT = 0x00000100;\nconst GL_STENCIL_BUFFER_BIT = 0x00000400;\nconst GL_COLOR_BUFFER_BIT = 0x00004000;\nconst GL_COLOR = 0x1800;\nconst GL_DEPTH = 0x1801;\nconst GL_STENCIL = 0x1802;\nconst GL_DEPTH_STENCIL = 0x84f9;\nconst ERR_ARGUMENTS = 'clear: bad arguments';\nexport function clear(gl) {\n  let {\n    framebuffer = null,\n    color = null,\n    depth = null,\n    stencil = null\n  } = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  const parameters = {};\n\n  if (framebuffer) {\n    parameters.framebuffer = framebuffer;\n  }\n\n  let clearFlags = 0;\n\n  if (color) {\n    clearFlags |= GL_COLOR_BUFFER_BIT;\n\n    if (color !== true) {\n      parameters.clearColor = color;\n    }\n  }\n\n  if (depth) {\n    clearFlags |= GL_DEPTH_BUFFER_BIT;\n\n    if (depth !== true) {\n      parameters.clearDepth = depth;\n    }\n  }\n\n  if (stencil) {\n    clearFlags |= GL_STENCIL_BUFFER_BIT;\n\n    if (depth !== true) {\n      parameters.clearStencil = depth;\n    }\n  }\n\n  assert(clearFlags !== 0, ERR_ARGUMENTS);\n  withParameters(gl, parameters, () => {\n    gl.clear(clearFlags);\n  });\n}\nexport function clearBuffer(gl) {\n  let {\n    framebuffer = null,\n    buffer = GL_COLOR,\n    drawBuffer = 0,\n    value = [0, 0, 0, 0]\n  } = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  assertWebGL2Context(gl);\n  withParameters(gl, {\n    framebuffer\n  }, () => {\n    switch (buffer) {\n      case GL_COLOR:\n        switch (value.constructor) {\n          case Int32Array:\n            gl.clearBufferiv(buffer, drawBuffer, value);\n            break;\n\n          case Uint32Array:\n            gl.clearBufferuiv(buffer, drawBuffer, value);\n            break;\n\n          case Float32Array:\n          default:\n            gl.clearBufferfv(buffer, drawBuffer, value);\n        }\n\n        break;\n\n      case GL_DEPTH:\n        gl.clearBufferfv(GL_DEPTH, 0, [value]);\n        break;\n\n      case GL_STENCIL:\n        gl.clearBufferiv(GL_STENCIL, 0, [value]);\n        break;\n\n      case GL_DEPTH_STENCIL:\n        const [depth, stencil] = value;\n        gl.clearBufferfi(GL_DEPTH_STENCIL, 0, depth, stencil);\n        break;\n\n      default:\n        assert(false, ERR_ARGUMENTS);\n    }\n  });\n}\n//# sourceMappingURL=clear.js.map","import { assert } from '../utils/assert';\nexport function glFormatToComponents(format) {\n  switch (format) {\n    case 6406:\n    case 33326:\n    case 6403:\n      return 1;\n\n    case 33328:\n    case 33319:\n      return 2;\n\n    case 6407:\n    case 34837:\n      return 3;\n\n    case 6408:\n    case 34836:\n      return 4;\n\n    default:\n      assert(false);\n      return 0;\n  }\n}\nexport function glTypeToBytes(type) {\n  switch (type) {\n    case 5121:\n      return 1;\n\n    case 33635:\n    case 32819:\n    case 32820:\n      return 2;\n\n    case 5126:\n      return 4;\n\n    default:\n      assert(false);\n      return 0;\n  }\n}\n//# sourceMappingURL=format-utils.js.map","import Buffer from './buffer';\nimport Framebuffer from './framebuffer';\nimport Texture from './texture';\nimport { assertWebGL2Context, withParameters, log } from '@luma.gl/gltools';\nimport { flipRows, scalePixels } from '../webgl-utils/typed-array-utils';\nimport { getTypedArrayFromGLType, getGLTypeFromTypedArray } from '../webgl-utils/typed-array-utils';\nimport { glFormatToComponents, glTypeToBytes } from '../webgl-utils/format-utils';\nimport { toFramebuffer } from '../webgl-utils/texture-utils';\nimport { assert } from '../utils/assert';\nexport function readPixelsToArray(source) {\n  let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  const {\n    sourceX = 0,\n    sourceY = 0,\n    sourceFormat = 6408\n  } = options;\n  let {\n    sourceAttachment = 36064,\n    target = null,\n    sourceWidth,\n    sourceHeight,\n    sourceType\n  } = options;\n  const {\n    framebuffer,\n    deleteFramebuffer\n  } = getFramebuffer(source);\n  assert(framebuffer);\n  const {\n    gl,\n    handle,\n    attachments\n  } = framebuffer;\n  sourceWidth = sourceWidth || framebuffer.width;\n  sourceHeight = sourceHeight || framebuffer.height;\n\n  if (sourceAttachment === 36064 && handle === null) {\n    sourceAttachment = 1028;\n  }\n\n  assert(attachments[sourceAttachment]);\n  sourceType = sourceType || attachments[sourceAttachment].type;\n  target = getPixelArray(target, sourceType, sourceFormat, sourceWidth, sourceHeight);\n  sourceType = sourceType || getGLTypeFromTypedArray(target);\n  const prevHandle = gl.bindFramebuffer(36160, handle);\n  gl.readPixels(sourceX, sourceY, sourceWidth, sourceHeight, sourceFormat, sourceType, target);\n  gl.bindFramebuffer(36160, prevHandle || null);\n\n  if (deleteFramebuffer) {\n    framebuffer.delete();\n  }\n\n  return target;\n}\nexport function readPixelsToBuffer(source, _ref) {\n  let {\n    sourceX = 0,\n    sourceY = 0,\n    sourceFormat = 6408,\n    target = null,\n    targetByteOffset = 0,\n    sourceWidth,\n    sourceHeight,\n    sourceType\n  } = _ref;\n  const {\n    framebuffer,\n    deleteFramebuffer\n  } = getFramebuffer(source);\n  assert(framebuffer);\n  sourceWidth = sourceWidth || framebuffer.width;\n  sourceHeight = sourceHeight || framebuffer.height;\n  const gl2 = assertWebGL2Context(framebuffer.gl);\n  sourceType = sourceType || (target ? target.type : 5121);\n\n  if (!target) {\n    const components = glFormatToComponents(sourceFormat);\n    const byteCount = glTypeToBytes(sourceType);\n    const byteLength = targetByteOffset + sourceWidth * sourceHeight * components * byteCount;\n    target = new Buffer(gl2, {\n      byteLength,\n      accessor: {\n        type: sourceType,\n        size: components\n      }\n    });\n  }\n\n  target.bind({\n    target: 35051\n  });\n  withParameters(gl2, {\n    framebuffer\n  }, () => {\n    gl2.readPixels(sourceX, sourceY, sourceWidth, sourceHeight, sourceFormat, sourceType, targetByteOffset);\n  });\n  target.unbind({\n    target: 35051\n  });\n\n  if (deleteFramebuffer) {\n    framebuffer.delete();\n  }\n\n  return target;\n}\nexport function copyToDataUrl(source) {\n  let {\n    sourceAttachment = 36064,\n    targetMaxHeight = Number.MAX_SAFE_INTEGER\n  } = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  let data = readPixelsToArray(source, {\n    sourceAttachment\n  });\n  let {\n    width,\n    height\n  } = source;\n\n  while (height > targetMaxHeight) {\n    ({\n      data,\n      width,\n      height\n    } = scalePixels({\n      data,\n      width,\n      height\n    }));\n  }\n\n  flipRows({\n    data,\n    width,\n    height\n  });\n  const canvas = document.createElement('canvas');\n  canvas.width = width;\n  canvas.height = height;\n  const context = canvas.getContext('2d');\n  const imageData = context.createImageData(width, height);\n  imageData.data.set(data);\n  context.putImageData(imageData, 0, 0);\n  return canvas.toDataURL();\n}\nexport function copyToImage(source) {\n  let {\n    sourceAttachment = 36064,\n    targetImage = null\n  } = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  const dataUrl = copyToDataUrl(source, {\n    sourceAttachment\n  });\n  targetImage = targetImage || new Image();\n  targetImage.src = dataUrl;\n  return targetImage;\n}\nexport function copyToTexture(source, target) {\n  let options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  const {\n    sourceX = 0,\n    sourceY = 0,\n    targetMipmaplevel = 0,\n    targetInternalFormat = 6408\n  } = options;\n  let {\n    targetX,\n    targetY,\n    targetZ,\n    width,\n    height\n  } = options;\n  const {\n    framebuffer,\n    deleteFramebuffer\n  } = getFramebuffer(source);\n  assert(framebuffer);\n  const {\n    gl,\n    handle\n  } = framebuffer;\n  const isSubCopy = typeof targetX !== 'undefined' || typeof targetY !== 'undefined' || typeof targetZ !== 'undefined';\n  targetX = targetX || 0;\n  targetY = targetY || 0;\n  targetZ = targetZ || 0;\n  const prevHandle = gl.bindFramebuffer(36160, handle);\n  assert(target);\n  let texture = null;\n\n  if (target instanceof Texture) {\n    texture = target;\n    width = Number.isFinite(width) ? width : texture.width;\n    height = Number.isFinite(height) ? height : texture.height;\n    texture.bind(0);\n    target = texture.target;\n  }\n\n  if (!isSubCopy) {\n    gl.copyTexImage2D(target, targetMipmaplevel, targetInternalFormat, sourceX, sourceY, width, height, 0);\n  } else {\n    switch (target) {\n      case 3553:\n      case 34067:\n        gl.copyTexSubImage2D(target, targetMipmaplevel, targetX, targetY, sourceX, sourceY, width, height);\n        break;\n\n      case 35866:\n      case 32879:\n        const gl2 = assertWebGL2Context(gl);\n        gl2.copyTexSubImage3D(target, targetMipmaplevel, targetX, targetY, targetZ, sourceX, sourceY, width, height);\n        break;\n\n      default:\n    }\n  }\n\n  if (texture) {\n    texture.unbind();\n  }\n\n  gl.bindFramebuffer(36160, prevHandle || null);\n\n  if (deleteFramebuffer) {\n    framebuffer.delete();\n  }\n\n  return texture;\n}\nexport function blit(source, target) {\n  let options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  const {\n    sourceX0 = 0,\n    sourceY0 = 0,\n    targetX0 = 0,\n    targetY0 = 0,\n    color = true,\n    depth = false,\n    stencil = false,\n    filter = 9728\n  } = options;\n  let {\n    sourceX1,\n    sourceY1,\n    targetX1,\n    targetY1,\n    sourceAttachment = 36064,\n    mask = 0\n  } = options;\n  const {\n    framebuffer: srcFramebuffer,\n    deleteFramebuffer: deleteSrcFramebuffer\n  } = getFramebuffer(source);\n  const {\n    framebuffer: dstFramebuffer,\n    deleteFramebuffer: deleteDstFramebuffer\n  } = getFramebuffer(target);\n  assert(srcFramebuffer);\n  assert(dstFramebuffer);\n  const {\n    gl,\n    handle,\n    width,\n    height,\n    readBuffer\n  } = dstFramebuffer;\n  const gl2 = assertWebGL2Context(gl);\n\n  if (!srcFramebuffer.handle && sourceAttachment === 36064) {\n    sourceAttachment = 1028;\n  }\n\n  if (color) {\n    mask |= 16384;\n  }\n\n  if (depth) {\n    mask |= 256;\n  }\n\n  if (stencil) {\n    mask |= 1024;\n  }\n\n  if (deleteSrcFramebuffer || deleteDstFramebuffer) {\n    if (mask & (256 | 1024)) {\n      mask = 16384;\n      log.warn('Blitting from or into a Texture object, forcing mask to GL.COLOR_BUFFER_BIT')();\n    }\n  }\n\n  assert(mask);\n  sourceX1 = sourceX1 === undefined ? srcFramebuffer.width : sourceX1;\n  sourceY1 = sourceY1 === undefined ? srcFramebuffer.height : sourceY1;\n  targetX1 = targetX1 === undefined ? width : targetX1;\n  targetY1 = targetY1 === undefined ? height : targetY1;\n  const prevDrawHandle = gl.bindFramebuffer(36009, handle);\n  const prevReadHandle = gl.bindFramebuffer(36008, srcFramebuffer.handle);\n  gl2.readBuffer(sourceAttachment);\n  gl2.blitFramebuffer(sourceX0, sourceY0, sourceX1, sourceY1, targetX0, targetY0, targetX1, targetY1, mask, filter);\n  gl2.readBuffer(readBuffer);\n  gl2.bindFramebuffer(36008, prevReadHandle || null);\n  gl2.bindFramebuffer(36009, prevDrawHandle || null);\n\n  if (deleteSrcFramebuffer) {\n    srcFramebuffer.delete();\n  }\n\n  if (deleteDstFramebuffer) {\n    dstFramebuffer.delete();\n  }\n\n  return dstFramebuffer;\n}\n\nfunction getFramebuffer(source) {\n  if (!(source instanceof Framebuffer)) {\n    return {\n      framebuffer: toFramebuffer(source),\n      deleteFramebuffer: true\n    };\n  }\n\n  return {\n    framebuffer: source,\n    deleteFramebuffer: false\n  };\n}\n\nfunction getPixelArray(pixelArray, type, format, width, height) {\n  if (pixelArray) {\n    return pixelArray;\n  }\n\n  type = type || 5121;\n  const ArrayType = getTypedArrayFromGLType(type, {\n    clamped: false\n  });\n  const components = glFormatToComponents(format);\n  return new ArrayType(width * height * components);\n}\n//# sourceMappingURL=copy-and-blit.js.map","import Framebuffer from '../classes/framebuffer';\nimport Texture2D from '../classes/texture-2d';\nexport const FEATURES = {\n  WEBGL2: 'WEBGL2',\n  VERTEX_ARRAY_OBJECT: 'VERTEX_ARRAY_OBJECT',\n  TIMER_QUERY: 'TIMER_QUERY',\n  INSTANCED_RENDERING: 'INSTANCED_RENDERING',\n  MULTIPLE_RENDER_TARGETS: 'MULTIPLE_RENDER_TARGETS',\n  ELEMENT_INDEX_UINT32: 'ELEMENT_INDEX_UINT32',\n  BLEND_EQUATION_MINMAX: 'BLEND_EQUATION_MINMAX',\n  FLOAT_BLEND: 'FLOAT_BLEND',\n  COLOR_ENCODING_SRGB: 'COLOR_ENCODING_SRGB',\n  TEXTURE_DEPTH: 'TEXTURE_DEPTH',\n  TEXTURE_FLOAT: 'TEXTURE_FLOAT',\n  TEXTURE_HALF_FLOAT: 'TEXTURE_HALF_FLOAT',\n  TEXTURE_FILTER_LINEAR_FLOAT: 'TEXTURE_FILTER_LINEAR_FLOAT',\n  TEXTURE_FILTER_LINEAR_HALF_FLOAT: 'TEXTURE_FILTER_LINEAR_HALF_FLOAT',\n  TEXTURE_FILTER_ANISOTROPIC: 'TEXTURE_FILTER_ANISOTROPIC',\n  COLOR_ATTACHMENT_RGBA32F: 'COLOR_ATTACHMENT_RGBA32F',\n  COLOR_ATTACHMENT_FLOAT: 'COLOR_ATTACHMENT_FLOAT',\n  COLOR_ATTACHMENT_HALF_FLOAT: 'COLOR_ATTACHMENT_HALF_FLOAT',\n  GLSL_FRAG_DATA: 'GLSL_FRAG_DATA',\n  GLSL_FRAG_DEPTH: 'GLSL_FRAG_DEPTH',\n  GLSL_DERIVATIVES: 'GLSL_DERIVATIVES',\n  GLSL_TEXTURE_LOD: 'GLSL_TEXTURE_LOD'\n};\n\nfunction checkFloat32ColorAttachment(gl) {\n  const testTexture = new Texture2D(gl, {\n    format: 6408,\n    type: 5126,\n    dataFormat: 6408\n  });\n  const testFb = new Framebuffer(gl, {\n    id: \"test-framebuffer\",\n    check: false,\n    attachments: {\n      [36064]: testTexture\n    }\n  });\n  const status = testFb.getStatus();\n  testTexture.delete();\n  testFb.delete();\n  return status === 36053;\n}\n\nexport default {\n  [FEATURES.WEBGL2]: [false, true],\n  [FEATURES.VERTEX_ARRAY_OBJECT]: ['OES_vertex_array_object', true],\n  [FEATURES.TIMER_QUERY]: ['EXT_disjoint_timer_query', 'EXT_disjoint_timer_query_webgl2'],\n  [FEATURES.INSTANCED_RENDERING]: ['ANGLE_instanced_arrays', true],\n  [FEATURES.MULTIPLE_RENDER_TARGETS]: ['WEBGL_draw_buffers', true],\n  [FEATURES.ELEMENT_INDEX_UINT32]: ['OES_element_index_uint', true],\n  [FEATURES.BLEND_EQUATION_MINMAX]: ['EXT_blend_minmax', true],\n  [FEATURES.FLOAT_BLEND]: ['EXT_float_blend'],\n  [FEATURES.COLOR_ENCODING_SRGB]: ['EXT_sRGB', true],\n  [FEATURES.TEXTURE_DEPTH]: ['WEBGL_depth_texture', true],\n  [FEATURES.TEXTURE_FLOAT]: ['OES_texture_float', true],\n  [FEATURES.TEXTURE_HALF_FLOAT]: ['OES_texture_half_float', true],\n  [FEATURES.TEXTURE_FILTER_LINEAR_FLOAT]: ['OES_texture_float_linear'],\n  [FEATURES.TEXTURE_FILTER_LINEAR_HALF_FLOAT]: ['OES_texture_half_float_linear'],\n  [FEATURES.TEXTURE_FILTER_ANISOTROPIC]: ['EXT_texture_filter_anisotropic'],\n  [FEATURES.COLOR_ATTACHMENT_RGBA32F]: [checkFloat32ColorAttachment, 'EXT_color_buffer_float'],\n  [FEATURES.COLOR_ATTACHMENT_FLOAT]: [false, 'EXT_color_buffer_float'],\n  [FEATURES.COLOR_ATTACHMENT_HALF_FLOAT]: ['EXT_color_buffer_half_float'],\n  [FEATURES.GLSL_FRAG_DATA]: ['WEBGL_draw_buffers', true],\n  [FEATURES.GLSL_FRAG_DEPTH]: ['EXT_frag_depth', true],\n  [FEATURES.GLSL_DERIVATIVES]: ['OES_standard_derivatives', true],\n  [FEATURES.GLSL_TEXTURE_LOD]: ['EXT_shader_texture_lod', true]\n};\n//# sourceMappingURL=webgl-features-table.js.map","import WEBGL_FEATURES from './webgl-features-table';\nimport { isWebGL2, log } from '@luma.gl/gltools';\nimport { assert } from '../utils/assert';\nconst LOG_UNSUPPORTED_FEATURE = 2;\nexport function hasFeature(gl, feature) {\n  return hasFeatures(gl, feature);\n}\nexport function hasFeatures(gl, features) {\n  features = Array.isArray(features) ? features : [features];\n  return features.every(feature => {\n    return isFeatureSupported(gl, feature);\n  });\n}\nexport function getFeatures(gl) {\n  gl.luma = gl.luma || {};\n  gl.luma.caps = gl.luma.caps || {};\n\n  for (const cap in WEBGL_FEATURES) {\n    if (gl.luma.caps[cap] === undefined) {\n      gl.luma.caps[cap] = isFeatureSupported(gl, cap);\n    }\n  }\n\n  return gl.luma.caps;\n}\n\nfunction isFeatureSupported(gl, cap) {\n  gl.luma = gl.luma || {};\n  gl.luma.caps = gl.luma.caps || {};\n\n  if (gl.luma.caps[cap] === undefined) {\n    gl.luma.caps[cap] = queryFeature(gl, cap);\n  }\n\n  if (!gl.luma.caps[cap]) {\n    log.log(LOG_UNSUPPORTED_FEATURE, \"Feature: \".concat(cap, \" not supported\"))();\n  }\n\n  return gl.luma.caps[cap];\n}\n\nfunction queryFeature(gl, cap) {\n  const feature = WEBGL_FEATURES[cap];\n  assert(feature, cap);\n  let isSupported;\n  const featureDefinition = isWebGL2(gl) ? feature[1] || feature[0] : feature[0];\n\n  if (typeof featureDefinition === 'function') {\n    isSupported = featureDefinition(gl);\n  } else if (Array.isArray(featureDefinition)) {\n    isSupported = true;\n\n    for (const extension of featureDefinition) {\n      isSupported = isSupported && Boolean(gl.getExtension(extension));\n    }\n  } else if (typeof featureDefinition === 'string') {\n    isSupported = Boolean(gl.getExtension(featureDefinition));\n  } else if (typeof featureDefinition === 'boolean') {\n    isSupported = featureDefinition;\n  } else {\n    assert(false);\n  }\n\n  return isSupported;\n}\n//# sourceMappingURL=features.js.map","import { getWebGL2Context, assertWebGL2Context, log } from '@luma.gl/gltools';\nimport Resource from './resource';\nimport Texture2D from './texture-2d';\nimport Renderbuffer from './renderbuffer';\nimport { clear, clearBuffer } from './clear';\nimport { copyToDataUrl } from './copy-and-blit.js';\nimport { getFeatures } from '../features';\nimport { getKey } from '../webgl-utils/constants-to-keys';\nimport { assert } from '../utils/assert';\nconst ERR_MULTIPLE_RENDERTARGETS = 'Multiple render targets not supported';\nexport default class Framebuffer extends Resource {\n  get [Symbol.toStringTag]() {\n    return 'Framebuffer';\n  }\n\n  static isSupported(gl) {\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    const {\n      colorBufferFloat,\n      colorBufferHalfFloat\n    } = options;\n    let supported = true;\n\n    if (colorBufferFloat) {\n      supported = Boolean(gl.getExtension('EXT_color_buffer_float') || gl.getExtension('WEBGL_color_buffer_float') || gl.getExtension('OES_texture_float'));\n    }\n\n    if (colorBufferHalfFloat) {\n      supported = supported && Boolean(gl.getExtension('EXT_color_buffer_float') || gl.getExtension('EXT_color_buffer_half_float'));\n    }\n\n    return supported;\n  }\n\n  static getDefaultFramebuffer(gl) {\n    gl.luma = gl.luma || {};\n    gl.luma.defaultFramebuffer = gl.luma.defaultFramebuffer || new Framebuffer(gl, {\n      id: 'default-framebuffer',\n      handle: null,\n      attachments: {}\n    });\n    return gl.luma.defaultFramebuffer;\n  }\n\n  get MAX_COLOR_ATTACHMENTS() {\n    const gl2 = assertWebGL2Context(this.gl);\n    return gl2.getParameter(gl2.MAX_COLOR_ATTACHMENTS);\n  }\n\n  get MAX_DRAW_BUFFERS() {\n    const gl2 = assertWebGL2Context(this.gl);\n    return gl2.getParameter(gl2.MAX_DRAW_BUFFERS);\n  }\n\n  constructor(gl) {\n    let opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    super(gl, opts);\n    this.width = null;\n    this.height = null;\n    this.attachments = {};\n    this.readBuffer = 36064;\n    this.drawBuffers = [36064];\n    this.ownResources = [];\n    this.initialize(opts);\n    Object.seal(this);\n  }\n\n  get color() {\n    return this.attachments[36064] || null;\n  }\n\n  get texture() {\n    return this.attachments[36064] || null;\n  }\n\n  get depth() {\n    return this.attachments[36096] || this.attachments[33306] || null;\n  }\n\n  get stencil() {\n    return this.attachments[36128] || this.attachments[33306] || null;\n  }\n\n  initialize(_ref) {\n    let {\n      width = 1,\n      height = 1,\n      attachments = null,\n      color = true,\n      depth = true,\n      stencil = false,\n      check = true,\n      readBuffer = undefined,\n      drawBuffers = undefined\n    } = _ref;\n    assert(width >= 0 && height >= 0, 'Width and height need to be integers');\n    this.width = width;\n    this.height = height;\n\n    if (attachments) {\n      for (const attachment in attachments) {\n        const target = attachments[attachment];\n        const object = Array.isArray(target) ? target[0] : target;\n        object.resize({\n          width,\n          height\n        });\n      }\n    } else {\n      attachments = this._createDefaultAttachments(color, depth, stencil, width, height);\n    }\n\n    this.update({\n      clearAttachments: true,\n      attachments,\n      readBuffer,\n      drawBuffers\n    });\n\n    if (attachments && check) {\n      this.checkStatus();\n    }\n  }\n\n  delete() {\n    for (const resource of this.ownResources) {\n      resource.delete();\n    }\n\n    super.delete();\n    return this;\n  }\n\n  update(_ref2) {\n    let {\n      attachments = {},\n      readBuffer,\n      drawBuffers,\n      clearAttachments = false,\n      resizeAttachments = true\n    } = _ref2;\n    this.attach(attachments, {\n      clearAttachments,\n      resizeAttachments\n    });\n    const {\n      gl\n    } = this;\n    const prevHandle = gl.bindFramebuffer(36160, this.handle);\n\n    if (readBuffer) {\n      this._setReadBuffer(readBuffer);\n    }\n\n    if (drawBuffers) {\n      this._setDrawBuffers(drawBuffers);\n    }\n\n    gl.bindFramebuffer(36160, prevHandle || null);\n    return this;\n  }\n\n  resize() {\n    let options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    let {\n      width,\n      height\n    } = options;\n\n    if (this.handle === null) {\n      assert(width === undefined && height === undefined);\n      this.width = this.gl.drawingBufferWidth;\n      this.height = this.gl.drawingBufferHeight;\n      return this;\n    }\n\n    if (width === undefined) {\n      width = this.gl.drawingBufferWidth;\n    }\n\n    if (height === undefined) {\n      height = this.gl.drawingBufferHeight;\n    }\n\n    if (width !== this.width && height !== this.height) {\n      log.log(2, \"Resizing framebuffer \".concat(this.id, \" to \").concat(width, \"x\").concat(height))();\n    }\n\n    for (const attachmentPoint in this.attachments) {\n      this.attachments[attachmentPoint].resize({\n        width,\n        height\n      });\n    }\n\n    this.width = width;\n    this.height = height;\n    return this;\n  }\n\n  attach(attachments) {\n    let {\n      clearAttachments = false,\n      resizeAttachments = true\n    } = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    const newAttachments = {};\n\n    if (clearAttachments) {\n      Object.keys(this.attachments).forEach(key => {\n        newAttachments[key] = null;\n      });\n    }\n\n    Object.assign(newAttachments, attachments);\n    const prevHandle = this.gl.bindFramebuffer(36160, this.handle);\n\n    for (const key in newAttachments) {\n      assert(key !== undefined, 'Misspelled framebuffer binding point?');\n      const attachment = Number(key);\n      const descriptor = newAttachments[attachment];\n      let object = descriptor;\n\n      if (!object) {\n        this._unattach(attachment);\n      } else if (object instanceof Renderbuffer) {\n        this._attachRenderbuffer({\n          attachment,\n          renderbuffer: object\n        });\n      } else if (Array.isArray(descriptor)) {\n        const [texture, layer = 0, level = 0] = descriptor;\n        object = texture;\n\n        this._attachTexture({\n          attachment,\n          texture,\n          layer,\n          level\n        });\n      } else {\n        this._attachTexture({\n          attachment,\n          texture: object,\n          layer: 0,\n          level: 0\n        });\n      }\n\n      if (resizeAttachments && object) {\n        object.resize({\n          width: this.width,\n          height: this.height\n        });\n      }\n    }\n\n    this.gl.bindFramebuffer(36160, prevHandle || null);\n    Object.assign(this.attachments, attachments);\n    Object.keys(this.attachments).filter(key => !this.attachments[key]).forEach(key => {\n      delete this.attachments[key];\n    });\n  }\n\n  checkStatus() {\n    const {\n      gl\n    } = this;\n    const status = this.getStatus();\n\n    if (status !== 36053) {\n      throw new Error(_getFrameBufferStatus(status));\n    }\n\n    return this;\n  }\n\n  getStatus() {\n    const {\n      gl\n    } = this;\n    const prevHandle = gl.bindFramebuffer(36160, this.handle);\n    const status = gl.checkFramebufferStatus(36160);\n    gl.bindFramebuffer(36160, prevHandle || null);\n    return status;\n  }\n\n  clear() {\n    let options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    const {\n      color,\n      depth,\n      stencil,\n      drawBuffers = []\n    } = options;\n    const prevHandle = this.gl.bindFramebuffer(36160, this.handle);\n\n    if (color || depth || stencil) {\n      clear(this.gl, {\n        color,\n        depth,\n        stencil\n      });\n    }\n\n    drawBuffers.forEach((value, drawBuffer) => {\n      clearBuffer(this.gl, {\n        drawBuffer,\n        value\n      });\n    });\n    this.gl.bindFramebuffer(36160, prevHandle || null);\n    return this;\n  }\n\n  readPixels() {\n    let opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    log.error('Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)')();\n    return null;\n  }\n\n  readPixelsToBuffer() {\n    let opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    log.error('Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)')();\n    return null;\n  }\n\n  copyToDataUrl() {\n    let opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    log.error('Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)')();\n    return null;\n  }\n\n  copyToImage() {\n    let opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    log.error('Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)')();\n    return null;\n  }\n\n  copyToTexture() {\n    let opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    log.error('Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})')();\n    return null;\n  }\n\n  blit() {\n    let opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    log.error('Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)')();\n    return null;\n  }\n\n  invalidate(_ref3) {\n    let {\n      attachments = [],\n      x = 0,\n      y = 0,\n      width,\n      height\n    } = _ref3;\n    const gl2 = assertWebGL2Context(this.gl);\n    const prevHandle = gl2.bindFramebuffer(36008, this.handle);\n    const invalidateAll = x === 0 && y === 0 && width === undefined && height === undefined;\n\n    if (invalidateAll) {\n      gl2.invalidateFramebuffer(36008, attachments);\n    } else {\n      gl2.invalidateFramebuffer(36008, attachments, x, y, width, height);\n    }\n\n    gl2.bindFramebuffer(36008, prevHandle);\n    return this;\n  }\n\n  getAttachmentParameter(attachment, pname, keys) {\n    let value = this._getAttachmentParameterFallback(pname);\n\n    if (value === null) {\n      this.gl.bindFramebuffer(36160, this.handle);\n      value = this.gl.getFramebufferAttachmentParameter(36160, attachment, pname);\n      this.gl.bindFramebuffer(36160, null);\n    }\n\n    if (keys && value > 1000) {\n      value = getKey(this.gl, value);\n    }\n\n    return value;\n  }\n\n  getAttachmentParameters() {\n    let attachment = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 36064;\n    let keys = arguments.length > 1 ? arguments[1] : undefined;\n    let parameters = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : this.constructor.ATTACHMENT_PARAMETERS || [];\n    const values = {};\n\n    for (const pname of parameters) {\n      const key = keys ? getKey(this.gl, pname) : pname;\n      values[key] = this.getAttachmentParameter(attachment, pname, keys);\n    }\n\n    return values;\n  }\n\n  getParameters() {\n    let keys = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n    const attachments = Object.keys(this.attachments);\n    const parameters = {};\n\n    for (const attachmentName of attachments) {\n      const attachment = Number(attachmentName);\n      const key = keys ? getKey(this.gl, attachment) : attachment;\n      parameters[key] = this.getAttachmentParameters(attachment, keys);\n    }\n\n    return parameters;\n  }\n\n  show() {\n    if (typeof window !== 'undefined') {\n      window.open(copyToDataUrl(this), 'luma-debug-texture');\n    }\n\n    return this;\n  }\n\n  log() {\n    let logLevel = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n    let message = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n\n    if (logLevel > log.level || typeof window === 'undefined') {\n      return this;\n    }\n\n    message = message || \"Framebuffer \".concat(this.id);\n    const image = copyToDataUrl(this, {\n      targetMaxHeight: 100\n    });\n    log.image({\n      logLevel,\n      message,\n      image\n    }, message)();\n    return this;\n  }\n\n  bind() {\n    let {\n      target = 36160\n    } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    this.gl.bindFramebuffer(target, this.handle);\n    return this;\n  }\n\n  unbind() {\n    let {\n      target = 36160\n    } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    this.gl.bindFramebuffer(target, null);\n    return this;\n  }\n\n  _createDefaultAttachments(color, depth, stencil, width, height) {\n    let defaultAttachments = null;\n\n    if (color) {\n      defaultAttachments = defaultAttachments || {};\n      defaultAttachments[36064] = new Texture2D(this.gl, {\n        id: \"\".concat(this.id, \"-color0\"),\n        pixels: null,\n        format: 6408,\n        type: 5121,\n        width,\n        height,\n        mipmaps: false,\n        parameters: {\n          [10241]: 9729,\n          [10240]: 9729,\n          [10242]: 33071,\n          [10243]: 33071\n        }\n      });\n      this.ownResources.push(defaultAttachments[36064]);\n    }\n\n    if (depth && stencil) {\n      defaultAttachments = defaultAttachments || {};\n      defaultAttachments[33306] = new Renderbuffer(this.gl, {\n        id: \"\".concat(this.id, \"-depth-stencil\"),\n        format: 35056,\n        width,\n        height: 111\n      });\n      this.ownResources.push(defaultAttachments[33306]);\n    } else if (depth) {\n      defaultAttachments = defaultAttachments || {};\n      defaultAttachments[36096] = new Renderbuffer(this.gl, {\n        id: \"\".concat(this.id, \"-depth\"),\n        format: 33189,\n        width,\n        height\n      });\n      this.ownResources.push(defaultAttachments[36096]);\n    } else if (stencil) {\n      assert(false);\n    }\n\n    return defaultAttachments;\n  }\n\n  _unattach(attachment) {\n    const oldAttachment = this.attachments[attachment];\n\n    if (!oldAttachment) {\n      return;\n    }\n\n    if (oldAttachment instanceof Renderbuffer) {\n      this.gl.framebufferRenderbuffer(36160, attachment, 36161, null);\n    } else {\n      this.gl.framebufferTexture2D(36160, attachment, 3553, null, 0);\n    }\n\n    delete this.attachments[attachment];\n  }\n\n  _attachRenderbuffer(_ref4) {\n    let {\n      attachment = 36064,\n      renderbuffer\n    } = _ref4;\n    const {\n      gl\n    } = this;\n    gl.framebufferRenderbuffer(36160, attachment, 36161, renderbuffer.handle);\n    this.attachments[attachment] = renderbuffer;\n  }\n\n  _attachTexture(_ref5) {\n    let {\n      attachment = 36064,\n      texture,\n      layer,\n      level\n    } = _ref5;\n    const {\n      gl\n    } = this;\n    gl.bindTexture(texture.target, texture.handle);\n\n    switch (texture.target) {\n      case 35866:\n      case 32879:\n        const gl2 = assertWebGL2Context(gl);\n        gl2.framebufferTextureLayer(36160, attachment, texture.target, level, layer);\n        break;\n\n      case 34067:\n        const face = mapIndexToCubeMapFace(layer);\n        gl.framebufferTexture2D(36160, attachment, face, texture.handle, level);\n        break;\n\n      case 3553:\n        gl.framebufferTexture2D(36160, attachment, 3553, texture.handle, level);\n        break;\n\n      default:\n        assert(false, 'Illegal texture type');\n    }\n\n    gl.bindTexture(texture.target, null);\n    this.attachments[attachment] = texture;\n  }\n\n  _setReadBuffer(readBuffer) {\n    const gl2 = getWebGL2Context(this.gl);\n\n    if (gl2) {\n      gl2.readBuffer(readBuffer);\n    } else {\n      assert(readBuffer === 36064 || readBuffer === 1029, ERR_MULTIPLE_RENDERTARGETS);\n    }\n\n    this.readBuffer = readBuffer;\n  }\n\n  _setDrawBuffers(drawBuffers) {\n    const {\n      gl\n    } = this;\n    const gl2 = assertWebGL2Context(gl);\n\n    if (gl2) {\n      gl2.drawBuffers(drawBuffers);\n    } else {\n      const ext = gl.getExtension('WEBGL_draw_buffers');\n\n      if (ext) {\n        ext.drawBuffersWEBGL(drawBuffers);\n      } else {\n        assert(drawBuffers.length === 1 && (drawBuffers[0] === 36064 || drawBuffers[0] === 1029), ERR_MULTIPLE_RENDERTARGETS);\n      }\n    }\n\n    this.drawBuffers = drawBuffers;\n  }\n\n  _getAttachmentParameterFallback(pname) {\n    const caps = getFeatures(this.gl);\n\n    switch (pname) {\n      case 36052:\n        return !caps.WEBGL2 ? 0 : null;\n\n      case 33298:\n      case 33299:\n      case 33300:\n      case 33301:\n      case 33302:\n      case 33303:\n        return !caps.WEBGL2 ? 8 : null;\n\n      case 33297:\n        return !caps.WEBGL2 ? 5125 : null;\n\n      case 33296:\n        return !caps.WEBGL2 && !caps.EXT_sRGB ? 9729 : null;\n\n      default:\n        return null;\n    }\n  }\n\n  _createHandle() {\n    return this.gl.createFramebuffer();\n  }\n\n  _deleteHandle() {\n    this.gl.deleteFramebuffer(this.handle);\n  }\n\n  _bindHandle(handle) {\n    return this.gl.bindFramebuffer(36160, handle);\n  }\n\n}\n\nfunction mapIndexToCubeMapFace(layer) {\n  return layer < 34069 ? layer + 34069 : layer;\n}\n\nfunction _getFrameBufferStatus(status) {\n  const STATUS = Framebuffer.STATUS || {};\n  return STATUS[status] || \"Framebuffer error \".concat(status);\n}\n\nexport const FRAMEBUFFER_ATTACHMENT_PARAMETERS = [36049, 36048, 33296, 33298, 33299, 33300, 33301, 33302, 33303];\nFramebuffer.ATTACHMENT_PARAMETERS = FRAMEBUFFER_ATTACHMENT_PARAMETERS;\n//# sourceMappingURL=framebuffer.js.map","import Texture2D from '../classes/texture-2d';\nimport TextureCube from '../classes/texture-cube';\nimport Texture3D from '../classes/texture-3d';\nimport Framebuffer from '../classes/framebuffer';\nimport { assert } from '../utils/assert';\nexport function cloneTextureFrom(refTexture, overrides) {\n  assert(refTexture instanceof Texture2D || refTexture instanceof TextureCube || refTexture instanceof Texture3D);\n  const TextureType = refTexture.constructor;\n  const {\n    gl,\n    width,\n    height,\n    format,\n    type,\n    dataFormat,\n    border,\n    mipmaps\n  } = refTexture;\n  const textureOptions = Object.assign({\n    width,\n    height,\n    format,\n    type,\n    dataFormat,\n    border,\n    mipmaps\n  }, overrides);\n  return new TextureType(gl, textureOptions);\n}\nexport function toFramebuffer(texture, opts) {\n  const {\n    gl,\n    width,\n    height,\n    id\n  } = texture;\n  const framebuffer = new Framebuffer(gl, Object.assign({}, opts, {\n    id: \"framebuffer-for-\".concat(id),\n    width,\n    height,\n    attachments: {\n      [36064]: texture\n    }\n  }));\n  return framebuffer;\n}\n//# sourceMappingURL=texture-utils.js.map","export default function getShaderName(shader) {\n  let defaultName = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'unnamed';\n  const SHADER_NAME_REGEXP = /#define[\\s*]SHADER_NAME[\\s*]([A-Za-z0-9_-]+)[\\s*]/;\n  const match = shader.match(SHADER_NAME_REGEXP);\n  return match ? match[1] : defaultName;\n}\n//# sourceMappingURL=get-shader-name.js.map","const GL_FRAGMENT_SHADER = 0x8b30;\nconst GL_VERTEX_SHADER = 0x8b31;\nexport default function getShaderTypeName(type) {\n  switch (type) {\n    case GL_FRAGMENT_SHADER:\n      return 'fragment';\n\n    case GL_VERTEX_SHADER:\n      return 'vertex';\n\n    default:\n      return 'unknown type';\n  }\n}\n//# sourceMappingURL=get-shader-type-name.js.map","import getShaderName from './get-shader-name';\nimport getShaderTypeName from './get-shader-type-name';\nexport default function formatGLSLCompilerError(errLog, src, shaderType) {\n  const {\n    shaderName,\n    errors,\n    warnings\n  } = parseGLSLCompilerError(errLog, src, shaderType);\n  return \"GLSL compilation error in \".concat(shaderName, \"\\n\\n\").concat(errors, \"\\n\").concat(warnings);\n}\nexport function parseGLSLCompilerError(errLog, src, shaderType, shaderName) {\n  const errorStrings = errLog.split(/\\r?\\n/);\n  const errors = {};\n  const warnings = {};\n  const name = shaderName || getShaderName(src) || '(unnamed)';\n  const shaderDescription = \"\".concat(getShaderTypeName(shaderType), \" shader \").concat(name);\n\n  for (let i = 0; i < errorStrings.length; i++) {\n    const errorString = errorStrings[i];\n\n    if (errorString.length <= 1) {\n      continue;\n    }\n\n    const segments = errorString.split(':');\n    const type = segments[0];\n    const line = parseInt(segments[2], 10);\n\n    if (isNaN(line)) {\n      throw new Error(\"GLSL compilation error in \".concat(shaderDescription, \": \").concat(errLog));\n    }\n\n    if (type !== 'WARNING') {\n      errors[line] = errorString;\n    } else {\n      warnings[line] = errorString;\n    }\n  }\n\n  const lines = addLineNumbers(src);\n  return {\n    shaderName: shaderDescription,\n    errors: formatErrors(errors, lines),\n    warnings: formatErrors(warnings, lines)\n  };\n}\n\nfunction formatErrors(errors, lines) {\n  let message = '';\n\n  for (let i = 0; i < lines.length; i++) {\n    const line = lines[i];\n\n    if (!errors[i + 3] && !errors[i + 2] && !errors[i + 1]) {\n      continue;\n    }\n\n    message += \"\".concat(line, \"\\n\");\n\n    if (errors[i + 1]) {\n      const error = errors[i + 1];\n      const segments = error.split(':', 3);\n      const type = segments[0];\n      const column = parseInt(segments[1], 10) || 0;\n      const err = error.substring(segments.join(':').length + 1).trim();\n      message += padLeft(\"^^^ \".concat(type, \": \").concat(err, \"\\n\\n\"), column);\n    }\n  }\n\n  return message;\n}\n\nfunction addLineNumbers(string) {\n  let start = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n  let delim = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : ': ';\n  const lines = string.split(/\\r?\\n/);\n  const maxDigits = String(lines.length + start - 1).length;\n  return lines.map((line, i) => {\n    const lineNumber = String(i + start);\n    const digits = lineNumber.length;\n    const prefix = padLeft(lineNumber, maxDigits - digits);\n    return prefix + delim + line;\n  });\n}\n\nfunction padLeft(string, digits) {\n  let result = '';\n\n  for (let i = 0; i < digits; ++i) {\n    result += ' ';\n  }\n\n  return \"\".concat(result).concat(string);\n}\n//# sourceMappingURL=format-glsl-error.js.map","export default function getShaderVersion(source) {\n  let version = 100;\n  const words = source.match(/[^\\s]+/g);\n\n  if (words.length >= 2 && words[0] === '#version') {\n    const v = parseInt(words[1], 10);\n\n    if (Number.isFinite(v)) {\n      version = v;\n    }\n  }\n\n  return version;\n}\n//# sourceMappingURL=get-shader-version.js.map","import { assertWebGLContext, log } from '@luma.gl/gltools';\nimport { parseGLSLCompilerError, getShaderName } from '../glsl-utils';\nimport { assert } from '../utils/assert';\nimport { uid } from '../utils/utils';\nimport Resource from './resource';\nconst ERR_SOURCE = 'Shader: GLSL source code must be a JavaScript string';\nexport class Shader extends Resource {\n  get [Symbol.toStringTag]() {\n    return 'Shader';\n  }\n\n  static getTypeName(shaderType) {\n    switch (shaderType) {\n      case 35633:\n        return 'vertex-shader';\n\n      case 35632:\n        return 'fragment-shader';\n\n      default:\n        assert(false);\n        return 'unknown';\n    }\n  }\n\n  constructor(gl, props) {\n    assertWebGLContext(gl);\n    assert(typeof props.source === 'string', ERR_SOURCE);\n    const id = getShaderName(props.source, null) || props.id || uid(\"unnamed \".concat(Shader.getTypeName(props.shaderType)));\n    super(gl, {\n      id\n    });\n    this.shaderType = props.shaderType;\n    this.source = props.source;\n    this.initialize(props);\n  }\n\n  initialize(_ref) {\n    let {\n      source\n    } = _ref;\n    const shaderName = getShaderName(source, null);\n\n    if (shaderName) {\n      this.id = uid(shaderName);\n    }\n\n    this._compile(source);\n  }\n\n  getParameter(pname) {\n    return this.gl.getShaderParameter(this.handle, pname);\n  }\n\n  toString() {\n    return \"\".concat(Shader.getTypeName(this.shaderType), \":\").concat(this.id);\n  }\n\n  getName() {\n    return getShaderName(this.source) || 'unnamed-shader';\n  }\n\n  getSource() {\n    return this.gl.getShaderSource(this.handle);\n  }\n\n  getTranslatedSource() {\n    const extension = this.gl.getExtension('WEBGL_debug_shaders');\n    return extension ? extension.getTranslatedShaderSource(this.handle) : 'No translated source available. WEBGL_debug_shaders not implemented';\n  }\n\n  _compile() {\n    let source = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.source;\n\n    if (!source.startsWith('#version ')) {\n      source = \"#version 100\\n\".concat(source);\n    }\n\n    this.source = source;\n    this.gl.shaderSource(this.handle, this.source);\n    this.gl.compileShader(this.handle);\n    const compileStatus = this.getParameter(35713);\n\n    if (!compileStatus) {\n      const infoLog = this.gl.getShaderInfoLog(this.handle);\n      const {\n        shaderName,\n        errors,\n        warnings\n      } = parseGLSLCompilerError(infoLog, this.source, this.shaderType, this.id);\n      log.error(\"GLSL compilation errors in \".concat(shaderName, \"\\n\").concat(errors))();\n      log.warn(\"GLSL compilation warnings in \".concat(shaderName, \"\\n\").concat(warnings))();\n      throw new Error(\"GLSL compilation errors in \".concat(shaderName));\n    }\n  }\n\n  _deleteHandle() {\n    this.gl.deleteShader(this.handle);\n  }\n\n  _getOptsFromHandle() {\n    return {\n      type: this.getParameter(35663),\n      source: this.getSource()\n    };\n  }\n\n}\nexport class VertexShader extends Shader {\n  get [Symbol.toStringTag]() {\n    return 'VertexShader';\n  }\n\n  constructor(gl, props) {\n    if (typeof props === 'string') {\n      props = {\n        source: props\n      };\n    }\n\n    super(gl, Object.assign({}, props, {\n      shaderType: 35633\n    }));\n  }\n\n  _createHandle() {\n    return this.gl.createShader(35633);\n  }\n\n}\nexport class FragmentShader extends Shader {\n  get [Symbol.toStringTag]() {\n    return 'FragmentShader';\n  }\n\n  constructor(gl, props) {\n    if (typeof props === 'string') {\n      props = {\n        source: props\n      };\n    }\n\n    super(gl, Object.assign({}, props, {\n      shaderType: 35632\n    }));\n  }\n\n  _createHandle() {\n    return this.gl.createShader(35632);\n  }\n\n}\n//# sourceMappingURL=shader.js.map","import { log } from '@luma.gl/gltools';\nimport Framebuffer from './framebuffer';\nimport Renderbuffer from './renderbuffer';\nimport Texture from './texture';\nimport { assert } from '../utils/assert';\nconst UNIFORM_SETTERS = {\n  [5126]: getArraySetter.bind(null, 'uniform1fv', toFloatArray, 1, setVectorUniform),\n  [35664]: getArraySetter.bind(null, 'uniform2fv', toFloatArray, 2, setVectorUniform),\n  [35665]: getArraySetter.bind(null, 'uniform3fv', toFloatArray, 3, setVectorUniform),\n  [35666]: getArraySetter.bind(null, 'uniform4fv', toFloatArray, 4, setVectorUniform),\n  [5124]: getArraySetter.bind(null, 'uniform1iv', toIntArray, 1, setVectorUniform),\n  [35667]: getArraySetter.bind(null, 'uniform2iv', toIntArray, 2, setVectorUniform),\n  [35668]: getArraySetter.bind(null, 'uniform3iv', toIntArray, 3, setVectorUniform),\n  [35669]: getArraySetter.bind(null, 'uniform4iv', toIntArray, 4, setVectorUniform),\n  [35670]: getArraySetter.bind(null, 'uniform1iv', toIntArray, 1, setVectorUniform),\n  [35671]: getArraySetter.bind(null, 'uniform2iv', toIntArray, 2, setVectorUniform),\n  [35672]: getArraySetter.bind(null, 'uniform3iv', toIntArray, 3, setVectorUniform),\n  [35673]: getArraySetter.bind(null, 'uniform4iv', toIntArray, 4, setVectorUniform),\n  [35674]: getArraySetter.bind(null, 'uniformMatrix2fv', toFloatArray, 4, setMatrixUniform),\n  [35675]: getArraySetter.bind(null, 'uniformMatrix3fv', toFloatArray, 9, setMatrixUniform),\n  [35676]: getArraySetter.bind(null, 'uniformMatrix4fv', toFloatArray, 16, setMatrixUniform),\n  [35678]: getSamplerSetter,\n  [35680]: getSamplerSetter,\n  [5125]: getArraySetter.bind(null, 'uniform1uiv', toUIntArray, 1, setVectorUniform),\n  [36294]: getArraySetter.bind(null, 'uniform2uiv', toUIntArray, 2, setVectorUniform),\n  [36295]: getArraySetter.bind(null, 'uniform3uiv', toUIntArray, 3, setVectorUniform),\n  [36296]: getArraySetter.bind(null, 'uniform4uiv', toUIntArray, 4, setVectorUniform),\n  [35685]: getArraySetter.bind(null, 'uniformMatrix2x3fv', toFloatArray, 6, setMatrixUniform),\n  [35686]: getArraySetter.bind(null, 'uniformMatrix2x4fv', toFloatArray, 8, setMatrixUniform),\n  [35687]: getArraySetter.bind(null, 'uniformMatrix3x2fv', toFloatArray, 6, setMatrixUniform),\n  [35688]: getArraySetter.bind(null, 'uniformMatrix3x4fv', toFloatArray, 12, setMatrixUniform),\n  [35689]: getArraySetter.bind(null, 'uniformMatrix4x2fv', toFloatArray, 8, setMatrixUniform),\n  [35690]: getArraySetter.bind(null, 'uniformMatrix4x3fv', toFloatArray, 12, setMatrixUniform),\n  [35678]: getSamplerSetter,\n  [35680]: getSamplerSetter,\n  [35679]: getSamplerSetter,\n  [35682]: getSamplerSetter,\n  [36289]: getSamplerSetter,\n  [36292]: getSamplerSetter,\n  [36293]: getSamplerSetter,\n  [36298]: getSamplerSetter,\n  [36299]: getSamplerSetter,\n  [36300]: getSamplerSetter,\n  [36303]: getSamplerSetter,\n  [36306]: getSamplerSetter,\n  [36307]: getSamplerSetter,\n  [36308]: getSamplerSetter,\n  [36311]: getSamplerSetter\n};\nconst FLOAT_ARRAY = {};\nconst INT_ARRAY = {};\nconst UINT_ARRAY = {};\nconst array1 = [0];\n\nfunction toTypedArray(value, uniformLength, Type, cache) {\n  if (uniformLength === 1 && typeof value === 'boolean') {\n    value = value ? 1 : 0;\n  }\n\n  if (Number.isFinite(value)) {\n    array1[0] = value;\n    value = array1;\n  }\n\n  const length = value.length;\n\n  if (length % uniformLength) {\n    log.warn(\"Uniform size should be multiples of \".concat(uniformLength), value)();\n  }\n\n  if (value instanceof Type) {\n    return value;\n  }\n\n  let result = cache[length];\n\n  if (!result) {\n    result = new Type(length);\n    cache[length] = result;\n  }\n\n  for (let i = 0; i < length; i++) {\n    result[i] = value[i];\n  }\n\n  return result;\n}\n\nfunction toFloatArray(value, uniformLength) {\n  return toTypedArray(value, uniformLength, Float32Array, FLOAT_ARRAY);\n}\n\nfunction toIntArray(value, uniformLength) {\n  return toTypedArray(value, uniformLength, Int32Array, INT_ARRAY);\n}\n\nfunction toUIntArray(value, uniformLength) {\n  return toTypedArray(value, uniformLength, Uint32Array, UINT_ARRAY);\n}\n\nexport function getUniformSetter(gl, location, info) {\n  const setter = UNIFORM_SETTERS[info.type];\n\n  if (!setter) {\n    throw new Error(\"Unknown GLSL uniform type \".concat(info.type));\n  }\n\n  return setter().bind(null, gl, location);\n}\nexport function parseUniformName(name) {\n  if (name[name.length - 1] !== ']') {\n    return {\n      name,\n      length: 1,\n      isArray: false\n    };\n  }\n\n  const UNIFORM_NAME_REGEXP = /([^[]*)(\\[[0-9]+\\])?/;\n  const matches = name.match(UNIFORM_NAME_REGEXP);\n\n  if (!matches || matches.length < 2) {\n    throw new Error(\"Failed to parse GLSL uniform name \".concat(name));\n  }\n\n  return {\n    name: matches[1],\n    length: matches[2] || 1,\n    isArray: Boolean(matches[2])\n  };\n}\nexport function checkUniformValues(uniforms, source, uniformMap) {\n  for (const uniformName in uniforms) {\n    const value = uniforms[uniformName];\n    const shouldCheck = !uniformMap || Boolean(uniformMap[uniformName]);\n\n    if (shouldCheck && !checkUniformValue(value)) {\n      source = source ? \"\".concat(source, \" \") : '';\n      console.error(\"\".concat(source, \" Bad uniform \").concat(uniformName), value);\n      throw new Error(\"\".concat(source, \" Bad uniform \").concat(uniformName));\n    }\n  }\n\n  return true;\n}\n\nfunction checkUniformValue(value) {\n  if (Array.isArray(value) || ArrayBuffer.isView(value)) {\n    return checkUniformArray(value);\n  }\n\n  if (isFinite(value)) {\n    return true;\n  } else if (value === true || value === false) {\n    return true;\n  } else if (value instanceof Texture) {\n    return true;\n  } else if (value instanceof Renderbuffer) {\n    return true;\n  } else if (value instanceof Framebuffer) {\n    return Boolean(value.texture);\n  }\n\n  return false;\n}\n\nexport function copyUniform(uniforms, key, value) {\n  if (Array.isArray(value) || ArrayBuffer.isView(value)) {\n    if (uniforms[key]) {\n      const dest = uniforms[key];\n\n      for (let i = 0, len = value.length; i < len; ++i) {\n        dest[i] = value[i];\n      }\n    } else {\n      uniforms[key] = value.slice();\n    }\n  } else {\n    uniforms[key] = value;\n  }\n}\n\nfunction checkUniformArray(value) {\n  if (value.length === 0) {\n    return false;\n  }\n\n  const checkLength = Math.min(value.length, 16);\n\n  for (let i = 0; i < checkLength; ++i) {\n    if (!Number.isFinite(value[i])) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction getSamplerSetter() {\n  let cache = null;\n  return (gl, location, value) => {\n    const update = cache !== value;\n\n    if (update) {\n      gl.uniform1i(location, value);\n      cache = value;\n    }\n\n    return update;\n  };\n}\n\nfunction getArraySetter(functionName, toArray, size, uniformSetter) {\n  let cache = null;\n  let cacheLength = null;\n  return (gl, location, value) => {\n    const arrayValue = toArray(value, size);\n    const length = arrayValue.length;\n    let update = false;\n\n    if (cache === null) {\n      cache = new Float32Array(length);\n      cacheLength = length;\n      update = true;\n    } else {\n      assert(cacheLength === length, 'Uniform length cannot change.');\n\n      for (let i = 0; i < length; ++i) {\n        if (arrayValue[i] !== cache[i]) {\n          update = true;\n          break;\n        }\n      }\n    }\n\n    if (update) {\n      uniformSetter(gl, functionName, location, arrayValue);\n      cache.set(arrayValue);\n    }\n\n    return update;\n  };\n}\n\nfunction setVectorUniform(gl, functionName, location, value) {\n  gl[functionName](location, value);\n}\n\nfunction setMatrixUniform(gl, functionName, location, value) {\n  gl[functionName](location, false, value);\n}\n//# sourceMappingURL=uniforms.js.map","import { assert } from '../utils/assert';\nconst GL_BYTE = 0x1400;\nconst GL_UNSIGNED_BYTE = 0x1401;\nconst GL_SHORT = 0x1402;\nconst GL_UNSIGNED_SHORT = 0x1403;\nconst GL_POINTS = 0x0;\nconst GL_LINES = 0x1;\nconst GL_LINE_LOOP = 0x2;\nconst GL_LINE_STRIP = 0x3;\nconst GL_TRIANGLES = 0x4;\nconst GL_TRIANGLE_STRIP = 0x5;\nconst GL_TRIANGLE_FAN = 0x6;\nconst GL_FLOAT = 0x1406;\nconst GL_FLOAT_VEC2 = 0x8b50;\nconst GL_FLOAT_VEC3 = 0x8b51;\nconst GL_FLOAT_VEC4 = 0x8b52;\nconst GL_INT = 0x1404;\nconst GL_INT_VEC2 = 0x8b53;\nconst GL_INT_VEC3 = 0x8b54;\nconst GL_INT_VEC4 = 0x8b55;\nconst GL_UNSIGNED_INT = 0x1405;\nconst GL_UNSIGNED_INT_VEC2 = 0x8dc6;\nconst GL_UNSIGNED_INT_VEC3 = 0x8dc7;\nconst GL_UNSIGNED_INT_VEC4 = 0x8dc8;\nconst GL_BOOL = 0x8b56;\nconst GL_BOOL_VEC2 = 0x8b57;\nconst GL_BOOL_VEC3 = 0x8b58;\nconst GL_BOOL_VEC4 = 0x8b59;\nconst GL_FLOAT_MAT2 = 0x8b5a;\nconst GL_FLOAT_MAT3 = 0x8b5b;\nconst GL_FLOAT_MAT4 = 0x8b5c;\nconst GL_FLOAT_MAT2x3 = 0x8b65;\nconst GL_FLOAT_MAT2x4 = 0x8b66;\nconst GL_FLOAT_MAT3x2 = 0x8b67;\nconst GL_FLOAT_MAT3x4 = 0x8b68;\nconst GL_FLOAT_MAT4x2 = 0x8b69;\nconst GL_FLOAT_MAT4x3 = 0x8b6a;\nconst COMPOSITE_GL_TYPES = {\n  [GL_FLOAT]: [GL_FLOAT, 1, 'float'],\n  [GL_FLOAT_VEC2]: [GL_FLOAT, 2, 'vec2'],\n  [GL_FLOAT_VEC3]: [GL_FLOAT, 3, 'vec3'],\n  [GL_FLOAT_VEC4]: [GL_FLOAT, 4, 'vec4'],\n  [GL_INT]: [GL_INT, 1, 'int'],\n  [GL_INT_VEC2]: [GL_INT, 2, 'ivec2'],\n  [GL_INT_VEC3]: [GL_INT, 3, 'ivec3'],\n  [GL_INT_VEC4]: [GL_INT, 4, 'ivec4'],\n  [GL_UNSIGNED_INT]: [GL_UNSIGNED_INT, 1, 'uint'],\n  [GL_UNSIGNED_INT_VEC2]: [GL_UNSIGNED_INT, 2, 'uvec2'],\n  [GL_UNSIGNED_INT_VEC3]: [GL_UNSIGNED_INT, 3, 'uvec3'],\n  [GL_UNSIGNED_INT_VEC4]: [GL_UNSIGNED_INT, 4, 'uvec4'],\n  [GL_BOOL]: [GL_FLOAT, 1, 'bool'],\n  [GL_BOOL_VEC2]: [GL_FLOAT, 2, 'bvec2'],\n  [GL_BOOL_VEC3]: [GL_FLOAT, 3, 'bvec3'],\n  [GL_BOOL_VEC4]: [GL_FLOAT, 4, 'bvec4'],\n  [GL_FLOAT_MAT2]: [GL_FLOAT, 8, 'mat2'],\n  [GL_FLOAT_MAT2x3]: [GL_FLOAT, 8, 'mat2x3'],\n  [GL_FLOAT_MAT2x4]: [GL_FLOAT, 8, 'mat2x4'],\n  [GL_FLOAT_MAT3]: [GL_FLOAT, 12, 'mat3'],\n  [GL_FLOAT_MAT3x2]: [GL_FLOAT, 12, 'mat3x2'],\n  [GL_FLOAT_MAT3x4]: [GL_FLOAT, 12, 'mat3x4'],\n  [GL_FLOAT_MAT4]: [GL_FLOAT, 16, 'mat4'],\n  [GL_FLOAT_MAT4x2]: [GL_FLOAT, 16, 'mat4x2'],\n  [GL_FLOAT_MAT4x3]: [GL_FLOAT, 16, 'mat4x3']\n};\nexport function getPrimitiveDrawMode(drawMode) {\n  switch (drawMode) {\n    case GL_POINTS:\n      return GL_POINTS;\n\n    case GL_LINES:\n      return GL_LINES;\n\n    case GL_LINE_STRIP:\n      return GL_LINES;\n\n    case GL_LINE_LOOP:\n      return GL_LINES;\n\n    case GL_TRIANGLES:\n      return GL_TRIANGLES;\n\n    case GL_TRIANGLE_STRIP:\n      return GL_TRIANGLES;\n\n    case GL_TRIANGLE_FAN:\n      return GL_TRIANGLES;\n\n    default:\n      assert(false);\n      return 0;\n  }\n}\nexport function getPrimitiveCount(_ref) {\n  let {\n    drawMode,\n    vertexCount\n  } = _ref;\n\n  switch (drawMode) {\n    case GL_POINTS:\n    case GL_LINE_LOOP:\n      return vertexCount;\n\n    case GL_LINES:\n      return vertexCount / 2;\n\n    case GL_LINE_STRIP:\n      return vertexCount - 1;\n\n    case GL_TRIANGLES:\n      return vertexCount / 3;\n\n    case GL_TRIANGLE_STRIP:\n    case GL_TRIANGLE_FAN:\n      return vertexCount - 2;\n\n    default:\n      assert(false);\n      return 0;\n  }\n}\nexport function getVertexCount(_ref2) {\n  let {\n    drawMode,\n    vertexCount\n  } = _ref2;\n  const primitiveCount = getPrimitiveCount({\n    drawMode,\n    vertexCount\n  });\n\n  switch (getPrimitiveDrawMode(drawMode)) {\n    case GL_POINTS:\n      return primitiveCount;\n\n    case GL_LINES:\n      return primitiveCount * 2;\n\n    case GL_TRIANGLES:\n      return primitiveCount * 3;\n\n    default:\n      assert(false);\n      return 0;\n  }\n}\nexport function decomposeCompositeGLType(compositeGLType) {\n  const typeAndSize = COMPOSITE_GL_TYPES[compositeGLType];\n\n  if (!typeAndSize) {\n    return null;\n  }\n\n  const [type, components] = typeAndSize;\n  return {\n    type,\n    components\n  };\n}\nexport function getCompositeGLType(type, components) {\n  switch (type) {\n    case GL_BYTE:\n    case GL_UNSIGNED_BYTE:\n    case GL_SHORT:\n    case GL_UNSIGNED_SHORT:\n      type = GL_FLOAT;\n      break;\n\n    default:\n  }\n\n  for (const glType in COMPOSITE_GL_TYPES) {\n    const [compType, compComponents, name] = COMPOSITE_GL_TYPES[glType];\n\n    if (compType === type && compComponents === components) {\n      return {\n        glType,\n        name\n      };\n    }\n  }\n\n  return null;\n}\n//# sourceMappingURL=attribute-utils.js.map","import Accessor from './accessor';\nimport { isWebGL2 } from '@luma.gl/gltools';\nimport { decomposeCompositeGLType } from '../webgl-utils/attribute-utils';\nexport default class ProgramConfiguration {\n  constructor(program) {\n    this.id = program.id;\n    this.attributeInfos = [];\n    this.attributeInfosByName = {};\n    this.attributeInfosByLocation = [];\n    this.varyingInfos = [];\n    this.varyingInfosByName = {};\n    Object.seal(this);\n\n    this._readAttributesFromProgram(program);\n\n    this._readVaryingsFromProgram(program);\n  }\n\n  getAttributeInfo(locationOrName) {\n    const location = Number(locationOrName);\n\n    if (Number.isFinite(location)) {\n      return this.attributeInfosByLocation[location];\n    }\n\n    return this.attributeInfosByName[locationOrName] || null;\n  }\n\n  getAttributeLocation(locationOrName) {\n    const attributeInfo = this.getAttributeInfo(locationOrName);\n    return attributeInfo ? attributeInfo.location : -1;\n  }\n\n  getAttributeAccessor(locationOrName) {\n    const attributeInfo = this.getAttributeInfo(locationOrName);\n    return attributeInfo ? attributeInfo.accessor : null;\n  }\n\n  getVaryingInfo(locationOrName) {\n    const location = Number(locationOrName);\n\n    if (Number.isFinite(location)) {\n      return this.varyingInfos[location];\n    }\n\n    return this.varyingInfosByName[locationOrName] || null;\n  }\n\n  getVaryingIndex(locationOrName) {\n    const varying = this.getVaryingInfo();\n    return varying ? varying.location : -1;\n  }\n\n  getVaryingAccessor(locationOrName) {\n    const varying = this.getVaryingInfo();\n    return varying ? varying.accessor : null;\n  }\n\n  _readAttributesFromProgram(program) {\n    const {\n      gl\n    } = program;\n    const count = gl.getProgramParameter(program.handle, 35721);\n\n    for (let index = 0; index < count; index++) {\n      const {\n        name,\n        type,\n        size\n      } = gl.getActiveAttrib(program.handle, index);\n      const location = gl.getAttribLocation(program.handle, name);\n\n      if (location >= 0) {\n        this._addAttribute(location, name, type, size);\n      }\n    }\n\n    this.attributeInfos.sort((a, b) => a.location - b.location);\n  }\n\n  _readVaryingsFromProgram(program) {\n    const {\n      gl\n    } = program;\n\n    if (!isWebGL2(gl)) {\n      return;\n    }\n\n    const count = gl.getProgramParameter(program.handle, 35971);\n\n    for (let location = 0; location < count; location++) {\n      const {\n        name,\n        type,\n        size\n      } = gl.getTransformFeedbackVarying(program.handle, location);\n\n      this._addVarying(location, name, type, size);\n    }\n\n    this.varyingInfos.sort((a, b) => a.location - b.location);\n  }\n\n  _addAttribute(location, name, compositeType, size) {\n    const {\n      type,\n      components\n    } = decomposeCompositeGLType(compositeType);\n    const accessor = {\n      type,\n      size: size * components\n    };\n\n    this._inferProperties(location, name, accessor);\n\n    const attributeInfo = {\n      location,\n      name,\n      accessor: new Accessor(accessor)\n    };\n    this.attributeInfos.push(attributeInfo);\n    this.attributeInfosByLocation[location] = attributeInfo;\n    this.attributeInfosByName[attributeInfo.name] = attributeInfo;\n  }\n\n  _inferProperties(location, name, accessor) {\n    if (/instance/i.test(name)) {\n      accessor.divisor = 1;\n    }\n  }\n\n  _addVarying(location, name, compositeType, size) {\n    const {\n      type,\n      components\n    } = decomposeCompositeGLType(compositeType);\n    const accessor = new Accessor({\n      type,\n      size: size * components\n    });\n    const varying = {\n      location,\n      name,\n      accessor\n    };\n    this.varyingInfos.push(varying);\n    this.varyingInfosByName[varying.name] = varying;\n  }\n\n}\n//# sourceMappingURL=program-configuration.js.map","import Resource from './resource';\nimport Texture from './texture';\nimport Framebuffer from './framebuffer';\nimport { parseUniformName, getUniformSetter } from './uniforms';\nimport { VertexShader, FragmentShader } from './shader';\nimport ProgramConfiguration from './program-configuration';\nimport { copyUniform, checkUniformValues } from './uniforms';\nimport { isWebGL2, assertWebGL2Context, withParameters, log } from '@luma.gl/gltools';\nimport { getKey } from '../webgl-utils/constants-to-keys';\nimport { getPrimitiveDrawMode } from '../webgl-utils/attribute-utils';\nimport { assert } from '../utils/assert';\nimport { uid } from '../utils/utils';\nconst LOG_PROGRAM_PERF_PRIORITY = 4;\nconst GL_SEPARATE_ATTRIBS = 0x8c8d;\nconst V6_DEPRECATED_METHODS = ['setVertexArray', 'setAttributes', 'setBuffers', 'unsetBuffers', 'use', 'getUniformCount', 'getUniformInfo', 'getUniformLocation', 'getUniformValue', 'getVarying', 'getFragDataLocation', 'getAttachedShaders', 'getAttributeCount', 'getAttributeLocation', 'getAttributeInfo'];\nexport default class Program extends Resource {\n  get [Symbol.toStringTag]() {\n    return 'Program';\n  }\n\n  constructor(gl) {\n    let props = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    super(gl, props);\n    this.stubRemovedMethods('Program', 'v6.0', V6_DEPRECATED_METHODS);\n    this._isCached = false;\n    this.initialize(props);\n    Object.seal(this);\n\n    this._setId(props.id);\n  }\n\n  initialize() {\n    let props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    const {\n      hash,\n      vs,\n      fs,\n      varyings,\n      bufferMode = GL_SEPARATE_ATTRIBS\n    } = props;\n    this.hash = hash || '';\n    this.vs = typeof vs === 'string' ? new VertexShader(this.gl, {\n      id: \"\".concat(props.id, \"-vs\"),\n      source: vs\n    }) : vs;\n    this.fs = typeof fs === 'string' ? new FragmentShader(this.gl, {\n      id: \"\".concat(props.id, \"-fs\"),\n      source: fs\n    }) : fs;\n    assert(this.vs instanceof VertexShader);\n    assert(this.fs instanceof FragmentShader);\n    this.uniforms = {};\n    this._textureUniforms = {};\n\n    if (varyings && varyings.length > 0) {\n      assertWebGL2Context(this.gl);\n      this.varyings = varyings;\n      this.gl2.transformFeedbackVaryings(this.handle, varyings, bufferMode);\n    }\n\n    this._compileAndLink();\n\n    this._readUniformLocationsFromLinkedProgram();\n\n    this.configuration = new ProgramConfiguration(this);\n    return this.setProps(props);\n  }\n\n  delete() {\n    let options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    if (this._isCached) {\n      return this;\n    }\n\n    return super.delete(options);\n  }\n\n  setProps(props) {\n    if ('uniforms' in props) {\n      this.setUniforms(props.uniforms);\n    }\n\n    return this;\n  }\n\n  draw(_ref) {\n    let {\n      logPriority,\n      drawMode = 4,\n      vertexCount,\n      offset = 0,\n      start,\n      end,\n      isIndexed = false,\n      indexType = 5123,\n      instanceCount = 0,\n      isInstanced = instanceCount > 0,\n      vertexArray = null,\n      transformFeedback,\n      framebuffer,\n      parameters = {},\n      uniforms,\n      samplers\n    } = _ref;\n\n    if (uniforms || samplers) {\n      log.deprecated('Program.draw({uniforms})', 'Program.setUniforms(uniforms)')();\n      this.setUniforms(uniforms || {});\n    }\n\n    if (log.priority >= logPriority) {\n      const fb = framebuffer ? framebuffer.id : 'default';\n      const message = \"mode=\".concat(getKey(this.gl, drawMode), \" verts=\").concat(vertexCount, \" \") + \"instances=\".concat(instanceCount, \" indexType=\").concat(getKey(this.gl, indexType), \" \") + \"isInstanced=\".concat(isInstanced, \" isIndexed=\").concat(isIndexed, \" \") + \"Framebuffer=\".concat(fb);\n      log.log(logPriority, message)();\n    }\n\n    assert(vertexArray);\n    this.gl.useProgram(this.handle);\n\n    if (!this._areTexturesRenderable() || vertexCount === 0 || isInstanced && instanceCount === 0) {\n      return false;\n    }\n\n    vertexArray.bindForDraw(vertexCount, instanceCount, () => {\n      if (framebuffer !== undefined) {\n        parameters = Object.assign({}, parameters, {\n          framebuffer\n        });\n      }\n\n      if (transformFeedback) {\n        const primitiveMode = getPrimitiveDrawMode(drawMode);\n        transformFeedback.begin(primitiveMode);\n      }\n\n      this._bindTextures();\n\n      withParameters(this.gl, parameters, () => {\n        if (isIndexed && isInstanced) {\n          this.gl2.drawElementsInstanced(drawMode, vertexCount, indexType, offset, instanceCount);\n        } else if (isIndexed && isWebGL2(this.gl) && !isNaN(start) && !isNaN(end)) {\n          this.gl2.drawRangeElements(drawMode, start, end, vertexCount, indexType, offset);\n        } else if (isIndexed) {\n          this.gl.drawElements(drawMode, vertexCount, indexType, offset);\n        } else if (isInstanced) {\n          this.gl2.drawArraysInstanced(drawMode, offset, vertexCount, instanceCount);\n        } else {\n          this.gl.drawArrays(drawMode, offset, vertexCount);\n        }\n      });\n\n      if (transformFeedback) {\n        transformFeedback.end();\n      }\n    });\n    return true;\n  }\n\n  setUniforms() {\n    let uniforms = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    if (log.priority >= 2) {\n      checkUniformValues(uniforms, this.id, this._uniformSetters);\n    }\n\n    this.gl.useProgram(this.handle);\n\n    for (const uniformName in uniforms) {\n      const uniform = uniforms[uniformName];\n      const uniformSetter = this._uniformSetters[uniformName];\n\n      if (uniformSetter) {\n        let value = uniform;\n        let textureUpdate = false;\n\n        if (value instanceof Framebuffer) {\n          value = value.texture;\n        }\n\n        if (value instanceof Texture) {\n          textureUpdate = this.uniforms[uniformName] !== uniform;\n\n          if (textureUpdate) {\n            if (uniformSetter.textureIndex === undefined) {\n              uniformSetter.textureIndex = this._textureIndexCounter++;\n            }\n\n            const texture = value;\n            const {\n              textureIndex\n            } = uniformSetter;\n            texture.bind(textureIndex);\n            value = textureIndex;\n            this._textureUniforms[uniformName] = texture;\n          } else {\n            value = uniformSetter.textureIndex;\n          }\n        } else if (this._textureUniforms[uniformName]) {\n          delete this._textureUniforms[uniformName];\n        }\n\n        if (uniformSetter(value) || textureUpdate) {\n          copyUniform(this.uniforms, uniformName, uniform);\n        }\n      }\n    }\n\n    return this;\n  }\n\n  _areTexturesRenderable() {\n    let texturesRenderable = true;\n\n    for (const uniformName in this._textureUniforms) {\n      const texture = this._textureUniforms[uniformName];\n      texture.update();\n      texturesRenderable = texturesRenderable && texture.loaded;\n    }\n\n    return texturesRenderable;\n  }\n\n  _bindTextures() {\n    for (const uniformName in this._textureUniforms) {\n      const textureIndex = this._uniformSetters[uniformName].textureIndex;\n\n      this._textureUniforms[uniformName].bind(textureIndex);\n    }\n  }\n\n  _createHandle() {\n    return this.gl.createProgram();\n  }\n\n  _deleteHandle() {\n    this.gl.deleteProgram(this.handle);\n  }\n\n  _getOptionsFromHandle(handle) {\n    const shaderHandles = this.gl.getAttachedShaders(handle);\n    const opts = {};\n\n    for (const shaderHandle of shaderHandles) {\n      const type = this.gl.getShaderParameter(this.handle, 35663);\n\n      switch (type) {\n        case 35633:\n          opts.vs = new VertexShader({\n            handle: shaderHandle\n          });\n          break;\n\n        case 35632:\n          opts.fs = new FragmentShader({\n            handle: shaderHandle\n          });\n          break;\n\n        default:\n      }\n    }\n\n    return opts;\n  }\n\n  _getParameter(pname) {\n    return this.gl.getProgramParameter(this.handle, pname);\n  }\n\n  _setId(id) {\n    if (!id) {\n      const programName = this._getName();\n\n      this.id = uid(programName);\n    }\n  }\n\n  _getName() {\n    let programName = this.vs.getName() || this.fs.getName();\n    programName = programName.replace(/shader/i, '');\n    programName = programName ? \"\".concat(programName, \"-program\") : 'program';\n    return programName;\n  }\n\n  _compileAndLink() {\n    const {\n      gl\n    } = this;\n    gl.attachShader(this.handle, this.vs.handle);\n    gl.attachShader(this.handle, this.fs.handle);\n    log.time(LOG_PROGRAM_PERF_PRIORITY, \"linkProgram for \".concat(this._getName()))();\n    gl.linkProgram(this.handle);\n    log.timeEnd(LOG_PROGRAM_PERF_PRIORITY, \"linkProgram for \".concat(this._getName()))();\n\n    if (gl.debug || log.level > 0) {\n      const linked = gl.getProgramParameter(this.handle, 35714);\n\n      if (!linked) {\n        throw new Error(\"Error linking: \".concat(gl.getProgramInfoLog(this.handle)));\n      }\n\n      gl.validateProgram(this.handle);\n      const validated = gl.getProgramParameter(this.handle, 35715);\n\n      if (!validated) {\n        throw new Error(\"Error validating: \".concat(gl.getProgramInfoLog(this.handle)));\n      }\n    }\n  }\n\n  _readUniformLocationsFromLinkedProgram() {\n    const {\n      gl\n    } = this;\n    this._uniformSetters = {};\n    this._uniformCount = this._getParameter(35718);\n\n    for (let i = 0; i < this._uniformCount; i++) {\n      const info = this.gl.getActiveUniform(this.handle, i);\n      const {\n        name\n      } = parseUniformName(info.name);\n      let location = gl.getUniformLocation(this.handle, name);\n      this._uniformSetters[name] = getUniformSetter(gl, location, info);\n\n      if (info.size > 1) {\n        for (let l = 0; l < info.size; l++) {\n          location = gl.getUniformLocation(this.handle, \"\".concat(name, \"[\").concat(l, \"]\"));\n          this._uniformSetters[\"\".concat(name, \"[\").concat(l, \"]\")] = getUniformSetter(gl, location, info);\n        }\n      }\n    }\n\n    this._textureIndexCounter = 0;\n  }\n\n  getActiveUniforms(uniformIndices, pname) {\n    return this.gl2.getActiveUniforms(this.handle, uniformIndices, pname);\n  }\n\n  getUniformBlockIndex(blockName) {\n    return this.gl2.getUniformBlockIndex(this.handle, blockName);\n  }\n\n  getActiveUniformBlockParameter(blockIndex, pname) {\n    return this.gl2.getActiveUniformBlockParameter(this.handle, blockIndex, pname);\n  }\n\n  uniformBlockBinding(blockIndex, blockBinding) {\n    this.gl2.uniformBlockBinding(this.handle, blockIndex, blockBinding);\n  }\n\n}\n//# sourceMappingURL=program.js.map","import Resource from './resource';\nimport { FEATURES, hasFeatures } from '../features';\nimport { isWebGL2 } from '@luma.gl/gltools';\nimport { assert } from '../utils/assert';\nconst GL_QUERY_RESULT = 0x8866;\nconst GL_QUERY_RESULT_AVAILABLE = 0x8867;\nconst GL_TIME_ELAPSED_EXT = 0x88bf;\nconst GL_GPU_DISJOINT_EXT = 0x8fbb;\nconst GL_TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN = 0x8c88;\nconst GL_ANY_SAMPLES_PASSED = 0x8c2f;\nconst GL_ANY_SAMPLES_PASSED_CONSERVATIVE = 0x8d6a;\nexport default class Query extends Resource {\n  get [Symbol.toStringTag]() {\n    return 'Query';\n  }\n\n  static isSupported(gl) {\n    let opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n    const webgl2 = isWebGL2(gl);\n    const hasTimerQuery = hasFeatures(gl, FEATURES.TIMER_QUERY);\n    let supported = webgl2 || hasTimerQuery;\n\n    for (const key of opts) {\n      switch (key) {\n        case 'queries':\n          supported = supported && webgl2;\n          break;\n\n        case 'timers':\n          supported = supported && hasTimerQuery;\n          break;\n\n        default:\n          assert(false);\n      }\n    }\n\n    return supported;\n  }\n\n  constructor(gl) {\n    let opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    super(gl, opts);\n    this.target = null;\n    this._queryPending = false;\n    this._pollingPromise = null;\n    Object.seal(this);\n  }\n\n  beginTimeElapsedQuery() {\n    return this.begin(GL_TIME_ELAPSED_EXT);\n  }\n\n  beginOcclusionQuery() {\n    let {\n      conservative = false\n    } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    return this.begin(conservative ? GL_ANY_SAMPLES_PASSED_CONSERVATIVE : GL_ANY_SAMPLES_PASSED);\n  }\n\n  beginTransformFeedbackQuery() {\n    return this.begin(GL_TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN);\n  }\n\n  begin(target) {\n    if (this._queryPending) {\n      return this;\n    }\n\n    this.target = target;\n    this.gl2.beginQuery(this.target, this.handle);\n    return this;\n  }\n\n  end() {\n    if (this._queryPending) {\n      return this;\n    }\n\n    if (this.target) {\n      this.gl2.endQuery(this.target);\n      this.target = null;\n      this._queryPending = true;\n    }\n\n    return this;\n  }\n\n  isResultAvailable() {\n    if (!this._queryPending) {\n      return false;\n    }\n\n    const resultAvailable = this.gl2.getQueryParameter(this.handle, GL_QUERY_RESULT_AVAILABLE);\n\n    if (resultAvailable) {\n      this._queryPending = false;\n    }\n\n    return resultAvailable;\n  }\n\n  isTimerDisjoint() {\n    return this.gl2.getParameter(GL_GPU_DISJOINT_EXT);\n  }\n\n  getResult() {\n    return this.gl2.getQueryParameter(this.handle, GL_QUERY_RESULT);\n  }\n\n  getTimerMilliseconds() {\n    return this.getResult() / 1e6;\n  }\n\n  createPoll() {\n    let limit = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : Number.POSITIVE_INFINITY;\n\n    if (this._pollingPromise) {\n      return this._pollingPromise;\n    }\n\n    let counter = 0;\n    this._pollingPromise = new Promise((resolve, reject) => {\n      const poll = () => {\n        if (this.isResultAvailable()) {\n          resolve(this.getResult());\n          this._pollingPromise = null;\n        } else if (counter++ > limit) {\n          reject('Timed out');\n          this._pollingPromise = null;\n        } else {\n          requestAnimationFrame(poll);\n        }\n      };\n\n      requestAnimationFrame(poll);\n    });\n    return this._pollingPromise;\n  }\n\n  _createHandle() {\n    return Query.isSupported(this.gl) ? this.gl2.createQuery() : null;\n  }\n\n  _deleteHandle() {\n    this.gl2.deleteQuery(this.handle);\n  }\n\n}\n//# sourceMappingURL=query.js.map","import { isWebGL2, assertWebGL2Context, log } from '@luma.gl/gltools';\nimport Resource from './resource';\nimport Buffer from './buffer';\nimport { isObjectEmpty } from '../utils/utils';\nexport default class TransformFeedback extends Resource {\n  get [Symbol.toStringTag]() {\n    return 'TransformFeedback';\n  }\n\n  static isSupported(gl) {\n    return isWebGL2(gl);\n  }\n\n  constructor(gl) {\n    let props = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    assertWebGL2Context(gl);\n    super(gl, props);\n    this.initialize(props);\n    this.stubRemovedMethods('TransformFeedback', 'v6.0', ['pause', 'resume']);\n    Object.seal(this);\n  }\n\n  initialize() {\n    let props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    this.buffers = {};\n    this.unused = {};\n    this.configuration = null;\n    this.bindOnUse = true;\n\n    if (!isObjectEmpty(this.buffers)) {\n      this.bind(() => this._unbindBuffers());\n    }\n\n    this.setProps(props);\n    return this;\n  }\n\n  setProps(props) {\n    if ('program' in props) {\n      this.configuration = props.program && props.program.configuration;\n    }\n\n    if ('configuration' in props) {\n      this.configuration = props.configuration;\n    }\n\n    if ('bindOnUse' in props) {\n      props = props.bindOnUse;\n    }\n\n    if ('buffers' in props) {\n      this.setBuffers(props.buffers);\n    }\n  }\n\n  setBuffers() {\n    let buffers = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    this.bind(() => {\n      for (const bufferName in buffers) {\n        this.setBuffer(bufferName, buffers[bufferName]);\n      }\n    });\n    return this;\n  }\n\n  setBuffer(locationOrName, bufferOrParams) {\n    const location = this._getVaryingIndex(locationOrName);\n\n    const {\n      buffer,\n      byteSize,\n      byteOffset\n    } = this._getBufferParams(bufferOrParams);\n\n    if (location < 0) {\n      this.unused[locationOrName] = buffer;\n      log.warn(\"\".concat(this.id, \" unused varying buffer \").concat(locationOrName))();\n      return this;\n    }\n\n    this.buffers[location] = bufferOrParams;\n\n    if (!this.bindOnUse) {\n      this._bindBuffer(location, buffer, byteOffset, byteSize);\n    }\n\n    return this;\n  }\n\n  begin() {\n    let primitiveMode = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n    this.gl.bindTransformFeedback(36386, this.handle);\n\n    this._bindBuffers();\n\n    this.gl.beginTransformFeedback(primitiveMode);\n    return this;\n  }\n\n  end() {\n    this.gl.endTransformFeedback();\n\n    this._unbindBuffers();\n\n    this.gl.bindTransformFeedback(36386, null);\n    return this;\n  }\n\n  _getBufferParams(bufferOrParams) {\n    let byteOffset;\n    let byteSize;\n    let buffer;\n\n    if (bufferOrParams instanceof Buffer === false) {\n      buffer = bufferOrParams.buffer;\n      byteSize = bufferOrParams.byteSize;\n      byteOffset = bufferOrParams.byteOffset;\n    } else {\n      buffer = bufferOrParams;\n    }\n\n    if (byteOffset !== undefined || byteSize !== undefined) {\n      byteOffset = byteOffset || 0;\n      byteSize = byteSize || buffer.byteLength - byteOffset;\n    }\n\n    return {\n      buffer,\n      byteOffset,\n      byteSize\n    };\n  }\n\n  _getVaryingInfo(locationOrName) {\n    return this.configuration && this.configuration.getVaryingInfo(locationOrName);\n  }\n\n  _getVaryingIndex(locationOrName) {\n    if (this.configuration) {\n      return this.configuration.getVaryingInfo(locationOrName).location;\n    }\n\n    const location = Number(locationOrName);\n    return Number.isFinite(location) ? location : -1;\n  }\n\n  _bindBuffers() {\n    if (this.bindOnUse) {\n      for (const bufferIndex in this.buffers) {\n        const {\n          buffer,\n          byteSize,\n          byteOffset\n        } = this._getBufferParams(this.buffers[bufferIndex]);\n\n        this._bindBuffer(bufferIndex, buffer, byteOffset, byteSize);\n      }\n    }\n  }\n\n  _unbindBuffers() {\n    if (this.bindOnUse) {\n      for (const bufferIndex in this.buffers) {\n        this._bindBuffer(bufferIndex, null);\n      }\n    }\n  }\n\n  _bindBuffer(index, buffer) {\n    let byteOffset = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n    let byteSize = arguments.length > 3 ? arguments[3] : undefined;\n    const handle = buffer && buffer.handle;\n\n    if (!handle || byteSize === undefined) {\n      this.gl.bindBufferBase(35982, index, handle);\n    } else {\n      this.gl.bindBufferRange(35982, index, handle, byteOffset, byteSize);\n    }\n\n    return this;\n  }\n\n  _createHandle() {\n    return this.gl.createTransformFeedback();\n  }\n\n  _deleteHandle() {\n    this.gl.deleteTransformFeedback(this.handle);\n  }\n\n  _bindHandle(handle) {\n    this.gl.bindTransformFeedback(36386, this.handle);\n  }\n\n}\n//# sourceMappingURL=transform-feedback.js.map","let arrayBuffer = null;\nexport function getScratchArrayBuffer(byteLength) {\n  if (!arrayBuffer || arrayBuffer.byteLength < byteLength) {\n    arrayBuffer = new ArrayBuffer(byteLength);\n  }\n\n  return arrayBuffer;\n}\nexport function getScratchArray(Type, length) {\n  const scratchArrayBuffer = getScratchArrayBuffer(Type.BYTES_PER_ELEMENT * length);\n  return new Type(scratchArrayBuffer, 0, length);\n}\nexport function fillArray(_ref) {\n  let {\n    target,\n    source,\n    start = 0,\n    count = 1\n  } = _ref;\n  const length = source.length;\n  const total = count * length;\n  let copied = 0;\n\n  for (let i = start; copied < length; copied++) {\n    target[i++] = source[copied];\n  }\n\n  while (copied < total) {\n    if (copied < total - copied) {\n      target.copyWithin(start + copied, start, start + copied);\n      copied *= 2;\n    } else {\n      target.copyWithin(start + copied, start, start + total - copied);\n      copied = total;\n    }\n  }\n\n  return target;\n}\n//# sourceMappingURL=array-utils-flat.js.map","import Resource from './resource';\nimport Buffer from './buffer';\nimport { isWebGL2 } from '@luma.gl/gltools';\nimport { getScratchArray, fillArray } from '../utils/array-utils-flat';\nimport { assert } from '../utils/assert';\nimport { getBrowser } from '@probe.gl/env';\nconst ERR_ELEMENTS = 'elements must be GL.ELEMENT_ARRAY_BUFFER';\nexport default class VertexArrayObject extends Resource {\n  get [Symbol.toStringTag]() {\n    return 'VertexArrayObject';\n  }\n\n  static isSupported(gl) {\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    if (options.constantAttributeZero) {\n      return isWebGL2(gl) || getBrowser() === 'Chrome';\n    }\n\n    return true;\n  }\n\n  static getDefaultArray(gl) {\n    gl.luma = gl.luma || {};\n\n    if (!gl.luma.defaultVertexArray) {\n      gl.luma.defaultVertexArray = new VertexArrayObject(gl, {\n        handle: null,\n        isDefaultArray: true\n      });\n    }\n\n    return gl.luma.defaultVertexArray;\n  }\n\n  static getMaxAttributes(gl) {\n    VertexArrayObject.MAX_ATTRIBUTES = VertexArrayObject.MAX_ATTRIBUTES || gl.getParameter(34921);\n    return VertexArrayObject.MAX_ATTRIBUTES;\n  }\n\n  static setConstant(gl, location, array) {\n    switch (array.constructor) {\n      case Float32Array:\n        VertexArrayObject._setConstantFloatArray(gl, location, array);\n\n        break;\n\n      case Int32Array:\n        VertexArrayObject._setConstantIntArray(gl, location, array);\n\n        break;\n\n      case Uint32Array:\n        VertexArrayObject._setConstantUintArray(gl, location, array);\n\n        break;\n\n      default:\n        assert(false);\n    }\n  }\n\n  constructor(gl) {\n    let opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    const id = opts.id || opts.program && opts.program.id;\n    super(gl, Object.assign({}, opts, {\n      id\n    }));\n    this.buffer = null;\n    this.bufferValue = null;\n    this.isDefaultArray = opts.isDefaultArray || false;\n    this.gl2 = gl;\n    this.initialize(opts);\n    Object.seal(this);\n  }\n\n  delete() {\n    super.delete();\n\n    if (this.buffer) {\n      this.buffer.delete();\n    }\n\n    return this;\n  }\n\n  get MAX_ATTRIBUTES() {\n    return VertexArrayObject.getMaxAttributes(this.gl);\n  }\n\n  initialize() {\n    let props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    return this.setProps(props);\n  }\n\n  setProps(props) {\n    return this;\n  }\n\n  setElementBuffer() {\n    let elementBuffer = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n    let opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    assert(!elementBuffer || elementBuffer.target === 34963, ERR_ELEMENTS);\n    this.bind(() => {\n      this.gl.bindBuffer(34963, elementBuffer ? elementBuffer.handle : null);\n    });\n    return this;\n  }\n\n  setBuffer(location, buffer, accessor) {\n    if (buffer.target === 34963) {\n      return this.setElementBuffer(buffer, accessor);\n    }\n\n    const {\n      size,\n      type,\n      stride,\n      offset,\n      normalized,\n      integer,\n      divisor\n    } = accessor;\n    const {\n      gl,\n      gl2\n    } = this;\n    location = Number(location);\n    this.bind(() => {\n      gl.bindBuffer(34962, buffer.handle);\n\n      if (integer) {\n        assert(isWebGL2(gl));\n        gl2.vertexAttribIPointer(location, size, type, stride, offset);\n      } else {\n        gl.vertexAttribPointer(location, size, type, normalized, stride, offset);\n      }\n\n      gl.enableVertexAttribArray(location);\n      gl2.vertexAttribDivisor(location, divisor || 0);\n    });\n    return this;\n  }\n\n  enable(location) {\n    let enable = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n    const disablingAttributeZero = !enable && location === 0 && !VertexArrayObject.isSupported(this.gl, {\n      constantAttributeZero: true\n    });\n\n    if (!disablingAttributeZero) {\n      location = Number(location);\n      this.bind(() => enable ? this.gl.enableVertexAttribArray(location) : this.gl.disableVertexAttribArray(location));\n    }\n\n    return this;\n  }\n\n  getConstantBuffer(elementCount, value) {\n    const constantValue = this._normalizeConstantArrayValue(value);\n\n    const byteLength = constantValue.byteLength * elementCount;\n    const length = constantValue.length * elementCount;\n    let updateNeeded = !this.buffer;\n    this.buffer = this.buffer || new Buffer(this.gl, byteLength);\n    updateNeeded = updateNeeded || this.buffer.reallocate(byteLength);\n    updateNeeded = updateNeeded || !this._compareConstantArrayValues(constantValue, this.bufferValue);\n\n    if (updateNeeded) {\n      const typedArray = getScratchArray(value.constructor, length);\n      fillArray({\n        target: typedArray,\n        source: constantValue,\n        start: 0,\n        count: length\n      });\n      this.buffer.subData(typedArray);\n      this.bufferValue = value;\n    }\n\n    return this.buffer;\n  }\n\n  _normalizeConstantArrayValue(arrayValue) {\n    if (Array.isArray(arrayValue)) {\n      return new Float32Array(arrayValue);\n    }\n\n    return arrayValue;\n  }\n\n  _compareConstantArrayValues(v1, v2) {\n    if (!v1 || !v2 || v1.length !== v2.length || v1.constructor !== v2.constructor) {\n      return false;\n    }\n\n    for (let i = 0; i < v1.length; ++i) {\n      if (v1[i] !== v2[i]) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  static _setConstantFloatArray(gl, location, array) {\n    switch (array.length) {\n      case 1:\n        gl.vertexAttrib1fv(location, array);\n        break;\n\n      case 2:\n        gl.vertexAttrib2fv(location, array);\n        break;\n\n      case 3:\n        gl.vertexAttrib3fv(location, array);\n        break;\n\n      case 4:\n        gl.vertexAttrib4fv(location, array);\n        break;\n\n      default:\n        assert(false);\n    }\n  }\n\n  static _setConstantIntArray(gl, location, array) {\n    assert(isWebGL2(gl));\n\n    switch (array.length) {\n      case 1:\n        gl.vertexAttribI1iv(location, array);\n        break;\n\n      case 2:\n        gl.vertexAttribI2iv(location, array);\n        break;\n\n      case 3:\n        gl.vertexAttribI3iv(location, array);\n        break;\n\n      case 4:\n        gl.vertexAttribI4iv(location, array);\n        break;\n\n      default:\n        assert(false);\n    }\n  }\n\n  static _setConstantUintArray(gl, location, array) {\n    assert(isWebGL2(gl));\n\n    switch (array.length) {\n      case 1:\n        gl.vertexAttribI1uiv(location, array);\n        break;\n\n      case 2:\n        gl.vertexAttribI2uiv(location, array);\n        break;\n\n      case 3:\n        gl.vertexAttribI3uiv(location, array);\n        break;\n\n      case 4:\n        gl.vertexAttribI4uiv(location, array);\n        break;\n\n      default:\n        assert(false);\n    }\n  }\n\n  _createHandle() {\n    const gl2 = this.gl;\n    return gl2.createVertexArray();\n  }\n\n  _deleteHandle(handle) {\n    this.gl2.deleteVertexArray(handle);\n    return [this.elements];\n  }\n\n  _bindHandle(handle) {\n    this.gl2.bindVertexArray(handle);\n  }\n\n  _getParameter(pname, _ref) {\n    let {\n      location\n    } = _ref;\n    assert(Number.isFinite(location));\n    return this.bind(() => {\n      switch (pname) {\n        case 34373:\n          return this.gl.getVertexAttribOffset(location, pname);\n\n        default:\n          return this.gl.getVertexAttrib(location, pname);\n      }\n    });\n  }\n\n}\n//# sourceMappingURL=vertex-array-object.js.map","import { log } from '@luma.gl/gltools';\nimport Accessor from './accessor';\nimport Buffer from './buffer';\nimport VertexArrayObject from './vertex-array-object';\nimport { assert } from '../utils/assert';\nimport { stubRemovedMethods } from '../utils/stub-methods';\nconst ERR_ATTRIBUTE_TYPE = 'VertexArray: attributes must be Buffers or constants (i.e. typed array)';\nconst MULTI_LOCATION_ATTRIBUTE_REGEXP = /^(.+)__LOCATION_([0-9]+)$/;\nconst DEPRECATIONS_V6 = ['setBuffers', 'setGeneric', 'clearBindings', 'setLocations', 'setGenericValues', 'setDivisor', 'enable', 'disable'];\nexport default class VertexArray {\n  constructor(gl) {\n    let opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    const id = opts.id || opts.program && opts.program.id;\n    this.id = id;\n    this.gl = gl;\n    this.configuration = null;\n    this.elements = null;\n    this.elementsAccessor = null;\n    this.values = null;\n    this.accessors = null;\n    this.unused = null;\n    this.drawParams = null;\n    this.buffer = null;\n    this.attributes = {};\n    this.vertexArrayObject = new VertexArrayObject(gl);\n    stubRemovedMethods(this, 'VertexArray', 'v6.0', DEPRECATIONS_V6);\n    this.initialize(opts);\n    Object.seal(this);\n  }\n\n  delete() {\n    if (this.buffer) {\n      this.buffer.delete();\n    }\n\n    this.vertexArrayObject.delete();\n  }\n\n  initialize() {\n    let props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    this.reset();\n    this.configuration = null;\n    this.bindOnUse = false;\n    return this.setProps(props);\n  }\n\n  reset() {\n    this.elements = null;\n    this.elementsAccessor = null;\n    const {\n      MAX_ATTRIBUTES\n    } = this.vertexArrayObject;\n    this.values = new Array(MAX_ATTRIBUTES).fill(null);\n    this.accessors = new Array(MAX_ATTRIBUTES).fill(null);\n    this.unused = {};\n    this.drawParams = null;\n    return this;\n  }\n\n  setProps(props) {\n    if ('program' in props) {\n      this.configuration = props.program && props.program.configuration;\n    }\n\n    if ('configuration' in props) {\n      this.configuration = props.configuration;\n    }\n\n    if ('attributes' in props) {\n      this.setAttributes(props.attributes);\n    }\n\n    if ('elements' in props) {\n      this.setElementBuffer(props.elements);\n    }\n\n    if ('bindOnUse' in props) {\n      props = props.bindOnUse;\n    }\n\n    return this;\n  }\n\n  clearDrawParams() {\n    this.drawParams = null;\n  }\n\n  getDrawParams() {\n    this.drawParams = this.drawParams || this._updateDrawParams();\n    return this.drawParams;\n  }\n\n  setAttributes(attributes) {\n    Object.assign(this.attributes, attributes);\n    this.vertexArrayObject.bind(() => {\n      for (const locationOrName in attributes) {\n        const value = attributes[locationOrName];\n\n        this._setAttribute(locationOrName, value);\n      }\n\n      this.gl.bindBuffer(34962, null);\n    });\n    return this;\n  }\n\n  setElementBuffer() {\n    let elementBuffer = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n    let accessor = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    this.elements = elementBuffer;\n    this.elementsAccessor = accessor;\n    this.clearDrawParams();\n    this.vertexArrayObject.setElementBuffer(elementBuffer, accessor);\n    return this;\n  }\n\n  setBuffer(locationOrName, buffer) {\n    let appAccessor = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n    if (buffer.target === 34963) {\n      return this.setElementBuffer(buffer, appAccessor);\n    }\n\n    const {\n      location,\n      accessor\n    } = this._resolveLocationAndAccessor(locationOrName, buffer, buffer.accessor, appAccessor);\n\n    if (location >= 0) {\n      this.values[location] = buffer;\n      this.accessors[location] = accessor;\n      this.clearDrawParams();\n      this.vertexArrayObject.setBuffer(location, buffer, accessor);\n    }\n\n    return this;\n  }\n\n  setConstant(locationOrName, arrayValue) {\n    let appAccessor = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n    const {\n      location,\n      accessor\n    } = this._resolveLocationAndAccessor(locationOrName, arrayValue, Object.assign({\n      size: arrayValue.length\n    }, appAccessor));\n\n    if (location >= 0) {\n      arrayValue = this.vertexArrayObject._normalizeConstantArrayValue(arrayValue);\n      this.values[location] = arrayValue;\n      this.accessors[location] = accessor;\n      this.clearDrawParams();\n      this.vertexArrayObject.enable(location, false);\n    }\n\n    return this;\n  }\n\n  unbindBuffers() {\n    this.vertexArrayObject.bind(() => {\n      if (this.elements) {\n        this.vertexArrayObject.setElementBuffer(null);\n      }\n\n      this.buffer = this.buffer || new Buffer(this.gl, {\n        accessor: {\n          size: 4\n        }\n      });\n\n      for (let location = 0; location < this.vertexArrayObject.MAX_ATTRIBUTES; location++) {\n        if (this.values[location] instanceof Buffer) {\n          this.gl.disableVertexAttribArray(location);\n          this.gl.bindBuffer(34962, this.buffer.handle);\n          this.gl.vertexAttribPointer(location, 1, 5126, false, 0, 0);\n        }\n      }\n    });\n    return this;\n  }\n\n  bindBuffers() {\n    this.vertexArrayObject.bind(() => {\n      if (this.elements) {\n        this.setElementBuffer(this.elements);\n      }\n\n      for (let location = 0; location < this.vertexArrayObject.MAX_ATTRIBUTES; location++) {\n        const buffer = this.values[location];\n\n        if (buffer instanceof Buffer) {\n          this.setBuffer(location, buffer);\n        }\n      }\n    });\n    return this;\n  }\n\n  bindForDraw(vertexCount, instanceCount, func) {\n    let value;\n    this.vertexArrayObject.bind(() => {\n      this._setConstantAttributes(vertexCount, instanceCount);\n\n      value = func();\n    });\n    return value;\n  }\n\n  _resolveLocationAndAccessor(locationOrName, value, valueAccessor, appAccessor) {\n    const INVALID_RESULT = {\n      location: -1,\n      accessor: null\n    };\n\n    const {\n      location,\n      name\n    } = this._getAttributeIndex(locationOrName);\n\n    if (!Number.isFinite(location) || location < 0) {\n      this.unused[locationOrName] = value;\n      log.once(3, () => \"unused value \".concat(locationOrName, \" in \").concat(this.id))();\n      return INVALID_RESULT;\n    }\n\n    const accessInfo = this._getAttributeInfo(name || location);\n\n    if (!accessInfo) {\n      return INVALID_RESULT;\n    }\n\n    const currentAccessor = this.accessors[location] || {};\n    const accessor = Accessor.resolve(accessInfo.accessor, currentAccessor, valueAccessor, appAccessor);\n    const {\n      size,\n      type\n    } = accessor;\n    assert(Number.isFinite(size) && Number.isFinite(type));\n    return {\n      location,\n      accessor\n    };\n  }\n\n  _getAttributeInfo(attributeName) {\n    return this.configuration && this.configuration.getAttributeInfo(attributeName);\n  }\n\n  _getAttributeIndex(locationOrName) {\n    const location = Number(locationOrName);\n\n    if (Number.isFinite(location)) {\n      return {\n        location\n      };\n    }\n\n    const multiLocation = MULTI_LOCATION_ATTRIBUTE_REGEXP.exec(locationOrName);\n    const name = multiLocation ? multiLocation[1] : locationOrName;\n    const locationOffset = multiLocation ? Number(multiLocation[2]) : 0;\n\n    if (this.configuration) {\n      return {\n        location: this.configuration.getAttributeLocation(name) + locationOffset,\n        name\n      };\n    }\n\n    return {\n      location: -1\n    };\n  }\n\n  _setAttribute(locationOrName, value) {\n    if (value instanceof Buffer) {\n      this.setBuffer(locationOrName, value);\n    } else if (Array.isArray(value) && value.length && value[0] instanceof Buffer) {\n      const buffer = value[0];\n      const accessor = value[1];\n      this.setBuffer(locationOrName, buffer, accessor);\n    } else if (ArrayBuffer.isView(value) || Array.isArray(value)) {\n      const constant = value;\n      this.setConstant(locationOrName, constant);\n    } else if (value.buffer instanceof Buffer) {\n      const accessor = value;\n      this.setBuffer(locationOrName, accessor.buffer, accessor);\n    } else {\n      throw new Error(ERR_ATTRIBUTE_TYPE);\n    }\n  }\n\n  _setConstantAttributes(vertexCount, instanceCount) {\n    const elementCount = Math.max(vertexCount | 0, instanceCount | 0);\n    let constant = this.values[0];\n\n    if (ArrayBuffer.isView(constant)) {\n      this._setConstantAttributeZero(constant, elementCount);\n    }\n\n    for (let location = 1; location < this.vertexArrayObject.MAX_ATTRIBUTES; location++) {\n      constant = this.values[location];\n\n      if (ArrayBuffer.isView(constant)) {\n        this._setConstantAttribute(location, constant);\n      }\n    }\n  }\n\n  _setConstantAttributeZero(constant, elementCount) {\n    if (VertexArrayObject.isSupported(this.gl, {\n      constantAttributeZero: true\n    })) {\n      this._setConstantAttribute(0, constant);\n\n      return;\n    }\n\n    const buffer = this.vertexArrayObject.getConstantBuffer(elementCount, constant);\n    this.vertexArrayObject.setBuffer(0, buffer, this.accessors[0]);\n  }\n\n  _setConstantAttribute(location, constant) {\n    VertexArrayObject.setConstant(this.gl, location, constant);\n  }\n\n  _updateDrawParams() {\n    const drawParams = {\n      isIndexed: false,\n      isInstanced: false,\n      indexCount: Infinity,\n      vertexCount: Infinity,\n      instanceCount: Infinity\n    };\n\n    for (let location = 0; location < this.vertexArrayObject.MAX_ATTRIBUTES; location++) {\n      this._updateDrawParamsForLocation(drawParams, location);\n    }\n\n    if (this.elements) {\n      drawParams.elementCount = this.elements.getElementCount(this.elements.accessor);\n      drawParams.isIndexed = true;\n      drawParams.indexType = this.elementsAccessor.type || this.elements.accessor.type;\n      drawParams.indexOffset = this.elementsAccessor.offset || 0;\n    }\n\n    if (drawParams.indexCount === Infinity) {\n      drawParams.indexCount = 0;\n    }\n\n    if (drawParams.vertexCount === Infinity) {\n      drawParams.vertexCount = 0;\n    }\n\n    if (drawParams.instanceCount === Infinity) {\n      drawParams.instanceCount = 0;\n    }\n\n    return drawParams;\n  }\n\n  _updateDrawParamsForLocation(drawParams, location) {\n    const value = this.values[location];\n    const accessor = this.accessors[location];\n\n    if (!value) {\n      return;\n    }\n\n    const {\n      divisor\n    } = accessor;\n    const isInstanced = divisor > 0;\n    drawParams.isInstanced = drawParams.isInstanced || isInstanced;\n\n    if (value instanceof Buffer) {\n      const buffer = value;\n\n      if (isInstanced) {\n        const instanceCount = buffer.getVertexCount(accessor);\n        drawParams.instanceCount = Math.min(drawParams.instanceCount, instanceCount);\n      } else {\n        const vertexCount = buffer.getVertexCount(accessor);\n        drawParams.vertexCount = Math.min(drawParams.vertexCount, vertexCount);\n      }\n    }\n  }\n\n  setElements() {\n    let elementBuffer = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n    let accessor = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    log.deprecated('setElements', 'setElementBuffer')();\n    return this.setElementBuffer(elementBuffer, accessor);\n  }\n\n}\n//# sourceMappingURL=vertex-array.js.map","function formatArrayValue(v, opts) {\n  const {\n    maxElts = 16,\n    size = 1\n  } = opts;\n  let string = '[';\n\n  for (let i = 0; i < v.length && i < maxElts; ++i) {\n    if (i > 0) {\n      string += \",\".concat(i % size === 0 ? ' ' : '');\n    }\n\n    string += formatValue(v[i], opts);\n  }\n\n  const terminator = v.length > maxElts ? '...' : ']';\n  return \"\".concat(string).concat(terminator);\n}\n\nexport function formatValue(v) {\n  let opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  const EPSILON = 1e-16;\n  const {\n    isInteger = false\n  } = opts;\n\n  if (Array.isArray(v) || ArrayBuffer.isView(v)) {\n    return formatArrayValue(v, opts);\n  }\n\n  if (!Number.isFinite(v)) {\n    return String(v);\n  }\n\n  if (Math.abs(v) < EPSILON) {\n    return isInteger ? '0' : '0.';\n  }\n\n  if (isInteger) {\n    return v.toFixed(0);\n  }\n\n  if (Math.abs(v) > 100 && Math.abs(v) < 10000) {\n    return v.toFixed(0);\n  }\n\n  const string = v.toPrecision(2);\n  const decimal = string.indexOf('.0');\n  return decimal === string.length - 2 ? string.slice(0, -1) : string;\n}\n//# sourceMappingURL=format-value.js.map","import { assert } from '../utils/assert';\nimport { formatValue } from '../utils/format-value';\nexport function getDebugTableForUniforms(_ref) {\n  let {\n    header = 'Uniforms',\n    program,\n    uniforms,\n    undefinedOnly = false\n  } = _ref;\n  assert(program);\n  const SHADER_MODULE_UNIFORM_REGEXP = '.*_.*';\n  const PROJECT_MODULE_UNIFORM_REGEXP = '.*Matrix';\n  const uniformLocations = program._uniformSetters;\n  const table = {};\n  const uniformNames = Object.keys(uniformLocations).sort();\n  let count = 0;\n\n  for (const uniformName of uniformNames) {\n    if (!uniformName.match(SHADER_MODULE_UNIFORM_REGEXP) && !uniformName.match(PROJECT_MODULE_UNIFORM_REGEXP)) {\n      if (addUniformToTable({\n        table,\n        header,\n        uniforms,\n        uniformName,\n        undefinedOnly\n      })) {\n        count++;\n      }\n    }\n  }\n\n  for (const uniformName of uniformNames) {\n    if (uniformName.match(PROJECT_MODULE_UNIFORM_REGEXP)) {\n      if (addUniformToTable({\n        table,\n        header,\n        uniforms,\n        uniformName,\n        undefinedOnly\n      })) {\n        count++;\n      }\n    }\n  }\n\n  for (const uniformName of uniformNames) {\n    if (!table[uniformName]) {\n      if (addUniformToTable({\n        table,\n        header,\n        uniforms,\n        uniformName,\n        undefinedOnly\n      })) {\n        count++;\n      }\n    }\n  }\n\n  let unusedCount = 0;\n  const unusedTable = {};\n\n  if (!undefinedOnly) {\n    for (const uniformName in uniforms) {\n      const uniform = uniforms[uniformName];\n\n      if (!table[uniformName]) {\n        unusedCount++;\n        unusedTable[uniformName] = {\n          Type: \"NOT USED: \".concat(uniform),\n          [header]: formatValue(uniform)\n        };\n      }\n    }\n  }\n\n  return {\n    table,\n    count,\n    unusedTable,\n    unusedCount\n  };\n}\n\nfunction addUniformToTable(_ref2) {\n  let {\n    table,\n    header,\n    uniforms,\n    uniformName,\n    undefinedOnly\n  } = _ref2;\n  const value = uniforms[uniformName];\n  const isDefined = isUniformDefined(value);\n\n  if (!undefinedOnly || !isDefined) {\n    table[uniformName] = {\n      [header]: isDefined ? formatValue(value) : 'N/A',\n      'Uniform Type': isDefined ? value : 'NOT PROVIDED'\n    };\n    return true;\n  }\n\n  return false;\n}\n\nfunction isUniformDefined(value) {\n  return value !== undefined && value !== null;\n}\n//# sourceMappingURL=debug-uniforms.js.map","import Buffer from '../classes/buffer';\nimport { getKey } from '../webgl-utils/constants-to-keys';\nimport { getCompositeGLType } from '../webgl-utils/attribute-utils';\nimport { formatValue } from '../utils/format-value';\nexport function getDebugTableForVertexArray(_ref) {\n  let {\n    vertexArray,\n    header = 'Attributes'\n  } = _ref;\n\n  if (!vertexArray.configuration) {\n    return {};\n  }\n\n  const table = {};\n\n  if (vertexArray.elements) {\n    table.ELEMENT_ARRAY_BUFFER = getDebugTableRow(vertexArray, vertexArray.elements, null, header);\n  }\n\n  const attributes = vertexArray.values;\n\n  for (const attributeLocation in attributes) {\n    const info = vertexArray._getAttributeInfo(attributeLocation);\n\n    if (info) {\n      let rowHeader = \"\".concat(attributeLocation, \": \").concat(info.name);\n      const accessor = vertexArray.accessors[info.location];\n\n      if (accessor) {\n        rowHeader = \"\".concat(attributeLocation, \": \").concat(getGLSLDeclaration(info.name, accessor));\n      }\n\n      table[rowHeader] = getDebugTableRow(vertexArray, attributes[attributeLocation], accessor, header);\n    }\n  }\n\n  return table;\n}\n\nfunction getDebugTableRow(vertexArray, attribute, accessor, header) {\n  const {\n    gl\n  } = vertexArray;\n\n  if (!attribute) {\n    return {\n      [header]: 'null',\n      'Format ': 'N/A'\n    };\n  }\n\n  let type = 'NOT PROVIDED';\n  let size = 1;\n  let verts = 0;\n  let bytes = 0;\n  let isInteger;\n  let marker;\n  let value;\n\n  if (accessor) {\n    type = accessor.type;\n    size = accessor.size;\n    type = String(type).replace('Array', '');\n    isInteger = type.indexOf('nt') !== -1;\n  }\n\n  if (attribute instanceof Buffer) {\n    const buffer = attribute;\n    const {\n      data,\n      changed\n    } = buffer.getDebugData();\n    marker = changed ? '*' : '';\n    value = data;\n    bytes = buffer.byteLength;\n    verts = bytes / data.BYTES_PER_ELEMENT / size;\n    let format;\n\n    if (accessor) {\n      const instanced = accessor.divisor > 0;\n      format = \"\".concat(instanced ? 'I ' : 'P ', \" \").concat(verts, \" (x\").concat(size, \"=\").concat(bytes, \" bytes \").concat(getKey(gl, type), \")\");\n    } else {\n      isInteger = true;\n      format = \"\".concat(bytes, \" bytes\");\n    }\n\n    return {\n      [header]: \"\".concat(marker).concat(formatValue(value, {\n        size,\n        isInteger\n      })),\n      'Format ': format\n    };\n  }\n\n  value = attribute;\n  size = attribute.length;\n  type = String(attribute.constructor.name).replace('Array', '');\n  isInteger = type.indexOf('nt') !== -1;\n  return {\n    [header]: \"\".concat(formatValue(value, {\n      size,\n      isInteger\n    }), \" (constant)\"),\n    'Format ': \"\".concat(size, \"x\").concat(type, \" (constant)\")\n  };\n}\n\nfunction getGLSLDeclaration(name, accessor) {\n  const {\n    type,\n    size\n  } = accessor;\n  const typeAndName = getCompositeGLType(type, size);\n  return typeAndName ? \"\".concat(name, \" (\").concat(typeAndName.name, \")\") : name;\n}\n//# sourceMappingURL=debug-vertex-array.js.map","import { getCompositeGLType } from '../webgl-utils/attribute-utils';\nexport function getDebugTableForProgramConfiguration(config) {\n  const table = {};\n  const header = \"Accessors for \".concat(config.id);\n\n  for (const attributeInfo of config.attributeInfos) {\n    if (attributeInfo) {\n      const glslDeclaration = getGLSLDeclaration(attributeInfo);\n      table[\"in \".concat(glslDeclaration)] = {\n        [header]: JSON.stringify(attributeInfo.accessor)\n      };\n    }\n  }\n\n  for (const varyingInfo of config.varyingInfos) {\n    if (varyingInfo) {\n      const glslDeclaration = getGLSLDeclaration(varyingInfo);\n      table[\"out \".concat(glslDeclaration)] = {\n        [header]: JSON.stringify(varyingInfo.accessor)\n      };\n    }\n  }\n\n  return table;\n}\n\nfunction getGLSLDeclaration(attributeInfo) {\n  const {\n    type,\n    size\n  } = attributeInfo.accessor;\n  const typeAndName = getCompositeGLType(type, size);\n\n  if (typeAndName) {\n    return \"\".concat(typeAndName.name, \" \").concat(attributeInfo.name);\n  }\n\n  return attributeInfo.name;\n}\n//# sourceMappingURL=debug-program-configuration.js.map","import { isWebGL, createGLContext, instrumentGLContext, resizeGLContext, resetParameters } from '@luma.gl/gltools';\nimport { requestAnimationFrame, cancelAnimationFrame, Query, lumaStats, Framebuffer, log, assert } from '@luma.gl/webgl';\nimport { isBrowser } from '@probe.gl/env';\nconst isPage = isBrowser() && typeof document !== 'undefined';\nlet statIdCounter = 0;\nexport default class AnimationLoop {\n  constructor() {\n    let props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    const {\n      onCreateContext = opts => createGLContext(opts),\n      onAddHTML = null,\n      onInitialize = () => {},\n      onRender = () => {},\n      onFinalize = () => {},\n      onError,\n      gl = null,\n      glOptions = {},\n      debug = false,\n      createFramebuffer = false,\n      autoResizeViewport = true,\n      autoResizeDrawingBuffer = true,\n      stats = lumaStats.get(\"animation-loop-\".concat(statIdCounter++))\n    } = props;\n    let {\n      useDevicePixels = true\n    } = props;\n\n    if ('useDevicePixelRatio' in props) {\n      log.deprecated('useDevicePixelRatio', 'useDevicePixels')();\n      useDevicePixels = props.useDevicePixelRatio;\n    }\n\n    this.props = {\n      onCreateContext,\n      onAddHTML,\n      onInitialize,\n      onRender,\n      onFinalize,\n      onError,\n      gl,\n      glOptions,\n      debug,\n      createFramebuffer\n    };\n    this.gl = gl;\n    this.needsRedraw = null;\n    this.timeline = null;\n    this.stats = stats;\n    this.cpuTime = this.stats.get('CPU Time');\n    this.gpuTime = this.stats.get('GPU Time');\n    this.frameRate = this.stats.get('Frame Rate');\n    this._initialized = false;\n    this._running = false;\n    this._animationFrameId = null;\n    this._nextFramePromise = null;\n    this._resolveNextFrame = null;\n    this._cpuStartTime = 0;\n    this.setProps({\n      autoResizeViewport,\n      autoResizeDrawingBuffer,\n      useDevicePixels\n    });\n    this.start = this.start.bind(this);\n    this.stop = this.stop.bind(this);\n    this._pageLoadPromise = null;\n    this._onMousemove = this._onMousemove.bind(this);\n    this._onMouseleave = this._onMouseleave.bind(this);\n  }\n\n  delete() {\n    this.stop();\n\n    this._setDisplay(null);\n  }\n\n  setNeedsRedraw(reason) {\n    assert(typeof reason === 'string');\n    this.needsRedraw = this.needsRedraw || reason;\n    return this;\n  }\n\n  setProps(props) {\n    if ('autoResizeViewport' in props) {\n      this.autoResizeViewport = props.autoResizeViewport;\n    }\n\n    if ('autoResizeDrawingBuffer' in props) {\n      this.autoResizeDrawingBuffer = props.autoResizeDrawingBuffer;\n    }\n\n    if ('useDevicePixels' in props) {\n      this.useDevicePixels = props.useDevicePixels;\n    }\n\n    return this;\n  }\n\n  start() {\n    let opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    if (this._running) {\n      return this;\n    }\n\n    this._running = true;\n\n    const startPromise = this._getPageLoadPromise().then(() => {\n      if (!this._running || this._initialized) {\n        return null;\n      }\n\n      this._createWebGLContext(opts);\n\n      this._createFramebuffer();\n\n      this._startEventHandling();\n\n      this._initializeCallbackData();\n\n      this._updateCallbackData();\n\n      this._resizeCanvasDrawingBuffer();\n\n      this._resizeViewport();\n\n      this._gpuTimeQuery = Query.isSupported(this.gl, ['timers']) ? new Query(this.gl) : null;\n      this._initialized = true;\n      return this.onInitialize(this.animationProps);\n    }).then(appContext => {\n      if (this._running) {\n        this._addCallbackData(appContext || {});\n\n        if (appContext !== false) {\n          this._startLoop();\n        }\n      }\n    });\n\n    if (this.props.onError) {\n      startPromise.catch(this.props.onError);\n    }\n\n    return this;\n  }\n\n  redraw() {\n    if (this.isContextLost()) {\n      return this;\n    }\n\n    this._beginTimers();\n\n    this._setupFrame();\n\n    this._updateCallbackData();\n\n    this._renderFrame(this.animationProps);\n\n    this._clearNeedsRedraw();\n\n    if (this.offScreen && this.gl.commit) {\n      this.gl.commit();\n    }\n\n    if (this._resolveNextFrame) {\n      this._resolveNextFrame(this);\n\n      this._nextFramePromise = null;\n      this._resolveNextFrame = null;\n    }\n\n    this._endTimers();\n\n    return this;\n  }\n\n  stop() {\n    if (this._running) {\n      this._finalizeCallbackData();\n\n      this._cancelAnimationFrame(this._animationFrameId);\n\n      this._nextFramePromise = null;\n      this._resolveNextFrame = null;\n      this._animationFrameId = null;\n      this._running = false;\n    }\n\n    return this;\n  }\n\n  attachTimeline(timeline) {\n    this.timeline = timeline;\n    return this.timeline;\n  }\n\n  detachTimeline() {\n    this.timeline = null;\n  }\n\n  waitForRender() {\n    this.setNeedsRedraw('waitForRender');\n\n    if (!this._nextFramePromise) {\n      this._nextFramePromise = new Promise(resolve => {\n        this._resolveNextFrame = resolve;\n      });\n    }\n\n    return this._nextFramePromise;\n  }\n\n  async toDataURL() {\n    this.setNeedsRedraw('toDataURL');\n    await this.waitForRender();\n    return this.gl.canvas.toDataURL();\n  }\n\n  isContextLost() {\n    return this.gl.isContextLost();\n  }\n\n  onCreateContext() {\n    return this.props.onCreateContext(...arguments);\n  }\n\n  onInitialize() {\n    return this.props.onInitialize(...arguments);\n  }\n\n  onRender() {\n    return this.props.onRender(...arguments);\n  }\n\n  onFinalize() {\n    return this.props.onFinalize(...arguments);\n  }\n\n  getHTMLControlValue(id) {\n    let defaultValue = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n    const element = document.getElementById(id);\n    return element ? Number(element.value) : defaultValue;\n  }\n\n  setViewParameters() {\n    log.removed('AnimationLoop.setViewParameters', 'AnimationLoop.setProps')();\n    return this;\n  }\n\n  _startLoop() {\n    const renderFrame = () => {\n      if (!this._running) {\n        return;\n      }\n\n      this.redraw();\n      this._animationFrameId = this._requestAnimationFrame(renderFrame);\n    };\n\n    this._cancelAnimationFrame(this._animationFrameId);\n\n    this._animationFrameId = this._requestAnimationFrame(renderFrame);\n  }\n\n  _getPageLoadPromise() {\n    if (!this._pageLoadPromise) {\n      this._pageLoadPromise = isPage ? new Promise((resolve, reject) => {\n        if (isPage && document.readyState === 'complete') {\n          resolve(document);\n          return;\n        }\n\n        window.addEventListener('load', () => {\n          resolve(document);\n        });\n      }) : Promise.resolve({});\n    }\n\n    return this._pageLoadPromise;\n  }\n\n  _setDisplay(display) {\n    if (this.display) {\n      this.display.delete();\n      this.display.animationLoop = null;\n    }\n\n    if (display) {\n      display.animationLoop = this;\n    }\n\n    this.display = display;\n  }\n\n  _cancelAnimationFrame(animationFrameId) {\n    if (this.display && this.display.cancelAnimationFrame) {\n      return this.display.cancelAnimationFrame(animationFrameId);\n    }\n\n    return cancelAnimationFrame(animationFrameId);\n  }\n\n  _requestAnimationFrame(renderFrameCallback) {\n    if (this._running) {\n      if (this.display && this.display.requestAnimationFrame) {\n        return this.display.requestAnimationFrame(renderFrameCallback);\n      }\n\n      return requestAnimationFrame(renderFrameCallback);\n    }\n\n    return undefined;\n  }\n\n  _renderFrame() {\n    if (this.display) {\n      this.display._renderFrame(...arguments);\n\n      return;\n    }\n\n    this.onRender(...arguments);\n  }\n\n  _clearNeedsRedraw() {\n    this.needsRedraw = null;\n  }\n\n  _setupFrame() {\n    this._resizeCanvasDrawingBuffer();\n\n    this._resizeViewport();\n\n    this._resizeFramebuffer();\n  }\n\n  _initializeCallbackData() {\n    this.animationProps = {\n      gl: this.gl,\n      stop: this.stop,\n      canvas: this.gl.canvas,\n      framebuffer: this.framebuffer,\n      useDevicePixels: this.useDevicePixels,\n      needsRedraw: null,\n      startTime: Date.now(),\n      engineTime: 0,\n      tick: 0,\n      tock: 0,\n      time: 0,\n      _timeline: this.timeline,\n      _loop: this,\n      _animationLoop: this,\n      _mousePosition: null\n    };\n  }\n\n  _updateCallbackData() {\n    const {\n      width,\n      height,\n      aspect\n    } = this._getSizeAndAspect();\n\n    if (width !== this.animationProps.width || height !== this.animationProps.height) {\n      this.setNeedsRedraw('drawing buffer resized');\n    }\n\n    if (aspect !== this.animationProps.aspect) {\n      this.setNeedsRedraw('drawing buffer aspect changed');\n    }\n\n    this.animationProps.width = width;\n    this.animationProps.height = height;\n    this.animationProps.aspect = aspect;\n    this.animationProps.needsRedraw = this.needsRedraw;\n    this.animationProps.engineTime = Date.now() - this.animationProps.startTime;\n\n    if (this.timeline) {\n      this.timeline.update(this.animationProps.engineTime);\n    }\n\n    this.animationProps.tick = Math.floor(this.animationProps.time / 1000 * 60);\n    this.animationProps.tock++;\n    this.animationProps.time = this.timeline ? this.timeline.getTime() : this.animationProps.engineTime;\n    this.animationProps._offScreen = this.offScreen;\n  }\n\n  _finalizeCallbackData() {\n    this.onFinalize(this.animationProps);\n  }\n\n  _addCallbackData(appContext) {\n    if (typeof appContext === 'object' && appContext !== null) {\n      this.animationProps = Object.assign({}, this.animationProps, appContext);\n    }\n  }\n\n  _createWebGLContext(opts) {\n    this.offScreen = opts.canvas && typeof OffscreenCanvas !== 'undefined' && opts.canvas instanceof OffscreenCanvas;\n    opts = Object.assign({}, opts, this.props.glOptions);\n    this.gl = this.props.gl ? instrumentGLContext(this.props.gl, opts) : this.onCreateContext(opts);\n\n    if (!isWebGL(this.gl)) {\n      throw new Error('AnimationLoop.onCreateContext - illegal context returned');\n    }\n\n    resetParameters(this.gl);\n\n    this._createInfoDiv();\n  }\n\n  _createInfoDiv() {\n    if (this.gl.canvas && this.props.onAddHTML) {\n      const wrapperDiv = document.createElement('div');\n      document.body.appendChild(wrapperDiv);\n      wrapperDiv.style.position = 'relative';\n      const div = document.createElement('div');\n      div.style.position = 'absolute';\n      div.style.left = '10px';\n      div.style.bottom = '10px';\n      div.style.width = '300px';\n      div.style.background = 'white';\n      wrapperDiv.appendChild(this.gl.canvas);\n      wrapperDiv.appendChild(div);\n      const html = this.props.onAddHTML(div);\n\n      if (html) {\n        div.innerHTML = html;\n      }\n    }\n  }\n\n  _getSizeAndAspect() {\n    const width = this.gl.drawingBufferWidth;\n    const height = this.gl.drawingBufferHeight;\n    let aspect = 1;\n    const {\n      canvas\n    } = this.gl;\n\n    if (canvas && canvas.clientHeight) {\n      aspect = canvas.clientWidth / canvas.clientHeight;\n    } else if (width > 0 && height > 0) {\n      aspect = width / height;\n    }\n\n    return {\n      width,\n      height,\n      aspect\n    };\n  }\n\n  _resizeViewport() {\n    if (this.autoResizeViewport) {\n      this.gl.viewport(0, 0, this.gl.drawingBufferWidth, this.gl.drawingBufferHeight);\n    }\n  }\n\n  _resizeCanvasDrawingBuffer() {\n    if (this.autoResizeDrawingBuffer) {\n      resizeGLContext(this.gl, {\n        useDevicePixels: this.useDevicePixels\n      });\n    }\n  }\n\n  _createFramebuffer() {\n    if (this.props.createFramebuffer) {\n      this.framebuffer = new Framebuffer(this.gl);\n    }\n  }\n\n  _resizeFramebuffer() {\n    if (this.framebuffer) {\n      this.framebuffer.resize({\n        width: this.gl.drawingBufferWidth,\n        height: this.gl.drawingBufferHeight\n      });\n    }\n  }\n\n  _beginTimers() {\n    this.frameRate.timeEnd();\n    this.frameRate.timeStart();\n\n    if (this._gpuTimeQuery && this._gpuTimeQuery.isResultAvailable() && !this._gpuTimeQuery.isTimerDisjoint()) {\n      this.stats.get('GPU Time').addTime(this._gpuTimeQuery.getTimerMilliseconds());\n    }\n\n    if (this._gpuTimeQuery) {\n      this._gpuTimeQuery.beginTimeElapsedQuery();\n    }\n\n    this.cpuTime.timeStart();\n  }\n\n  _endTimers() {\n    this.cpuTime.timeEnd();\n\n    if (this._gpuTimeQuery) {\n      this._gpuTimeQuery.end();\n    }\n  }\n\n  _startEventHandling() {\n    const {\n      canvas\n    } = this.gl;\n\n    if (canvas) {\n      canvas.addEventListener('mousemove', this._onMousemove);\n      canvas.addEventListener('mouseleave', this._onMouseleave);\n    }\n  }\n\n  _onMousemove(e) {\n    this.animationProps._mousePosition = [e.offsetX, e.offsetY];\n  }\n\n  _onMouseleave(e) {\n    this.animationProps._mousePosition = null;\n  }\n\n}\n//# sourceMappingURL=animation-loop.js.map","export const VERTEX_SHADER = 'vs';\nexport const FRAGMENT_SHADER = 'fs';\n//# sourceMappingURL=constants.js.map","export default function assert(condition, message) {\n  if (!condition) {\n    throw new Error(message || 'shadertools: assertion failed.');\n  }\n}\n//# sourceMappingURL=assert.js.map","const TYPE_DEFINITIONS = {\n  number: {\n    validate(value, propType) {\n      return Number.isFinite(value) && (!('max' in propType) || value <= propType.max) && (!('min' in propType) || value >= propType.min);\n    }\n\n  },\n  array: {\n    validate(value, propType) {\n      return Array.isArray(value) || ArrayBuffer.isView(value);\n    }\n\n  }\n};\nexport function parsePropTypes(propDefs) {\n  const propTypes = {};\n\n  for (const propName in propDefs) {\n    const propDef = propDefs[propName];\n    const propType = parsePropType(propDef);\n    propTypes[propName] = propType;\n  }\n\n  return propTypes;\n}\n\nfunction parsePropType(propDef) {\n  let type = getTypeOf(propDef);\n\n  if (type === 'object') {\n    if (!propDef) {\n      return {\n        type: 'object',\n        value: null\n      };\n    }\n\n    if ('type' in propDef) {\n      return Object.assign({}, propDef, TYPE_DEFINITIONS[propDef.type]);\n    }\n\n    if (!('value' in propDef)) {\n      return {\n        type: 'object',\n        value: propDef\n      };\n    }\n\n    type = getTypeOf(propDef.value);\n    return Object.assign({\n      type\n    }, propDef, TYPE_DEFINITIONS[type]);\n  }\n\n  return Object.assign({\n    type,\n    value: propDef\n  }, TYPE_DEFINITIONS[type]);\n}\n\nfunction getTypeOf(value) {\n  if (Array.isArray(value) || ArrayBuffer.isView(value)) {\n    return 'array';\n  }\n\n  return typeof value;\n}\n//# sourceMappingURL=prop-types.js.map","import { assert } from '../utils';\nimport { parsePropTypes } from './filters/prop-types';\nconst VERTEX_SHADER = 'vs';\nconst FRAGMENT_SHADER = 'fs';\nexport default class ShaderModule {\n  constructor(_ref) {\n    let {\n      name,\n      vs,\n      fs,\n      dependencies = [],\n      uniforms,\n      getUniforms,\n      deprecations = [],\n      defines = {},\n      inject = {},\n      vertexShader,\n      fragmentShader\n    } = _ref;\n    assert(typeof name === 'string');\n    this.name = name;\n    this.vs = vs || vertexShader;\n    this.fs = fs || fragmentShader;\n    this.getModuleUniforms = getUniforms;\n    this.dependencies = dependencies;\n    this.deprecations = this._parseDeprecationDefinitions(deprecations);\n    this.defines = defines;\n    this.injections = normalizeInjections(inject);\n\n    if (uniforms) {\n      this.uniforms = parsePropTypes(uniforms);\n    }\n  }\n\n  getModuleSource(type) {\n    let moduleSource;\n\n    switch (type) {\n      case VERTEX_SHADER:\n        moduleSource = this.vs || '';\n        break;\n\n      case FRAGMENT_SHADER:\n        moduleSource = this.fs || '';\n        break;\n\n      default:\n        assert(false);\n    }\n\n    return \"#define MODULE_\".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi, '_'), \"\\n\").concat(moduleSource, \"// END MODULE_\").concat(this.name, \"\\n\\n\");\n  }\n\n  getUniforms(opts, uniforms) {\n    if (this.getModuleUniforms) {\n      return this.getModuleUniforms(opts, uniforms);\n    }\n\n    if (this.uniforms) {\n      return this._defaultGetUniforms(opts);\n    }\n\n    return {};\n  }\n\n  getDefines() {\n    return this.defines;\n  }\n\n  checkDeprecations(shaderSource, log) {\n    this.deprecations.forEach(def => {\n      if (def.regex.test(shaderSource)) {\n        if (def.deprecated) {\n          log.deprecated(def.old, def.new)();\n        } else {\n          log.removed(def.old, def.new)();\n        }\n      }\n    });\n  }\n\n  _parseDeprecationDefinitions(deprecations) {\n    deprecations.forEach(def => {\n      switch (def.type) {\n        case 'function':\n          def.regex = new RegExp(\"\\\\b\".concat(def.old, \"\\\\(\"));\n          break;\n\n        default:\n          def.regex = new RegExp(\"\".concat(def.type, \" \").concat(def.old, \";\"));\n      }\n    });\n    return deprecations;\n  }\n\n  _defaultGetUniforms() {\n    let opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    const uniforms = {};\n    const propTypes = this.uniforms;\n\n    for (const key in propTypes) {\n      const propDef = propTypes[key];\n\n      if (key in opts && !propDef.private) {\n        if (propDef.validate) {\n          assert(propDef.validate(opts[key], propDef), \"\".concat(this.name, \": invalid \").concat(key));\n        }\n\n        uniforms[key] = opts[key];\n      } else {\n        uniforms[key] = propDef.value;\n      }\n    }\n\n    return uniforms;\n  }\n\n}\nexport function normalizeShaderModule(module) {\n  if (!module.normalized) {\n    module.normalized = true;\n\n    if (module.uniforms && !module.getUniforms) {\n      const shaderModule = new ShaderModule(module);\n      module.getUniforms = shaderModule.getUniforms.bind(shaderModule);\n    }\n  }\n\n  return module;\n}\n\nfunction normalizeInjections(injections) {\n  const result = {\n    vs: {},\n    fs: {}\n  };\n\n  for (const hook in injections) {\n    let injection = injections[hook];\n    const stage = hook.slice(0, 2);\n\n    if (typeof injection === 'string') {\n      injection = {\n        order: 0,\n        injection\n      };\n    }\n\n    result[stage][hook] = injection;\n  }\n\n  return result;\n}\n//# sourceMappingURL=shader-module.js.map","import ShaderModule from './shader-module';\nimport { assert } from '../utils';\nexport function resolveModules(modules) {\n  return getShaderDependencies(instantiateModules(modules));\n}\n\nfunction getShaderDependencies(modules) {\n  const moduleMap = {};\n  const moduleDepth = {};\n  getDependencyGraph({\n    modules,\n    level: 0,\n    moduleMap,\n    moduleDepth\n  });\n  return Object.keys(moduleDepth).sort((a, b) => moduleDepth[b] - moduleDepth[a]).map(name => moduleMap[name]);\n}\n\nfunction getDependencyGraph(_ref) {\n  let {\n    modules,\n    level,\n    moduleMap,\n    moduleDepth\n  } = _ref;\n\n  if (level >= 5) {\n    throw new Error('Possible loop in shader dependency graph');\n  }\n\n  for (const module of modules) {\n    moduleMap[module.name] = module;\n\n    if (moduleDepth[module.name] === undefined || moduleDepth[module.name] < level) {\n      moduleDepth[module.name] = level;\n    }\n  }\n\n  for (const module of modules) {\n    if (module.dependencies) {\n      getDependencyGraph({\n        modules: module.dependencies,\n        level: level + 1,\n        moduleMap,\n        moduleDepth\n      });\n    }\n  }\n}\n\nfunction instantiateModules(modules, seen) {\n  return modules.map(module => {\n    if (module instanceof ShaderModule) {\n      return module;\n    }\n\n    assert(typeof module !== 'string', \"Shader module use by name is deprecated. Import shader module '\".concat(module, \"' and use it directly.\"));\n    assert(module.name, 'shader module has no name');\n    module = new ShaderModule(module);\n    module.dependencies = instantiateModules(module.dependencies);\n    return module;\n  });\n}\n\nexport const TEST_EXPORTS = {\n  getShaderDependencies,\n  getDependencyGraph\n};\n//# sourceMappingURL=resolve-modules.js.map","export default function isOldIE() {\n  let opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  const navigator = typeof window !== 'undefined' ? window.navigator || {} : {};\n  const userAgent = opts.userAgent || navigator.userAgent || '';\n  const isMSIE = userAgent.indexOf('MSIE ') !== -1;\n  const isTrident = userAgent.indexOf('Trident/') !== -1;\n  return isMSIE || isTrident;\n}\n//# sourceMappingURL=is-old-ie.js.map","import isOldIE from './is-old-ie';\nimport assert from './assert';\nconst GL_VENDOR = 0x1f00;\nconst GL_RENDERER = 0x1f01;\nconst GL_VERSION = 0x1f02;\nconst GL_SHADING_LANGUAGE_VERSION = 0x8b8c;\nconst WEBGL_FEATURES = {\n  GLSL_FRAG_DATA: ['WEBGL_draw_buffers', true],\n  GLSL_FRAG_DEPTH: ['EXT_frag_depth', true],\n  GLSL_DERIVATIVES: ['OES_standard_derivatives', true],\n  GLSL_TEXTURE_LOD: ['EXT_shader_texture_lod', true]\n};\nconst FEATURES = {};\nObject.keys(WEBGL_FEATURES).forEach(key => {\n  FEATURES[key] = key;\n});\nexport { FEATURES };\n\nfunction isWebGL2(gl) {\n  if (typeof WebGL2RenderingContext !== 'undefined' && gl instanceof WebGL2RenderingContext) {\n    return true;\n  }\n\n  return Boolean(gl && gl._version === 2);\n}\n\nexport function getContextInfo(gl) {\n  const info = gl.getExtension('WEBGL_debug_renderer_info');\n  const vendor = gl.getParameter(info && info.UNMASKED_VENDOR_WEBGL || GL_VENDOR);\n  const renderer = gl.getParameter(info && info.UNMASKED_RENDERER_WEBGL || GL_RENDERER);\n  const gpuVendor = identifyGPUVendor(vendor, renderer);\n  const gpuInfo = {\n    gpuVendor,\n    vendor,\n    renderer,\n    version: gl.getParameter(GL_VERSION),\n    shadingLanguageVersion: gl.getParameter(GL_SHADING_LANGUAGE_VERSION)\n  };\n  return gpuInfo;\n}\n\nfunction identifyGPUVendor(vendor, renderer) {\n  if (vendor.match(/NVIDIA/i) || renderer.match(/NVIDIA/i)) {\n    return 'NVIDIA';\n  }\n\n  if (vendor.match(/INTEL/i) || renderer.match(/INTEL/i)) {\n    return 'INTEL';\n  }\n\n  if (vendor.match(/AMD/i) || renderer.match(/AMD/i) || vendor.match(/ATI/i) || renderer.match(/ATI/i)) {\n    return 'AMD';\n  }\n\n  return 'UNKNOWN GPU';\n}\n\nconst compiledGlslExtensions = {};\nexport function canCompileGLGSExtension(gl, cap) {\n  let opts = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  const feature = WEBGL_FEATURES[cap];\n  assert(feature, cap);\n\n  if (!isOldIE(opts)) {\n    return true;\n  }\n\n  if (cap in compiledGlslExtensions) {\n    return compiledGlslExtensions[cap];\n  }\n\n  const extensionName = feature[0];\n  const behavior = opts.behavior || 'enable';\n  const source = \"#extension GL_\".concat(extensionName, \" : \").concat(behavior, \"\\nvoid main(void) {}\");\n  const shader = gl.createShader(35633);\n  gl.shaderSource(shader, source);\n  gl.compileShader(shader);\n  const canCompile = gl.getShaderParameter(shader, 35713);\n  gl.deleteShader(shader);\n  compiledGlslExtensions[cap] = canCompile;\n  return canCompile;\n}\n\nfunction getFeature(gl, cap) {\n  const feature = WEBGL_FEATURES[cap];\n  assert(feature, cap);\n  const extensionName = isWebGL2(gl) ? feature[1] || feature[0] : feature[0];\n  const value = typeof extensionName === 'string' ? Boolean(gl.getExtension(extensionName)) : extensionName;\n  assert(value === false || value === true);\n  return value;\n}\n\nexport function hasFeatures(gl, features) {\n  features = Array.isArray(features) ? features : [features];\n  return features.every(feature => getFeature(gl, feature));\n}\n//# sourceMappingURL=webgl-info.js.map","import { getContextInfo, hasFeatures, canCompileGLGSExtension, FEATURES } from '../utils/webgl-info';\nexport function getPlatformShaderDefines(gl) {\n  const debugInfo = getContextInfo(gl);\n\n  switch (debugInfo.gpuVendor.toLowerCase()) {\n    case 'nvidia':\n      return \"#define NVIDIA_GPU\\n// Nvidia optimizes away the calculation necessary for emulated fp64\\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\\n\";\n\n    case 'intel':\n      return \"#define INTEL_GPU\\n// Intel optimizes away the calculation necessary for emulated fp64\\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\\n// Intel's built-in 'tan' function doesn't have acceptable precision\\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\\n\";\n\n    case 'amd':\n      return \"#define AMD_GPU\\n\";\n\n    default:\n      return \"#define DEFAULT_GPU\\n// Prevent driver from optimizing away the calculation necessary for emulated fp64\\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\\n// Intel's built-in 'tan' function doesn't have acceptable precision\\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\\n\";\n  }\n}\nexport function getVersionDefines(gl, glslVersion, isFragment) {\n  let versionDefines = \"#if (__VERSION__ > 120)\\n\\n# define FEATURE_GLSL_DERIVATIVES\\n# define FEATURE_GLSL_DRAW_BUFFERS\\n# define FEATURE_GLSL_FRAG_DEPTH\\n# define FEATURE_GLSL_TEXTURE_LOD\\n\\n// DEPRECATED FLAGS, remove in v9\\n# define FRAG_DEPTH\\n# define DERIVATIVES\\n# define DRAW_BUFFERS\\n# define TEXTURE_LOD\\n\\n#endif // __VERSION\\n\";\n\n  if (hasFeatures(gl, FEATURES.GLSL_FRAG_DEPTH)) {\n    versionDefines += \"\\n// FRAG_DEPTH => gl_FragDepth is available\\n#ifdef GL_EXT_frag_depth\\n#extension GL_EXT_frag_depth : enable\\n# define FEATURE_GLSL_FRAG_DEPTH\\n# define FRAG_DEPTH\\n# define gl_FragDepth gl_FragDepthEXT\\n#endif\\n\";\n  }\n\n  if (hasFeatures(gl, FEATURES.GLSL_DERIVATIVES) && canCompileGLGSExtension(gl, FEATURES.GLSL_DERIVATIVES)) {\n    versionDefines += \"\\n// DERIVATIVES => dxdF, dxdY and fwidth are available\\n#ifdef GL_OES_standard_derivatives\\n#extension GL_OES_standard_derivatives : enable\\n# define FEATURE_GLSL_DERIVATIVES\\n# define DERIVATIVES\\n#endif\\n\";\n  }\n\n  if (hasFeatures(gl, FEATURES.GLSL_FRAG_DATA) && canCompileGLGSExtension(gl, FEATURES.GLSL_FRAG_DATA, {\n    behavior: 'require'\n  })) {\n    versionDefines += \"\\n// DRAW_BUFFERS => gl_FragData[] is available\\n#ifdef GL_EXT_draw_buffers\\n#extension GL_EXT_draw_buffers : require\\n#define FEATURE_GLSL_DRAW_BUFFERS\\n#define DRAW_BUFFERS\\n#endif\\n\";\n  }\n\n  if (hasFeatures(gl, FEATURES.GLSL_TEXTURE_LOD)) {\n    versionDefines += \"// TEXTURE_LOD => texture2DLod etc are available\\n#ifdef GL_EXT_shader_texture_lod\\n#extension GL_EXT_shader_texture_lod : enable\\n\\n# define FEATURE_GLSL_TEXTURE_LOD\\n# define TEXTURE_LOD\\n\\n#endif\\n\";\n  }\n\n  return versionDefines;\n}\n//# sourceMappingURL=platform-defines.js.map","export const MODULE_INJECTORS_VS = \"#ifdef MODULE_LOGDEPTH\\n  logdepth_adjustPosition(gl_Position);\\n#endif\\n\";\nexport const MODULE_INJECTORS_FS = \"#ifdef MODULE_MATERIAL\\n  gl_FragColor = material_filterColor(gl_FragColor);\\n#endif\\n\\n#ifdef MODULE_LIGHTING\\n  gl_FragColor = lighting_filterColor(gl_FragColor);\\n#endif\\n\\n#ifdef MODULE_FOG\\n  gl_FragColor = fog_filterColor(gl_FragColor);\\n#endif\\n\\n#ifdef MODULE_PICKING\\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\\n#endif\\n\\n#ifdef MODULE_LOGDEPTH\\n  logdepth_setFragDepth();\\n#endif\\n\";\n//# sourceMappingURL=module-injectors.js.map","import { MODULE_INJECTORS_VS, MODULE_INJECTORS_FS } from '../modules/module-injectors';\nimport { VERTEX_SHADER, FRAGMENT_SHADER } from './constants';\nimport { assert } from '../utils';\nconst MODULE_INJECTORS = {\n  [VERTEX_SHADER]: MODULE_INJECTORS_VS,\n  [FRAGMENT_SHADER]: MODULE_INJECTORS_FS\n};\nexport const DECLARATION_INJECT_MARKER = '__LUMA_INJECT_DECLARATIONS__';\nconst REGEX_START_OF_MAIN = /void\\s+main\\s*\\([^)]*\\)\\s*\\{\\n?/;\nconst REGEX_END_OF_MAIN = /}\\n?[^{}]*$/;\nconst fragments = [];\nexport default function injectShader(source, type, inject) {\n  let injectStandardStubs = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n  const isVertex = type === VERTEX_SHADER;\n\n  for (const key in inject) {\n    const fragmentData = inject[key];\n    fragmentData.sort((a, b) => a.order - b.order);\n    fragments.length = fragmentData.length;\n\n    for (let i = 0, len = fragmentData.length; i < len; ++i) {\n      fragments[i] = fragmentData[i].injection;\n    }\n\n    const fragmentString = \"\".concat(fragments.join('\\n'), \"\\n\");\n\n    switch (key) {\n      case 'vs:#decl':\n        if (isVertex) {\n          source = source.replace(DECLARATION_INJECT_MARKER, fragmentString);\n        }\n\n        break;\n\n      case 'vs:#main-start':\n        if (isVertex) {\n          source = source.replace(REGEX_START_OF_MAIN, match => match + fragmentString);\n        }\n\n        break;\n\n      case 'vs:#main-end':\n        if (isVertex) {\n          source = source.replace(REGEX_END_OF_MAIN, match => fragmentString + match);\n        }\n\n        break;\n\n      case 'fs:#decl':\n        if (!isVertex) {\n          source = source.replace(DECLARATION_INJECT_MARKER, fragmentString);\n        }\n\n        break;\n\n      case 'fs:#main-start':\n        if (!isVertex) {\n          source = source.replace(REGEX_START_OF_MAIN, match => match + fragmentString);\n        }\n\n        break;\n\n      case 'fs:#main-end':\n        if (!isVertex) {\n          source = source.replace(REGEX_END_OF_MAIN, match => fragmentString + match);\n        }\n\n        break;\n\n      default:\n        source = source.replace(key, match => match + fragmentString);\n    }\n  }\n\n  source = source.replace(DECLARATION_INJECT_MARKER, '');\n\n  if (injectStandardStubs) {\n    source = source.replace(/\\}\\s*$/, match => match + MODULE_INJECTORS[type]);\n  }\n\n  return source;\n}\nexport function combineInjects(injects) {\n  const result = {};\n  assert(Array.isArray(injects) && injects.length > 1);\n  injects.forEach(inject => {\n    for (const key in inject) {\n      result[key] = result[key] ? \"\".concat(result[key], \"\\n\").concat(inject[key]) : inject[key];\n    }\n  });\n  return result;\n}\n//# sourceMappingURL=inject-shader.js.map","function testVariable(qualifier) {\n  return new RegExp(\"\\\\b\".concat(qualifier, \"[ \\\\t]+(\\\\w+[ \\\\t]+\\\\w+(\\\\[\\\\w+\\\\])?;)\"), 'g');\n}\n\nconst ES300_REPLACEMENTS = [[/^(#version[ \\t]+(100|300[ \\t]+es))?[ \\t]*\\n/, '#version 300 es\\n'], [/\\btexture(2D|2DProj|Cube)Lod(EXT)?\\(/g, 'textureLod('], [/\\btexture(2D|2DProj|Cube)(EXT)?\\(/g, 'texture(']];\nconst ES300_VERTEX_REPLACEMENTS = [...ES300_REPLACEMENTS, [testVariable('attribute'), 'in $1'], [testVariable('varying'), 'out $1']];\nconst ES300_FRAGMENT_REPLACEMENTS = [...ES300_REPLACEMENTS, [testVariable('varying'), 'in $1']];\nconst ES100_REPLACEMENTS = [[/^#version[ \\t]+300[ \\t]+es/, '#version 100'], [/\\btexture(2D|2DProj|Cube)Lod\\(/g, 'texture$1LodEXT('], [/\\btexture\\(/g, 'texture2D('], [/\\btextureLod\\(/g, 'texture2DLodEXT(']];\nconst ES100_VERTEX_REPLACEMENTS = [...ES100_REPLACEMENTS, [testVariable('in'), 'attribute $1'], [testVariable('out'), 'varying $1']];\nconst ES100_FRAGMENT_REPLACEMENTS = [...ES100_REPLACEMENTS, [testVariable('in'), 'varying $1']];\nconst ES100_FRAGMENT_OUTPUT_NAME = 'gl_FragColor';\nconst ES300_FRAGMENT_OUTPUT_REGEX = /\\bout[ \\t]+vec4[ \\t]+(\\w+)[ \\t]*;\\n?/;\nconst REGEX_START_OF_MAIN = /void\\s+main\\s*\\([^)]*\\)\\s*\\{\\n?/;\nexport default function transpileShader(source, targetGLSLVersion, isVertex) {\n  switch (targetGLSLVersion) {\n    case 300:\n      return isVertex ? convertShader(source, ES300_VERTEX_REPLACEMENTS) : convertFragmentShaderTo300(source);\n\n    case 100:\n      return isVertex ? convertShader(source, ES100_VERTEX_REPLACEMENTS) : convertFragmentShaderTo100(source);\n\n    default:\n      throw new Error(\"unknown GLSL version \".concat(targetGLSLVersion));\n  }\n}\n\nfunction convertShader(source, replacements) {\n  for (const [pattern, replacement] of replacements) {\n    source = source.replace(pattern, replacement);\n  }\n\n  return source;\n}\n\nfunction convertFragmentShaderTo300(source) {\n  source = convertShader(source, ES300_FRAGMENT_REPLACEMENTS);\n  const outputMatch = source.match(ES300_FRAGMENT_OUTPUT_REGEX);\n\n  if (outputMatch) {\n    const outputName = outputMatch[1];\n    source = source.replace(new RegExp(\"\\\\b\".concat(ES100_FRAGMENT_OUTPUT_NAME, \"\\\\b\"), 'g'), outputName);\n  } else {\n    const outputName = 'fragmentColor';\n    source = source.replace(REGEX_START_OF_MAIN, match => \"out vec4 \".concat(outputName, \";\\n\").concat(match)).replace(new RegExp(\"\\\\b\".concat(ES100_FRAGMENT_OUTPUT_NAME, \"\\\\b\"), 'g'), outputName);\n  }\n\n  return source;\n}\n\nfunction convertFragmentShaderTo100(source) {\n  source = convertShader(source, ES100_FRAGMENT_REPLACEMENTS);\n  const outputMatch = source.match(ES300_FRAGMENT_OUTPUT_REGEX);\n\n  if (outputMatch) {\n    const outputName = outputMatch[1];\n    source = source.replace(ES300_FRAGMENT_OUTPUT_REGEX, '').replace(new RegExp(\"\\\\b\".concat(outputName, \"\\\\b\"), 'g'), ES100_FRAGMENT_OUTPUT_NAME);\n  }\n\n  return source;\n}\n//# sourceMappingURL=transpile-shader.js.map","import { VERTEX_SHADER, FRAGMENT_SHADER } from './constants';\nimport { resolveModules } from './resolve-modules';\nimport { getPlatformShaderDefines, getVersionDefines } from './platform-defines';\nimport injectShader, { DECLARATION_INJECT_MARKER } from './inject-shader';\nimport transpileShader from './transpile-shader';\nimport { assert } from '../utils';\nconst INJECT_SHADER_DECLARATIONS = \"\\n\\n\".concat(DECLARATION_INJECT_MARKER, \"\\n\\n\");\nconst SHADER_TYPE = {\n  [VERTEX_SHADER]: 'vertex',\n  [FRAGMENT_SHADER]: 'fragment'\n};\nconst FRAGMENT_SHADER_PROLOGUE = \"precision highp float;\\n\\n\";\nexport function assembleShaders(gl, opts) {\n  const {\n    vs,\n    fs\n  } = opts;\n  const modules = resolveModules(opts.modules || []);\n  return {\n    gl,\n    vs: assembleShader(gl, Object.assign({}, opts, {\n      source: vs,\n      type: VERTEX_SHADER,\n      modules\n    })),\n    fs: assembleShader(gl, Object.assign({}, opts, {\n      source: fs,\n      type: FRAGMENT_SHADER,\n      modules\n    })),\n    getUniforms: assembleGetUniforms(modules)\n  };\n}\n\nfunction assembleShader(gl, _ref) {\n  let {\n    id,\n    source,\n    type,\n    modules,\n    defines = {},\n    hookFunctions = [],\n    inject = {},\n    transpileToGLSL100 = false,\n    prologue = true,\n    log\n  } = _ref;\n  assert(typeof source === 'string', 'shader source must be a string');\n  const isVertex = type === VERTEX_SHADER;\n  const sourceLines = source.split('\\n');\n  let glslVersion = 100;\n  let versionLine = '';\n  let coreSource = source;\n\n  if (sourceLines[0].indexOf('#version ') === 0) {\n    glslVersion = 300;\n    versionLine = sourceLines[0];\n    coreSource = sourceLines.slice(1).join('\\n');\n  } else {\n    versionLine = \"#version \".concat(glslVersion);\n  }\n\n  const allDefines = {};\n  modules.forEach(module => {\n    Object.assign(allDefines, module.getDefines());\n  });\n  Object.assign(allDefines, defines);\n  let assembledSource = prologue ? \"\".concat(versionLine, \"\\n\").concat(getShaderName({\n    id,\n    source,\n    type\n  }), \"\\n\").concat(getShaderType({\n    type\n  }), \"\\n\").concat(getPlatformShaderDefines(gl), \"\\n\").concat(getVersionDefines(gl, glslVersion, !isVertex), \"\\n\").concat(getApplicationDefines(allDefines), \"\\n\").concat(isVertex ? '' : FRAGMENT_SHADER_PROLOGUE, \"\\n\") : \"\".concat(versionLine, \"\\n\");\n  const hookFunctionMap = normalizeHookFunctions(hookFunctions);\n  const hookInjections = {};\n  const declInjections = {};\n  const mainInjections = {};\n\n  for (const key in inject) {\n    const injection = typeof inject[key] === 'string' ? {\n      injection: inject[key],\n      order: 0\n    } : inject[key];\n    const match = key.match(/^(v|f)s:(#)?([\\w-]+)$/);\n\n    if (match) {\n      const hash = match[2];\n      const name = match[3];\n\n      if (hash) {\n        if (name === 'decl') {\n          declInjections[key] = [injection];\n        } else {\n          mainInjections[key] = [injection];\n        }\n      } else {\n        hookInjections[key] = [injection];\n      }\n    } else {\n      mainInjections[key] = [injection];\n    }\n  }\n\n  for (const module of modules) {\n    if (log) {\n      module.checkDeprecations(coreSource, log);\n    }\n\n    const moduleSource = module.getModuleSource(type, glslVersion);\n    assembledSource += moduleSource;\n    const injections = module.injections[type];\n\n    for (const key in injections) {\n      const match = key.match(/^(v|f)s:#([\\w-]+)$/);\n\n      if (match) {\n        const name = match[2];\n        const injectionType = name === 'decl' ? declInjections : mainInjections;\n        injectionType[key] = injectionType[key] || [];\n        injectionType[key].push(injections[key]);\n      } else {\n        hookInjections[key] = hookInjections[key] || [];\n        hookInjections[key].push(injections[key]);\n      }\n    }\n  }\n\n  assembledSource += INJECT_SHADER_DECLARATIONS;\n  assembledSource = injectShader(assembledSource, type, declInjections);\n  assembledSource += getHookFunctions(hookFunctionMap[type], hookInjections);\n  assembledSource += coreSource;\n  assembledSource = injectShader(assembledSource, type, mainInjections);\n  assembledSource = transpileShader(assembledSource, transpileToGLSL100 ? 100 : glslVersion, isVertex);\n  return assembledSource;\n}\n\nfunction assembleGetUniforms(modules) {\n  return function getUniforms(opts) {\n    const uniforms = {};\n\n    for (const module of modules) {\n      const moduleUniforms = module.getUniforms(opts, uniforms);\n      Object.assign(uniforms, moduleUniforms);\n    }\n\n    return uniforms;\n  };\n}\n\nfunction getShaderType(_ref2) {\n  let {\n    type\n  } = _ref2;\n  return \"\\n#define SHADER_TYPE_\".concat(SHADER_TYPE[type].toUpperCase(), \"\\n\");\n}\n\nfunction getShaderName(_ref3) {\n  let {\n    id,\n    source,\n    type\n  } = _ref3;\n  const injectShaderName = id && typeof id === 'string' && source.indexOf('SHADER_NAME') === -1;\n  return injectShaderName ? \"\\n#define SHADER_NAME \".concat(id, \"_\").concat(SHADER_TYPE[type], \"\\n\\n\") : '';\n}\n\nfunction getApplicationDefines() {\n  let defines = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  let count = 0;\n  let sourceText = '';\n\n  for (const define in defines) {\n    if (count === 0) {\n      sourceText += '\\n// APPLICATION DEFINES\\n';\n    }\n\n    count++;\n    const value = defines[define];\n\n    if (value || Number.isFinite(value)) {\n      sourceText += \"#define \".concat(define.toUpperCase(), \" \").concat(defines[define], \"\\n\");\n    }\n  }\n\n  if (count === 0) {\n    sourceText += '\\n';\n  }\n\n  return sourceText;\n}\n\nfunction getHookFunctions(hookFunctions, hookInjections) {\n  let result = '';\n\n  for (const hookName in hookFunctions) {\n    const hookFunction = hookFunctions[hookName];\n    result += \"void \".concat(hookFunction.signature, \" {\\n\");\n\n    if (hookFunction.header) {\n      result += \"  \".concat(hookFunction.header);\n    }\n\n    if (hookInjections[hookName]) {\n      const injections = hookInjections[hookName];\n      injections.sort((a, b) => a.order - b.order);\n\n      for (const injection of injections) {\n        result += \"  \".concat(injection.injection, \"\\n\");\n      }\n    }\n\n    if (hookFunction.footer) {\n      result += \"  \".concat(hookFunction.footer);\n    }\n\n    result += '}\\n';\n  }\n\n  return result;\n}\n\nfunction normalizeHookFunctions(hookFunctions) {\n  const result = {\n    vs: {},\n    fs: {}\n  };\n  hookFunctions.forEach(hook => {\n    let opts;\n\n    if (typeof hook !== 'string') {\n      opts = hook;\n      hook = opts.hook;\n    } else {\n      opts = {};\n    }\n\n    hook = hook.trim();\n    const [stage, signature] = hook.split(':');\n    const name = hook.replace(/\\(.+/, '');\n    result[stage][name] = Object.assign(opts, {\n      signature\n    });\n  });\n  return result;\n}\n//# sourceMappingURL=assemble-shaders.js.map","import { assert } from '../utils';\nconst FS100 = \"void main() {gl_FragColor = vec4(0);}\";\nconst FS_GLES = \"out vec4 transform_output;\\nvoid main() {\\n  transform_output = vec4(0);\\n}\";\nconst FS300 = \"#version 300 es\\n\".concat(FS_GLES);\nexport function getQualifierDetails(line, qualifiers) {\n  qualifiers = Array.isArray(qualifiers) ? qualifiers : [qualifiers];\n  const words = line.replace(/^\\s+/, '').split(/\\s+/);\n  const [qualifier, type, definition] = words;\n\n  if (!qualifiers.includes(qualifier) || !type || !definition) {\n    return null;\n  }\n\n  const name = definition.split(';')[0];\n  return {\n    qualifier,\n    type,\n    name\n  };\n}\nexport function getPassthroughFS() {\n  let options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  const {\n    version = 100,\n    input,\n    inputType,\n    output\n  } = options;\n\n  if (!input) {\n    if (version === 300) {\n      return FS300;\n    } else if (version > 300) {\n      return \"#version \".concat(version, \"\\n\").concat(FS_GLES);\n    }\n\n    return FS100;\n  }\n\n  const outputValue = convertToVec4(input, inputType);\n\n  if (version >= 300) {\n    return \"#version \".concat(version, \" \").concat(version === 300 ? 'es' : '', \"\\nin \").concat(inputType, \" \").concat(input, \";\\nout vec4 \").concat(output, \";\\nvoid main() {\\n  \").concat(output, \" = \").concat(outputValue, \";\\n}\");\n  }\n\n  return \"varying \".concat(inputType, \" \").concat(input, \";\\nvoid main() {\\n  gl_FragColor = \").concat(outputValue, \";\\n}\");\n}\nexport function typeToChannelSuffix(type) {\n  switch (type) {\n    case 'float':\n      return 'x';\n\n    case 'vec2':\n      return 'xy';\n\n    case 'vec3':\n      return 'xyz';\n\n    case 'vec4':\n      return 'xyzw';\n\n    default:\n      assert(false);\n      return null;\n  }\n}\nexport function typeToChannelCount(type) {\n  switch (type) {\n    case 'float':\n      return 1;\n\n    case 'vec2':\n      return 2;\n\n    case 'vec3':\n      return 3;\n\n    case 'vec4':\n      return 4;\n\n    default:\n      assert(false);\n      return null;\n  }\n}\nexport function convertToVec4(variable, type) {\n  switch (type) {\n    case 'float':\n      return \"vec4(\".concat(variable, \", 0.0, 0.0, 1.0)\");\n\n    case 'vec2':\n      return \"vec4(\".concat(variable, \", 0.0, 1.0)\");\n\n    case 'vec3':\n      return \"vec4(\".concat(variable, \", 1.0)\");\n\n    case 'vec4':\n      return variable;\n\n    default:\n      assert(false);\n      return null;\n  }\n}\n//# sourceMappingURL=shader-utils.js.map","const fp32shader = \"#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\\nconst float TWO_PI = 6.2831854820251465;\\nconst float PI_2 = 1.5707963705062866;\\nconst float PI_16 = 0.1963495463132858;\\n\\nconst float SIN_TABLE_0 = 0.19509032368659973;\\nconst float SIN_TABLE_1 = 0.3826834261417389;\\nconst float SIN_TABLE_2 = 0.5555702447891235;\\nconst float SIN_TABLE_3 = 0.7071067690849304;\\n\\nconst float COS_TABLE_0 = 0.9807852506637573;\\nconst float COS_TABLE_1 = 0.9238795042037964;\\nconst float COS_TABLE_2 = 0.8314695954322815;\\nconst float COS_TABLE_3 = 0.7071067690849304;\\n\\nconst float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;\\nconst float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;\\nconst float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;\\nconst float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;\\n\\nfloat sin_taylor_fp32(float a) {\\n  float r, s, t, x;\\n\\n  if (a == 0.0) {\\n    return 0.0;\\n  }\\n\\n  x = -a * a;\\n  s = a;\\n  r = a;\\n\\n  r = r * x;\\n  t = r * INVERSE_FACTORIAL_3;\\n  s = s + t;\\n\\n  r = r * x;\\n  t = r * INVERSE_FACTORIAL_5;\\n  s = s + t;\\n\\n  r = r * x;\\n  t = r * INVERSE_FACTORIAL_7;\\n  s = s + t;\\n\\n  r = r * x;\\n  t = r * INVERSE_FACTORIAL_9;\\n  s = s + t;\\n\\n  return s;\\n}\\n\\nvoid sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {\\n  if (a == 0.0) {\\n    sin_t = 0.0;\\n    cos_t = 1.0;\\n  }\\n  sin_t = sin_taylor_fp32(a);\\n  cos_t = sqrt(1.0 - sin_t * sin_t);\\n}\\n\\nfloat tan_taylor_fp32(float a) {\\n    float sin_a;\\n    float cos_a;\\n\\n    if (a == 0.0) {\\n        return 0.0;\\n    }\\n    float z = floor(a / TWO_PI);\\n    float r = a - TWO_PI * z;\\n\\n    float t;\\n    float q = floor(r / PI_2 + 0.5);\\n    int j = int(q);\\n\\n    if (j < -2 || j > 2) {\\n        return 1.0 / 0.0;\\n    }\\n\\n    t = r - PI_2 * q;\\n\\n    q = floor(t / PI_16 + 0.5);\\n    int k = int(q);\\n    int abs_k = int(abs(float(k)));\\n\\n    if (abs_k > 4) {\\n        return 1.0 / 0.0;\\n    } else {\\n        t = t - PI_16 * q;\\n    }\\n\\n    float u = 0.0;\\n    float v = 0.0;\\n\\n    float sin_t, cos_t;\\n    float s, c;\\n    sincos_taylor_fp32(t, sin_t, cos_t);\\n\\n    if (k == 0) {\\n        s = sin_t;\\n        c = cos_t;\\n    } else {\\n        if (abs(float(abs_k) - 1.0) < 0.5) {\\n            u = COS_TABLE_0;\\n            v = SIN_TABLE_0;\\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\\n            u = COS_TABLE_1;\\n            v = SIN_TABLE_1;\\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\\n            u = COS_TABLE_2;\\n            v = SIN_TABLE_2;\\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\\n            u = COS_TABLE_3;\\n            v = SIN_TABLE_3;\\n        }\\n        if (k > 0) {\\n            s = u * sin_t + v * cos_t;\\n            c = u * cos_t - v * sin_t;\\n        } else {\\n            s = u * sin_t - v * cos_t;\\n            c = u * cos_t + v * sin_t;\\n        }\\n    }\\n\\n    if (j == 0) {\\n        sin_a = s;\\n        cos_a = c;\\n    } else if (j == 1) {\\n        sin_a = c;\\n        cos_a = -s;\\n    } else if (j == -1) {\\n        sin_a = -c;\\n        cos_a = s;\\n    } else {\\n        sin_a = -s;\\n        cos_a = -c;\\n    }\\n    return sin_a / cos_a;\\n}\\n#endif\\n\\nfloat tan_fp32(float a) {\\n#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\\n  return tan_taylor_fp32(a);\\n#else\\n  return tan(a);\\n#endif\\n}\\n\";\nexport const fp32 = {\n  name: 'fp32',\n  vs: fp32shader,\n  fs: null\n};\n//# sourceMappingURL=fp32.js.map","export default function assert(condition, message) {\n  if (!condition) {\n    throw new Error(\"math.gl assertion \".concat(message));\n  }\n}\n//# sourceMappingURL=assert.js.map","import assert from './assert';\nconst RADIANS_TO_DEGREES = 1 / Math.PI * 180;\nconst DEGREES_TO_RADIANS = 1 / 180 * Math.PI;\nexport const config = {\n  EPSILON: 1e-12,\n  debug: false,\n  precision: 4,\n  printTypes: false,\n  printDegrees: false,\n  printRowMajor: true\n};\nexport function configure(options) {\n  for (const key in options) {\n    assert(key in config);\n    config[key] = options[key];\n  }\n\n  return config;\n}\nexport function formatValue(value, {\n  precision = config.precision\n} = {}) {\n  value = round(value);\n  return \"\".concat(parseFloat(value.toPrecision(precision)));\n}\nexport function isArray(value) {\n  return Array.isArray(value) || ArrayBuffer.isView(value) && !(value instanceof DataView);\n}\nexport function clone(array) {\n  return 'clone' in array ? array.clone() : array.slice();\n}\nexport function toRadians(degrees) {\n  return radians(degrees);\n}\nexport function toDegrees(radians) {\n  return degrees(radians);\n}\nexport function radians(degrees, result) {\n  return map(degrees, degrees => degrees * DEGREES_TO_RADIANS, result);\n}\nexport function degrees(radians, result) {\n  return map(radians, radians => radians * RADIANS_TO_DEGREES, result);\n}\nexport function sin(radians, result) {\n  return map(radians, angle => Math.sin(angle), result);\n}\nexport function cos(radians, result) {\n  return map(radians, angle => Math.cos(angle), result);\n}\nexport function tan(radians, result) {\n  return map(radians, angle => Math.tan(angle), result);\n}\nexport function asin(radians, result) {\n  return map(radians, angle => Math.asin(angle), result);\n}\nexport function acos(radians, result) {\n  return map(radians, angle => Math.acos(angle), result);\n}\nexport function atan(radians, result) {\n  return map(radians, angle => Math.atan(angle), result);\n}\nexport function clamp(value, min, max) {\n  return map(value, value => Math.max(min, Math.min(max, value)));\n}\nexport function lerp(a, b, t) {\n  if (isArray(a)) {\n    return a.map((ai, i) => lerp(ai, b[i], t));\n  }\n\n  return t * b + (1 - t) * a;\n}\nexport function equals(a, b, epsilon) {\n  const oldEpsilon = config.EPSILON;\n\n  if (epsilon) {\n    config.EPSILON = epsilon;\n  }\n\n  try {\n    if (a === b) {\n      return true;\n    }\n\n    if (isArray(a) && isArray(b)) {\n      if (a.length !== b.length) {\n        return false;\n      }\n\n      for (let i = 0; i < a.length; ++i) {\n        if (!equals(a[i], b[i])) {\n          return false;\n        }\n      }\n\n      return true;\n    }\n\n    if (a && a.equals) {\n      return a.equals(b);\n    }\n\n    if (b && b.equals) {\n      return b.equals(a);\n    }\n\n    if (typeof a === 'number' && typeof b === 'number') {\n      return Math.abs(a - b) <= config.EPSILON * Math.max(1, Math.abs(a), Math.abs(b));\n    }\n\n    return false;\n  } finally {\n    config.EPSILON = oldEpsilon;\n  }\n}\nexport function exactEquals(a, b) {\n  if (a === b) {\n    return true;\n  }\n\n  if (a && typeof a === 'object' && b && typeof b === 'object') {\n    if (a.constructor !== b.constructor) {\n      return false;\n    }\n\n    if (a.exactEquals) {\n      return a.exactEquals(b);\n    }\n  }\n\n  if (isArray(a) && isArray(b)) {\n    if (a.length !== b.length) {\n      return false;\n    }\n\n    for (let i = 0; i < a.length; ++i) {\n      if (!exactEquals(a[i], b[i])) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  return false;\n}\nexport function withEpsilon(epsilon, func) {\n  const oldPrecision = config.EPSILON;\n  config.EPSILON = epsilon;\n  let value;\n\n  try {\n    value = func();\n  } finally {\n    config.EPSILON = oldPrecision;\n  }\n\n  return value;\n}\n\nfunction round(value) {\n  return Math.round(value / config.EPSILON) * config.EPSILON;\n}\n\nfunction duplicateArray(array) {\n  return array.clone ? array.clone() : new Array(array.length);\n}\n\nfunction map(value, func, result) {\n  if (isArray(value)) {\n    const array = value;\n    result = result || duplicateArray(array);\n\n    for (let i = 0; i < result.length && i < array.length; ++i) {\n      result[i] = func(value[i], i, result);\n    }\n\n    return result;\n  }\n\n  return func(value);\n}\n//# sourceMappingURL=common.js.map","function _extendableBuiltin(cls) {\n  function ExtendableBuiltin() {\n    var instance = Reflect.construct(cls, Array.from(arguments));\n    Object.setPrototypeOf(instance, Object.getPrototypeOf(this));\n    return instance;\n  }\n\n  ExtendableBuiltin.prototype = Object.create(cls.prototype, {\n    constructor: {\n      value: cls,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n\n  if (Object.setPrototypeOf) {\n    Object.setPrototypeOf(ExtendableBuiltin, cls);\n  } else {\n    ExtendableBuiltin.__proto__ = cls;\n  }\n\n  return ExtendableBuiltin;\n}\n\nimport { config, formatValue, equals, isArray } from '../../lib/common';\nexport default class MathArray extends _extendableBuiltin(Array) {\n  clone() {\n    return new this.constructor().copy(this);\n  }\n\n  fromArray(array, offset = 0) {\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      this[i] = array[i + offset];\n    }\n\n    return this.check();\n  }\n\n  toArray(targetArray = [], offset = 0) {\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      targetArray[offset + i] = this[i];\n    }\n\n    return targetArray;\n  }\n\n  from(arrayOrObject) {\n    return Array.isArray(arrayOrObject) ? this.copy(arrayOrObject) : this.fromObject(arrayOrObject);\n  }\n\n  to(arrayOrObject) {\n    if (arrayOrObject === this) {\n      return this;\n    }\n\n    return isArray(arrayOrObject) ? this.toArray(arrayOrObject) : this.toObject(arrayOrObject);\n  }\n\n  toTarget(target) {\n    return target ? this.to(target) : this;\n  }\n\n  toFloat32Array() {\n    return new Float32Array(this);\n  }\n\n  toString() {\n    return this.formatString(config);\n  }\n\n  formatString(opts) {\n    let string = '';\n\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      string += (i > 0 ? ', ' : '') + formatValue(this[i], opts);\n    }\n\n    return \"\".concat(opts.printTypes ? this.constructor.name : '', \"[\").concat(string, \"]\");\n  }\n\n  equals(array) {\n    if (!array || this.length !== array.length) {\n      return false;\n    }\n\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      if (!equals(this[i], array[i])) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  exactEquals(array) {\n    if (!array || this.length !== array.length) {\n      return false;\n    }\n\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      if (this[i] !== array[i]) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  negate() {\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      this[i] = -this[i];\n    }\n\n    return this.check();\n  }\n\n  lerp(a, b, t) {\n    if (t === undefined) {\n      return this.lerp(this, a, b);\n    }\n\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      const ai = a[i];\n      this[i] = ai + t * (b[i] - ai);\n    }\n\n    return this.check();\n  }\n\n  min(vector) {\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      this[i] = Math.min(vector[i], this[i]);\n    }\n\n    return this.check();\n  }\n\n  max(vector) {\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      this[i] = Math.max(vector[i], this[i]);\n    }\n\n    return this.check();\n  }\n\n  clamp(minVector, maxVector) {\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      this[i] = Math.min(Math.max(this[i], minVector[i]), maxVector[i]);\n    }\n\n    return this.check();\n  }\n\n  add(...vectors) {\n    for (const vector of vectors) {\n      for (let i = 0; i < this.ELEMENTS; ++i) {\n        this[i] += vector[i];\n      }\n    }\n\n    return this.check();\n  }\n\n  subtract(...vectors) {\n    for (const vector of vectors) {\n      for (let i = 0; i < this.ELEMENTS; ++i) {\n        this[i] -= vector[i];\n      }\n    }\n\n    return this.check();\n  }\n\n  scale(scale) {\n    if (typeof scale === 'number') {\n      for (let i = 0; i < this.ELEMENTS; ++i) {\n        this[i] *= scale;\n      }\n    } else {\n      for (let i = 0; i < this.ELEMENTS && i < scale.length; ++i) {\n        this[i] *= scale[i];\n      }\n    }\n\n    return this.check();\n  }\n\n  multiplyByScalar(scalar) {\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      this[i] *= scalar;\n    }\n\n    return this.check();\n  }\n\n  check() {\n    if (config.debug && !this.validate()) {\n      throw new Error(\"math.gl: \".concat(this.constructor.name, \" some fields set to invalid numbers'\"));\n    }\n\n    return this;\n  }\n\n  validate() {\n    let valid = this.length === this.ELEMENTS;\n\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      valid = valid && Number.isFinite(this[i]);\n    }\n\n    return valid;\n  }\n\n  sub(a) {\n    return this.subtract(a);\n  }\n\n  setScalar(a) {\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      this[i] = a;\n    }\n\n    return this.check();\n  }\n\n  addScalar(a) {\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      this[i] += a;\n    }\n\n    return this.check();\n  }\n\n  subScalar(a) {\n    return this.addScalar(-a);\n  }\n\n  multiplyScalar(scalar) {\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      this[i] *= scalar;\n    }\n\n    return this.check();\n  }\n\n  divideScalar(a) {\n    return this.multiplyByScalar(1 / a);\n  }\n\n  clampScalar(min, max) {\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      this[i] = Math.min(Math.max(this[i], min), max);\n    }\n\n    return this.check();\n  }\n\n  get elements() {\n    return this;\n  }\n\n}\n//# sourceMappingURL=math-array.js.map","import { config } from './common';\nexport function validateVector(v, length) {\n  if (v.length !== length) {\n    return false;\n  }\n\n  for (let i = 0; i < v.length; ++i) {\n    if (!Number.isFinite(v[i])) {\n      return false;\n    }\n  }\n\n  return true;\n}\nexport function checkNumber(value) {\n  if (!Number.isFinite(value)) {\n    throw new Error(\"Invalid number \".concat(value));\n  }\n\n  return value;\n}\nexport function checkVector(v, length, callerName = '') {\n  if (config.debug && !validateVector(v, length)) {\n    throw new Error(\"math.gl: \".concat(callerName, \" some fields set to invalid numbers'\"));\n  }\n\n  return v;\n}\nconst map = {};\nexport function deprecated(method, version) {\n  if (!map[method]) {\n    map[method] = true;\n    console.warn(\"\".concat(method, \" has been removed in version \").concat(version, \", see upgrade guide for more information\"));\n  }\n}\n//# sourceMappingURL=validators.js.map","import MathArray from './math-array';\nimport { checkNumber } from '../../lib/validators';\nimport assert from '../../lib/assert';\nexport default class Vector extends MathArray {\n  get x() {\n    return this[0];\n  }\n\n  set x(value) {\n    this[0] = checkNumber(value);\n  }\n\n  get y() {\n    return this[1];\n  }\n\n  set y(value) {\n    this[1] = checkNumber(value);\n  }\n\n  len() {\n    return Math.sqrt(this.lengthSquared());\n  }\n\n  magnitude() {\n    return this.len();\n  }\n\n  lengthSquared() {\n    let length = 0;\n\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      length += this[i] * this[i];\n    }\n\n    return length;\n  }\n\n  magnitudeSquared() {\n    return this.lengthSquared();\n  }\n\n  distance(mathArray) {\n    return Math.sqrt(this.distanceSquared(mathArray));\n  }\n\n  distanceSquared(mathArray) {\n    let length = 0;\n\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      const dist = this[i] - mathArray[i];\n      length += dist * dist;\n    }\n\n    return checkNumber(length);\n  }\n\n  dot(mathArray) {\n    let product = 0;\n\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      product += this[i] * mathArray[i];\n    }\n\n    return checkNumber(product);\n  }\n\n  normalize() {\n    const length = this.magnitude();\n\n    if (length !== 0) {\n      for (let i = 0; i < this.ELEMENTS; ++i) {\n        this[i] /= length;\n      }\n    }\n\n    return this.check();\n  }\n\n  multiply(...vectors) {\n    for (const vector of vectors) {\n      for (let i = 0; i < this.ELEMENTS; ++i) {\n        this[i] *= vector[i];\n      }\n    }\n\n    return this.check();\n  }\n\n  divide(...vectors) {\n    for (const vector of vectors) {\n      for (let i = 0; i < this.ELEMENTS; ++i) {\n        this[i] /= vector[i];\n      }\n    }\n\n    return this.check();\n  }\n\n  lengthSq() {\n    return this.lengthSquared();\n  }\n\n  distanceTo(vector) {\n    return this.distance(vector);\n  }\n\n  distanceToSquared(vector) {\n    return this.distanceSquared(vector);\n  }\n\n  getComponent(i) {\n    assert(i >= 0 && i < this.ELEMENTS, 'index is out of range');\n    return checkNumber(this[i]);\n  }\n\n  setComponent(i, value) {\n    assert(i >= 0 && i < this.ELEMENTS, 'index is out of range');\n    this[i] = value;\n    return this.check();\n  }\n\n  addVectors(a, b) {\n    return this.copy(a).add(b);\n  }\n\n  subVectors(a, b) {\n    return this.copy(a).subtract(b);\n  }\n\n  multiplyVectors(a, b) {\n    return this.copy(a).multiply(b);\n  }\n\n  addScaledVector(a, b) {\n    return this.add(new this.constructor(a).multiplyScalar(b));\n  }\n\n}\n//# sourceMappingURL=vector.js.map","/**\n * Common utilities\n * @module glMatrix\n */\n// Configuration Constants\nexport var EPSILON = 0.000001;\nexport var ARRAY_TYPE = typeof Float32Array !== 'undefined' ? Float32Array : Array;\nexport var RANDOM = Math.random;\n/**\n * Sets the type of array used when creating new vectors and matrices\n *\n * @param {Float32ArrayConstructor | ArrayConstructor} type Array type, such as Float32Array or Array\n */\n\nexport function setMatrixArrayType(type) {\n  ARRAY_TYPE = type;\n}\nvar degree = Math.PI / 180;\n/**\n * Convert Degree To Radian\n *\n * @param {Number} a Angle in Degrees\n */\n\nexport function toRadian(a) {\n  return a * degree;\n}\n/**\n * Tests whether or not the arguments have approximately the same value, within an absolute\n * or relative tolerance of glMatrix.EPSILON (an absolute tolerance is used for values less\n * than or equal to 1.0, and a relative tolerance is used for larger values)\n *\n * @param {Number} a The first number to test.\n * @param {Number} b The second number to test.\n * @returns {Boolean} True if the numbers are approximately equal, false otherwise.\n */\n\nexport function equals(a, b) {\n  return Math.abs(a - b) <= EPSILON * Math.max(1.0, Math.abs(a), Math.abs(b));\n}\nif (!Math.hypot) Math.hypot = function () {\n  var y = 0,\n      i = arguments.length;\n\n  while (i--) {\n    y += arguments[i] * arguments[i];\n  }\n\n  return Math.sqrt(y);\n};","import * as glMatrix from \"./common.js\";\n/**\n * 2 Dimensional Vector\n * @module vec2\n */\n\n/**\n * Creates a new, empty vec2\n *\n * @returns {vec2} a new 2D vector\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(2);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n  }\n\n  return out;\n}\n/**\n * Creates a new vec2 initialized with values from an existing vector\n *\n * @param {ReadonlyVec2} a vector to clone\n * @returns {vec2} a new 2D vector\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(2);\n  out[0] = a[0];\n  out[1] = a[1];\n  return out;\n}\n/**\n * Creates a new vec2 initialized with the given values\n *\n * @param {Number} x X component\n * @param {Number} y Y component\n * @returns {vec2} a new 2D vector\n */\n\nexport function fromValues(x, y) {\n  var out = new glMatrix.ARRAY_TYPE(2);\n  out[0] = x;\n  out[1] = y;\n  return out;\n}\n/**\n * Copy the values from one vec2 to another\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the source vector\n * @returns {vec2} out\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  return out;\n}\n/**\n * Set the components of a vec2 to the given values\n *\n * @param {vec2} out the receiving vector\n * @param {Number} x X component\n * @param {Number} y Y component\n * @returns {vec2} out\n */\n\nexport function set(out, x, y) {\n  out[0] = x;\n  out[1] = y;\n  return out;\n}\n/**\n * Adds two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec2} out\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  return out;\n}\n/**\n * Subtracts vector b from vector a\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec2} out\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  return out;\n}\n/**\n * Multiplies two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec2} out\n */\n\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  return out;\n}\n/**\n * Divides two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec2} out\n */\n\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  return out;\n}\n/**\n * Math.ceil the components of a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a vector to ceil\n * @returns {vec2} out\n */\n\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  return out;\n}\n/**\n * Math.floor the components of a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a vector to floor\n * @returns {vec2} out\n */\n\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  return out;\n}\n/**\n * Returns the minimum of two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec2} out\n */\n\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  return out;\n}\n/**\n * Returns the maximum of two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec2} out\n */\n\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  return out;\n}\n/**\n * Math.round the components of a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a vector to round\n * @returns {vec2} out\n */\n\nexport function round(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  return out;\n}\n/**\n * Scales a vec2 by a scalar number\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the vector to scale\n * @param {Number} b amount to scale the vector by\n * @returns {vec2} out\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  return out;\n}\n/**\n * Adds two vec2's after scaling the second operand by a scalar value\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @param {Number} scale the amount to scale b by before adding\n * @returns {vec2} out\n */\n\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  return out;\n}\n/**\n * Calculates the euclidian distance between two vec2's\n *\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {Number} distance between a and b\n */\n\nexport function distance(a, b) {\n  var x = b[0] - a[0],\n      y = b[1] - a[1];\n  return Math.hypot(x, y);\n}\n/**\n * Calculates the squared euclidian distance between two vec2's\n *\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {Number} squared distance between a and b\n */\n\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0],\n      y = b[1] - a[1];\n  return x * x + y * y;\n}\n/**\n * Calculates the length of a vec2\n *\n * @param {ReadonlyVec2} a vector to calculate length of\n * @returns {Number} length of a\n */\n\nexport function length(a) {\n  var x = a[0],\n      y = a[1];\n  return Math.hypot(x, y);\n}\n/**\n * Calculates the squared length of a vec2\n *\n * @param {ReadonlyVec2} a vector to calculate squared length of\n * @returns {Number} squared length of a\n */\n\nexport function squaredLength(a) {\n  var x = a[0],\n      y = a[1];\n  return x * x + y * y;\n}\n/**\n * Negates the components of a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a vector to negate\n * @returns {vec2} out\n */\n\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  return out;\n}\n/**\n * Returns the inverse of the components of a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a vector to invert\n * @returns {vec2} out\n */\n\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  return out;\n}\n/**\n * Normalize a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a vector to normalize\n * @returns {vec2} out\n */\n\nexport function normalize(out, a) {\n  var x = a[0],\n      y = a[1];\n  var len = x * x + y * y;\n\n  if (len > 0) {\n    //TODO: evaluate use of glm_invsqrt here?\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = a[0] * len;\n  out[1] = a[1] * len;\n  return out;\n}\n/**\n * Calculates the dot product of two vec2's\n *\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {Number} dot product of a and b\n */\n\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1];\n}\n/**\n * Computes the cross product of two vec2's\n * Note that the cross product must by definition produce a 3D vector\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec3} out\n */\n\nexport function cross(out, a, b) {\n  var z = a[0] * b[1] - a[1] * b[0];\n  out[0] = out[1] = 0;\n  out[2] = z;\n  return out;\n}\n/**\n * Performs a linear interpolation between two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec2} out\n */\n\nexport function lerp(out, a, b, t) {\n  var ax = a[0],\n      ay = a[1];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  return out;\n}\n/**\n * Generates a random vector with the given scale\n *\n * @param {vec2} out the receiving vector\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\n * @returns {vec2} out\n */\n\nexport function random(out, scale) {\n  scale = scale || 1.0;\n  var r = glMatrix.RANDOM() * 2.0 * Math.PI;\n  out[0] = Math.cos(r) * scale;\n  out[1] = Math.sin(r) * scale;\n  return out;\n}\n/**\n * Transforms the vec2 with a mat2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the vector to transform\n * @param {ReadonlyMat2} m matrix to transform with\n * @returns {vec2} out\n */\n\nexport function transformMat2(out, a, m) {\n  var x = a[0],\n      y = a[1];\n  out[0] = m[0] * x + m[2] * y;\n  out[1] = m[1] * x + m[3] * y;\n  return out;\n}\n/**\n * Transforms the vec2 with a mat2d\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the vector to transform\n * @param {ReadonlyMat2d} m matrix to transform with\n * @returns {vec2} out\n */\n\nexport function transformMat2d(out, a, m) {\n  var x = a[0],\n      y = a[1];\n  out[0] = m[0] * x + m[2] * y + m[4];\n  out[1] = m[1] * x + m[3] * y + m[5];\n  return out;\n}\n/**\n * Transforms the vec2 with a mat3\n * 3rd vector component is implicitly '1'\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the vector to transform\n * @param {ReadonlyMat3} m matrix to transform with\n * @returns {vec2} out\n */\n\nexport function transformMat3(out, a, m) {\n  var x = a[0],\n      y = a[1];\n  out[0] = m[0] * x + m[3] * y + m[6];\n  out[1] = m[1] * x + m[4] * y + m[7];\n  return out;\n}\n/**\n * Transforms the vec2 with a mat4\n * 3rd vector component is implicitly '0'\n * 4th vector component is implicitly '1'\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the vector to transform\n * @param {ReadonlyMat4} m matrix to transform with\n * @returns {vec2} out\n */\n\nexport function transformMat4(out, a, m) {\n  var x = a[0];\n  var y = a[1];\n  out[0] = m[0] * x + m[4] * y + m[12];\n  out[1] = m[1] * x + m[5] * y + m[13];\n  return out;\n}\n/**\n * Rotate a 2D vector\n * @param {vec2} out The receiving vec2\n * @param {ReadonlyVec2} a The vec2 point to rotate\n * @param {ReadonlyVec2} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec2} out\n */\n\nexport function rotate(out, a, b, rad) {\n  //Translate point to the origin\n  var p0 = a[0] - b[0],\n      p1 = a[1] - b[1],\n      sinC = Math.sin(rad),\n      cosC = Math.cos(rad); //perform rotation and translate to correct position\n\n  out[0] = p0 * cosC - p1 * sinC + b[0];\n  out[1] = p0 * sinC + p1 * cosC + b[1];\n  return out;\n}\n/**\n * Get the angle between two 2D vectors\n * @param {ReadonlyVec2} a The first operand\n * @param {ReadonlyVec2} b The second operand\n * @returns {Number} The angle in radians\n */\n\nexport function angle(a, b) {\n  var x1 = a[0],\n      y1 = a[1],\n      x2 = b[0],\n      y2 = b[1],\n      // mag is the product of the magnitudes of a and b\n  mag = Math.sqrt(x1 * x1 + y1 * y1) * Math.sqrt(x2 * x2 + y2 * y2),\n      // mag &&.. short circuits if mag == 0\n  cosine = mag && (x1 * x2 + y1 * y2) / mag; // Math.min(Math.max(cosine, -1), 1) clamps the cosine between -1 and 1\n\n  return Math.acos(Math.min(Math.max(cosine, -1), 1));\n}\n/**\n * Set the components of a vec2 to zero\n *\n * @param {vec2} out the receiving vector\n * @returns {vec2} out\n */\n\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  return out;\n}\n/**\n * Returns a string representation of a vector\n *\n * @param {ReadonlyVec2} a vector to represent as a string\n * @returns {String} string representation of the vector\n */\n\nexport function str(a) {\n  return \"vec2(\" + a[0] + \", \" + a[1] + \")\";\n}\n/**\n * Returns whether or not the vectors exactly have the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyVec2} a The first vector.\n * @param {ReadonlyVec2} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1];\n}\n/**\n * Returns whether or not the vectors have approximately the same elements in the same position.\n *\n * @param {ReadonlyVec2} a The first vector.\n * @param {ReadonlyVec2} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1];\n  var b0 = b[0],\n      b1 = b[1];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1));\n}\n/**\n * Alias for {@link vec2.length}\n * @function\n */\n\nexport var len = length;\n/**\n * Alias for {@link vec2.subtract}\n * @function\n */\n\nexport var sub = subtract;\n/**\n * Alias for {@link vec2.multiply}\n * @function\n */\n\nexport var mul = multiply;\n/**\n * Alias for {@link vec2.divide}\n * @function\n */\n\nexport var div = divide;\n/**\n * Alias for {@link vec2.distance}\n * @function\n */\n\nexport var dist = distance;\n/**\n * Alias for {@link vec2.squaredDistance}\n * @function\n */\n\nexport var sqrDist = squaredDistance;\n/**\n * Alias for {@link vec2.squaredLength}\n * @function\n */\n\nexport var sqrLen = squaredLength;\n/**\n * Perform some operation over an array of vec2s.\n *\n * @param {Array} a the array of vectors to iterate over\n * @param {Number} stride Number of elements between the start of each vec2. If 0 assumes tightly packed\n * @param {Number} offset Number of elements to skip at the beginning of the array\n * @param {Number} count Number of vec2s to iterate over. If 0 iterates over entire array\n * @param {Function} fn Function to call for each vector in the array\n * @param {Object} [arg] additional argument to pass to fn\n * @returns {Array} a\n * @function\n */\n\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 2;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n    }\n\n    return a;\n  };\n}();","export function vec2_transformMat4AsVector(out, a, m) {\n  const x = a[0];\n  const y = a[1];\n  const w = m[3] * x + m[7] * y || 1.0;\n  out[0] = (m[0] * x + m[4] * y) / w;\n  out[1] = (m[1] * x + m[5] * y) / w;\n  return out;\n}\nexport function vec3_transformMat4AsVector(out, a, m) {\n  const x = a[0];\n  const y = a[1];\n  const z = a[2];\n  const w = m[3] * x + m[7] * y + m[11] * z || 1.0;\n  out[0] = (m[0] * x + m[4] * y + m[8] * z) / w;\n  out[1] = (m[1] * x + m[5] * y + m[9] * z) / w;\n  out[2] = (m[2] * x + m[6] * y + m[10] * z) / w;\n  return out;\n}\nexport function vec3_transformMat2(out, a, m) {\n  const x = a[0];\n  const y = a[1];\n  out[0] = m[0] * x + m[2] * y;\n  out[1] = m[1] * x + m[3] * y;\n  out[2] = a[2];\n  return out;\n}\nexport function vec4_transformMat2(out, a, m) {\n  const x = a[0];\n  const y = a[1];\n  out[0] = m[0] * x + m[2] * y;\n  out[1] = m[1] * x + m[3] * y;\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\nexport function vec4_transformMat3(out, a, m) {\n  const x = a[0];\n  const y = a[1];\n  const z = a[2];\n  out[0] = m[0] * x + m[3] * y + m[6] * z;\n  out[1] = m[1] * x + m[4] * y + m[7] * z;\n  out[2] = m[2] * x + m[5] * y + m[8] * z;\n  out[3] = a[3];\n  return out;\n}\n//# sourceMappingURL=gl-matrix-extras.js.map","import * as glMatrix from \"./common.js\";\n/**\n * 3 Dimensional Vector\n * @module vec3\n */\n\n/**\n * Creates a new, empty vec3\n *\n * @returns {vec3} a new 3D vector\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(3);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n  }\n\n  return out;\n}\n/**\n * Creates a new vec3 initialized with values from an existing vector\n *\n * @param {ReadonlyVec3} a vector to clone\n * @returns {vec3} a new 3D vector\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n/**\n * Calculates the length of a vec3\n *\n * @param {ReadonlyVec3} a vector to calculate length of\n * @returns {Number} length of a\n */\n\nexport function length(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return Math.hypot(x, y, z);\n}\n/**\n * Creates a new vec3 initialized with the given values\n *\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @returns {vec3} a new 3D vector\n */\n\nexport function fromValues(x, y, z) {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n/**\n * Copy the values from one vec3 to another\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the source vector\n * @returns {vec3} out\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n/**\n * Set the components of a vec3 to the given values\n *\n * @param {vec3} out the receiving vector\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @returns {vec3} out\n */\n\nexport function set(out, x, y, z) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n/**\n * Adds two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  return out;\n}\n/**\n * Subtracts vector b from vector a\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  return out;\n}\n/**\n * Multiplies two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  out[2] = a[2] * b[2];\n  return out;\n}\n/**\n * Divides two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  out[2] = a[2] / b[2];\n  return out;\n}\n/**\n * Math.ceil the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to ceil\n * @returns {vec3} out\n */\n\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  out[2] = Math.ceil(a[2]);\n  return out;\n}\n/**\n * Math.floor the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to floor\n * @returns {vec3} out\n */\n\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  out[2] = Math.floor(a[2]);\n  return out;\n}\n/**\n * Returns the minimum of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  out[2] = Math.min(a[2], b[2]);\n  return out;\n}\n/**\n * Returns the maximum of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  out[2] = Math.max(a[2], b[2]);\n  return out;\n}\n/**\n * Math.round the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to round\n * @returns {vec3} out\n */\n\nexport function round(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  out[2] = Math.round(a[2]);\n  return out;\n}\n/**\n * Scales a vec3 by a scalar number\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to scale\n * @param {Number} b amount to scale the vector by\n * @returns {vec3} out\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  return out;\n}\n/**\n * Adds two vec3's after scaling the second operand by a scalar value\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {Number} scale the amount to scale b by before adding\n * @returns {vec3} out\n */\n\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  return out;\n}\n/**\n * Calculates the euclidian distance between two vec3's\n *\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {Number} distance between a and b\n */\n\nexport function distance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return Math.hypot(x, y, z);\n}\n/**\n * Calculates the squared euclidian distance between two vec3's\n *\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {Number} squared distance between a and b\n */\n\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return x * x + y * y + z * z;\n}\n/**\n * Calculates the squared length of a vec3\n *\n * @param {ReadonlyVec3} a vector to calculate squared length of\n * @returns {Number} squared length of a\n */\n\nexport function squaredLength(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return x * x + y * y + z * z;\n}\n/**\n * Negates the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to negate\n * @returns {vec3} out\n */\n\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  return out;\n}\n/**\n * Returns the inverse of the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to invert\n * @returns {vec3} out\n */\n\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  out[2] = 1.0 / a[2];\n  return out;\n}\n/**\n * Normalize a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to normalize\n * @returns {vec3} out\n */\n\nexport function normalize(out, a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var len = x * x + y * y + z * z;\n\n  if (len > 0) {\n    //TODO: evaluate use of glm_invsqrt here?\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = a[0] * len;\n  out[1] = a[1] * len;\n  out[2] = a[2] * len;\n  return out;\n}\n/**\n * Calculates the dot product of two vec3's\n *\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {Number} dot product of a and b\n */\n\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n}\n/**\n * Computes the cross product of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function cross(out, a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2];\n  var bx = b[0],\n      by = b[1],\n      bz = b[2];\n  out[0] = ay * bz - az * by;\n  out[1] = az * bx - ax * bz;\n  out[2] = ax * by - ay * bx;\n  return out;\n}\n/**\n * Performs a linear interpolation between two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec3} out\n */\n\nexport function lerp(out, a, b, t) {\n  var ax = a[0];\n  var ay = a[1];\n  var az = a[2];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  out[2] = az + t * (b[2] - az);\n  return out;\n}\n/**\n * Performs a hermite interpolation with two control points\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {ReadonlyVec3} c the third operand\n * @param {ReadonlyVec3} d the fourth operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec3} out\n */\n\nexport function hermite(out, a, b, c, d, t) {\n  var factorTimes2 = t * t;\n  var factor1 = factorTimes2 * (2 * t - 3) + 1;\n  var factor2 = factorTimes2 * (t - 2) + t;\n  var factor3 = factorTimes2 * (t - 1);\n  var factor4 = factorTimes2 * (3 - 2 * t);\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  return out;\n}\n/**\n * Performs a bezier interpolation with two control points\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {ReadonlyVec3} c the third operand\n * @param {ReadonlyVec3} d the fourth operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec3} out\n */\n\nexport function bezier(out, a, b, c, d, t) {\n  var inverseFactor = 1 - t;\n  var inverseFactorTimesTwo = inverseFactor * inverseFactor;\n  var factorTimes2 = t * t;\n  var factor1 = inverseFactorTimesTwo * inverseFactor;\n  var factor2 = 3 * t * inverseFactorTimesTwo;\n  var factor3 = 3 * factorTimes2 * inverseFactor;\n  var factor4 = factorTimes2 * t;\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  return out;\n}\n/**\n * Generates a random vector with the given scale\n *\n * @param {vec3} out the receiving vector\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\n * @returns {vec3} out\n */\n\nexport function random(out, scale) {\n  scale = scale || 1.0;\n  var r = glMatrix.RANDOM() * 2.0 * Math.PI;\n  var z = glMatrix.RANDOM() * 2.0 - 1.0;\n  var zScale = Math.sqrt(1.0 - z * z) * scale;\n  out[0] = Math.cos(r) * zScale;\n  out[1] = Math.sin(r) * zScale;\n  out[2] = z * scale;\n  return out;\n}\n/**\n * Transforms the vec3 with a mat4.\n * 4th vector component is implicitly '1'\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to transform\n * @param {ReadonlyMat4} m matrix to transform with\n * @returns {vec3} out\n */\n\nexport function transformMat4(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  var w = m[3] * x + m[7] * y + m[11] * z + m[15];\n  w = w || 1.0;\n  out[0] = (m[0] * x + m[4] * y + m[8] * z + m[12]) / w;\n  out[1] = (m[1] * x + m[5] * y + m[9] * z + m[13]) / w;\n  out[2] = (m[2] * x + m[6] * y + m[10] * z + m[14]) / w;\n  return out;\n}\n/**\n * Transforms the vec3 with a mat3.\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to transform\n * @param {ReadonlyMat3} m the 3x3 matrix to transform with\n * @returns {vec3} out\n */\n\nexport function transformMat3(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  out[0] = x * m[0] + y * m[3] + z * m[6];\n  out[1] = x * m[1] + y * m[4] + z * m[7];\n  out[2] = x * m[2] + y * m[5] + z * m[8];\n  return out;\n}\n/**\n * Transforms the vec3 with a quat\n * Can also be used for dual quaternions. (Multiply it with the real part)\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to transform\n * @param {ReadonlyQuat} q quaternion to transform with\n * @returns {vec3} out\n */\n\nexport function transformQuat(out, a, q) {\n  // benchmarks: https://jsperf.com/quaternion-transform-vec3-implementations-fixed\n  var qx = q[0],\n      qy = q[1],\n      qz = q[2],\n      qw = q[3];\n  var x = a[0],\n      y = a[1],\n      z = a[2]; // var qvec = [qx, qy, qz];\n  // var uv = vec3.cross([], qvec, a);\n\n  var uvx = qy * z - qz * y,\n      uvy = qz * x - qx * z,\n      uvz = qx * y - qy * x; // var uuv = vec3.cross([], qvec, uv);\n\n  var uuvx = qy * uvz - qz * uvy,\n      uuvy = qz * uvx - qx * uvz,\n      uuvz = qx * uvy - qy * uvx; // vec3.scale(uv, uv, 2 * w);\n\n  var w2 = qw * 2;\n  uvx *= w2;\n  uvy *= w2;\n  uvz *= w2; // vec3.scale(uuv, uuv, 2);\n\n  uuvx *= 2;\n  uuvy *= 2;\n  uuvz *= 2; // return vec3.add(out, a, vec3.add(out, uv, uuv));\n\n  out[0] = x + uvx + uuvx;\n  out[1] = y + uvy + uuvy;\n  out[2] = z + uvz + uuvz;\n  return out;\n}\n/**\n * Rotate a 3D vector around the x-axis\n * @param {vec3} out The receiving vec3\n * @param {ReadonlyVec3} a The vec3 point to rotate\n * @param {ReadonlyVec3} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec3} out\n */\n\nexport function rotateX(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[0];\n  r[1] = p[1] * Math.cos(rad) - p[2] * Math.sin(rad);\n  r[2] = p[1] * Math.sin(rad) + p[2] * Math.cos(rad); //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\n * Rotate a 3D vector around the y-axis\n * @param {vec3} out The receiving vec3\n * @param {ReadonlyVec3} a The vec3 point to rotate\n * @param {ReadonlyVec3} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec3} out\n */\n\nexport function rotateY(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[2] * Math.sin(rad) + p[0] * Math.cos(rad);\n  r[1] = p[1];\n  r[2] = p[2] * Math.cos(rad) - p[0] * Math.sin(rad); //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\n * Rotate a 3D vector around the z-axis\n * @param {vec3} out The receiving vec3\n * @param {ReadonlyVec3} a The vec3 point to rotate\n * @param {ReadonlyVec3} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec3} out\n */\n\nexport function rotateZ(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[0] * Math.cos(rad) - p[1] * Math.sin(rad);\n  r[1] = p[0] * Math.sin(rad) + p[1] * Math.cos(rad);\n  r[2] = p[2]; //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\n * Get the angle between two 3D vectors\n * @param {ReadonlyVec3} a The first operand\n * @param {ReadonlyVec3} b The second operand\n * @returns {Number} The angle in radians\n */\n\nexport function angle(a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      bx = b[0],\n      by = b[1],\n      bz = b[2],\n      mag1 = Math.sqrt(ax * ax + ay * ay + az * az),\n      mag2 = Math.sqrt(bx * bx + by * by + bz * bz),\n      mag = mag1 * mag2,\n      cosine = mag && dot(a, b) / mag;\n  return Math.acos(Math.min(Math.max(cosine, -1), 1));\n}\n/**\n * Set the components of a vec3 to zero\n *\n * @param {vec3} out the receiving vector\n * @returns {vec3} out\n */\n\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  return out;\n}\n/**\n * Returns a string representation of a vector\n *\n * @param {ReadonlyVec3} a vector to represent as a string\n * @returns {String} string representation of the vector\n */\n\nexport function str(a) {\n  return \"vec3(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \")\";\n}\n/**\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyVec3} a The first vector.\n * @param {ReadonlyVec3} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2];\n}\n/**\n * Returns whether or not the vectors have approximately the same elements in the same position.\n *\n * @param {ReadonlyVec3} a The first vector.\n * @param {ReadonlyVec3} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2));\n}\n/**\n * Alias for {@link vec3.subtract}\n * @function\n */\n\nexport var sub = subtract;\n/**\n * Alias for {@link vec3.multiply}\n * @function\n */\n\nexport var mul = multiply;\n/**\n * Alias for {@link vec3.divide}\n * @function\n */\n\nexport var div = divide;\n/**\n * Alias for {@link vec3.distance}\n * @function\n */\n\nexport var dist = distance;\n/**\n * Alias for {@link vec3.squaredDistance}\n * @function\n */\n\nexport var sqrDist = squaredDistance;\n/**\n * Alias for {@link vec3.length}\n * @function\n */\n\nexport var len = length;\n/**\n * Alias for {@link vec3.squaredLength}\n * @function\n */\n\nexport var sqrLen = squaredLength;\n/**\n * Perform some operation over an array of vec3s.\n *\n * @param {Array} a the array of vectors to iterate over\n * @param {Number} stride Number of elements between the start of each vec3. If 0 assumes tightly packed\n * @param {Number} offset Number of elements to skip at the beginning of the array\n * @param {Number} count Number of vec3s to iterate over. If 0 iterates over entire array\n * @param {Function} fn Function to call for each vector in the array\n * @param {Object} [arg] additional argument to pass to fn\n * @returns {Array} a\n * @function\n */\n\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 3;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      vec[2] = a[i + 2];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n      a[i + 2] = vec[2];\n    }\n\n    return a;\n  };\n}();","import Vector from './base/vector';\nimport { config, isArray } from '../lib/common';\nimport { checkNumber } from '../lib/validators';\nimport * as vec3 from 'gl-matrix/vec3';\nimport { vec3_transformMat2, vec3_transformMat4AsVector } from '../lib/gl-matrix-extras';\nconst ORIGIN = [0, 0, 0];\nlet ZERO;\nexport default class Vector3 extends Vector {\n  static get ZERO() {\n    if (!ZERO) {\n      ZERO = new Vector3(0, 0, 0);\n      Object.freeze(ZERO);\n    }\n\n    return ZERO;\n  }\n\n  constructor(x = 0, y = 0, z = 0) {\n    super(-0, -0, -0);\n\n    if (arguments.length === 1 && isArray(x)) {\n      this.copy(x);\n    } else {\n      if (config.debug) {\n        checkNumber(x);\n        checkNumber(y);\n        checkNumber(z);\n      }\n\n      this[0] = x;\n      this[1] = y;\n      this[2] = z;\n    }\n  }\n\n  set(x, y, z) {\n    this[0] = x;\n    this[1] = y;\n    this[2] = z;\n    return this.check();\n  }\n\n  copy(array) {\n    this[0] = array[0];\n    this[1] = array[1];\n    this[2] = array[2];\n    return this.check();\n  }\n\n  fromObject(object) {\n    if (config.debug) {\n      checkNumber(object.x);\n      checkNumber(object.y);\n      checkNumber(object.z);\n    }\n\n    this[0] = object.x;\n    this[1] = object.y;\n    this[2] = object.z;\n    return this.check();\n  }\n\n  toObject(object) {\n    object.x = this[0];\n    object.y = this[1];\n    object.z = this[2];\n    return object;\n  }\n\n  get ELEMENTS() {\n    return 3;\n  }\n\n  get z() {\n    return this[2];\n  }\n\n  set z(value) {\n    this[2] = checkNumber(value);\n  }\n\n  angle(vector) {\n    return vec3.angle(this, vector);\n  }\n\n  cross(vector) {\n    vec3.cross(this, this, vector);\n    return this.check();\n  }\n\n  rotateX({\n    radians,\n    origin = ORIGIN\n  }) {\n    vec3.rotateX(this, this, origin, radians);\n    return this.check();\n  }\n\n  rotateY({\n    radians,\n    origin = ORIGIN\n  }) {\n    vec3.rotateY(this, this, origin, radians);\n    return this.check();\n  }\n\n  rotateZ({\n    radians,\n    origin = ORIGIN\n  }) {\n    vec3.rotateZ(this, this, origin, radians);\n    return this.check();\n  }\n\n  transform(matrix4) {\n    return this.transformAsPoint(matrix4);\n  }\n\n  transformAsPoint(matrix4) {\n    vec3.transformMat4(this, this, matrix4);\n    return this.check();\n  }\n\n  transformAsVector(matrix4) {\n    vec3_transformMat4AsVector(this, this, matrix4);\n    return this.check();\n  }\n\n  transformByMatrix3(matrix3) {\n    vec3.transformMat3(this, this, matrix3);\n    return this.check();\n  }\n\n  transformByMatrix2(matrix2) {\n    vec3_transformMat2(this, this, matrix2);\n    return this.check();\n  }\n\n  transformByQuaternion(quaternion) {\n    vec3.transformQuat(this, this, quaternion);\n    return this.check();\n  }\n\n}\n//# sourceMappingURL=vector3.js.map","import MathArray from './math-array';\nimport { checkNumber } from '../../lib/validators';\nimport { config } from '../../lib/common';\nexport default class Matrix extends MathArray {\n  toString() {\n    let string = '[';\n\n    if (config.printRowMajor) {\n      string += 'row-major:';\n\n      for (let row = 0; row < this.RANK; ++row) {\n        for (let col = 0; col < this.RANK; ++col) {\n          string += \" \".concat(this[col * this.RANK + row]);\n        }\n      }\n    } else {\n      string += 'column-major:';\n\n      for (let i = 0; i < this.ELEMENTS; ++i) {\n        string += \" \".concat(this[i]);\n      }\n    }\n\n    string += ']';\n    return string;\n  }\n\n  getElementIndex(row, col) {\n    return col * this.RANK + row;\n  }\n\n  getElement(row, col) {\n    return this[col * this.RANK + row];\n  }\n\n  setElement(row, col, value) {\n    this[col * this.RANK + row] = checkNumber(value);\n    return this;\n  }\n\n  getColumn(columnIndex, result = new Array(this.RANK).fill(-0)) {\n    const firstIndex = columnIndex * this.RANK;\n\n    for (let i = 0; i < this.RANK; ++i) {\n      result[i] = this[firstIndex + i];\n    }\n\n    return result;\n  }\n\n  setColumn(columnIndex, columnVector) {\n    const firstIndex = columnIndex * this.RANK;\n\n    for (let i = 0; i < this.RANK; ++i) {\n      this[firstIndex + i] = columnVector[i];\n    }\n\n    return this;\n  }\n\n}\n//# sourceMappingURL=matrix.js.map","import * as glMatrix from \"./common.js\";\n/**\n * 4x4 Matrix<br>Format: column-major, when typed out it looks like row-major<br>The matrices are being post multiplied.\n * @module mat4\n */\n\n/**\n * Creates a new identity mat4\n *\n * @returns {mat4} a new 4x4 matrix\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(16);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[4] = 0;\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = 0;\n    out[9] = 0;\n    out[11] = 0;\n    out[12] = 0;\n    out[13] = 0;\n    out[14] = 0;\n  }\n\n  out[0] = 1;\n  out[5] = 1;\n  out[10] = 1;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a new mat4 initialized with values from an existing matrix\n *\n * @param {ReadonlyMat4} a matrix to clone\n * @returns {mat4} a new 4x4 matrix\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\n * Copy the values from one mat4 to another\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\n * Create a new mat4 with the given values\n *\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\n * @returns {mat4} A new mat4\n */\n\nexport function fromValues(m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n/**\n * Set the components of a mat4 to the given values\n *\n * @param {mat4} out the receiving matrix\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\n * @returns {mat4} out\n */\n\nexport function set(out, m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n/**\n * Set a mat4 to the identity matrix\n *\n * @param {mat4} out the receiving matrix\n * @returns {mat4} out\n */\n\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Transpose the values of a mat4\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\n\nexport function transpose(out, a) {\n  // If we are transposing ourselves we can skip a few steps but have to cache some values\n  if (out === a) {\n    var a01 = a[1],\n        a02 = a[2],\n        a03 = a[3];\n    var a12 = a[6],\n        a13 = a[7];\n    var a23 = a[11];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a01;\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a02;\n    out[9] = a12;\n    out[11] = a[14];\n    out[12] = a03;\n    out[13] = a13;\n    out[14] = a23;\n  } else {\n    out[0] = a[0];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a[1];\n    out[5] = a[5];\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a[2];\n    out[9] = a[6];\n    out[10] = a[10];\n    out[11] = a[14];\n    out[12] = a[3];\n    out[13] = a[7];\n    out[14] = a[11];\n    out[15] = a[15];\n  }\n\n  return out;\n}\n/**\n * Inverts a mat4\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\n\nexport function invert(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  var det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\n  out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\n  out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n  out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n  out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n  out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\n  out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\n  out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\n  out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\n  out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\n  return out;\n}\n/**\n * Calculates the adjugate of a mat4\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\n\nexport function adjoint(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  out[0] = a11 * (a22 * a33 - a23 * a32) - a21 * (a12 * a33 - a13 * a32) + a31 * (a12 * a23 - a13 * a22);\n  out[1] = -(a01 * (a22 * a33 - a23 * a32) - a21 * (a02 * a33 - a03 * a32) + a31 * (a02 * a23 - a03 * a22));\n  out[2] = a01 * (a12 * a33 - a13 * a32) - a11 * (a02 * a33 - a03 * a32) + a31 * (a02 * a13 - a03 * a12);\n  out[3] = -(a01 * (a12 * a23 - a13 * a22) - a11 * (a02 * a23 - a03 * a22) + a21 * (a02 * a13 - a03 * a12));\n  out[4] = -(a10 * (a22 * a33 - a23 * a32) - a20 * (a12 * a33 - a13 * a32) + a30 * (a12 * a23 - a13 * a22));\n  out[5] = a00 * (a22 * a33 - a23 * a32) - a20 * (a02 * a33 - a03 * a32) + a30 * (a02 * a23 - a03 * a22);\n  out[6] = -(a00 * (a12 * a33 - a13 * a32) - a10 * (a02 * a33 - a03 * a32) + a30 * (a02 * a13 - a03 * a12));\n  out[7] = a00 * (a12 * a23 - a13 * a22) - a10 * (a02 * a23 - a03 * a22) + a20 * (a02 * a13 - a03 * a12);\n  out[8] = a10 * (a21 * a33 - a23 * a31) - a20 * (a11 * a33 - a13 * a31) + a30 * (a11 * a23 - a13 * a21);\n  out[9] = -(a00 * (a21 * a33 - a23 * a31) - a20 * (a01 * a33 - a03 * a31) + a30 * (a01 * a23 - a03 * a21));\n  out[10] = a00 * (a11 * a33 - a13 * a31) - a10 * (a01 * a33 - a03 * a31) + a30 * (a01 * a13 - a03 * a11);\n  out[11] = -(a00 * (a11 * a23 - a13 * a21) - a10 * (a01 * a23 - a03 * a21) + a20 * (a01 * a13 - a03 * a11));\n  out[12] = -(a10 * (a21 * a32 - a22 * a31) - a20 * (a11 * a32 - a12 * a31) + a30 * (a11 * a22 - a12 * a21));\n  out[13] = a00 * (a21 * a32 - a22 * a31) - a20 * (a01 * a32 - a02 * a31) + a30 * (a01 * a22 - a02 * a21);\n  out[14] = -(a00 * (a11 * a32 - a12 * a31) - a10 * (a01 * a32 - a02 * a31) + a30 * (a01 * a12 - a02 * a11));\n  out[15] = a00 * (a11 * a22 - a12 * a21) - a10 * (a01 * a22 - a02 * a21) + a20 * (a01 * a12 - a02 * a11);\n  return out;\n}\n/**\n * Calculates the determinant of a mat4\n *\n * @param {ReadonlyMat4} a the source matrix\n * @returns {Number} determinant of a\n */\n\nexport function determinant(a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  return b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n}\n/**\n * Multiplies two mat4s\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @returns {mat4} out\n */\n\nexport function multiply(out, a, b) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15]; // Cache only the current line of the second matrix\n\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  out[0] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[1] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[2] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[3] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[4];\n  b1 = b[5];\n  b2 = b[6];\n  b3 = b[7];\n  out[4] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[5] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[6] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[7] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[8];\n  b1 = b[9];\n  b2 = b[10];\n  b3 = b[11];\n  out[8] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[9] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[10] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[11] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[12];\n  b1 = b[13];\n  b2 = b[14];\n  b3 = b[15];\n  out[12] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[13] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[14] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[15] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  return out;\n}\n/**\n * Translate a mat4 by the given vector\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to translate\n * @param {ReadonlyVec3} v vector to translate by\n * @returns {mat4} out\n */\n\nexport function translate(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n\n  if (a === out) {\n    out[12] = a[0] * x + a[4] * y + a[8] * z + a[12];\n    out[13] = a[1] * x + a[5] * y + a[9] * z + a[13];\n    out[14] = a[2] * x + a[6] * y + a[10] * z + a[14];\n    out[15] = a[3] * x + a[7] * y + a[11] * z + a[15];\n  } else {\n    a00 = a[0];\n    a01 = a[1];\n    a02 = a[2];\n    a03 = a[3];\n    a10 = a[4];\n    a11 = a[5];\n    a12 = a[6];\n    a13 = a[7];\n    a20 = a[8];\n    a21 = a[9];\n    a22 = a[10];\n    a23 = a[11];\n    out[0] = a00;\n    out[1] = a01;\n    out[2] = a02;\n    out[3] = a03;\n    out[4] = a10;\n    out[5] = a11;\n    out[6] = a12;\n    out[7] = a13;\n    out[8] = a20;\n    out[9] = a21;\n    out[10] = a22;\n    out[11] = a23;\n    out[12] = a00 * x + a10 * y + a20 * z + a[12];\n    out[13] = a01 * x + a11 * y + a21 * z + a[13];\n    out[14] = a02 * x + a12 * y + a22 * z + a[14];\n    out[15] = a03 * x + a13 * y + a23 * z + a[15];\n  }\n\n  return out;\n}\n/**\n * Scales the mat4 by the dimensions in the given vec3 not using vectorization\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to scale\n * @param {ReadonlyVec3} v the vec3 to scale the matrix by\n * @returns {mat4} out\n **/\n\nexport function scale(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  out[0] = a[0] * x;\n  out[1] = a[1] * x;\n  out[2] = a[2] * x;\n  out[3] = a[3] * x;\n  out[4] = a[4] * y;\n  out[5] = a[5] * y;\n  out[6] = a[6] * y;\n  out[7] = a[7] * y;\n  out[8] = a[8] * z;\n  out[9] = a[9] * z;\n  out[10] = a[10] * z;\n  out[11] = a[11] * z;\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\n * Rotates a mat4 by the given angle around the given axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @param {ReadonlyVec3} axis the axis to rotate around\n * @returns {mat4} out\n */\n\nexport function rotate(out, a, rad, axis) {\n  var x = axis[0],\n      y = axis[1],\n      z = axis[2];\n  var len = Math.hypot(x, y, z);\n  var s, c, t;\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n  var b00, b01, b02;\n  var b10, b11, b12;\n  var b20, b21, b22;\n\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c;\n  a00 = a[0];\n  a01 = a[1];\n  a02 = a[2];\n  a03 = a[3];\n  a10 = a[4];\n  a11 = a[5];\n  a12 = a[6];\n  a13 = a[7];\n  a20 = a[8];\n  a21 = a[9];\n  a22 = a[10];\n  a23 = a[11]; // Construct the elements of the rotation matrix\n\n  b00 = x * x * t + c;\n  b01 = y * x * t + z * s;\n  b02 = z * x * t - y * s;\n  b10 = x * y * t - z * s;\n  b11 = y * y * t + c;\n  b12 = z * y * t + x * s;\n  b20 = x * z * t + y * s;\n  b21 = y * z * t - x * s;\n  b22 = z * z * t + c; // Perform rotation-specific matrix multiplication\n\n  out[0] = a00 * b00 + a10 * b01 + a20 * b02;\n  out[1] = a01 * b00 + a11 * b01 + a21 * b02;\n  out[2] = a02 * b00 + a12 * b01 + a22 * b02;\n  out[3] = a03 * b00 + a13 * b01 + a23 * b02;\n  out[4] = a00 * b10 + a10 * b11 + a20 * b12;\n  out[5] = a01 * b10 + a11 * b11 + a21 * b12;\n  out[6] = a02 * b10 + a12 * b11 + a22 * b12;\n  out[7] = a03 * b10 + a13 * b11 + a23 * b12;\n  out[8] = a00 * b20 + a10 * b21 + a20 * b22;\n  out[9] = a01 * b20 + a11 * b21 + a21 * b22;\n  out[10] = a02 * b20 + a12 * b21 + a22 * b22;\n  out[11] = a03 * b20 + a13 * b21 + a23 * b22;\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n\n  return out;\n}\n/**\n * Rotates a matrix by the given angle around the X axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function rotateX(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[3];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[4] = a10 * c + a20 * s;\n  out[5] = a11 * c + a21 * s;\n  out[6] = a12 * c + a22 * s;\n  out[7] = a13 * c + a23 * s;\n  out[8] = a20 * c - a10 * s;\n  out[9] = a21 * c - a11 * s;\n  out[10] = a22 * c - a12 * s;\n  out[11] = a23 * c - a13 * s;\n  return out;\n}\n/**\n * Rotates a matrix by the given angle around the Y axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function rotateY(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[4] = a[4];\n    out[5] = a[5];\n    out[6] = a[6];\n    out[7] = a[7];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[0] = a00 * c - a20 * s;\n  out[1] = a01 * c - a21 * s;\n  out[2] = a02 * c - a22 * s;\n  out[3] = a03 * c - a23 * s;\n  out[8] = a00 * s + a20 * c;\n  out[9] = a01 * s + a21 * c;\n  out[10] = a02 * s + a22 * c;\n  out[11] = a03 * s + a23 * c;\n  return out;\n}\n/**\n * Rotates a matrix by the given angle around the Z axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function rotateZ(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[8] = a[8];\n    out[9] = a[9];\n    out[10] = a[10];\n    out[11] = a[11];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[0] = a00 * c + a10 * s;\n  out[1] = a01 * c + a11 * s;\n  out[2] = a02 * c + a12 * s;\n  out[3] = a03 * c + a13 * s;\n  out[4] = a10 * c - a00 * s;\n  out[5] = a11 * c - a01 * s;\n  out[6] = a12 * c - a02 * s;\n  out[7] = a13 * c - a03 * s;\n  return out;\n}\n/**\n * Creates a matrix from a vector translation\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, dest, vec);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {ReadonlyVec3} v Translation vector\n * @returns {mat4} out\n */\n\nexport function fromTranslation(out, v) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from a vector scaling\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.scale(dest, dest, vec);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {ReadonlyVec3} v Scaling vector\n * @returns {mat4} out\n */\n\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = v[1];\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = v[2];\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from a given angle around a given axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotate(dest, dest, rad, axis);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @param {ReadonlyVec3} axis the axis to rotate around\n * @returns {mat4} out\n */\n\nexport function fromRotation(out, rad, axis) {\n  var x = axis[0],\n      y = axis[1],\n      z = axis[2];\n  var len = Math.hypot(x, y, z);\n  var s, c, t;\n\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c; // Perform rotation-specific matrix multiplication\n\n  out[0] = x * x * t + c;\n  out[1] = y * x * t + z * s;\n  out[2] = z * x * t - y * s;\n  out[3] = 0;\n  out[4] = x * y * t - z * s;\n  out[5] = y * y * t + c;\n  out[6] = z * y * t + x * s;\n  out[7] = 0;\n  out[8] = x * z * t + y * s;\n  out[9] = y * z * t - x * s;\n  out[10] = z * z * t + c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from the given angle around the X axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotateX(dest, dest, rad);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function fromXRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = c;\n  out[6] = s;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = -s;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from the given angle around the Y axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotateY(dest, dest, rad);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function fromYRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = c;\n  out[1] = 0;\n  out[2] = -s;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = s;\n  out[9] = 0;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from the given angle around the Z axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotateZ(dest, dest, rad);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function fromZRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = c;\n  out[1] = s;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = -s;\n  out[5] = c;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from a quaternion rotation and vector translation\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, vec);\n *     let quatMat = mat4.create();\n *     quat4.toMat4(quat, quatMat);\n *     mat4.multiply(dest, quatMat);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat4} q Rotation quaternion\n * @param {ReadonlyVec3} v Translation vector\n * @returns {mat4} out\n */\n\nexport function fromRotationTranslation(out, q, v) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - (yy + zz);\n  out[1] = xy + wz;\n  out[2] = xz - wy;\n  out[3] = 0;\n  out[4] = xy - wz;\n  out[5] = 1 - (xx + zz);\n  out[6] = yz + wx;\n  out[7] = 0;\n  out[8] = xz + wy;\n  out[9] = yz - wx;\n  out[10] = 1 - (xx + yy);\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a new mat4 from a dual quat.\n *\n * @param {mat4} out Matrix\n * @param {ReadonlyQuat2} a Dual Quaternion\n * @returns {mat4} mat4 receiving operation result\n */\n\nexport function fromQuat2(out, a) {\n  var translation = new glMatrix.ARRAY_TYPE(3);\n  var bx = -a[0],\n      by = -a[1],\n      bz = -a[2],\n      bw = a[3],\n      ax = a[4],\n      ay = a[5],\n      az = a[6],\n      aw = a[7];\n  var magnitude = bx * bx + by * by + bz * bz + bw * bw; //Only scale if it makes sense\n\n  if (magnitude > 0) {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2 / magnitude;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2 / magnitude;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2 / magnitude;\n  } else {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2;\n  }\n\n  fromRotationTranslation(out, a, translation);\n  return out;\n}\n/**\n * Returns the translation vector component of a transformation\n *  matrix. If a matrix is built with fromRotationTranslation,\n *  the returned vector will be the same as the translation vector\n *  originally supplied.\n * @param  {vec3} out Vector to receive translation component\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @return {vec3} out\n */\n\nexport function getTranslation(out, mat) {\n  out[0] = mat[12];\n  out[1] = mat[13];\n  out[2] = mat[14];\n  return out;\n}\n/**\n * Returns the scaling factor component of a transformation\n *  matrix. If a matrix is built with fromRotationTranslationScale\n *  with a normalized Quaternion paramter, the returned vector will be\n *  the same as the scaling vector\n *  originally supplied.\n * @param  {vec3} out Vector to receive scaling factor component\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @return {vec3} out\n */\n\nexport function getScaling(out, mat) {\n  var m11 = mat[0];\n  var m12 = mat[1];\n  var m13 = mat[2];\n  var m21 = mat[4];\n  var m22 = mat[5];\n  var m23 = mat[6];\n  var m31 = mat[8];\n  var m32 = mat[9];\n  var m33 = mat[10];\n  out[0] = Math.hypot(m11, m12, m13);\n  out[1] = Math.hypot(m21, m22, m23);\n  out[2] = Math.hypot(m31, m32, m33);\n  return out;\n}\n/**\n * Returns a quaternion representing the rotational component\n *  of a transformation matrix. If a matrix is built with\n *  fromRotationTranslation, the returned quaternion will be the\n *  same as the quaternion originally supplied.\n * @param {quat} out Quaternion to receive the rotation component\n * @param {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @return {quat} out\n */\n\nexport function getRotation(out, mat) {\n  var scaling = new glMatrix.ARRAY_TYPE(3);\n  getScaling(scaling, mat);\n  var is1 = 1 / scaling[0];\n  var is2 = 1 / scaling[1];\n  var is3 = 1 / scaling[2];\n  var sm11 = mat[0] * is1;\n  var sm12 = mat[1] * is2;\n  var sm13 = mat[2] * is3;\n  var sm21 = mat[4] * is1;\n  var sm22 = mat[5] * is2;\n  var sm23 = mat[6] * is3;\n  var sm31 = mat[8] * is1;\n  var sm32 = mat[9] * is2;\n  var sm33 = mat[10] * is3;\n  var trace = sm11 + sm22 + sm33;\n  var S = 0;\n\n  if (trace > 0) {\n    S = Math.sqrt(trace + 1.0) * 2;\n    out[3] = 0.25 * S;\n    out[0] = (sm23 - sm32) / S;\n    out[1] = (sm31 - sm13) / S;\n    out[2] = (sm12 - sm21) / S;\n  } else if (sm11 > sm22 && sm11 > sm33) {\n    S = Math.sqrt(1.0 + sm11 - sm22 - sm33) * 2;\n    out[3] = (sm23 - sm32) / S;\n    out[0] = 0.25 * S;\n    out[1] = (sm12 + sm21) / S;\n    out[2] = (sm31 + sm13) / S;\n  } else if (sm22 > sm33) {\n    S = Math.sqrt(1.0 + sm22 - sm11 - sm33) * 2;\n    out[3] = (sm31 - sm13) / S;\n    out[0] = (sm12 + sm21) / S;\n    out[1] = 0.25 * S;\n    out[2] = (sm23 + sm32) / S;\n  } else {\n    S = Math.sqrt(1.0 + sm33 - sm11 - sm22) * 2;\n    out[3] = (sm12 - sm21) / S;\n    out[0] = (sm31 + sm13) / S;\n    out[1] = (sm23 + sm32) / S;\n    out[2] = 0.25 * S;\n  }\n\n  return out;\n}\n/**\n * Creates a matrix from a quaternion rotation, vector translation and vector scale\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, vec);\n *     let quatMat = mat4.create();\n *     quat4.toMat4(quat, quatMat);\n *     mat4.multiply(dest, quatMat);\n *     mat4.scale(dest, scale)\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat4} q Rotation quaternion\n * @param {ReadonlyVec3} v Translation vector\n * @param {ReadonlyVec3} s Scaling vector\n * @returns {mat4} out\n */\n\nexport function fromRotationTranslationScale(out, q, v, s) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  out[0] = (1 - (yy + zz)) * sx;\n  out[1] = (xy + wz) * sx;\n  out[2] = (xz - wy) * sx;\n  out[3] = 0;\n  out[4] = (xy - wz) * sy;\n  out[5] = (1 - (xx + zz)) * sy;\n  out[6] = (yz + wx) * sy;\n  out[7] = 0;\n  out[8] = (xz + wy) * sz;\n  out[9] = (yz - wx) * sz;\n  out[10] = (1 - (xx + yy)) * sz;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from a quaternion rotation, vector translation and vector scale, rotating and scaling around the given origin\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, vec);\n *     mat4.translate(dest, origin);\n *     let quatMat = mat4.create();\n *     quat4.toMat4(quat, quatMat);\n *     mat4.multiply(dest, quatMat);\n *     mat4.scale(dest, scale)\n *     mat4.translate(dest, negativeOrigin);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat4} q Rotation quaternion\n * @param {ReadonlyVec3} v Translation vector\n * @param {ReadonlyVec3} s Scaling vector\n * @param {ReadonlyVec3} o The origin vector around which to scale and rotate\n * @returns {mat4} out\n */\n\nexport function fromRotationTranslationScaleOrigin(out, q, v, s, o) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  var ox = o[0];\n  var oy = o[1];\n  var oz = o[2];\n  var out0 = (1 - (yy + zz)) * sx;\n  var out1 = (xy + wz) * sx;\n  var out2 = (xz - wy) * sx;\n  var out4 = (xy - wz) * sy;\n  var out5 = (1 - (xx + zz)) * sy;\n  var out6 = (yz + wx) * sy;\n  var out8 = (xz + wy) * sz;\n  var out9 = (yz - wx) * sz;\n  var out10 = (1 - (xx + yy)) * sz;\n  out[0] = out0;\n  out[1] = out1;\n  out[2] = out2;\n  out[3] = 0;\n  out[4] = out4;\n  out[5] = out5;\n  out[6] = out6;\n  out[7] = 0;\n  out[8] = out8;\n  out[9] = out9;\n  out[10] = out10;\n  out[11] = 0;\n  out[12] = v[0] + ox - (out0 * ox + out4 * oy + out8 * oz);\n  out[13] = v[1] + oy - (out1 * ox + out5 * oy + out9 * oz);\n  out[14] = v[2] + oz - (out2 * ox + out6 * oy + out10 * oz);\n  out[15] = 1;\n  return out;\n}\n/**\n * Calculates a 4x4 matrix from the given quaternion\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {ReadonlyQuat} q Quaternion to create matrix from\n *\n * @returns {mat4} out\n */\n\nexport function fromQuat(out, q) {\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var yx = y * x2;\n  var yy = y * y2;\n  var zx = z * x2;\n  var zy = z * y2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - yy - zz;\n  out[1] = yx + wz;\n  out[2] = zx - wy;\n  out[3] = 0;\n  out[4] = yx - wz;\n  out[5] = 1 - xx - zz;\n  out[6] = zy + wx;\n  out[7] = 0;\n  out[8] = zx + wy;\n  out[9] = zy - wx;\n  out[10] = 1 - xx - yy;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Generates a frustum matrix with the given bounds\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {Number} left Left bound of the frustum\n * @param {Number} right Right bound of the frustum\n * @param {Number} bottom Bottom bound of the frustum\n * @param {Number} top Top bound of the frustum\n * @param {Number} near Near bound of the frustum\n * @param {Number} far Far bound of the frustum\n * @returns {mat4} out\n */\n\nexport function frustum(out, left, right, bottom, top, near, far) {\n  var rl = 1 / (right - left);\n  var tb = 1 / (top - bottom);\n  var nf = 1 / (near - far);\n  out[0] = near * 2 * rl;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = near * 2 * tb;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = (right + left) * rl;\n  out[9] = (top + bottom) * tb;\n  out[10] = (far + near) * nf;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = far * near * 2 * nf;\n  out[15] = 0;\n  return out;\n}\n/**\n * Generates a perspective projection matrix with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [-1, 1],\n * which matches WebGL/OpenGL's clip volume.\n * Passing null/undefined/no value for far will generate infinite projection matrix.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} fovy Vertical field of view in radians\n * @param {number} aspect Aspect ratio. typically viewport width/height\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum, can be null or Infinity\n * @returns {mat4} out\n */\n\nexport function perspectiveNO(out, fovy, aspect, near, far) {\n  var f = 1.0 / Math.tan(fovy / 2),\n      nf;\n  out[0] = f / aspect;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = f;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[15] = 0;\n\n  if (far != null && far !== Infinity) {\n    nf = 1 / (near - far);\n    out[10] = (far + near) * nf;\n    out[14] = 2 * far * near * nf;\n  } else {\n    out[10] = -1;\n    out[14] = -2 * near;\n  }\n\n  return out;\n}\n/**\n * Alias for {@link mat4.perspectiveNO}\n * @function\n */\n\nexport var perspective = perspectiveNO;\n/**\n * Generates a perspective projection matrix suitable for WebGPU with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [0, 1],\n * which matches WebGPU/Vulkan/DirectX/Metal's clip volume.\n * Passing null/undefined/no value for far will generate infinite projection matrix.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} fovy Vertical field of view in radians\n * @param {number} aspect Aspect ratio. typically viewport width/height\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum, can be null or Infinity\n * @returns {mat4} out\n */\n\nexport function perspectiveZO(out, fovy, aspect, near, far) {\n  var f = 1.0 / Math.tan(fovy / 2),\n      nf;\n  out[0] = f / aspect;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = f;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[15] = 0;\n\n  if (far != null && far !== Infinity) {\n    nf = 1 / (near - far);\n    out[10] = far * nf;\n    out[14] = far * near * nf;\n  } else {\n    out[10] = -1;\n    out[14] = -near;\n  }\n\n  return out;\n}\n/**\n * Generates a perspective projection matrix with the given field of view.\n * This is primarily useful for generating projection matrices to be used\n * with the still experiemental WebVR API.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {Object} fov Object containing the following values: upDegrees, downDegrees, leftDegrees, rightDegrees\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\n\nexport function perspectiveFromFieldOfView(out, fov, near, far) {\n  var upTan = Math.tan(fov.upDegrees * Math.PI / 180.0);\n  var downTan = Math.tan(fov.downDegrees * Math.PI / 180.0);\n  var leftTan = Math.tan(fov.leftDegrees * Math.PI / 180.0);\n  var rightTan = Math.tan(fov.rightDegrees * Math.PI / 180.0);\n  var xScale = 2.0 / (leftTan + rightTan);\n  var yScale = 2.0 / (upTan + downTan);\n  out[0] = xScale;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  out[3] = 0.0;\n  out[4] = 0.0;\n  out[5] = yScale;\n  out[6] = 0.0;\n  out[7] = 0.0;\n  out[8] = -((leftTan - rightTan) * xScale * 0.5);\n  out[9] = (upTan - downTan) * yScale * 0.5;\n  out[10] = far / (near - far);\n  out[11] = -1.0;\n  out[12] = 0.0;\n  out[13] = 0.0;\n  out[14] = far * near / (near - far);\n  out[15] = 0.0;\n  return out;\n}\n/**\n * Generates a orthogonal projection matrix with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [-1, 1],\n * which matches WebGL/OpenGL's clip volume.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} left Left bound of the frustum\n * @param {number} right Right bound of the frustum\n * @param {number} bottom Bottom bound of the frustum\n * @param {number} top Top bound of the frustum\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\n\nexport function orthoNO(out, left, right, bottom, top, near, far) {\n  var lr = 1 / (left - right);\n  var bt = 1 / (bottom - top);\n  var nf = 1 / (near - far);\n  out[0] = -2 * lr;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = -2 * bt;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 2 * nf;\n  out[11] = 0;\n  out[12] = (left + right) * lr;\n  out[13] = (top + bottom) * bt;\n  out[14] = (far + near) * nf;\n  out[15] = 1;\n  return out;\n}\n/**\n * Alias for {@link mat4.orthoNO}\n * @function\n */\n\nexport var ortho = orthoNO;\n/**\n * Generates a orthogonal projection matrix with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [0, 1],\n * which matches WebGPU/Vulkan/DirectX/Metal's clip volume.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} left Left bound of the frustum\n * @param {number} right Right bound of the frustum\n * @param {number} bottom Bottom bound of the frustum\n * @param {number} top Top bound of the frustum\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\n\nexport function orthoZO(out, left, right, bottom, top, near, far) {\n  var lr = 1 / (left - right);\n  var bt = 1 / (bottom - top);\n  var nf = 1 / (near - far);\n  out[0] = -2 * lr;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = -2 * bt;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = nf;\n  out[11] = 0;\n  out[12] = (left + right) * lr;\n  out[13] = (top + bottom) * bt;\n  out[14] = near * nf;\n  out[15] = 1;\n  return out;\n}\n/**\n * Generates a look-at matrix with the given eye position, focal point, and up axis.\n * If you want a matrix that actually makes an object look at another object, you should use targetTo instead.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {ReadonlyVec3} eye Position of the viewer\n * @param {ReadonlyVec3} center Point the viewer is looking at\n * @param {ReadonlyVec3} up vec3 pointing up\n * @returns {mat4} out\n */\n\nexport function lookAt(out, eye, center, up) {\n  var x0, x1, x2, y0, y1, y2, z0, z1, z2, len;\n  var eyex = eye[0];\n  var eyey = eye[1];\n  var eyez = eye[2];\n  var upx = up[0];\n  var upy = up[1];\n  var upz = up[2];\n  var centerx = center[0];\n  var centery = center[1];\n  var centerz = center[2];\n\n  if (Math.abs(eyex - centerx) < glMatrix.EPSILON && Math.abs(eyey - centery) < glMatrix.EPSILON && Math.abs(eyez - centerz) < glMatrix.EPSILON) {\n    return identity(out);\n  }\n\n  z0 = eyex - centerx;\n  z1 = eyey - centery;\n  z2 = eyez - centerz;\n  len = 1 / Math.hypot(z0, z1, z2);\n  z0 *= len;\n  z1 *= len;\n  z2 *= len;\n  x0 = upy * z2 - upz * z1;\n  x1 = upz * z0 - upx * z2;\n  x2 = upx * z1 - upy * z0;\n  len = Math.hypot(x0, x1, x2);\n\n  if (!len) {\n    x0 = 0;\n    x1 = 0;\n    x2 = 0;\n  } else {\n    len = 1 / len;\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n\n  y0 = z1 * x2 - z2 * x1;\n  y1 = z2 * x0 - z0 * x2;\n  y2 = z0 * x1 - z1 * x0;\n  len = Math.hypot(y0, y1, y2);\n\n  if (!len) {\n    y0 = 0;\n    y1 = 0;\n    y2 = 0;\n  } else {\n    len = 1 / len;\n    y0 *= len;\n    y1 *= len;\n    y2 *= len;\n  }\n\n  out[0] = x0;\n  out[1] = y0;\n  out[2] = z0;\n  out[3] = 0;\n  out[4] = x1;\n  out[5] = y1;\n  out[6] = z1;\n  out[7] = 0;\n  out[8] = x2;\n  out[9] = y2;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = -(x0 * eyex + x1 * eyey + x2 * eyez);\n  out[13] = -(y0 * eyex + y1 * eyey + y2 * eyez);\n  out[14] = -(z0 * eyex + z1 * eyey + z2 * eyez);\n  out[15] = 1;\n  return out;\n}\n/**\n * Generates a matrix that makes something look at something else.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {ReadonlyVec3} eye Position of the viewer\n * @param {ReadonlyVec3} center Point the viewer is looking at\n * @param {ReadonlyVec3} up vec3 pointing up\n * @returns {mat4} out\n */\n\nexport function targetTo(out, eye, target, up) {\n  var eyex = eye[0],\n      eyey = eye[1],\n      eyez = eye[2],\n      upx = up[0],\n      upy = up[1],\n      upz = up[2];\n  var z0 = eyex - target[0],\n      z1 = eyey - target[1],\n      z2 = eyez - target[2];\n  var len = z0 * z0 + z1 * z1 + z2 * z2;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    z0 *= len;\n    z1 *= len;\n    z2 *= len;\n  }\n\n  var x0 = upy * z2 - upz * z1,\n      x1 = upz * z0 - upx * z2,\n      x2 = upx * z1 - upy * z0;\n  len = x0 * x0 + x1 * x1 + x2 * x2;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n\n  out[0] = x0;\n  out[1] = x1;\n  out[2] = x2;\n  out[3] = 0;\n  out[4] = z1 * x2 - z2 * x1;\n  out[5] = z2 * x0 - z0 * x2;\n  out[6] = z0 * x1 - z1 * x0;\n  out[7] = 0;\n  out[8] = z0;\n  out[9] = z1;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = eyex;\n  out[13] = eyey;\n  out[14] = eyez;\n  out[15] = 1;\n  return out;\n}\n/**\n * Returns a string representation of a mat4\n *\n * @param {ReadonlyMat4} a matrix to represent as a string\n * @returns {String} string representation of the matrix\n */\n\nexport function str(a) {\n  return \"mat4(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \", \" + a[4] + \", \" + a[5] + \", \" + a[6] + \", \" + a[7] + \", \" + a[8] + \", \" + a[9] + \", \" + a[10] + \", \" + a[11] + \", \" + a[12] + \", \" + a[13] + \", \" + a[14] + \", \" + a[15] + \")\";\n}\n/**\n * Returns Frobenius norm of a mat4\n *\n * @param {ReadonlyMat4} a the matrix to calculate Frobenius norm of\n * @returns {Number} Frobenius norm\n */\n\nexport function frob(a) {\n  return Math.hypot(a[0], a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8], a[9], a[10], a[11], a[12], a[13], a[14], a[15]);\n}\n/**\n * Adds two mat4's\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @returns {mat4} out\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  out[6] = a[6] + b[6];\n  out[7] = a[7] + b[7];\n  out[8] = a[8] + b[8];\n  out[9] = a[9] + b[9];\n  out[10] = a[10] + b[10];\n  out[11] = a[11] + b[11];\n  out[12] = a[12] + b[12];\n  out[13] = a[13] + b[13];\n  out[14] = a[14] + b[14];\n  out[15] = a[15] + b[15];\n  return out;\n}\n/**\n * Subtracts matrix b from matrix a\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @returns {mat4} out\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  out[4] = a[4] - b[4];\n  out[5] = a[5] - b[5];\n  out[6] = a[6] - b[6];\n  out[7] = a[7] - b[7];\n  out[8] = a[8] - b[8];\n  out[9] = a[9] - b[9];\n  out[10] = a[10] - b[10];\n  out[11] = a[11] - b[11];\n  out[12] = a[12] - b[12];\n  out[13] = a[13] - b[13];\n  out[14] = a[14] - b[14];\n  out[15] = a[15] - b[15];\n  return out;\n}\n/**\n * Multiply each element of the matrix by a scalar.\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to scale\n * @param {Number} b amount to scale the matrix's elements by\n * @returns {mat4} out\n */\n\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  out[6] = a[6] * b;\n  out[7] = a[7] * b;\n  out[8] = a[8] * b;\n  out[9] = a[9] * b;\n  out[10] = a[10] * b;\n  out[11] = a[11] * b;\n  out[12] = a[12] * b;\n  out[13] = a[13] * b;\n  out[14] = a[14] * b;\n  out[15] = a[15] * b;\n  return out;\n}\n/**\n * Adds two mat4's after multiplying each element of the second operand by a scalar value.\n *\n * @param {mat4} out the receiving vector\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @param {Number} scale the amount to scale b's elements by before adding\n * @returns {mat4} out\n */\n\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  out[4] = a[4] + b[4] * scale;\n  out[5] = a[5] + b[5] * scale;\n  out[6] = a[6] + b[6] * scale;\n  out[7] = a[7] + b[7] * scale;\n  out[8] = a[8] + b[8] * scale;\n  out[9] = a[9] + b[9] * scale;\n  out[10] = a[10] + b[10] * scale;\n  out[11] = a[11] + b[11] * scale;\n  out[12] = a[12] + b[12] * scale;\n  out[13] = a[13] + b[13] * scale;\n  out[14] = a[14] + b[14] * scale;\n  out[15] = a[15] + b[15] * scale;\n  return out;\n}\n/**\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyMat4} a The first matrix.\n * @param {ReadonlyMat4} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7] && a[8] === b[8] && a[9] === b[9] && a[10] === b[10] && a[11] === b[11] && a[12] === b[12] && a[13] === b[13] && a[14] === b[14] && a[15] === b[15];\n}\n/**\n * Returns whether or not the matrices have approximately the same elements in the same position.\n *\n * @param {ReadonlyMat4} a The first matrix.\n * @param {ReadonlyMat4} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var a4 = a[4],\n      a5 = a[5],\n      a6 = a[6],\n      a7 = a[7];\n  var a8 = a[8],\n      a9 = a[9],\n      a10 = a[10],\n      a11 = a[11];\n  var a12 = a[12],\n      a13 = a[13],\n      a14 = a[14],\n      a15 = a[15];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  var b4 = b[4],\n      b5 = b[5],\n      b6 = b[6],\n      b7 = b[7];\n  var b8 = b[8],\n      b9 = b[9],\n      b10 = b[10],\n      b11 = b[11];\n  var b12 = b[12],\n      b13 = b[13],\n      b14 = b[14],\n      b15 = b[15];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)) && Math.abs(a8 - b8) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a8), Math.abs(b8)) && Math.abs(a9 - b9) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a9), Math.abs(b9)) && Math.abs(a10 - b10) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a10), Math.abs(b10)) && Math.abs(a11 - b11) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a11), Math.abs(b11)) && Math.abs(a12 - b12) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a12), Math.abs(b12)) && Math.abs(a13 - b13) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a13), Math.abs(b13)) && Math.abs(a14 - b14) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a14), Math.abs(b14)) && Math.abs(a15 - b15) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a15), Math.abs(b15));\n}\n/**\n * Alias for {@link mat4.multiply}\n * @function\n */\n\nexport var mul = multiply;\n/**\n * Alias for {@link mat4.subtract}\n * @function\n */\n\nexport var sub = subtract;","import * as glMatrix from \"./common.js\";\n/**\n * 4 Dimensional Vector\n * @module vec4\n */\n\n/**\n * Creates a new, empty vec4\n *\n * @returns {vec4} a new 4D vector\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(4);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n  }\n\n  return out;\n}\n/**\n * Creates a new vec4 initialized with values from an existing vector\n *\n * @param {ReadonlyVec4} a vector to clone\n * @returns {vec4} a new 4D vector\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(4);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\n * Creates a new vec4 initialized with the given values\n *\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @param {Number} w W component\n * @returns {vec4} a new 4D vector\n */\n\nexport function fromValues(x, y, z, w) {\n  var out = new glMatrix.ARRAY_TYPE(4);\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = w;\n  return out;\n}\n/**\n * Copy the values from one vec4 to another\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the source vector\n * @returns {vec4} out\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\n * Set the components of a vec4 to the given values\n *\n * @param {vec4} out the receiving vector\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @param {Number} w W component\n * @returns {vec4} out\n */\n\nexport function set(out, x, y, z, w) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = w;\n  return out;\n}\n/**\n * Adds two vec4's\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {vec4} out\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  return out;\n}\n/**\n * Subtracts vector b from vector a\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {vec4} out\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  return out;\n}\n/**\n * Multiplies two vec4's\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {vec4} out\n */\n\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  out[2] = a[2] * b[2];\n  out[3] = a[3] * b[3];\n  return out;\n}\n/**\n * Divides two vec4's\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {vec4} out\n */\n\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  out[2] = a[2] / b[2];\n  out[3] = a[3] / b[3];\n  return out;\n}\n/**\n * Math.ceil the components of a vec4\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a vector to ceil\n * @returns {vec4} out\n */\n\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  out[2] = Math.ceil(a[2]);\n  out[3] = Math.ceil(a[3]);\n  return out;\n}\n/**\n * Math.floor the components of a vec4\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a vector to floor\n * @returns {vec4} out\n */\n\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  out[2] = Math.floor(a[2]);\n  out[3] = Math.floor(a[3]);\n  return out;\n}\n/**\n * Returns the minimum of two vec4's\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {vec4} out\n */\n\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  out[2] = Math.min(a[2], b[2]);\n  out[3] = Math.min(a[3], b[3]);\n  return out;\n}\n/**\n * Returns the maximum of two vec4's\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {vec4} out\n */\n\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  out[2] = Math.max(a[2], b[2]);\n  out[3] = Math.max(a[3], b[3]);\n  return out;\n}\n/**\n * Math.round the components of a vec4\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a vector to round\n * @returns {vec4} out\n */\n\nexport function round(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  out[2] = Math.round(a[2]);\n  out[3] = Math.round(a[3]);\n  return out;\n}\n/**\n * Scales a vec4 by a scalar number\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the vector to scale\n * @param {Number} b amount to scale the vector by\n * @returns {vec4} out\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  return out;\n}\n/**\n * Adds two vec4's after scaling the second operand by a scalar value\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @param {Number} scale the amount to scale b by before adding\n * @returns {vec4} out\n */\n\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  return out;\n}\n/**\n * Calculates the euclidian distance between two vec4's\n *\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {Number} distance between a and b\n */\n\nexport function distance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  var w = b[3] - a[3];\n  return Math.hypot(x, y, z, w);\n}\n/**\n * Calculates the squared euclidian distance between two vec4's\n *\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {Number} squared distance between a and b\n */\n\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  var w = b[3] - a[3];\n  return x * x + y * y + z * z + w * w;\n}\n/**\n * Calculates the length of a vec4\n *\n * @param {ReadonlyVec4} a vector to calculate length of\n * @returns {Number} length of a\n */\n\nexport function length(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  return Math.hypot(x, y, z, w);\n}\n/**\n * Calculates the squared length of a vec4\n *\n * @param {ReadonlyVec4} a vector to calculate squared length of\n * @returns {Number} squared length of a\n */\n\nexport function squaredLength(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  return x * x + y * y + z * z + w * w;\n}\n/**\n * Negates the components of a vec4\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a vector to negate\n * @returns {vec4} out\n */\n\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  out[3] = -a[3];\n  return out;\n}\n/**\n * Returns the inverse of the components of a vec4\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a vector to invert\n * @returns {vec4} out\n */\n\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  out[2] = 1.0 / a[2];\n  out[3] = 1.0 / a[3];\n  return out;\n}\n/**\n * Normalize a vec4\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a vector to normalize\n * @returns {vec4} out\n */\n\nexport function normalize(out, a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  var len = x * x + y * y + z * z + w * w;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = x * len;\n  out[1] = y * len;\n  out[2] = z * len;\n  out[3] = w * len;\n  return out;\n}\n/**\n * Calculates the dot product of two vec4's\n *\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {Number} dot product of a and b\n */\n\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2] + a[3] * b[3];\n}\n/**\n * Returns the cross-product of three vectors in a 4-dimensional space\n *\n * @param {ReadonlyVec4} result the receiving vector\n * @param {ReadonlyVec4} U the first vector\n * @param {ReadonlyVec4} V the second vector\n * @param {ReadonlyVec4} W the third vector\n * @returns {vec4} result\n */\n\nexport function cross(out, u, v, w) {\n  var A = v[0] * w[1] - v[1] * w[0],\n      B = v[0] * w[2] - v[2] * w[0],\n      C = v[0] * w[3] - v[3] * w[0],\n      D = v[1] * w[2] - v[2] * w[1],\n      E = v[1] * w[3] - v[3] * w[1],\n      F = v[2] * w[3] - v[3] * w[2];\n  var G = u[0];\n  var H = u[1];\n  var I = u[2];\n  var J = u[3];\n  out[0] = H * F - I * E + J * D;\n  out[1] = -(G * F) + I * C - J * B;\n  out[2] = G * E - H * C + J * A;\n  out[3] = -(G * D) + H * B - I * A;\n  return out;\n}\n/**\n * Performs a linear interpolation between two vec4's\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec4} out\n */\n\nexport function lerp(out, a, b, t) {\n  var ax = a[0];\n  var ay = a[1];\n  var az = a[2];\n  var aw = a[3];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  out[2] = az + t * (b[2] - az);\n  out[3] = aw + t * (b[3] - aw);\n  return out;\n}\n/**\n * Generates a random vector with the given scale\n *\n * @param {vec4} out the receiving vector\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\n * @returns {vec4} out\n */\n\nexport function random(out, scale) {\n  scale = scale || 1.0; // Marsaglia, George. Choosing a Point from the Surface of a\n  // Sphere. Ann. Math. Statist. 43 (1972), no. 2, 645--646.\n  // http://projecteuclid.org/euclid.aoms/1177692644;\n\n  var v1, v2, v3, v4;\n  var s1, s2;\n\n  do {\n    v1 = glMatrix.RANDOM() * 2 - 1;\n    v2 = glMatrix.RANDOM() * 2 - 1;\n    s1 = v1 * v1 + v2 * v2;\n  } while (s1 >= 1);\n\n  do {\n    v3 = glMatrix.RANDOM() * 2 - 1;\n    v4 = glMatrix.RANDOM() * 2 - 1;\n    s2 = v3 * v3 + v4 * v4;\n  } while (s2 >= 1);\n\n  var d = Math.sqrt((1 - s1) / s2);\n  out[0] = scale * v1;\n  out[1] = scale * v2;\n  out[2] = scale * v3 * d;\n  out[3] = scale * v4 * d;\n  return out;\n}\n/**\n * Transforms the vec4 with a mat4.\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the vector to transform\n * @param {ReadonlyMat4} m matrix to transform with\n * @returns {vec4} out\n */\n\nexport function transformMat4(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2],\n      w = a[3];\n  out[0] = m[0] * x + m[4] * y + m[8] * z + m[12] * w;\n  out[1] = m[1] * x + m[5] * y + m[9] * z + m[13] * w;\n  out[2] = m[2] * x + m[6] * y + m[10] * z + m[14] * w;\n  out[3] = m[3] * x + m[7] * y + m[11] * z + m[15] * w;\n  return out;\n}\n/**\n * Transforms the vec4 with a quat\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the vector to transform\n * @param {ReadonlyQuat} q quaternion to transform with\n * @returns {vec4} out\n */\n\nexport function transformQuat(out, a, q) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  var qx = q[0],\n      qy = q[1],\n      qz = q[2],\n      qw = q[3]; // calculate quat * vec\n\n  var ix = qw * x + qy * z - qz * y;\n  var iy = qw * y + qz * x - qx * z;\n  var iz = qw * z + qx * y - qy * x;\n  var iw = -qx * x - qy * y - qz * z; // calculate result * inverse quat\n\n  out[0] = ix * qw + iw * -qx + iy * -qz - iz * -qy;\n  out[1] = iy * qw + iw * -qy + iz * -qx - ix * -qz;\n  out[2] = iz * qw + iw * -qz + ix * -qy - iy * -qx;\n  out[3] = a[3];\n  return out;\n}\n/**\n * Set the components of a vec4 to zero\n *\n * @param {vec4} out the receiving vector\n * @returns {vec4} out\n */\n\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  out[3] = 0.0;\n  return out;\n}\n/**\n * Returns a string representation of a vector\n *\n * @param {ReadonlyVec4} a vector to represent as a string\n * @returns {String} string representation of the vector\n */\n\nexport function str(a) {\n  return \"vec4(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \")\";\n}\n/**\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyVec4} a The first vector.\n * @param {ReadonlyVec4} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3];\n}\n/**\n * Returns whether or not the vectors have approximately the same elements in the same position.\n *\n * @param {ReadonlyVec4} a The first vector.\n * @param {ReadonlyVec4} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3));\n}\n/**\n * Alias for {@link vec4.subtract}\n * @function\n */\n\nexport var sub = subtract;\n/**\n * Alias for {@link vec4.multiply}\n * @function\n */\n\nexport var mul = multiply;\n/**\n * Alias for {@link vec4.divide}\n * @function\n */\n\nexport var div = divide;\n/**\n * Alias for {@link vec4.distance}\n * @function\n */\n\nexport var dist = distance;\n/**\n * Alias for {@link vec4.squaredDistance}\n * @function\n */\n\nexport var sqrDist = squaredDistance;\n/**\n * Alias for {@link vec4.length}\n * @function\n */\n\nexport var len = length;\n/**\n * Alias for {@link vec4.squaredLength}\n * @function\n */\n\nexport var sqrLen = squaredLength;\n/**\n * Perform some operation over an array of vec4s.\n *\n * @param {Array} a the array of vectors to iterate over\n * @param {Number} stride Number of elements between the start of each vec4. If 0 assumes tightly packed\n * @param {Number} offset Number of elements to skip at the beginning of the array\n * @param {Number} count Number of vec4s to iterate over. If 0 iterates over entire array\n * @param {Function} fn Function to call for each vector in the array\n * @param {Object} [arg] additional argument to pass to fn\n * @returns {Array} a\n * @function\n */\n\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 4;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      vec[2] = a[i + 2];\n      vec[3] = a[i + 3];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n      a[i + 2] = vec[2];\n      a[i + 3] = vec[3];\n    }\n\n    return a;\n  };\n}();","import Matrix from './base/matrix';\nimport { checkVector } from '../lib/validators';\nimport { vec2_transformMat4AsVector, vec3_transformMat4AsVector } from '../lib/gl-matrix-extras';\nimport * as mat4 from 'gl-matrix/mat4';\nimport * as vec2 from 'gl-matrix/vec2';\nimport * as vec3 from 'gl-matrix/vec3';\nimport * as vec4 from 'gl-matrix/vec4';\nvar INDICES;\n\n(function (INDICES) {\n  INDICES[INDICES[\"COL0ROW0\"] = 0] = \"COL0ROW0\";\n  INDICES[INDICES[\"COL0ROW1\"] = 1] = \"COL0ROW1\";\n  INDICES[INDICES[\"COL0ROW2\"] = 2] = \"COL0ROW2\";\n  INDICES[INDICES[\"COL0ROW3\"] = 3] = \"COL0ROW3\";\n  INDICES[INDICES[\"COL1ROW0\"] = 4] = \"COL1ROW0\";\n  INDICES[INDICES[\"COL1ROW1\"] = 5] = \"COL1ROW1\";\n  INDICES[INDICES[\"COL1ROW2\"] = 6] = \"COL1ROW2\";\n  INDICES[INDICES[\"COL1ROW3\"] = 7] = \"COL1ROW3\";\n  INDICES[INDICES[\"COL2ROW0\"] = 8] = \"COL2ROW0\";\n  INDICES[INDICES[\"COL2ROW1\"] = 9] = \"COL2ROW1\";\n  INDICES[INDICES[\"COL2ROW2\"] = 10] = \"COL2ROW2\";\n  INDICES[INDICES[\"COL2ROW3\"] = 11] = \"COL2ROW3\";\n  INDICES[INDICES[\"COL3ROW0\"] = 12] = \"COL3ROW0\";\n  INDICES[INDICES[\"COL3ROW1\"] = 13] = \"COL3ROW1\";\n  INDICES[INDICES[\"COL3ROW2\"] = 14] = \"COL3ROW2\";\n  INDICES[INDICES[\"COL3ROW3\"] = 15] = \"COL3ROW3\";\n})(INDICES || (INDICES = {}));\n\nconst DEFAULT_FOVY = 45 * Math.PI / 180;\nconst DEFAULT_ASPECT = 1;\nconst DEFAULT_NEAR = 0.1;\nconst DEFAULT_FAR = 500;\nconst IDENTITY_MATRIX = Object.freeze([1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1]);\nexport default class Matrix4 extends Matrix {\n  static get IDENTITY() {\n    return getIdentityMatrix();\n  }\n\n  static get ZERO() {\n    return getZeroMatrix();\n  }\n\n  get ELEMENTS() {\n    return 16;\n  }\n\n  get RANK() {\n    return 4;\n  }\n\n  get INDICES() {\n    return INDICES;\n  }\n\n  constructor(array) {\n    super(-0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0);\n\n    if (arguments.length === 1 && Array.isArray(array)) {\n      this.copy(array);\n    } else {\n      this.identity();\n    }\n  }\n\n  copy(array) {\n    this[0] = array[0];\n    this[1] = array[1];\n    this[2] = array[2];\n    this[3] = array[3];\n    this[4] = array[4];\n    this[5] = array[5];\n    this[6] = array[6];\n    this[7] = array[7];\n    this[8] = array[8];\n    this[9] = array[9];\n    this[10] = array[10];\n    this[11] = array[11];\n    this[12] = array[12];\n    this[13] = array[13];\n    this[14] = array[14];\n    this[15] = array[15];\n    return this.check();\n  }\n\n  set(m00, m10, m20, m30, m01, m11, m21, m31, m02, m12, m22, m32, m03, m13, m23, m33) {\n    this[0] = m00;\n    this[1] = m10;\n    this[2] = m20;\n    this[3] = m30;\n    this[4] = m01;\n    this[5] = m11;\n    this[6] = m21;\n    this[7] = m31;\n    this[8] = m02;\n    this[9] = m12;\n    this[10] = m22;\n    this[11] = m32;\n    this[12] = m03;\n    this[13] = m13;\n    this[14] = m23;\n    this[15] = m33;\n    return this.check();\n  }\n\n  setRowMajor(m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n    this[0] = m00;\n    this[1] = m10;\n    this[2] = m20;\n    this[3] = m30;\n    this[4] = m01;\n    this[5] = m11;\n    this[6] = m21;\n    this[7] = m31;\n    this[8] = m02;\n    this[9] = m12;\n    this[10] = m22;\n    this[11] = m32;\n    this[12] = m03;\n    this[13] = m13;\n    this[14] = m23;\n    this[15] = m33;\n    return this.check();\n  }\n\n  toRowMajor(result) {\n    result[0] = this[0];\n    result[1] = this[4];\n    result[2] = this[8];\n    result[3] = this[12];\n    result[4] = this[1];\n    result[5] = this[5];\n    result[6] = this[9];\n    result[7] = this[13];\n    result[8] = this[2];\n    result[9] = this[6];\n    result[10] = this[10];\n    result[11] = this[14];\n    result[12] = this[3];\n    result[13] = this[7];\n    result[14] = this[11];\n    result[15] = this[15];\n    return result;\n  }\n\n  identity() {\n    return this.copy(IDENTITY_MATRIX);\n  }\n\n  fromObject(object) {\n    return this.check();\n  }\n\n  fromQuaternion(quaternion) {\n    mat4.fromQuat(this, quaternion);\n    return this.check();\n  }\n\n  frustum(view) {\n    const {\n      left,\n      right,\n      bottom,\n      top,\n      near = DEFAULT_NEAR,\n      far = DEFAULT_FAR\n    } = view;\n\n    if (far === Infinity) {\n      computeInfinitePerspectiveOffCenter(this, left, right, bottom, top, near);\n    } else {\n      mat4.frustum(this, left, right, bottom, top, near, far);\n    }\n\n    return this.check();\n  }\n\n  lookAt(view) {\n    const {\n      eye,\n      center = [0, 0, 0],\n      up = [0, 1, 0]\n    } = view;\n    mat4.lookAt(this, eye, center, up);\n    return this.check();\n  }\n\n  ortho(view) {\n    const {\n      left,\n      right,\n      bottom,\n      top,\n      near = DEFAULT_NEAR,\n      far = DEFAULT_FAR\n    } = view;\n    mat4.ortho(this, left, right, bottom, top, near, far);\n    return this.check();\n  }\n\n  orthographic(view) {\n    const {\n      fovy = DEFAULT_FOVY,\n      aspect = DEFAULT_ASPECT,\n      focalDistance = 1,\n      near = DEFAULT_NEAR,\n      far = DEFAULT_FAR\n    } = view;\n    checkRadians(fovy);\n    const halfY = fovy / 2;\n    const top = focalDistance * Math.tan(halfY);\n    const right = top * aspect;\n    return this.ortho({\n      left: -right,\n      right,\n      bottom: -top,\n      top,\n      near,\n      far\n    });\n  }\n\n  perspective(view) {\n    const {\n      fovy = 45 * Math.PI / 180,\n      aspect = 1,\n      near = 0.1,\n      far = 500\n    } = view;\n    checkRadians(fovy);\n    mat4.perspective(this, fovy, aspect, near, far);\n    return this.check();\n  }\n\n  determinant() {\n    return mat4.determinant(this);\n  }\n\n  getScale(result = [-0, -0, -0]) {\n    result[0] = Math.sqrt(this[0] * this[0] + this[1] * this[1] + this[2] * this[2]);\n    result[1] = Math.sqrt(this[4] * this[4] + this[5] * this[5] + this[6] * this[6]);\n    result[2] = Math.sqrt(this[8] * this[8] + this[9] * this[9] + this[10] * this[10]);\n    return result;\n  }\n\n  getTranslation(result = [-0, -0, -0]) {\n    result[0] = this[12];\n    result[1] = this[13];\n    result[2] = this[14];\n    return result;\n  }\n\n  getRotation(result, scaleResult) {\n    result = result || [-0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0];\n    scaleResult = scaleResult || [-0, -0, -0];\n    const scale = this.getScale(scaleResult);\n    const inverseScale0 = 1 / scale[0];\n    const inverseScale1 = 1 / scale[1];\n    const inverseScale2 = 1 / scale[2];\n    result[0] = this[0] * inverseScale0;\n    result[1] = this[1] * inverseScale1;\n    result[2] = this[2] * inverseScale2;\n    result[3] = 0;\n    result[4] = this[4] * inverseScale0;\n    result[5] = this[5] * inverseScale1;\n    result[6] = this[6] * inverseScale2;\n    result[7] = 0;\n    result[8] = this[8] * inverseScale0;\n    result[9] = this[9] * inverseScale1;\n    result[10] = this[10] * inverseScale2;\n    result[11] = 0;\n    result[12] = 0;\n    result[13] = 0;\n    result[14] = 0;\n    result[15] = 1;\n    return result;\n  }\n\n  getRotationMatrix3(result, scaleResult) {\n    result = result || [-0, -0, -0, -0, -0, -0, -0, -0, -0];\n    scaleResult = scaleResult || [-0, -0, -0];\n    const scale = this.getScale(scaleResult);\n    const inverseScale0 = 1 / scale[0];\n    const inverseScale1 = 1 / scale[1];\n    const inverseScale2 = 1 / scale[2];\n    result[0] = this[0] * inverseScale0;\n    result[1] = this[1] * inverseScale1;\n    result[2] = this[2] * inverseScale2;\n    result[3] = this[4] * inverseScale0;\n    result[4] = this[5] * inverseScale1;\n    result[5] = this[6] * inverseScale2;\n    result[6] = this[8] * inverseScale0;\n    result[7] = this[9] * inverseScale1;\n    result[8] = this[10] * inverseScale2;\n    return result;\n  }\n\n  transpose() {\n    mat4.transpose(this, this);\n    return this.check();\n  }\n\n  invert() {\n    mat4.invert(this, this);\n    return this.check();\n  }\n\n  multiplyLeft(a) {\n    mat4.multiply(this, a, this);\n    return this.check();\n  }\n\n  multiplyRight(a) {\n    mat4.multiply(this, this, a);\n    return this.check();\n  }\n\n  rotateX(radians) {\n    mat4.rotateX(this, this, radians);\n    return this.check();\n  }\n\n  rotateY(radians) {\n    mat4.rotateY(this, this, radians);\n    return this.check();\n  }\n\n  rotateZ(radians) {\n    mat4.rotateZ(this, this, radians);\n    return this.check();\n  }\n\n  rotateXYZ(angleXYZ) {\n    return this.rotateX(angleXYZ[0]).rotateY(angleXYZ[1]).rotateZ(angleXYZ[2]);\n  }\n\n  rotateAxis(radians, axis) {\n    mat4.rotate(this, this, radians, axis);\n    return this.check();\n  }\n\n  scale(factor) {\n    mat4.scale(this, this, Array.isArray(factor) ? factor : [factor, factor, factor]);\n    return this.check();\n  }\n\n  translate(vector) {\n    mat4.translate(this, this, vector);\n    return this.check();\n  }\n\n  transform(vector, result) {\n    if (vector.length === 4) {\n      result = vec4.transformMat4(result || [-0, -0, -0, -0], vector, this);\n      checkVector(result, 4);\n      return result;\n    }\n\n    return this.transformAsPoint(vector, result);\n  }\n\n  transformAsPoint(vector, result) {\n    const {\n      length\n    } = vector;\n    let out;\n\n    switch (length) {\n      case 2:\n        out = vec2.transformMat4(result || [-0, -0], vector, this);\n        break;\n\n      case 3:\n        out = vec3.transformMat4(result || [-0, -0, -0], vector, this);\n        break;\n\n      default:\n        throw new Error('Illegal vector');\n    }\n\n    checkVector(out, vector.length);\n    return out;\n  }\n\n  transformAsVector(vector, result) {\n    let out;\n\n    switch (vector.length) {\n      case 2:\n        out = vec2_transformMat4AsVector(result || [-0, -0], vector, this);\n        break;\n\n      case 3:\n        out = vec3_transformMat4AsVector(result || [-0, -0, -0], vector, this);\n        break;\n\n      default:\n        throw new Error('Illegal vector');\n    }\n\n    checkVector(out, vector.length);\n    return out;\n  }\n\n  transformPoint(vector, result) {\n    return this.transformAsPoint(vector, result);\n  }\n\n  transformVector(vector, result) {\n    return this.transformAsPoint(vector, result);\n  }\n\n  transformDirection(vector, result) {\n    return this.transformAsVector(vector, result);\n  }\n\n  makeRotationX(radians) {\n    return this.identity().rotateX(radians);\n  }\n\n  makeTranslation(x, y, z) {\n    return this.identity().translate([x, y, z]);\n  }\n\n}\nlet ZERO;\nlet IDENTITY;\n\nfunction getZeroMatrix() {\n  if (!ZERO) {\n    ZERO = new Matrix4([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]);\n    Object.freeze(ZERO);\n  }\n\n  return ZERO;\n}\n\nfunction getIdentityMatrix() {\n  if (!IDENTITY) {\n    IDENTITY = new Matrix4();\n    Object.freeze(IDENTITY);\n  }\n\n  return IDENTITY;\n}\n\nfunction checkRadians(possiblyDegrees) {\n  if (possiblyDegrees > Math.PI * 2) {\n    throw Error('expected radians');\n  }\n}\n\nfunction computeInfinitePerspectiveOffCenter(result, left, right, bottom, top, near) {\n  const column0Row0 = 2 * near / (right - left);\n  const column1Row1 = 2 * near / (top - bottom);\n  const column2Row0 = (right + left) / (right - left);\n  const column2Row1 = (top + bottom) / (top - bottom);\n  const column2Row2 = -1;\n  const column2Row3 = -1;\n  const column3Row2 = -2 * near;\n  result[0] = column0Row0;\n  result[1] = 0;\n  result[2] = 0;\n  result[3] = 0;\n  result[4] = 0;\n  result[5] = column1Row1;\n  result[6] = 0;\n  result[7] = 0;\n  result[8] = column2Row0;\n  result[9] = column2Row1;\n  result[10] = column2Row2;\n  result[11] = column2Row3;\n  result[12] = 0;\n  result[13] = 0;\n  result[14] = column3Row2;\n  result[15] = 0;\n  return result;\n}\n//# sourceMappingURL=matrix4.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport Vector3 from './vector3';\nimport { formatValue, equals, config } from '../lib/common';\nimport { degrees, radians, clamp } from '../lib/common';\nimport * as vec3 from 'gl-matrix/vec3';\nconst EPSILON = 0.000001;\nconst EARTH_RADIUS_METERS = 6371000;\nexport default class SphericalCoordinates {\n  constructor({\n    phi = 0,\n    theta = 0,\n    radius = 1,\n    bearing,\n    pitch,\n    altitude,\n    radiusScale = EARTH_RADIUS_METERS\n  } = {}) {\n    _defineProperty(this, \"phi\", void 0);\n\n    _defineProperty(this, \"theta\", void 0);\n\n    _defineProperty(this, \"radius\", void 0);\n\n    _defineProperty(this, \"radiusScale\", void 0);\n\n    this.phi = phi;\n    this.theta = theta;\n    this.radius = radius || altitude || 1;\n    this.radiusScale = radiusScale || 1;\n\n    if (bearing !== undefined) {\n      this.bearing = bearing;\n    }\n\n    if (pitch !== undefined) {\n      this.pitch = pitch;\n    }\n\n    this.check();\n  }\n\n  toString() {\n    return this.formatString(config);\n  }\n\n  formatString({\n    printTypes = false\n  }) {\n    const f = formatValue;\n    return \"\".concat(printTypes ? 'Spherical' : '', \"[rho:\").concat(f(this.radius), \",theta:\").concat(f(this.theta), \",phi:\").concat(f(this.phi), \"]\");\n  }\n\n  equals(other) {\n    return equals(this.radius, other.radius) && equals(this.theta, other.theta) && equals(this.phi, other.phi);\n  }\n\n  exactEquals(other) {\n    return this.radius === other.radius && this.theta === other.theta && this.phi === other.phi;\n  }\n\n  get bearing() {\n    return 180 - degrees(this.phi);\n  }\n\n  set bearing(v) {\n    this.phi = Math.PI - radians(v);\n  }\n\n  get pitch() {\n    return degrees(this.theta);\n  }\n\n  set pitch(v) {\n    this.theta = radians(v);\n  }\n\n  get longitude() {\n    return degrees(this.phi);\n  }\n\n  get latitude() {\n    return degrees(this.theta);\n  }\n\n  get lng() {\n    return degrees(this.phi);\n  }\n\n  get lat() {\n    return degrees(this.theta);\n  }\n\n  get z() {\n    return (this.radius - 1) * this.radiusScale;\n  }\n\n  set(radius, phi, theta) {\n    this.radius = radius;\n    this.phi = phi;\n    this.theta = theta;\n    return this.check();\n  }\n\n  clone() {\n    return new SphericalCoordinates().copy(this);\n  }\n\n  copy(other) {\n    this.radius = other.radius;\n    this.phi = other.phi;\n    this.theta = other.theta;\n    return this.check();\n  }\n\n  fromLngLatZ([lng, lat, z]) {\n    this.radius = 1 + z / this.radiusScale;\n    this.phi = radians(lat);\n    this.theta = radians(lng);\n    return this.check();\n  }\n\n  fromVector3(v) {\n    this.radius = vec3.length(v);\n\n    if (this.radius > 0) {\n      this.theta = Math.atan2(v[0], v[1]);\n      this.phi = Math.acos(clamp(v[2] / this.radius, -1, 1));\n    }\n\n    return this.check();\n  }\n\n  toVector3() {\n    return new Vector3(0, 0, this.radius).rotateX({\n      radians: this.theta\n    }).rotateZ({\n      radians: this.phi\n    });\n  }\n\n  makeSafe() {\n    this.phi = Math.max(EPSILON, Math.min(Math.PI - EPSILON, this.phi));\n    return this;\n  }\n\n  check() {\n    if (!Number.isFinite(this.phi) || !Number.isFinite(this.theta) || !(this.radius > 0)) {\n      throw new Error('SphericalCoordinates: some fields set to invalid numbers');\n    }\n\n    return this;\n  }\n\n}\n//# sourceMappingURL=spherical-coordinates.js.map","const DEFAULT_HIGHLIGHT_COLOR = new Uint8Array([0, 255, 255, 255]);\nconst DEFAULT_MODULE_OPTIONS = {\n  pickingSelectedColor: null,\n  pickingHighlightColor: DEFAULT_HIGHLIGHT_COLOR,\n  pickingActive: false,\n  pickingAttribute: false\n};\n\nfunction getUniforms() {\n  let opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : DEFAULT_MODULE_OPTIONS;\n  const uniforms = {};\n\n  if (opts.pickingSelectedColor !== undefined) {\n    if (!opts.pickingSelectedColor) {\n      uniforms.picking_uSelectedColorValid = 0;\n    } else {\n      const selectedColor = opts.pickingSelectedColor.slice(0, 3);\n      uniforms.picking_uSelectedColorValid = 1;\n      uniforms.picking_uSelectedColor = selectedColor;\n    }\n  }\n\n  if (opts.pickingHighlightColor) {\n    const color = Array.from(opts.pickingHighlightColor, x => x / 255);\n\n    if (!Number.isFinite(color[3])) {\n      color[3] = 1;\n    }\n\n    uniforms.picking_uHighlightColor = color;\n  }\n\n  if (opts.pickingActive !== undefined) {\n    uniforms.picking_uActive = Boolean(opts.pickingActive);\n    uniforms.picking_uAttribute = Boolean(opts.pickingAttribute);\n  }\n\n  return uniforms;\n}\n\nconst vs = \"uniform bool picking_uActive;\\nuniform bool picking_uAttribute;\\nuniform vec3 picking_uSelectedColor;\\nuniform bool picking_uSelectedColorValid;\\n\\nout vec4 picking_vRGBcolor_Avalid;\\n\\nconst float COLOR_SCALE = 1. / 255.;\\n\\nbool picking_isColorValid(vec3 color) {\\n  return dot(color, vec3(1.0)) > 0.001;\\n}\\n\\nbool isVertexPicked(vec3 vertexColor) {\\n  return\\n    picking_uSelectedColorValid &&\\n    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));\\n}\\n\\nvoid picking_setPickingColor(vec3 pickingColor) {\\n  if (picking_uActive) {\\n    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));\\n\\n    if (!picking_uAttribute) {\\n      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;\\n    }\\n  } else {\\n    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));\\n  }\\n}\\n\\nvoid picking_setPickingAttribute(float value) {\\n  if (picking_uAttribute) {\\n    picking_vRGBcolor_Avalid.r = value;\\n  }\\n}\\nvoid picking_setPickingAttribute(vec2 value) {\\n  if (picking_uAttribute) {\\n    picking_vRGBcolor_Avalid.rg = value;\\n  }\\n}\\nvoid picking_setPickingAttribute(vec3 value) {\\n  if (picking_uAttribute) {\\n    picking_vRGBcolor_Avalid.rgb = value;\\n  }\\n}\\n\";\nconst fs = \"uniform bool picking_uActive;\\nuniform vec3 picking_uSelectedColor;\\nuniform vec4 picking_uHighlightColor;\\n\\nin vec4 picking_vRGBcolor_Avalid;\\nvec4 picking_filterHighlightColor(vec4 color) {\\n  if (picking_uActive) {\\n    return color;\\n  }\\n  bool selected = bool(picking_vRGBcolor_Avalid.a);\\n\\n  if (selected) {\\n    float highLightAlpha = picking_uHighlightColor.a;\\n    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);\\n    float highLightRatio = highLightAlpha / blendedAlpha;\\n\\n    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);\\n    return vec4(blendedRGB, blendedAlpha);\\n  } else {\\n    return color;\\n  }\\n}\\nvec4 picking_filterPickingColor(vec4 color) {\\n  if (picking_uActive) {\\n    if (picking_vRGBcolor_Avalid.a == 0.0) {\\n      discard;\\n    }\\n    return picking_vRGBcolor_Avalid;\\n  }\\n  return color;\\n}\\nvec4 picking_filterColor(vec4 color) {\\n  vec4 highightColor = picking_filterHighlightColor(color);\\n  return picking_filterPickingColor(highightColor);\\n}\\n\\n\";\nexport const picking = {\n  name: 'picking',\n  vs,\n  fs,\n  getUniforms\n};\n//# sourceMappingURL=picking.js.map","const vs = \"attribute float transform_elementID;\\nvec2 transform_getPixelSizeHalf(vec2 size) {\\n  return vec2(1.) / (2. * size);\\n}\\n\\nvec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {\\n  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);\\n  float xIndex = transform_elementID - (yIndex * texSize[0]);\\n  return vec2(xIndex, yIndex);\\n}\\nvec2 transform_getTexCoord(vec2 size) {\\n  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);\\n  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);\\n  vec2 coord = indices / size + pixelSizeHalf;\\n  return coord;\\n}\\nvec2 transform_getPos(vec2 size) {\\n  vec2 texCoord = transform_getTexCoord(size);\\n  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);\\n  return pos;\\n}\\nvec4 transform_getInput(sampler2D texSampler, vec2 size) {\\n  vec2 texCoord = transform_getTexCoord(size);\\n  vec4 textureColor = texture2D(texSampler, texCoord);\\n  return textureColor;\\n}\\n\";\nexport const transform = {\n  name: 'transform',\n  vs,\n  fs: null\n};\n//# sourceMappingURL=transform.js.map","import { assembleShaders } from '@luma.gl/shadertools';\nimport { Program } from '@luma.gl/webgl';\nexport default class ProgramManager {\n  static getDefaultProgramManager(gl) {\n    gl.luma = gl.luma || {};\n    gl.luma.defaultProgramManager = gl.luma.defaultProgramManager || new ProgramManager(gl);\n    return gl.luma.defaultProgramManager;\n  }\n\n  constructor(gl) {\n    this.gl = gl;\n    this._programCache = {};\n    this._getUniforms = {};\n    this._registeredModules = {};\n    this._hookFunctions = [];\n    this._defaultModules = [];\n    this._hashes = {};\n    this._hashCounter = 0;\n    this.stateHash = 0;\n    this._useCounts = {};\n  }\n\n  addDefaultModule(module) {\n    if (!this._defaultModules.find(m => m.name === module.name)) {\n      this._defaultModules.push(module);\n    }\n\n    this.stateHash++;\n  }\n\n  removeDefaultModule(module) {\n    const moduleName = typeof module === 'string' ? module : module.name;\n    this._defaultModules = this._defaultModules.filter(m => m.name !== moduleName);\n    this.stateHash++;\n  }\n\n  addShaderHook(hook, opts) {\n    if (opts) {\n      hook = Object.assign(opts, {\n        hook\n      });\n    }\n\n    this._hookFunctions.push(hook);\n\n    this.stateHash++;\n  }\n\n  get() {\n    let props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    const {\n      vs = '',\n      fs = '',\n      defines = {},\n      inject = {},\n      varyings = [],\n      bufferMode = 0x8c8d,\n      transpileToGLSL100 = false\n    } = props;\n\n    const modules = this._getModuleList(props.modules);\n\n    const vsHash = this._getHash(vs);\n\n    const fsHash = this._getHash(fs);\n\n    const moduleHashes = modules.map(m => this._getHash(m.name)).sort();\n    const varyingHashes = varyings.map(v => this._getHash(v));\n    const defineKeys = Object.keys(defines).sort();\n    const injectKeys = Object.keys(inject).sort();\n    const defineHashes = [];\n    const injectHashes = [];\n\n    for (const key of defineKeys) {\n      defineHashes.push(this._getHash(key));\n      defineHashes.push(this._getHash(defines[key]));\n    }\n\n    for (const key of injectKeys) {\n      injectHashes.push(this._getHash(key));\n      injectHashes.push(this._getHash(inject[key]));\n    }\n\n    const hash = \"\".concat(vsHash, \"/\").concat(fsHash, \"D\").concat(defineHashes.join('/'), \"M\").concat(moduleHashes.join('/'), \"I\").concat(injectHashes.join('/'), \"V\").concat(varyingHashes.join('/'), \"H\").concat(this.stateHash, \"B\").concat(bufferMode).concat(transpileToGLSL100 ? 'T' : '');\n\n    if (!this._programCache[hash]) {\n      const assembled = assembleShaders(this.gl, {\n        vs,\n        fs,\n        modules,\n        inject,\n        defines,\n        hookFunctions: this._hookFunctions,\n        transpileToGLSL100\n      });\n      this._programCache[hash] = new Program(this.gl, {\n        hash,\n        vs: assembled.vs,\n        fs: assembled.fs,\n        varyings,\n        bufferMode\n      });\n\n      this._getUniforms[hash] = assembled.getUniforms || (x => {});\n\n      this._useCounts[hash] = 0;\n    }\n\n    this._useCounts[hash]++;\n    return this._programCache[hash];\n  }\n\n  getUniforms(program) {\n    return this._getUniforms[program.hash] || null;\n  }\n\n  release(program) {\n    const hash = program.hash;\n    this._useCounts[hash]--;\n\n    if (this._useCounts[hash] === 0) {\n      this._programCache[hash].delete();\n\n      delete this._programCache[hash];\n      delete this._getUniforms[hash];\n      delete this._useCounts[hash];\n    }\n  }\n\n  _getHash(key) {\n    if (this._hashes[key] === undefined) {\n      this._hashes[key] = this._hashCounter++;\n    }\n\n    return this._hashes[key];\n  }\n\n  _getModuleList() {\n    let appModules = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n    const modules = new Array(this._defaultModules.length + appModules.length);\n    const seen = {};\n    let count = 0;\n\n    for (let i = 0, len = this._defaultModules.length; i < len; ++i) {\n      const module = this._defaultModules[i];\n      const name = module.name;\n      modules[count++] = module;\n      seen[name] = true;\n    }\n\n    for (let i = 0, len = appModules.length; i < len; ++i) {\n      const module = appModules[i];\n      const name = module.name;\n\n      if (!seen[name]) {\n        modules[count++] = module;\n        seen[name] = true;\n      }\n    }\n\n    modules.length = count;\n    return modules;\n  }\n\n}\n//# sourceMappingURL=program-manager.js.map","import { Buffer, assert } from '@luma.gl/webgl';\nconst GLTF_TO_LUMA_ATTRIBUTE_MAP = {\n  POSITION: 'positions',\n  NORMAL: 'normals',\n  COLOR_0: 'colors',\n  TEXCOORD_0: 'texCoords',\n  TEXCOORD_1: 'texCoords1',\n  TEXCOORD_2: 'texCoords2'\n};\nexport function getBuffersFromGeometry(gl, geometry, options) {\n  const buffers = {};\n  let indices = geometry.indices;\n\n  for (const name in geometry.attributes) {\n    const attribute = geometry.attributes[name];\n    const remappedName = mapAttributeName(name, options);\n\n    if (name === 'indices') {\n      indices = attribute;\n    } else if (attribute.constant) {\n      buffers[remappedName] = attribute.value;\n    } else {\n      const typedArray = attribute.value;\n      const accessor = { ...attribute\n      };\n      delete accessor.value;\n      buffers[remappedName] = [new Buffer(gl, typedArray), accessor];\n      inferAttributeAccessor(name, accessor);\n    }\n  }\n\n  if (indices) {\n    const data = indices.value || indices;\n    assert(data instanceof Uint16Array || data instanceof Uint32Array, 'attribute array for \"indices\" must be of integer type');\n    const accessor = {\n      size: 1,\n      isIndexed: indices.isIndexed === undefined ? true : indices.isIndexed\n    };\n    buffers.indices = [new Buffer(gl, {\n      data,\n      target: 34963\n    }), accessor];\n  }\n\n  return buffers;\n}\n\nfunction mapAttributeName(name, options) {\n  const {\n    attributeMap = GLTF_TO_LUMA_ATTRIBUTE_MAP\n  } = options || {};\n  return attributeMap && attributeMap[name] || name;\n}\n\nexport function inferAttributeAccessor(attributeName, attribute) {\n  let category;\n\n  switch (attributeName) {\n    case 'texCoords':\n    case 'texCoord1':\n    case 'texCoord2':\n    case 'texCoord3':\n      category = 'uvs';\n      break;\n\n    case 'vertices':\n    case 'positions':\n    case 'normals':\n    case 'pickingColors':\n      category = 'vectors';\n      break;\n\n    default:\n  }\n\n  switch (category) {\n    case 'vectors':\n      attribute.size = attribute.size || 3;\n      break;\n\n    case 'uvs':\n      attribute.size = attribute.size || 2;\n      break;\n\n    default:\n  }\n\n  assert(Number.isFinite(attribute.size), \"attribute \".concat(attributeName, \" needs size\"));\n}\n//# sourceMappingURL=model-utils.js.map","import { isWebGL } from '@luma.gl/gltools';\nimport ProgramManager from './program-manager';\nimport { Program, VertexArray, clear, TransformFeedback, Buffer, log, isObjectEmpty, uid, assert } from '@luma.gl/webgl';\nimport { getDebugTableForUniforms, getDebugTableForVertexArray, getDebugTableForProgramConfiguration } from '@luma.gl/webgl';\nimport { getBuffersFromGeometry } from './model-utils';\nconst LOG_DRAW_PRIORITY = 2;\nconst LOG_DRAW_TIMEOUT = 10000;\nconst ERR_MODEL_PARAMS = 'Model needs drawMode and vertexCount';\n\nconst NOOP = () => {};\n\nconst DRAW_PARAMS = {};\nexport default class Model {\n  constructor(gl) {\n    let props = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    const {\n      id = uid('model')\n    } = props;\n    assert(isWebGL(gl));\n    this.id = id;\n    this.gl = gl;\n    this.id = props.id || uid('Model');\n    this.lastLogTime = 0;\n    this.animated = false;\n    this.initialize(props);\n  }\n\n  initialize(props) {\n    this.props = {};\n    this.programManager = props.programManager || ProgramManager.getDefaultProgramManager(this.gl);\n    this._programManagerState = -1;\n    this._managedProgram = false;\n    const {\n      program = null,\n      vs,\n      fs,\n      modules,\n      defines,\n      inject,\n      varyings,\n      bufferMode,\n      transpileToGLSL100\n    } = props;\n    this.programProps = {\n      program,\n      vs,\n      fs,\n      modules,\n      defines,\n      inject,\n      varyings,\n      bufferMode,\n      transpileToGLSL100\n    };\n    this.program = null;\n    this.vertexArray = null;\n    this._programDirty = true;\n    this.userData = {};\n    this.needsRedraw = true;\n    this._attributes = {};\n    this.attributes = {};\n    this.uniforms = {};\n    this.pickable = true;\n\n    this._checkProgram();\n\n    this.setUniforms(Object.assign({}, this.getModuleUniforms(props.moduleSettings)));\n    this.drawMode = props.drawMode !== undefined ? props.drawMode : 4;\n    this.vertexCount = props.vertexCount || 0;\n    this.geometryBuffers = {};\n    this.isInstanced = props.isInstanced || props.instanced || props.instanceCount > 0;\n\n    this._setModelProps(props);\n\n    this.geometry = {};\n    assert(this.drawMode !== undefined && Number.isFinite(this.vertexCount), ERR_MODEL_PARAMS);\n  }\n\n  setProps(props) {\n    this._setModelProps(props);\n  }\n\n  delete() {\n    for (const key in this._attributes) {\n      if (this._attributes[key] !== this.attributes[key]) {\n        this._attributes[key].delete();\n      }\n    }\n\n    if (this._managedProgram) {\n      this.programManager.release(this.program);\n      this._managedProgram = false;\n    }\n\n    this.vertexArray.delete();\n\n    this._deleteGeometryBuffers();\n  }\n\n  getDrawMode() {\n    return this.drawMode;\n  }\n\n  getVertexCount() {\n    return this.vertexCount;\n  }\n\n  getInstanceCount() {\n    return this.instanceCount;\n  }\n\n  getAttributes() {\n    return this.attributes;\n  }\n\n  getProgram() {\n    return this.program;\n  }\n\n  setProgram(props) {\n    const {\n      program,\n      vs,\n      fs,\n      modules,\n      defines,\n      inject,\n      varyings,\n      bufferMode,\n      transpileToGLSL100\n    } = props;\n    this.programProps = {\n      program,\n      vs,\n      fs,\n      modules,\n      defines,\n      inject,\n      varyings,\n      bufferMode,\n      transpileToGLSL100\n    };\n    this._programDirty = true;\n  }\n\n  getUniforms() {\n    return this.uniforms;\n  }\n\n  setDrawMode(drawMode) {\n    this.drawMode = drawMode;\n    return this;\n  }\n\n  setVertexCount(vertexCount) {\n    assert(Number.isFinite(vertexCount));\n    this.vertexCount = vertexCount;\n    return this;\n  }\n\n  setInstanceCount(instanceCount) {\n    assert(Number.isFinite(instanceCount));\n    this.instanceCount = instanceCount;\n    return this;\n  }\n\n  setGeometry(geometry) {\n    this.drawMode = geometry.drawMode;\n    this.vertexCount = geometry.getVertexCount();\n\n    this._deleteGeometryBuffers();\n\n    this.geometryBuffers = getBuffersFromGeometry(this.gl, geometry);\n    this.vertexArray.setAttributes(this.geometryBuffers);\n    return this;\n  }\n\n  setAttributes() {\n    let attributes = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    if (isObjectEmpty(attributes)) {\n      return this;\n    }\n\n    const normalizedAttributes = {};\n\n    for (const name in attributes) {\n      const attribute = attributes[name];\n      normalizedAttributes[name] = attribute.getValue ? attribute.getValue() : attribute;\n    }\n\n    this.vertexArray.setAttributes(normalizedAttributes);\n    return this;\n  }\n\n  setUniforms() {\n    let uniforms = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    Object.assign(this.uniforms, uniforms);\n    return this;\n  }\n\n  getModuleUniforms(opts) {\n    this._checkProgram();\n\n    const getUniforms = this.programManager.getUniforms(this.program);\n\n    if (getUniforms) {\n      return getUniforms(opts);\n    }\n\n    return {};\n  }\n\n  updateModuleSettings(opts) {\n    const uniforms = this.getModuleUniforms(opts || {});\n    return this.setUniforms(uniforms);\n  }\n\n  clear(opts) {\n    clear(this.program.gl, opts);\n    return this;\n  }\n\n  draw() {\n    let opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    this._checkProgram();\n\n    const {\n      moduleSettings = null,\n      framebuffer,\n      uniforms = {},\n      attributes = {},\n      transformFeedback = this.transformFeedback,\n      parameters = {},\n      vertexArray = this.vertexArray\n    } = opts;\n    this.setAttributes(attributes);\n    this.updateModuleSettings(moduleSettings);\n    this.setUniforms(uniforms);\n    let logPriority;\n\n    if (log.priority >= LOG_DRAW_PRIORITY) {\n      logPriority = this._logDrawCallStart(LOG_DRAW_PRIORITY);\n    }\n\n    const drawParams = this.vertexArray.getDrawParams();\n    const {\n      isIndexed = drawParams.isIndexed,\n      indexType = drawParams.indexType,\n      indexOffset = drawParams.indexOffset,\n      vertexArrayInstanced = drawParams.isInstanced\n    } = this.props;\n\n    if (vertexArrayInstanced && !this.isInstanced) {\n      log.warn('Found instanced attributes on non-instanced model', this.id)();\n    }\n\n    const {\n      isInstanced,\n      instanceCount\n    } = this;\n    const {\n      onBeforeRender = NOOP,\n      onAfterRender = NOOP\n    } = this.props;\n    onBeforeRender();\n    this.program.setUniforms(this.uniforms);\n    const didDraw = this.program.draw(Object.assign(DRAW_PARAMS, opts, {\n      logPriority,\n      uniforms: null,\n      framebuffer,\n      parameters,\n      drawMode: this.getDrawMode(),\n      vertexCount: this.getVertexCount(),\n      vertexArray,\n      transformFeedback,\n      isIndexed,\n      indexType,\n      isInstanced,\n      instanceCount,\n      offset: isIndexed ? indexOffset : 0\n    }));\n    onAfterRender();\n\n    if (log.priority >= LOG_DRAW_PRIORITY) {\n      this._logDrawCallEnd(logPriority, vertexArray, framebuffer);\n    }\n\n    return didDraw;\n  }\n\n  transform() {\n    let opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    const {\n      discard = true,\n      feedbackBuffers,\n      unbindModels = []\n    } = opts;\n    let {\n      parameters\n    } = opts;\n\n    if (feedbackBuffers) {\n      this._setFeedbackBuffers(feedbackBuffers);\n    }\n\n    if (discard) {\n      parameters = Object.assign({}, parameters, {\n        [35977]: discard\n      });\n    }\n\n    unbindModels.forEach(model => model.vertexArray.unbindBuffers());\n\n    try {\n      this.draw(Object.assign({}, opts, {\n        parameters\n      }));\n    } finally {\n      unbindModels.forEach(model => model.vertexArray.bindBuffers());\n    }\n\n    return this;\n  }\n\n  render() {\n    let uniforms = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    log.warn('Model.render() is deprecated. Use Model.setUniforms() and Model.draw()')();\n    return this.setUniforms(uniforms).draw();\n  }\n\n  _setModelProps(props) {\n    Object.assign(this.props, props);\n\n    if ('uniforms' in props) {\n      this.setUniforms(props.uniforms);\n    }\n\n    if ('pickable' in props) {\n      this.pickable = props.pickable;\n    }\n\n    if ('instanceCount' in props) {\n      this.instanceCount = props.instanceCount;\n    }\n\n    if ('geometry' in props) {\n      this.setGeometry(props.geometry);\n    }\n\n    if ('attributes' in props) {\n      this.setAttributes(props.attributes);\n    }\n\n    if ('_feedbackBuffers' in props) {\n      this._setFeedbackBuffers(props._feedbackBuffers);\n    }\n  }\n\n  _checkProgram() {\n    const needsUpdate = this._programDirty || this.programManager.stateHash !== this._programManagerState;\n\n    if (!needsUpdate) {\n      return;\n    }\n\n    let {\n      program\n    } = this.programProps;\n\n    if (program) {\n      this._managedProgram = false;\n    } else {\n      const {\n        vs,\n        fs,\n        modules,\n        inject,\n        defines,\n        varyings,\n        bufferMode,\n        transpileToGLSL100\n      } = this.programProps;\n      program = this.programManager.get({\n        vs,\n        fs,\n        modules,\n        inject,\n        defines,\n        varyings,\n        bufferMode,\n        transpileToGLSL100\n      });\n\n      if (this.program && this._managedProgram) {\n        this.programManager.release(this.program);\n      }\n\n      this._programManagerState = this.programManager.stateHash;\n      this._managedProgram = true;\n    }\n\n    assert(program instanceof Program, 'Model needs a program');\n    this._programDirty = false;\n\n    if (program === this.program) {\n      return;\n    }\n\n    this.program = program;\n\n    if (this.vertexArray) {\n      this.vertexArray.setProps({\n        program: this.program,\n        attributes: this.vertexArray.attributes\n      });\n    } else {\n      this.vertexArray = new VertexArray(this.gl, {\n        program: this.program\n      });\n    }\n\n    this.setUniforms(Object.assign({}, this.getModuleUniforms()));\n  }\n\n  _deleteGeometryBuffers() {\n    for (const name in this.geometryBuffers) {\n      const buffer = this.geometryBuffers[name][0] || this.geometryBuffers[name];\n\n      if (buffer instanceof Buffer) {\n        buffer.delete();\n      }\n    }\n  }\n\n  _setAnimationProps(animationProps) {\n    if (this.animated) {\n      assert(animationProps, 'Model.draw(): animated uniforms but no animationProps');\n    }\n  }\n\n  _setFeedbackBuffers() {\n    let feedbackBuffers = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    if (isObjectEmpty(feedbackBuffers)) {\n      return this;\n    }\n\n    const {\n      gl\n    } = this.program;\n    this.transformFeedback = this.transformFeedback || new TransformFeedback(gl, {\n      program: this.program\n    });\n    this.transformFeedback.setBuffers(feedbackBuffers);\n    return this;\n  }\n\n  _logDrawCallStart(logLevel) {\n    const logDrawTimeout = logLevel > 3 ? 0 : LOG_DRAW_TIMEOUT;\n\n    if (Date.now() - this.lastLogTime < logDrawTimeout) {\n      return undefined;\n    }\n\n    this.lastLogTime = Date.now();\n    log.group(LOG_DRAW_PRIORITY, \">>> DRAWING MODEL \".concat(this.id), {\n      collapsed: log.level <= 2\n    })();\n    return logLevel;\n  }\n\n  _logDrawCallEnd(logLevel, vertexArray, uniforms, framebuffer) {\n    if (logLevel === undefined) {\n      return;\n    }\n\n    const attributeTable = getDebugTableForVertexArray({\n      vertexArray,\n      header: \"\".concat(this.id, \" attributes\"),\n      attributes: this._attributes\n    });\n    const {\n      table: uniformTable,\n      unusedTable,\n      unusedCount\n    } = getDebugTableForUniforms({\n      header: \"\".concat(this.id, \" uniforms\"),\n      program: this.program,\n      uniforms: Object.assign({}, this.program.uniforms, uniforms)\n    });\n    const {\n      table: missingTable,\n      count: missingCount\n    } = getDebugTableForUniforms({\n      header: \"\".concat(this.id, \" uniforms\"),\n      program: this.program,\n      uniforms: Object.assign({}, this.program.uniforms, uniforms),\n      undefinedOnly: true\n    });\n\n    if (missingCount > 0) {\n      log.log('MISSING UNIFORMS', Object.keys(missingTable))();\n    }\n\n    if (unusedCount > 0) {\n      log.log('UNUSED UNIFORMS', Object.keys(unusedTable))();\n    }\n\n    const configTable = getDebugTableForProgramConfiguration(this.vertexArray.configuration);\n    log.table(logLevel, attributeTable)();\n    log.table(logLevel, uniformTable)();\n    log.table(logLevel + 1, configTable)();\n\n    if (framebuffer) {\n      framebuffer.log({\n        logLevel: LOG_DRAW_PRIORITY,\n        message: \"Rendered to \".concat(framebuffer.id)\n      });\n    }\n\n    log.groupEnd(LOG_DRAW_PRIORITY)();\n  }\n\n}\n//# sourceMappingURL=model.js.map","import { isWebGL2 } from '@luma.gl/gltools';\nimport { Buffer, TransformFeedback } from '@luma.gl/webgl';\nimport { assert } from '@luma.gl/webgl';\nexport default class BufferTransform {\n  constructor(gl) {\n    let props = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    this.gl = gl;\n    this.currentIndex = 0;\n    this.feedbackMap = {};\n    this.varyings = null;\n    this.bindings = [];\n    this.resources = {};\n\n    this._initialize(props);\n\n    Object.seal(this);\n  }\n\n  setupResources(opts) {\n    for (const binding of this.bindings) {\n      this._setupTransformFeedback(binding, opts);\n    }\n  }\n\n  updateModelProps() {\n    let props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    const {\n      varyings\n    } = this;\n\n    if (varyings.length > 0) {\n      props = Object.assign({}, props, {\n        varyings\n      });\n    }\n\n    return props;\n  }\n\n  getDrawOptions() {\n    let opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    const binding = this.bindings[this.currentIndex];\n    const {\n      sourceBuffers,\n      transformFeedback\n    } = binding;\n    const attributes = Object.assign({}, sourceBuffers, opts.attributes);\n    return {\n      attributes,\n      transformFeedback\n    };\n  }\n\n  swap() {\n    if (this.feedbackMap) {\n      this.currentIndex = this._getNextIndex();\n      return true;\n    }\n\n    return false;\n  }\n\n  update() {\n    let opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    this._setupBuffers(opts);\n  }\n\n  getBuffer(varyingName) {\n    const {\n      feedbackBuffers\n    } = this.bindings[this.currentIndex];\n    const bufferOrParams = varyingName ? feedbackBuffers[varyingName] : null;\n\n    if (!bufferOrParams) {\n      return null;\n    }\n\n    return bufferOrParams instanceof Buffer ? bufferOrParams : bufferOrParams.buffer;\n  }\n\n  getData() {\n    let options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    const {\n      varyingName\n    } = options;\n    const buffer = this.getBuffer(varyingName);\n\n    if (buffer) {\n      return buffer.getData();\n    }\n\n    return null;\n  }\n\n  delete() {\n    for (const name in this.resources) {\n      this.resources[name].delete();\n    }\n  }\n\n  _initialize() {\n    let props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    this._setupBuffers(props);\n\n    this.varyings = props.varyings || Object.keys(this.bindings[this.currentIndex].feedbackBuffers);\n\n    if (this.varyings.length > 0) {\n      assert(isWebGL2(this.gl));\n    }\n  }\n\n  _getFeedbackBuffers(props) {\n    const {\n      sourceBuffers = {}\n    } = props;\n    const feedbackBuffers = {};\n\n    if (this.bindings[this.currentIndex]) {\n      Object.assign(feedbackBuffers, this.bindings[this.currentIndex].feedbackBuffers);\n    }\n\n    if (this.feedbackMap) {\n      for (const sourceName in this.feedbackMap) {\n        const feedbackName = this.feedbackMap[sourceName];\n\n        if (sourceName in sourceBuffers) {\n          feedbackBuffers[feedbackName] = sourceName;\n        }\n      }\n    }\n\n    Object.assign(feedbackBuffers, props.feedbackBuffers);\n\n    for (const bufferName in feedbackBuffers) {\n      const bufferOrRef = feedbackBuffers[bufferName];\n\n      if (typeof bufferOrRef === 'string') {\n        const sourceBuffer = sourceBuffers[bufferOrRef];\n        const {\n          byteLength,\n          usage,\n          accessor\n        } = sourceBuffer;\n        feedbackBuffers[bufferName] = this._createNewBuffer(bufferName, {\n          byteLength,\n          usage,\n          accessor\n        });\n      }\n    }\n\n    return feedbackBuffers;\n  }\n\n  _setupBuffers() {\n    let props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    const {\n      sourceBuffers = null\n    } = props;\n    Object.assign(this.feedbackMap, props.feedbackMap);\n\n    const feedbackBuffers = this._getFeedbackBuffers(props);\n\n    this._updateBindings({\n      sourceBuffers,\n      feedbackBuffers\n    });\n  }\n\n  _setupTransformFeedback(binding, _ref) {\n    let {\n      model\n    } = _ref;\n    const {\n      program\n    } = model;\n    binding.transformFeedback = new TransformFeedback(this.gl, {\n      program,\n      buffers: binding.feedbackBuffers\n    });\n  }\n\n  _updateBindings(opts) {\n    this.bindings[this.currentIndex] = this._updateBinding(this.bindings[this.currentIndex], opts);\n\n    if (this.feedbackMap) {\n      const {\n        sourceBuffers,\n        feedbackBuffers\n      } = this._swapBuffers(this.bindings[this.currentIndex]);\n\n      const nextIndex = this._getNextIndex();\n\n      this.bindings[nextIndex] = this._updateBinding(this.bindings[nextIndex], {\n        sourceBuffers,\n        feedbackBuffers\n      });\n    }\n  }\n\n  _updateBinding(binding, opts) {\n    if (!binding) {\n      return {\n        sourceBuffers: Object.assign({}, opts.sourceBuffers),\n        feedbackBuffers: Object.assign({}, opts.feedbackBuffers)\n      };\n    }\n\n    Object.assign(binding.sourceBuffers, opts.sourceBuffers);\n    Object.assign(binding.feedbackBuffers, opts.feedbackBuffers);\n\n    if (binding.transformFeedback) {\n      binding.transformFeedback.setBuffers(binding.feedbackBuffers);\n    }\n\n    return binding;\n  }\n\n  _swapBuffers(opts) {\n    if (!this.feedbackMap) {\n      return null;\n    }\n\n    const sourceBuffers = Object.assign({}, opts.sourceBuffers);\n    const feedbackBuffers = Object.assign({}, opts.feedbackBuffers);\n\n    for (const srcName in this.feedbackMap) {\n      const dstName = this.feedbackMap[srcName];\n      sourceBuffers[srcName] = opts.feedbackBuffers[dstName];\n      feedbackBuffers[dstName] = opts.sourceBuffers[srcName];\n      assert(feedbackBuffers[dstName] instanceof Buffer);\n    }\n\n    return {\n      sourceBuffers,\n      feedbackBuffers\n    };\n  }\n\n  _createNewBuffer(name, opts) {\n    const buffer = new Buffer(this.gl, opts);\n\n    if (this.resources[name]) {\n      this.resources[name].delete();\n    }\n\n    this.resources[name] = buffer;\n    return buffer;\n  }\n\n  _getNextIndex() {\n    return (this.currentIndex + 1) % 2;\n  }\n\n}\n//# sourceMappingURL=buffer-transform.js.map","import { assert } from '@luma.gl/webgl';\nimport { combineInjects, getQualifierDetails, typeToChannelSuffix } from '@luma.gl/shadertools';\nconst SAMPLER_UNIFORM_PREFIX = 'transform_uSampler_';\nconst SIZE_UNIFORM_PREFIX = 'transform_uSize_';\nconst VS_POS_VARIABLE = 'transform_position';\nexport function updateForTextures(_ref) {\n  let {\n    vs,\n    sourceTextureMap,\n    targetTextureVarying,\n    targetTexture\n  } = _ref;\n  const texAttributeNames = Object.keys(sourceTextureMap);\n  let sourceCount = texAttributeNames.length;\n  let targetTextureType = null;\n  const samplerTextureMap = {};\n  let updatedVs = vs;\n  let finalInject = {};\n\n  if (sourceCount > 0 || targetTextureVarying) {\n    const vsLines = updatedVs.split('\\n');\n    const updateVsLines = vsLines.slice();\n    vsLines.forEach((line, index, lines) => {\n      if (sourceCount > 0) {\n        const updated = processAttributeDefinition(line, sourceTextureMap);\n\n        if (updated) {\n          const {\n            updatedLine,\n            inject\n          } = updated;\n          updateVsLines[index] = updatedLine;\n          finalInject = combineInjects([finalInject, inject]);\n          Object.assign(samplerTextureMap, updated.samplerTextureMap);\n          sourceCount--;\n        }\n      }\n\n      if (targetTextureVarying && !targetTextureType) {\n        targetTextureType = getVaryingType(line, targetTextureVarying);\n      }\n    });\n\n    if (targetTextureVarying) {\n      assert(targetTexture);\n      const sizeName = \"\".concat(SIZE_UNIFORM_PREFIX).concat(targetTextureVarying);\n      const uniformDeclaration = \"uniform vec2 \".concat(sizeName, \";\\n\");\n      const posInstructions = \"     vec2 \".concat(VS_POS_VARIABLE, \" = transform_getPos(\").concat(sizeName, \");\\n     gl_Position = vec4(\").concat(VS_POS_VARIABLE, \", 0, 1.);\\n\");\n      const inject = {\n        'vs:#decl': uniformDeclaration,\n        'vs:#main-start': posInstructions\n      };\n      finalInject = combineInjects([finalInject, inject]);\n    }\n\n    updatedVs = updateVsLines.join('\\n');\n  }\n\n  return {\n    vs: updatedVs,\n    targetTextureType,\n    inject: finalInject,\n    samplerTextureMap\n  };\n}\nexport function getSizeUniforms(_ref2) {\n  let {\n    sourceTextureMap,\n    targetTextureVarying,\n    targetTexture\n  } = _ref2;\n  const uniforms = {};\n  let width;\n  let height;\n\n  if (targetTextureVarying) {\n    ({\n      width,\n      height\n    } = targetTexture);\n    uniforms[\"\".concat(SIZE_UNIFORM_PREFIX).concat(targetTextureVarying)] = [width, height];\n  }\n\n  for (const textureName in sourceTextureMap) {\n    ({\n      width,\n      height\n    } = sourceTextureMap[textureName]);\n    uniforms[\"\".concat(SIZE_UNIFORM_PREFIX).concat(textureName)] = [width, height];\n  }\n\n  return uniforms;\n}\n\nfunction getAttributeDefinition(line) {\n  return getQualifierDetails(line, ['attribute', 'in']);\n}\n\nfunction getSamplerDeclerations(textureName) {\n  const samplerName = \"\".concat(SAMPLER_UNIFORM_PREFIX).concat(textureName);\n  const sizeName = \"\".concat(SIZE_UNIFORM_PREFIX).concat(textureName);\n  const uniformDeclerations = \"  uniform sampler2D \".concat(samplerName, \";\\n  uniform vec2 \").concat(sizeName, \";\");\n  return {\n    samplerName,\n    sizeName,\n    uniformDeclerations\n  };\n}\n\nexport function getVaryingType(line, varying) {\n  const qualaiferDetails = getQualifierDetails(line, ['varying', 'out']);\n\n  if (!qualaiferDetails) {\n    return null;\n  }\n\n  return qualaiferDetails.name === varying ? qualaiferDetails.type : null;\n}\nexport function processAttributeDefinition(line, textureMap) {\n  const samplerTextureMap = {};\n  const attributeData = getAttributeDefinition(line);\n\n  if (!attributeData) {\n    return null;\n  }\n\n  const {\n    type,\n    name\n  } = attributeData;\n\n  if (name && textureMap[name]) {\n    const updatedLine = \"// \".concat(line, \" => Replaced by Transform with a sampler\");\n    const {\n      samplerName,\n      sizeName,\n      uniformDeclerations\n    } = getSamplerDeclerations(name);\n    const channels = typeToChannelSuffix(type);\n    const sampleInstruction = \"  \".concat(type, \" \").concat(name, \" = transform_getInput(\").concat(samplerName, \", \").concat(sizeName, \").\").concat(channels, \";\\n\");\n    samplerTextureMap[samplerName] = name;\n    const inject = {\n      'vs:#decl': uniformDeclerations,\n      'vs:#main-start': sampleInstruction\n    };\n    return {\n      updatedLine,\n      inject,\n      samplerTextureMap\n    };\n  }\n\n  return null;\n}\n//# sourceMappingURL=transform-shader-utils.js.map","import { cloneTextureFrom, readPixelsToArray, getShaderVersion, Buffer, Texture2D, Framebuffer } from '@luma.gl/webgl';\nimport { _transform as transformModule, getPassthroughFS, typeToChannelCount, combineInjects } from '@luma.gl/shadertools';\nimport { updateForTextures, getSizeUniforms } from './transform-shader-utils';\nconst SRC_TEX_PARAMETER_OVERRIDES = {\n  [10241]: 9728,\n  [10240]: 9728,\n  [10242]: 33071,\n  [10243]: 33071\n};\nconst FS_OUTPUT_VARIABLE = 'transform_output';\nexport default class TextureTransform {\n  constructor(gl) {\n    let props = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    this.gl = gl;\n    this.id = this.currentIndex = 0;\n    this._swapTexture = null;\n    this.targetTextureVarying = null;\n    this.targetTextureType = null;\n    this.samplerTextureMap = null;\n    this.bindings = [];\n    this.resources = {};\n\n    this._initialize(props);\n\n    Object.seal(this);\n  }\n\n  updateModelProps() {\n    let props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    const updatedModelProps = this._processVertexShader(props);\n\n    return Object.assign({}, props, updatedModelProps);\n  }\n\n  getDrawOptions() {\n    let opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    const {\n      sourceBuffers,\n      sourceTextures,\n      framebuffer,\n      targetTexture\n    } = this.bindings[this.currentIndex];\n    const attributes = Object.assign({}, sourceBuffers, opts.attributes);\n    const uniforms = Object.assign({}, opts.uniforms);\n    const parameters = Object.assign({}, opts.parameters);\n    let discard = opts.discard;\n\n    if (this.hasSourceTextures || this.hasTargetTexture) {\n      attributes.transform_elementID = this.elementIDBuffer;\n\n      for (const sampler in this.samplerTextureMap) {\n        const textureName = this.samplerTextureMap[sampler];\n        uniforms[sampler] = sourceTextures[textureName];\n      }\n\n      this._setSourceTextureParameters();\n\n      const sizeUniforms = getSizeUniforms({\n        sourceTextureMap: sourceTextures,\n        targetTextureVarying: this.targetTextureVarying,\n        targetTexture\n      });\n      Object.assign(uniforms, sizeUniforms);\n    }\n\n    if (this.hasTargetTexture) {\n      discard = false;\n      parameters.viewport = [0, 0, framebuffer.width, framebuffer.height];\n    }\n\n    return {\n      attributes,\n      framebuffer,\n      uniforms,\n      discard,\n      parameters\n    };\n  }\n\n  swap() {\n    if (this._swapTexture) {\n      this.currentIndex = this._getNextIndex();\n      return true;\n    }\n\n    return false;\n  }\n\n  update() {\n    let opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    this._setupTextures(opts);\n  }\n\n  getTargetTexture() {\n    const {\n      targetTexture\n    } = this.bindings[this.currentIndex];\n    return targetTexture;\n  }\n\n  getData() {\n    let {\n      packed = false\n    } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    const {\n      framebuffer\n    } = this.bindings[this.currentIndex];\n    const pixels = readPixelsToArray(framebuffer);\n\n    if (!packed) {\n      return pixels;\n    }\n\n    const ArrayType = pixels.constructor;\n    const channelCount = typeToChannelCount(this.targetTextureType);\n    const packedPixels = new ArrayType(pixels.length * channelCount / 4);\n    let packCount = 0;\n\n    for (let i = 0; i < pixels.length; i += 4) {\n      for (let j = 0; j < channelCount; j++) {\n        packedPixels[packCount++] = pixels[i + j];\n      }\n    }\n\n    return packedPixels;\n  }\n\n  getFramebuffer() {\n    const currentResources = this.bindings[this.currentIndex];\n    return currentResources.framebuffer;\n  }\n\n  delete() {\n    if (this.ownTexture) {\n      this.ownTexture.delete();\n    }\n\n    if (this.elementIDBuffer) {\n      this.elementIDBuffer.delete();\n    }\n  }\n\n  _initialize() {\n    let props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    const {\n      _targetTextureVarying,\n      _swapTexture\n    } = props;\n    this._swapTexture = _swapTexture;\n    this.targetTextureVarying = _targetTextureVarying;\n    this.hasTargetTexture = _targetTextureVarying;\n\n    this._setupTextures(props);\n  }\n\n  _createTargetTexture(props) {\n    const {\n      sourceTextures,\n      textureOrReference\n    } = props;\n\n    if (textureOrReference instanceof Texture2D) {\n      return textureOrReference;\n    }\n\n    const refTexture = sourceTextures[textureOrReference];\n\n    if (!refTexture) {\n      return null;\n    }\n\n    this._targetRefTexName = textureOrReference;\n    return this._createNewTexture(refTexture);\n  }\n\n  _setupTextures() {\n    let props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    const {\n      sourceBuffers,\n      _sourceTextures = {},\n      _targetTexture\n    } = props;\n\n    const targetTexture = this._createTargetTexture({\n      sourceTextures: _sourceTextures,\n      textureOrReference: _targetTexture\n    });\n\n    this.hasSourceTextures = this.hasSourceTextures || _sourceTextures && Object.keys(_sourceTextures).length > 0;\n\n    this._updateBindings({\n      sourceBuffers,\n      sourceTextures: _sourceTextures,\n      targetTexture\n    });\n\n    if ('elementCount' in props) {\n      this._updateElementIDBuffer(props.elementCount);\n    }\n  }\n\n  _updateElementIDBuffer(elementCount) {\n    if (typeof elementCount !== 'number' || this.elementCount >= elementCount) {\n      return;\n    }\n\n    const elementIds = new Float32Array(elementCount);\n    elementIds.forEach((_, index, array) => {\n      array[index] = index;\n    });\n\n    if (!this.elementIDBuffer) {\n      this.elementIDBuffer = new Buffer(this.gl, {\n        data: elementIds,\n        accessor: {\n          size: 1\n        }\n      });\n    } else {\n      this.elementIDBuffer.setData({\n        data: elementIds\n      });\n    }\n\n    this.elementCount = elementCount;\n  }\n\n  _updateBindings(opts) {\n    this.bindings[this.currentIndex] = this._updateBinding(this.bindings[this.currentIndex], opts);\n\n    if (this._swapTexture) {\n      const {\n        sourceTextures,\n        targetTexture\n      } = this._swapTextures(this.bindings[this.currentIndex]);\n\n      const nextIndex = this._getNextIndex();\n\n      this.bindings[nextIndex] = this._updateBinding(this.bindings[nextIndex], {\n        sourceTextures,\n        targetTexture\n      });\n    }\n  }\n\n  _updateBinding(binding, opts) {\n    const {\n      sourceBuffers,\n      sourceTextures,\n      targetTexture\n    } = opts;\n\n    if (!binding) {\n      binding = {\n        sourceBuffers: {},\n        sourceTextures: {},\n        targetTexture: null\n      };\n    }\n\n    Object.assign(binding.sourceTextures, sourceTextures);\n    Object.assign(binding.sourceBuffers, sourceBuffers);\n\n    if (targetTexture) {\n      binding.targetTexture = targetTexture;\n      const {\n        width,\n        height\n      } = targetTexture;\n      const {\n        framebuffer\n      } = binding;\n\n      if (framebuffer) {\n        framebuffer.update({\n          attachments: {\n            [36064]: targetTexture\n          },\n          resizeAttachments: false\n        });\n        framebuffer.resize({\n          width,\n          height\n        });\n      } else {\n        binding.framebuffer = new Framebuffer(this.gl, {\n          id: \"transform-framebuffer\",\n          width,\n          height,\n          attachments: {\n            [36064]: targetTexture\n          }\n        });\n      }\n    }\n\n    return binding;\n  }\n\n  _setSourceTextureParameters() {\n    const index = this.currentIndex;\n    const {\n      sourceTextures\n    } = this.bindings[index];\n\n    for (const name in sourceTextures) {\n      sourceTextures[name].setParameters(SRC_TEX_PARAMETER_OVERRIDES);\n    }\n  }\n\n  _swapTextures(opts) {\n    if (!this._swapTexture) {\n      return null;\n    }\n\n    const sourceTextures = Object.assign({}, opts.sourceTextures);\n    sourceTextures[this._swapTexture] = opts.targetTexture;\n    const targetTexture = opts.sourceTextures[this._swapTexture];\n    return {\n      sourceTextures,\n      targetTexture\n    };\n  }\n\n  _createNewTexture(refTexture) {\n    const texture = cloneTextureFrom(refTexture, {\n      parameters: {\n        [10241]: 9728,\n        [10240]: 9728,\n        [10242]: 33071,\n        [10243]: 33071\n      },\n      pixelStore: {\n        [37440]: false\n      }\n    });\n\n    if (this.ownTexture) {\n      this.ownTexture.delete();\n    }\n\n    this.ownTexture = texture;\n    return texture;\n  }\n\n  _getNextIndex() {\n    return (this.currentIndex + 1) % 2;\n  }\n\n  _processVertexShader() {\n    let props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    const {\n      sourceTextures,\n      targetTexture\n    } = this.bindings[this.currentIndex];\n    const {\n      vs,\n      uniforms,\n      targetTextureType,\n      inject,\n      samplerTextureMap\n    } = updateForTextures({\n      vs: props.vs,\n      sourceTextureMap: sourceTextures,\n      targetTextureVarying: this.targetTextureVarying,\n      targetTexture\n    });\n    const combinedInject = combineInjects([props.inject || {}, inject]);\n    this.targetTextureType = targetTextureType;\n    this.samplerTextureMap = samplerTextureMap;\n    const fs = props._fs || getPassthroughFS({\n      version: getShaderVersion(vs),\n      input: this.targetTextureVarying,\n      inputType: targetTextureType,\n      output: FS_OUTPUT_VARIABLE\n    });\n    const modules = this.hasSourceTextures || this.targetTextureVarying ? [transformModule].concat(props.modules || []) : props.modules;\n    return {\n      vs,\n      fs,\n      modules,\n      uniforms,\n      inject: combinedInject\n    };\n  }\n\n}\n//# sourceMappingURL=texture-transform.js.map","import { getPassthroughFS } from '@luma.gl/shadertools';\nimport BufferTransform from './buffer-transform';\nimport TextureTransform from './texture-transform';\nimport { isWebGL2 } from '@luma.gl/gltools';\nimport { assert, isObjectEmpty, getShaderVersion } from '@luma.gl/webgl';\nimport Model from '../lib/model';\nexport default class Transform {\n  static isSupported(gl) {\n    return isWebGL2(gl);\n  }\n\n  constructor(gl) {\n    let props = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    this.gl = gl;\n    this.model = null;\n    this.elementCount = 0;\n    this.bufferTransform = null;\n    this.textureTransform = null;\n    this.elementIDBuffer = null;\n\n    this._initialize(props);\n\n    Object.seal(this);\n  }\n\n  delete() {\n    const {\n      model,\n      bufferTransform,\n      textureTransform\n    } = this;\n\n    if (model) {\n      model.delete();\n    }\n\n    if (bufferTransform) {\n      bufferTransform.delete();\n    }\n\n    if (textureTransform) {\n      textureTransform.delete();\n    }\n  }\n\n  run() {\n    let opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    const {\n      clearRenderTarget = true\n    } = opts;\n\n    const updatedOpts = this._updateDrawOptions(opts);\n\n    if (clearRenderTarget && updatedOpts.framebuffer) {\n      updatedOpts.framebuffer.clear({\n        color: true\n      });\n    }\n\n    this.model.transform(updatedOpts);\n  }\n\n  swap() {\n    let swapped = false;\n    const resourceTransforms = [this.bufferTransform, this.textureTransform].filter(Boolean);\n\n    for (const resourceTransform of resourceTransforms) {\n      swapped = swapped || resourceTransform.swap();\n    }\n\n    assert(swapped, 'Nothing to swap');\n  }\n\n  getBuffer() {\n    let varyingName = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n    return this.bufferTransform && this.bufferTransform.getBuffer(varyingName);\n  }\n\n  getData() {\n    let opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    const resourceTransforms = [this.bufferTransform, this.textureTransform].filter(Boolean);\n\n    for (const resourceTransform of resourceTransforms) {\n      const data = resourceTransform.getData(opts);\n\n      if (data) {\n        return data;\n      }\n    }\n\n    return null;\n  }\n\n  getFramebuffer() {\n    return this.textureTransform && this.textureTransform.getFramebuffer();\n  }\n\n  update() {\n    let opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    if ('elementCount' in opts) {\n      this.model.setVertexCount(opts.elementCount);\n    }\n\n    const resourceTransforms = [this.bufferTransform, this.textureTransform].filter(Boolean);\n\n    for (const resourceTransform of resourceTransforms) {\n      resourceTransform.update(opts);\n    }\n  }\n\n  _initialize() {\n    let props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    const {\n      gl\n    } = this;\n\n    this._buildResourceTransforms(gl, props);\n\n    props = this._updateModelProps(props);\n    this.model = new Model(gl, Object.assign({}, props, {\n      fs: props.fs || getPassthroughFS({\n        version: getShaderVersion(props.vs)\n      }),\n      id: props.id || 'transform-model',\n      drawMode: props.drawMode || 0,\n      vertexCount: props.elementCount\n    }));\n    this.bufferTransform && this.bufferTransform.setupResources({\n      model: this.model\n    });\n  }\n\n  _updateModelProps(props) {\n    let updatedProps = Object.assign({}, props);\n    const resourceTransforms = [this.bufferTransform, this.textureTransform].filter(Boolean);\n\n    for (const resourceTransform of resourceTransforms) {\n      updatedProps = resourceTransform.updateModelProps(updatedProps);\n    }\n\n    return updatedProps;\n  }\n\n  _buildResourceTransforms(gl, props) {\n    if (canCreateBufferTransform(props)) {\n      this.bufferTransform = new BufferTransform(gl, props);\n    }\n\n    if (canCreateTextureTransform(props)) {\n      this.textureTransform = new TextureTransform(gl, props);\n    }\n\n    assert(this.bufferTransform || this.textureTransform, 'must provide source/feedback buffers or source/target textures');\n  }\n\n  _updateDrawOptions(opts) {\n    let updatedOpts = Object.assign({}, opts);\n    const resourceTransforms = [this.bufferTransform, this.textureTransform].filter(Boolean);\n\n    for (const resourceTransform of resourceTransforms) {\n      updatedOpts = Object.assign(updatedOpts, resourceTransform.getDrawOptions(updatedOpts));\n    }\n\n    return updatedOpts;\n  }\n\n}\n\nfunction canCreateBufferTransform(props) {\n  if (!isObjectEmpty(props.feedbackBuffers) || !isObjectEmpty(props.feedbackMap) || props.varyings && props.varyings.length > 0) {\n    return true;\n  }\n\n  return false;\n}\n\nfunction canCreateTextureTransform(props) {\n  if (!isObjectEmpty(props._sourceTextures) || props._targetTexture || props._targetTextureVarying) {\n    return true;\n  }\n\n  return false;\n}\n//# sourceMappingURL=transform.js.map","let channelHandles = 1;\nlet animationHandles = 1;\nexport class Timeline {\n  constructor() {\n    this.time = 0;\n    this.channels = new Map();\n    this.animations = new Map();\n    this.playing = false;\n    this.lastEngineTime = -1;\n  }\n\n  addChannel(props) {\n    const {\n      delay = 0,\n      duration = Number.POSITIVE_INFINITY,\n      rate = 1,\n      repeat = 1\n    } = props;\n    const handle = channelHandles++;\n    const channel = {\n      time: 0,\n      delay,\n      duration,\n      rate,\n      repeat\n    };\n\n    this._setChannelTime(channel, this.time);\n\n    this.channels.set(handle, channel);\n    return handle;\n  }\n\n  removeChannel(handle) {\n    this.channels.delete(handle);\n\n    for (const [animationHandle, animation] of this.animations) {\n      if (animation.channel === handle) {\n        this.detachAnimation(animationHandle);\n      }\n    }\n  }\n\n  isFinished(handle) {\n    const channel = this.channels.get(handle);\n\n    if (channel === undefined) {\n      return false;\n    }\n\n    return this.time >= channel.delay + channel.duration * channel.repeat;\n  }\n\n  getTime(handle) {\n    if (handle === undefined) {\n      return this.time;\n    }\n\n    const channel = this.channels.get(handle);\n\n    if (channel === undefined) {\n      return -1;\n    }\n\n    return channel.time;\n  }\n\n  setTime(time) {\n    this.time = Math.max(0, time);\n    const channels = this.channels.values();\n\n    for (const channel of channels) {\n      this._setChannelTime(channel, this.time);\n    }\n\n    const animations = this.animations.values();\n\n    for (const animationData of animations) {\n      const {\n        animation,\n        channel\n      } = animationData;\n      animation.setTime(this.getTime(channel));\n    }\n  }\n\n  play() {\n    this.playing = true;\n  }\n\n  pause() {\n    this.playing = false;\n    this.lastEngineTime = -1;\n  }\n\n  reset() {\n    this.setTime(0);\n  }\n\n  attachAnimation(animation, channelHandle) {\n    const animationHandle = animationHandles++;\n    this.animations.set(animationHandle, {\n      animation,\n      channel: channelHandle\n    });\n    animation.setTime(this.getTime(channelHandle));\n    return animationHandle;\n  }\n\n  detachAnimation(handle) {\n    this.animations.delete(handle);\n  }\n\n  update(engineTime) {\n    if (this.playing) {\n      if (this.lastEngineTime === -1) {\n        this.lastEngineTime = engineTime;\n      }\n\n      this.setTime(this.time + (engineTime - this.lastEngineTime));\n      this.lastEngineTime = engineTime;\n    }\n  }\n\n  _setChannelTime(channel, time) {\n    const offsetTime = time - channel.delay;\n    const totalDuration = channel.duration * channel.repeat;\n\n    if (offsetTime >= totalDuration) {\n      channel.time = channel.duration * channel.rate;\n    } else {\n      channel.time = Math.max(0, offsetTime) % channel.duration;\n      channel.time *= channel.rate;\n    }\n  }\n\n}\n//# sourceMappingURL=timeline.js.map","const defines = '#define SMOOTH_EDGE_RADIUS 0.5';\nconst vs = \"\\n\".concat(defines, \"\\n\\nstruct VertexGeometry {\\n  vec4 position;\\n  vec3 worldPosition;\\n  vec3 worldPositionAlt;\\n  vec3 normal;\\n  vec2 uv;\\n  vec3 pickingColor;\\n} geometry = VertexGeometry(\\n  vec4(0.0, 0.0, 1.0, 0.0),\\n  vec3(0.0),\\n  vec3(0.0),\\n  vec3(0.0),\\n  vec2(0.0),\\n  vec3(0.0)\\n);\\n\");\nconst fs = \"\\n\".concat(defines, \"\\n\\nstruct FragmentGeometry {\\n  vec2 uv;\\n} geometry;\\n\\nfloat smoothedge(float edge, float x) {\\n  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);\\n}\\n\");\nexport default {\n  name: 'geometry',\n  vs,\n  fs\n};\n//# sourceMappingURL=geometry.js.map","import log from '../utils/log';\nexport const COORDINATE_SYSTEM = {\n  DEFAULT: -1,\n  LNGLAT: 1,\n  METER_OFFSETS: 2,\n  LNGLAT_OFFSETS: 3,\n  CARTESIAN: 0\n};\nObject.defineProperty(COORDINATE_SYSTEM, 'IDENTITY', {\n  get: () => {\n    log.deprecated('COORDINATE_SYSTEM.IDENTITY', 'COORDINATE_SYSTEM.CARTESIAN')();\n    return 0;\n  }\n});\nexport const PROJECTION_MODE = {\n  WEB_MERCATOR: 1,\n  GLOBE: 2,\n  WEB_MERCATOR_AUTO_OFFSET: 4,\n  IDENTITY: 0\n};\nexport const UNIT = {\n  common: 0,\n  meters: 1,\n  pixels: 2\n};\nexport const EVENTS = {\n  click: {\n    handler: 'onClick'\n  },\n  panstart: {\n    handler: 'onDragStart'\n  },\n  panmove: {\n    handler: 'onDrag'\n  },\n  panend: {\n    handler: 'onDragEnd'\n  }\n};\nexport const OPERATION = {\n  DRAW: 'draw',\n  MASK: 'mask'\n};\n//# sourceMappingURL=constants.js.map","import { COORDINATE_SYSTEM, PROJECTION_MODE, UNIT } from '../../lib/constants';\nconst COORDINATE_SYSTEM_GLSL_CONSTANTS = Object.keys(COORDINATE_SYSTEM).map(key => \"const int COORDINATE_SYSTEM_\".concat(key, \" = \").concat(COORDINATE_SYSTEM[key], \";\")).join('');\nconst PROJECTION_MODE_GLSL_CONSTANTS = Object.keys(PROJECTION_MODE).map(key => \"const int PROJECTION_MODE_\".concat(key, \" = \").concat(PROJECTION_MODE[key], \";\")).join('');\nconst UNIT_GLSL_CONSTANTS = Object.keys(UNIT).map(key => \"const int UNIT_\".concat(key.toUpperCase(), \" = \").concat(UNIT[key], \";\")).join('');\nexport default \"\".concat(COORDINATE_SYSTEM_GLSL_CONSTANTS, \"\\n\").concat(PROJECTION_MODE_GLSL_CONSTANTS, \"\\n\").concat(UNIT_GLSL_CONSTANTS, \"\\n\\nuniform int project_uCoordinateSystem;\\nuniform int project_uProjectionMode;\\nuniform float project_uScale;\\nuniform bool project_uWrapLongitude;\\nuniform vec3 project_uCommonUnitsPerMeter;\\nuniform vec3 project_uCommonUnitsPerWorldUnit;\\nuniform vec3 project_uCommonUnitsPerWorldUnit2;\\nuniform vec4 project_uCenter;\\nuniform mat4 project_uModelMatrix;\\nuniform mat4 project_uViewProjectionMatrix;\\nuniform vec2 project_uViewportSize;\\nuniform float project_uDevicePixelRatio;\\nuniform float project_uFocalDistance;\\nuniform vec3 project_uCameraPosition;\\nuniform vec3 project_uCoordinateOrigin;\\nuniform vec3 project_uCommonOrigin;\\nuniform bool project_uPseudoMeters;\\n\\nconst float TILE_SIZE = 512.0;\\nconst float PI = 3.1415926536;\\nconst float WORLD_SCALE = TILE_SIZE / (PI * 2.0);\\nconst vec3 ZERO_64_LOW = vec3(0.0);\\nconst float EARTH_RADIUS = 6370972.0; // meters\\nconst float GLOBE_RADIUS = 256.0;\\n\\n// returns an adjustment factor for uCommonUnitsPerMeter\\nfloat project_size_at_latitude(float lat) {\\n  float y = clamp(lat, -89.9, 89.9);\\n  return 1.0 / cos(radians(y));\\n}\\n\\nfloat project_size() {\\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&\\n    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&\\n    project_uPseudoMeters == false) {\\n\\n    // uCommonUnitsPerMeter in low-zoom Web Mercator is non-linear\\n    // Adjust by 1 / cos(latitude)\\n    // If geometry.position (vertex in common space) is populated, use it\\n    // Otherwise use geometry.worldPosition (anchor in world space)\\n    \\n    if (geometry.position.w == 0.0) {\\n      return project_size_at_latitude(geometry.worldPosition.y);\\n    }\\n\\n    // latitude from common y: 2.0 * (atan(exp(y / TILE_SIZE * 2.0 * PI - PI)) - PI / 4.0)\\n    // Taylor series of 1 / cos(latitude)\\n    // Max error < 0.003\\n  \\n    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;\\n    float y2 = y * y;\\n    float y4 = y2 * y2;\\n    float y6 = y4 * y2;\\n    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;\\n  }\\n  return 1.0;\\n}\\n\\nfloat project_size_at_latitude(float meters, float lat) {\\n  return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);\\n}\\n\\n//\\n// Scaling offsets - scales meters to \\\"world distance\\\"\\n// Note the scalar version of project_size is for scaling the z component only\\n//\\nfloat project_size(float meters) {\\n  return meters * project_uCommonUnitsPerMeter.z * project_size();\\n}\\n\\nvec2 project_size(vec2 meters) {\\n  return meters * project_uCommonUnitsPerMeter.xy * project_size();\\n}\\n\\nvec3 project_size(vec3 meters) {\\n  return meters * project_uCommonUnitsPerMeter * project_size();\\n}\\n\\nvec4 project_size(vec4 meters) {\\n  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);\\n}\\n\\n// Get rotation matrix that aligns the z axis with the given up vector\\n// Find 3 unit vectors ux, uy, uz that are perpendicular to each other and uz == up\\nmat3 project_get_orientation_matrix(vec3 up) {\\n  vec3 uz = normalize(up);\\n  // Tangent on XY plane\\n  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));\\n  vec3 uy = cross(uz, ux);\\n  return mat3(ux, uy, uz);\\n}\\n\\nbool project_needs_rotation(vec3 commonPosition, out mat3 transform) {\\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\\n    transform = project_get_orientation_matrix(commonPosition);\\n    return true;\\n  }\\n  return false;\\n}\\n\\n//\\n// Projecting normal - transform deltas from current coordinate system to\\n// normals in the worldspace\\n//\\nvec3 project_normal(vec3 vector) {\\n  // Apply model matrix\\n  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);\\n  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);\\n  mat3 rotation;\\n  if (project_needs_rotation(geometry.position.xyz, rotation)) {\\n    n = rotation * n;\\n  }\\n  return n;\\n}\\n\\nvec4 project_offset_(vec4 offset) {\\n  float dy = offset.y;\\n  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;\\n  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);\\n}\\n\\n//\\n// Projecting positions - non-linear projection: lnglats => unit tile [0-1, 0-1]\\n//\\nvec2 project_mercator_(vec2 lnglat) {\\n  float x = lnglat.x;\\n  if (project_uWrapLongitude) {\\n    x = mod(x + 180., 360.0) - 180.;\\n  }\\n  float y = clamp(lnglat.y, -89.9, 89.9);\\n  return vec2(\\n    radians(x) + PI,\\n    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))\\n  ) * WORLD_SCALE;\\n}\\n\\nvec3 project_globe_(vec3 lnglatz) {\\n  float lambda = radians(lnglatz.x);\\n  float phi = radians(lnglatz.y);\\n  float cosPhi = cos(phi);\\n  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;\\n\\n  return vec3(\\n    sin(lambda) * cosPhi,\\n    -cos(lambda) * cosPhi,\\n    sin(phi)\\n  ) * D;\\n}\\n\\n//\\n// Projects positions (defined by project_uCoordinateSystem) to common space (defined by project_uProjectionMode)\\n//\\nvec4 project_position(vec4 position, vec3 position64Low) {\\n  vec4 position_world = project_uModelMatrix * position;\\n\\n  // Work around for a Mac+NVIDIA bug https://github.com/visgl/deck.gl/issues/4145\\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {\\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\\n      return vec4(\\n        project_mercator_(position_world.xy),\\n        project_size_at_latitude(position_world.z, position_world.y),\\n        position_world.w\\n      );\\n    }\\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {\\n      position_world.xyz += project_uCoordinateOrigin;\\n    }\\n  }\\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\\n      return vec4(\\n        project_globe_(position_world.xyz),\\n        position_world.w\\n      );\\n    }\\n  }\\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\\n      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {\\n        // Too far from the projection center for offset mode to be accurate\\n        // Only use high parts\\n        return vec4(\\n          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,\\n          project_size(position_world.z),\\n          position_world.w\\n        );\\n      }\\n    }\\n  }\\n  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||\\n    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&\\n    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\\n     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {\\n    // Subtract high part of 64 bit value. Convert remainder to float32, preserving precision.\\n    position_world.xyz -= project_uCoordinateOrigin;\\n  }\\n\\n  // Translation is already added to the high parts\\n  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));\\n}\\n\\nvec4 project_position(vec4 position) {\\n  return project_position(position, ZERO_64_LOW);\\n}\\n\\nvec3 project_position(vec3 position, vec3 position64Low) {\\n  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);\\n  return projected_position.xyz;\\n}\\n\\nvec3 project_position(vec3 position) {\\n  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);\\n  return projected_position.xyz;\\n}\\n\\nvec2 project_position(vec2 position) {\\n  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);\\n  return projected_position.xy;\\n}\\n\\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\\n  return viewProjectionMatrix * position + center;\\n}\\n\\n//\\n// Projects from common space coordinates to clip space.\\n// Uses project_uViewProjectionMatrix\\n//\\nvec4 project_common_position_to_clipspace(vec4 position) {\\n  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);\\n}\\n\\n// Returns a clip space offset that corresponds to a given number of screen pixels\\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\\n  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;\\n  return offset * project_uFocalDistance;\\n}\\n\\nfloat project_size_to_pixel(float meters) {\\n  return project_size(meters) * project_uScale;\\n}\\nfloat project_size_to_pixel(float size, int unit) {\\n  if (unit == UNIT_METERS) return project_size_to_pixel(size);\\n  if (unit == UNIT_COMMON) return size * project_uScale;\\n  // UNIT_PIXELS\\n  return size;\\n}\\nfloat project_pixel_size(float pixels) {\\n  return pixels / project_uScale;\\n}\\nvec2 project_pixel_size(vec2 pixels) {\\n  return pixels / project_uScale;\\n}\\n\");\n//# sourceMappingURL=project.glsl.js.map","function isEqual(a, b) {\n  if (a === b) {\n    return true;\n  }\n\n  if (Array.isArray(a)) {\n    const len = a.length;\n\n    if (!b || b.length !== len) {\n      return false;\n    }\n\n    for (let i = 0; i < len; i++) {\n      if (a[i] !== b[i]) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  return false;\n}\n\nexport default function memoize(compute) {\n  let cachedArgs = {};\n  let cachedResult;\n  return args => {\n    for (const key in args) {\n      if (!isEqual(args[key], cachedArgs[key])) {\n        cachedResult = compute(args);\n        cachedArgs = args;\n        break;\n      }\n    }\n\n    return cachedResult;\n  };\n}\n//# sourceMappingURL=memoize.js.map","import * as mat4 from 'gl-matrix/mat4';\nimport * as vec4 from 'gl-matrix/vec4';\nimport { COORDINATE_SYSTEM, PROJECTION_MODE } from '../../lib/constants';\nimport memoize from '../../utils/memoize';\nconst ZERO_VECTOR = [0, 0, 0, 0];\nconst VECTOR_TO_POINT_MATRIX = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0];\nconst IDENTITY_MATRIX = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\nconst DEFAULT_PIXELS_PER_UNIT2 = [0, 0, 0];\nconst DEFAULT_COORDINATE_ORIGIN = [0, 0, 0];\nconst getMemoizedViewportUniforms = memoize(calculateViewportUniforms);\nexport function getOffsetOrigin(viewport, coordinateSystem, coordinateOrigin = DEFAULT_COORDINATE_ORIGIN) {\n  if (coordinateOrigin.length < 3) {\n    coordinateOrigin = [coordinateOrigin[0], coordinateOrigin[1], 0];\n  }\n\n  let shaderCoordinateOrigin = coordinateOrigin;\n  let geospatialOrigin;\n  let offsetMode = true;\n\n  if (coordinateSystem === COORDINATE_SYSTEM.LNGLAT_OFFSETS || coordinateSystem === COORDINATE_SYSTEM.METER_OFFSETS) {\n    geospatialOrigin = coordinateOrigin;\n  } else {\n    geospatialOrigin = viewport.isGeospatial ? [Math.fround(viewport.longitude), Math.fround(viewport.latitude), 0] : null;\n  }\n\n  switch (viewport.projectionMode) {\n    case PROJECTION_MODE.WEB_MERCATOR:\n      if (coordinateSystem === COORDINATE_SYSTEM.LNGLAT || coordinateSystem === COORDINATE_SYSTEM.CARTESIAN) {\n        geospatialOrigin = [0, 0, 0];\n        offsetMode = false;\n      }\n\n      break;\n\n    case PROJECTION_MODE.WEB_MERCATOR_AUTO_OFFSET:\n      if (coordinateSystem === COORDINATE_SYSTEM.LNGLAT) {\n        shaderCoordinateOrigin = geospatialOrigin;\n      } else if (coordinateSystem === COORDINATE_SYSTEM.CARTESIAN) {\n        shaderCoordinateOrigin = [Math.fround(viewport.center[0]), Math.fround(viewport.center[1]), 0];\n        geospatialOrigin = viewport.unprojectPosition(shaderCoordinateOrigin);\n        shaderCoordinateOrigin[0] -= coordinateOrigin[0];\n        shaderCoordinateOrigin[1] -= coordinateOrigin[1];\n        shaderCoordinateOrigin[2] -= coordinateOrigin[2];\n      }\n\n      break;\n\n    case PROJECTION_MODE.IDENTITY:\n      shaderCoordinateOrigin = viewport.position.map(Math.fround);\n      shaderCoordinateOrigin[2] = shaderCoordinateOrigin[2] || 0;\n      break;\n\n    case PROJECTION_MODE.GLOBE:\n      offsetMode = false;\n      geospatialOrigin = null;\n      break;\n\n    default:\n      offsetMode = false;\n  }\n\n  return {\n    geospatialOrigin,\n    shaderCoordinateOrigin,\n    offsetMode\n  };\n}\n\nfunction calculateMatrixAndOffset(viewport, coordinateSystem, coordinateOrigin) {\n  const {\n    viewMatrixUncentered,\n    projectionMatrix\n  } = viewport;\n  let {\n    viewMatrix,\n    viewProjectionMatrix\n  } = viewport;\n  let projectionCenter = ZERO_VECTOR;\n  let originCommon = ZERO_VECTOR;\n  let cameraPosCommon = viewport.cameraPosition;\n  const {\n    geospatialOrigin,\n    shaderCoordinateOrigin,\n    offsetMode\n  } = getOffsetOrigin(viewport, coordinateSystem, coordinateOrigin);\n\n  if (offsetMode) {\n    originCommon = viewport.projectPosition(geospatialOrigin || shaderCoordinateOrigin);\n    cameraPosCommon = [cameraPosCommon[0] - originCommon[0], cameraPosCommon[1] - originCommon[1], cameraPosCommon[2] - originCommon[2]];\n    originCommon[3] = 1;\n    projectionCenter = vec4.transformMat4([], originCommon, viewProjectionMatrix);\n    viewMatrix = viewMatrixUncentered || viewMatrix;\n    viewProjectionMatrix = mat4.multiply([], projectionMatrix, viewMatrix);\n    viewProjectionMatrix = mat4.multiply([], viewProjectionMatrix, VECTOR_TO_POINT_MATRIX);\n  }\n\n  return {\n    viewMatrix,\n    viewProjectionMatrix,\n    projectionCenter,\n    originCommon,\n    cameraPosCommon,\n    shaderCoordinateOrigin,\n    geospatialOrigin\n  };\n}\n\nexport function getUniformsFromViewport({\n  viewport,\n  devicePixelRatio = 1,\n  modelMatrix = null,\n  coordinateSystem = COORDINATE_SYSTEM.DEFAULT,\n  coordinateOrigin = DEFAULT_COORDINATE_ORIGIN,\n  autoWrapLongitude = false\n}) {\n  if (coordinateSystem === COORDINATE_SYSTEM.DEFAULT) {\n    coordinateSystem = viewport.isGeospatial ? COORDINATE_SYSTEM.LNGLAT : COORDINATE_SYSTEM.CARTESIAN;\n  }\n\n  const uniforms = getMemoizedViewportUniforms({\n    viewport,\n    devicePixelRatio,\n    coordinateSystem,\n    coordinateOrigin\n  });\n  uniforms.project_uWrapLongitude = autoWrapLongitude;\n  uniforms.project_uModelMatrix = modelMatrix || IDENTITY_MATRIX;\n  return uniforms;\n}\n\nfunction calculateViewportUniforms({\n  viewport,\n  devicePixelRatio,\n  coordinateSystem,\n  coordinateOrigin\n}) {\n  const {\n    projectionCenter,\n    viewProjectionMatrix,\n    originCommon,\n    cameraPosCommon,\n    shaderCoordinateOrigin,\n    geospatialOrigin\n  } = calculateMatrixAndOffset(viewport, coordinateSystem, coordinateOrigin);\n  const distanceScales = viewport.getDistanceScales();\n  const viewportSize = [viewport.width * devicePixelRatio, viewport.height * devicePixelRatio];\n  const focalDistance = vec4.transformMat4([], [0, 0, -viewport.focalDistance, 1], viewport.projectionMatrix)[3] || 1;\n  const uniforms = {\n    project_uCoordinateSystem: coordinateSystem,\n    project_uProjectionMode: viewport.projectionMode,\n    project_uCoordinateOrigin: shaderCoordinateOrigin,\n    project_uCommonOrigin: originCommon.slice(0, 3),\n    project_uCenter: projectionCenter,\n    project_uPseudoMeters: Boolean(viewport._pseudoMeters),\n    project_uViewportSize: viewportSize,\n    project_uDevicePixelRatio: devicePixelRatio,\n    project_uFocalDistance: focalDistance,\n    project_uCommonUnitsPerMeter: distanceScales.unitsPerMeter,\n    project_uCommonUnitsPerWorldUnit: distanceScales.unitsPerMeter,\n    project_uCommonUnitsPerWorldUnit2: DEFAULT_PIXELS_PER_UNIT2,\n    project_uScale: viewport.scale,\n    project_uWrapLongitude: false,\n    project_uViewProjectionMatrix: viewProjectionMatrix,\n    project_uModelMatrix: IDENTITY_MATRIX,\n    project_uCameraPosition: cameraPosCommon\n  };\n\n  if (geospatialOrigin) {\n    const distanceScalesAtOrigin = viewport.getDistanceScales(geospatialOrigin);\n\n    switch (coordinateSystem) {\n      case COORDINATE_SYSTEM.METER_OFFSETS:\n        uniforms.project_uCommonUnitsPerWorldUnit = distanceScalesAtOrigin.unitsPerMeter;\n        uniforms.project_uCommonUnitsPerWorldUnit2 = distanceScalesAtOrigin.unitsPerMeter2;\n        break;\n\n      case COORDINATE_SYSTEM.LNGLAT:\n      case COORDINATE_SYSTEM.LNGLAT_OFFSETS:\n        if (!viewport._pseudoMeters) {\n          uniforms.project_uCommonUnitsPerMeter = distanceScalesAtOrigin.unitsPerMeter;\n        }\n\n        uniforms.project_uCommonUnitsPerWorldUnit = distanceScalesAtOrigin.unitsPerDegree;\n        uniforms.project_uCommonUnitsPerWorldUnit2 = distanceScalesAtOrigin.unitsPerDegree2;\n        break;\n\n      case COORDINATE_SYSTEM.CARTESIAN:\n        uniforms.project_uCommonUnitsPerWorldUnit = [1, 1, distanceScalesAtOrigin.unitsPerMeter[2]];\n        uniforms.project_uCommonUnitsPerWorldUnit2 = [0, 0, distanceScalesAtOrigin.unitsPerMeter2[2]];\n        break;\n\n      default:\n        break;\n    }\n  }\n\n  return uniforms;\n}\n//# sourceMappingURL=viewport-uniforms.js.map","import { fp32 } from '@luma.gl/core';\nimport geometry from '../misc/geometry';\nimport projectShader from './project.glsl';\nimport { getUniformsFromViewport } from './viewport-uniforms';\nconst INITIAL_MODULE_OPTIONS = {};\n\nfunction getUniforms(opts = INITIAL_MODULE_OPTIONS) {\n  if ('viewport' in opts) {\n    return getUniformsFromViewport(opts);\n  }\n\n  return {};\n}\n\nexport default {\n  name: 'project',\n  dependencies: [fp32, geometry],\n  vs: projectShader,\n  getUniforms\n};\n//# sourceMappingURL=project.js.map","import { transformMat4, scale } from 'gl-matrix/vec4';\nexport function createMat4() {\n  return [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\n}\nexport function transformVector(matrix, vector) {\n  const result = transformMat4([], vector, matrix);\n  scale(result, result, 1 / result[3]);\n  return result;\n}\nexport function mod(value, divisor) {\n  const modulus = value % divisor;\n  return modulus < 0 ? divisor + modulus : modulus;\n}\nexport function lerp(start, end, step) {\n  return step * end + (1 - step) * start;\n}\nexport function clamp(x, min, max) {\n  return x < min ? min : x > max ? max : x;\n}\n\nfunction ieLog2(x) {\n  return Math.log(x) * Math.LOG2E;\n}\n\nexport const log2 = Math.log2 || ieLog2;\n//# sourceMappingURL=math-utils.js.map","export default function assert(condition, message) {\n  if (!condition) {\n    throw new Error(message || '@math.gl/web-mercator: assertion failed.');\n  }\n}\n//# sourceMappingURL=assert.js.map","import { createMat4, transformVector, clamp, log2 } from './math-utils';\nimport * as mat4 from 'gl-matrix/mat4';\nimport * as vec2 from 'gl-matrix/vec2';\nimport * as vec3 from 'gl-matrix/vec3';\nimport assert from './assert';\nconst PI = Math.PI;\nconst PI_4 = PI / 4;\nconst DEGREES_TO_RADIANS = PI / 180;\nconst RADIANS_TO_DEGREES = 180 / PI;\nconst TILE_SIZE = 512;\nconst EARTH_CIRCUMFERENCE = 40.03e6;\nexport const MAX_LATITUDE = 85.051129;\nexport const DEFAULT_ALTITUDE = 1.5;\nexport function zoomToScale(zoom) {\n  return Math.pow(2, zoom);\n}\nexport function scaleToZoom(scale) {\n  return log2(scale);\n}\nexport function lngLatToWorld(lngLat) {\n  const [lng, lat] = lngLat;\n  assert(Number.isFinite(lng));\n  assert(Number.isFinite(lat) && lat >= -90 && lat <= 90, 'invalid latitude');\n  const lambda2 = lng * DEGREES_TO_RADIANS;\n  const phi2 = lat * DEGREES_TO_RADIANS;\n  const x = TILE_SIZE * (lambda2 + PI) / (2 * PI);\n  const y = TILE_SIZE * (PI + Math.log(Math.tan(PI_4 + phi2 * 0.5))) / (2 * PI);\n  return [x, y];\n}\nexport function worldToLngLat(xy) {\n  const [x, y] = xy;\n  const lambda2 = x / TILE_SIZE * (2 * PI) - PI;\n  const phi2 = 2 * (Math.atan(Math.exp(y / TILE_SIZE * (2 * PI) - PI)) - PI_4);\n  return [lambda2 * RADIANS_TO_DEGREES, phi2 * RADIANS_TO_DEGREES];\n}\nexport function getMeterZoom(options) {\n  const {\n    latitude\n  } = options;\n  assert(Number.isFinite(latitude));\n  const latCosine = Math.cos(latitude * DEGREES_TO_RADIANS);\n  return scaleToZoom(EARTH_CIRCUMFERENCE * latCosine) - 9;\n}\nexport function unitsPerMeter(latitude) {\n  const latCosine = Math.cos(latitude * DEGREES_TO_RADIANS);\n  return TILE_SIZE / EARTH_CIRCUMFERENCE / latCosine;\n}\nexport function getDistanceScales(options) {\n  const {\n    latitude,\n    longitude,\n    highPrecision = false\n  } = options;\n  assert(Number.isFinite(latitude) && Number.isFinite(longitude));\n  const worldSize = TILE_SIZE;\n  const latCosine = Math.cos(latitude * DEGREES_TO_RADIANS);\n  const unitsPerDegreeX = worldSize / 360;\n  const unitsPerDegreeY = unitsPerDegreeX / latCosine;\n  const altUnitsPerMeter = worldSize / EARTH_CIRCUMFERENCE / latCosine;\n  const result = {\n    unitsPerMeter: [altUnitsPerMeter, altUnitsPerMeter, altUnitsPerMeter],\n    metersPerUnit: [1 / altUnitsPerMeter, 1 / altUnitsPerMeter, 1 / altUnitsPerMeter],\n    unitsPerDegree: [unitsPerDegreeX, unitsPerDegreeY, altUnitsPerMeter],\n    degreesPerUnit: [1 / unitsPerDegreeX, 1 / unitsPerDegreeY, 1 / altUnitsPerMeter]\n  };\n\n  if (highPrecision) {\n    const latCosine2 = DEGREES_TO_RADIANS * Math.tan(latitude * DEGREES_TO_RADIANS) / latCosine;\n    const unitsPerDegreeY2 = unitsPerDegreeX * latCosine2 / 2;\n    const altUnitsPerDegree2 = worldSize / EARTH_CIRCUMFERENCE * latCosine2;\n    const altUnitsPerMeter2 = altUnitsPerDegree2 / unitsPerDegreeY * altUnitsPerMeter;\n    result.unitsPerDegree2 = [0, unitsPerDegreeY2, altUnitsPerDegree2];\n    result.unitsPerMeter2 = [altUnitsPerMeter2, 0, altUnitsPerMeter2];\n  }\n\n  return result;\n}\nexport function addMetersToLngLat(lngLatZ, xyz) {\n  const [longitude, latitude, z0] = lngLatZ;\n  const [x, y, z] = xyz;\n  const {\n    unitsPerMeter,\n    unitsPerMeter2\n  } = getDistanceScales({\n    longitude,\n    latitude,\n    highPrecision: true\n  });\n  const worldspace = lngLatToWorld(lngLatZ);\n  worldspace[0] += x * (unitsPerMeter[0] + unitsPerMeter2[0] * y);\n  worldspace[1] += y * (unitsPerMeter[1] + unitsPerMeter2[1] * y);\n  const newLngLat = worldToLngLat(worldspace);\n  const newZ = (z0 || 0) + (z || 0);\n  return Number.isFinite(z0) || Number.isFinite(z) ? [newLngLat[0], newLngLat[1], newZ] : newLngLat;\n}\nexport function getViewMatrix(options) {\n  const {\n    height,\n    pitch,\n    bearing,\n    altitude,\n    scale,\n    center\n  } = options;\n  const vm = createMat4();\n  mat4.translate(vm, vm, [0, 0, -altitude]);\n  mat4.rotateX(vm, vm, -pitch * DEGREES_TO_RADIANS);\n  mat4.rotateZ(vm, vm, bearing * DEGREES_TO_RADIANS);\n  const relativeScale = scale / height;\n  mat4.scale(vm, vm, [relativeScale, relativeScale, relativeScale]);\n\n  if (center) {\n    mat4.translate(vm, vm, vec3.negate([], center));\n  }\n\n  return vm;\n}\nexport function getProjectionParameters(options) {\n  const {\n    width,\n    height,\n    altitude,\n    pitch = 0,\n    offset,\n    center,\n    scale,\n    nearZMultiplier = 1,\n    farZMultiplier = 1\n  } = options;\n  let {\n    fovy = altitudeToFovy(DEFAULT_ALTITUDE)\n  } = options;\n\n  if (altitude !== undefined) {\n    fovy = altitudeToFovy(altitude);\n  }\n\n  const fovRadians = fovy * DEGREES_TO_RADIANS;\n  const pitchRadians = pitch * DEGREES_TO_RADIANS;\n  const focalDistance = fovyToAltitude(fovy);\n  let cameraToSeaLevelDistance = focalDistance;\n\n  if (center) {\n    cameraToSeaLevelDistance += center[2] * scale / Math.cos(pitchRadians) / height;\n  }\n\n  const fovAboveCenter = fovRadians * (0.5 + (offset ? offset[1] : 0) / height);\n  const topHalfSurfaceDistance = Math.sin(fovAboveCenter) * cameraToSeaLevelDistance / Math.sin(clamp(Math.PI / 2 - pitchRadians - fovAboveCenter, 0.01, Math.PI - 0.01));\n  const furthestDistance = Math.sin(pitchRadians) * topHalfSurfaceDistance + cameraToSeaLevelDistance;\n  const horizonDistance = cameraToSeaLevelDistance * 10;\n  const farZ = Math.min(furthestDistance * farZMultiplier, horizonDistance);\n  return {\n    fov: fovRadians,\n    aspect: width / height,\n    focalDistance,\n    near: nearZMultiplier,\n    far: farZ\n  };\n}\nexport function getProjectionMatrix(options) {\n  const {\n    fov,\n    aspect,\n    near,\n    far\n  } = getProjectionParameters(options);\n  const projectionMatrix = mat4.perspective([], fov, aspect, near, far);\n  return projectionMatrix;\n}\nexport function altitudeToFovy(altitude) {\n  return 2 * Math.atan(0.5 / altitude) * RADIANS_TO_DEGREES;\n}\nexport function fovyToAltitude(fovy) {\n  return 0.5 / Math.tan(0.5 * fovy * DEGREES_TO_RADIANS);\n}\nexport function worldToPixels(xyz, pixelProjectionMatrix) {\n  const [x, y, z = 0] = xyz;\n  assert(Number.isFinite(x) && Number.isFinite(y) && Number.isFinite(z));\n  return transformVector(pixelProjectionMatrix, [x, y, z, 1]);\n}\nexport function pixelsToWorld(xyz, pixelUnprojectionMatrix, targetZ = 0) {\n  const [x, y, z] = xyz;\n  assert(Number.isFinite(x) && Number.isFinite(y), 'invalid pixel coordinate');\n\n  if (Number.isFinite(z)) {\n    const coord = transformVector(pixelUnprojectionMatrix, [x, y, z, 1]);\n    return coord;\n  }\n\n  const coord0 = transformVector(pixelUnprojectionMatrix, [x, y, 0, 1]);\n  const coord1 = transformVector(pixelUnprojectionMatrix, [x, y, 1, 1]);\n  const z0 = coord0[2];\n  const z1 = coord1[2];\n  const t = z0 === z1 ? 0 : ((targetZ || 0) - z0) / (z1 - z0);\n  return vec2.lerp([], coord0, coord1, t);\n}\n//# sourceMappingURL=web-mercator-utils.js.map","import assert from './assert';\nimport { log2, clamp } from './math-utils';\nimport { MAX_LATITUDE, lngLatToWorld, worldToLngLat } from './web-mercator-utils';\nexport default function fitBounds(options) {\n  const {\n    width,\n    height,\n    bounds,\n    minExtent = 0,\n    maxZoom = 24,\n    offset = [0, 0]\n  } = options;\n  const [[west, south], [east, north]] = bounds;\n  const padding = getPaddingObject(options.padding);\n  const nw = lngLatToWorld([west, clamp(north, -MAX_LATITUDE, MAX_LATITUDE)]);\n  const se = lngLatToWorld([east, clamp(south, -MAX_LATITUDE, MAX_LATITUDE)]);\n  const size = [Math.max(Math.abs(se[0] - nw[0]), minExtent), Math.max(Math.abs(se[1] - nw[1]), minExtent)];\n  const targetSize = [width - padding.left - padding.right - Math.abs(offset[0]) * 2, height - padding.top - padding.bottom - Math.abs(offset[1]) * 2];\n  assert(targetSize[0] > 0 && targetSize[1] > 0);\n  const scaleX = targetSize[0] / size[0];\n  const scaleY = targetSize[1] / size[1];\n  const offsetX = (padding.right - padding.left) / 2 / scaleX;\n  const offsetY = (padding.top - padding.bottom) / 2 / scaleY;\n  const center = [(se[0] + nw[0]) / 2 + offsetX, (se[1] + nw[1]) / 2 + offsetY];\n  const centerLngLat = worldToLngLat(center);\n  const zoom = Math.min(maxZoom, log2(Math.abs(Math.min(scaleX, scaleY))));\n  assert(Number.isFinite(zoom));\n  return {\n    longitude: centerLngLat[0],\n    latitude: centerLngLat[1],\n    zoom\n  };\n}\n\nfunction getPaddingObject(padding = 0) {\n  if (typeof padding === 'number') {\n    return {\n      top: padding,\n      bottom: padding,\n      left: padding,\n      right: padding\n    };\n  }\n\n  assert(Number.isFinite(padding.top) && Number.isFinite(padding.bottom) && Number.isFinite(padding.left) && Number.isFinite(padding.right));\n  return padding;\n}\n//# sourceMappingURL=fit-bounds.js.map","import { worldToLngLat } from './web-mercator-utils';\nimport * as vec2 from 'gl-matrix/vec2';\nimport { transformVector } from './math-utils';\nconst DEGREES_TO_RADIANS = Math.PI / 180;\nexport default function getBounds(viewport, z = 0) {\n  const {\n    width,\n    height,\n    unproject\n  } = viewport;\n  const unprojectOps = {\n    targetZ: z\n  };\n  const bottomLeft = unproject([0, height], unprojectOps);\n  const bottomRight = unproject([width, height], unprojectOps);\n  let topLeft;\n  let topRight;\n  const halfFov = viewport.fovy ? 0.5 * viewport.fovy * DEGREES_TO_RADIANS : Math.atan(0.5 / viewport.altitude);\n  const angleToGround = (90 - viewport.pitch) * DEGREES_TO_RADIANS;\n\n  if (halfFov > angleToGround - 0.01) {\n    topLeft = unprojectOnFarPlane(viewport, 0, z);\n    topRight = unprojectOnFarPlane(viewport, width, z);\n  } else {\n    topLeft = unproject([0, 0], unprojectOps);\n    topRight = unproject([width, 0], unprojectOps);\n  }\n\n  return [bottomLeft, bottomRight, topRight, topLeft];\n}\n\nfunction unprojectOnFarPlane(viewport, x, targetZ) {\n  const {\n    pixelUnprojectionMatrix\n  } = viewport;\n  const coord0 = transformVector(pixelUnprojectionMatrix, [x, 0, 1, 1]);\n  const coord1 = transformVector(pixelUnprojectionMatrix, [x, viewport.height, 1, 1]);\n  const z = targetZ * viewport.distanceScales.unitsPerMeter[2];\n  const t = (z - coord0[2]) / (coord1[2] - coord0[2]);\n  const coord = vec2.lerp([], coord0, coord1, t);\n  const result = worldToLngLat(coord);\n  result.push(targetZ);\n  return result;\n}\n//# sourceMappingURL=get-bounds.js.map","import { worldToLngLat } from './web-mercator-utils';\nimport { mod, log2 } from './math-utils';\nconst TILE_SIZE = 512;\nexport default function normalizeViewportProps(props) {\n  const {\n    width,\n    height,\n    pitch = 0\n  } = props;\n  let {\n    longitude,\n    latitude,\n    zoom,\n    bearing = 0\n  } = props;\n\n  if (longitude < -180 || longitude > 180) {\n    longitude = mod(longitude + 180, 360) - 180;\n  }\n\n  if (bearing < -180 || bearing > 180) {\n    bearing = mod(bearing + 180, 360) - 180;\n  }\n\n  const minZoom = log2(height / TILE_SIZE);\n\n  if (zoom <= minZoom) {\n    zoom = minZoom;\n    latitude = 0;\n  } else {\n    const halfHeightPixels = height / 2 / Math.pow(2, zoom);\n    const minLatitude = worldToLngLat([0, halfHeightPixels])[1];\n\n    if (latitude < minLatitude) {\n      latitude = minLatitude;\n    } else {\n      const maxLatitude = worldToLngLat([0, TILE_SIZE - halfHeightPixels])[1];\n\n      if (latitude > maxLatitude) {\n        latitude = maxLatitude;\n      }\n    }\n  }\n\n  return {\n    width,\n    height,\n    longitude,\n    latitude,\n    zoom,\n    pitch,\n    bearing\n  };\n}\n//# sourceMappingURL=normalize-viewport-props.js.map","import { COORDINATE_SYSTEM, PROJECTION_MODE } from '../../lib/constants';\nimport project from '../project/project';\nimport { Vector3, Matrix4 } from '@math.gl/core';\nimport memoize from '../../utils/memoize';\nimport { pixelsToWorld } from '@math.gl/web-mercator';\nconst vs = \"\\nconst int max_lights = 2;\\nuniform mat4 shadow_uViewProjectionMatrices[max_lights];\\nuniform vec4 shadow_uProjectCenters[max_lights];\\nuniform bool shadow_uDrawShadowMap;\\nuniform bool shadow_uUseShadowMap;\\nuniform int shadow_uLightId;\\nuniform float shadow_uLightCount;\\n\\nvarying vec3 shadow_vPosition[max_lights];\\n\\nvec4 shadow_setVertexPosition(vec4 position_commonspace) {\\n  if (shadow_uDrawShadowMap) {\\n    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);\\n  }\\n  if (shadow_uUseShadowMap) {\\n    for (int i = 0; i < max_lights; i++) {\\n      if(i < int(shadow_uLightCount)) {\\n        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);\\n        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;\\n      }\\n    }\\n  }\\n  return gl_Position;\\n}\\n\";\nconst fs = \"\\nconst int max_lights = 2;\\nuniform bool shadow_uDrawShadowMap;\\nuniform bool shadow_uUseShadowMap;\\nuniform sampler2D shadow_uShadowMap0;\\nuniform sampler2D shadow_uShadowMap1;\\nuniform vec4 shadow_uColor;\\nuniform float shadow_uLightCount;\\n\\nvarying vec3 shadow_vPosition[max_lights];\\n\\nconst vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);\\nconst vec4 bitUnpackShift = 1.0 / bitPackShift;\\nconst vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);\\n\\nfloat shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {\\n  vec4 rgbaDepth = texture2D(shadowMap, position.xy);\\n\\n  float z = dot(rgbaDepth, bitUnpackShift);\\n  return smoothstep(0.001, 0.01, position.z - z);\\n}\\n\\nvec4 shadow_filterShadowColor(vec4 color) {\\n  if (shadow_uDrawShadowMap) {\\n    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);\\n    rgbaDepth -= rgbaDepth.gbaa * bitMask;\\n    return rgbaDepth;\\n  }\\n  if (shadow_uUseShadowMap) {\\n    float shadowAlpha = 0.0;\\n    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);\\n    if(shadow_uLightCount > 1.0) {\\n      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);\\n    }\\n    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;\\n    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);\\n\\n    return vec4(\\n      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),\\n      blendedAlpha\\n    );\\n  }\\n  return color;\\n}\\n\";\nconst getMemoizedViewportCenterPosition = memoize(getViewportCenterPosition);\nconst getMemoizedViewProjectionMatrices = memoize(getViewProjectionMatrices);\nconst DEFAULT_SHADOW_COLOR = [0, 0, 0, 1.0];\nconst VECTOR_TO_POINT_MATRIX = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0];\n\nfunction screenToCommonSpace(xyz, pixelUnprojectionMatrix) {\n  const [x, y, z] = xyz;\n  const coord = pixelsToWorld([x, y, z], pixelUnprojectionMatrix);\n\n  if (Number.isFinite(z)) {\n    return coord;\n  }\n\n  return [coord[0], coord[1], 0];\n}\n\nfunction getViewportCenterPosition({\n  viewport,\n  center\n}) {\n  return new Matrix4(viewport.viewProjectionMatrix).invert().transform(center);\n}\n\nfunction getViewProjectionMatrices({\n  viewport,\n  shadowMatrices\n}) {\n  const projectionMatrices = [];\n  const pixelUnprojectionMatrix = viewport.pixelUnprojectionMatrix;\n  const farZ = viewport.isGeospatial ? undefined : 1;\n  const corners = [[0, 0, farZ], [viewport.width, 0, farZ], [0, viewport.height, farZ], [viewport.width, viewport.height, farZ], [0, 0, -1], [viewport.width, 0, -1], [0, viewport.height, -1], [viewport.width, viewport.height, -1]].map(pixel => screenToCommonSpace(pixel, pixelUnprojectionMatrix));\n\n  for (const shadowMatrix of shadowMatrices) {\n    const viewMatrix = shadowMatrix.clone().translate(new Vector3(viewport.center).negate());\n    const positions = corners.map(corner => viewMatrix.transform(corner));\n    const projectionMatrix = new Matrix4().ortho({\n      left: Math.min(...positions.map(position => position[0])),\n      right: Math.max(...positions.map(position => position[0])),\n      bottom: Math.min(...positions.map(position => position[1])),\n      top: Math.max(...positions.map(position => position[1])),\n      near: Math.min(...positions.map(position => -position[2])),\n      far: Math.max(...positions.map(position => -position[2]))\n    });\n    projectionMatrices.push(projectionMatrix.multiplyRight(shadowMatrix));\n  }\n\n  return projectionMatrices;\n}\n\nfunction createShadowUniforms(opts, context) {\n  const {\n    shadowEnabled = true\n  } = opts;\n\n  if (!shadowEnabled || !opts.shadowMatrices || !opts.shadowMatrices.length) {\n    return {\n      shadow_uDrawShadowMap: false,\n      shadow_uUseShadowMap: false\n    };\n  }\n\n  const uniforms = {\n    shadow_uDrawShadowMap: Boolean(opts.drawToShadowMap),\n    shadow_uUseShadowMap: opts.shadowMaps ? opts.shadowMaps.length > 0 : false,\n    shadow_uColor: opts.shadowColor || DEFAULT_SHADOW_COLOR,\n    shadow_uLightId: opts.shadowLightId || 0,\n    shadow_uLightCount: opts.shadowMatrices.length\n  };\n  const center = getMemoizedViewportCenterPosition({\n    viewport: opts.viewport,\n    center: context.project_uCenter\n  });\n  const projectCenters = [];\n  const viewProjectionMatrices = getMemoizedViewProjectionMatrices({\n    shadowMatrices: opts.shadowMatrices,\n    viewport: opts.viewport\n  }).slice();\n\n  for (let i = 0; i < opts.shadowMatrices.length; i++) {\n    const viewProjectionMatrix = viewProjectionMatrices[i];\n    const viewProjectionMatrixCentered = viewProjectionMatrix.clone().translate(new Vector3(opts.viewport.center).negate());\n\n    if (context.project_uCoordinateSystem === COORDINATE_SYSTEM.LNGLAT && context.project_uProjectionMode === PROJECTION_MODE.WEB_MERCATOR) {\n      viewProjectionMatrices[i] = viewProjectionMatrixCentered;\n      projectCenters[i] = center;\n    } else {\n      viewProjectionMatrices[i] = viewProjectionMatrix.clone().multiplyRight(VECTOR_TO_POINT_MATRIX);\n      projectCenters[i] = viewProjectionMatrixCentered.transform(center);\n    }\n  }\n\n  for (let i = 0; i < viewProjectionMatrices.length; i++) {\n    uniforms[\"shadow_uViewProjectionMatrices[\".concat(i, \"]\")] = viewProjectionMatrices[i];\n    uniforms[\"shadow_uProjectCenters[\".concat(i, \"]\")] = projectCenters[i];\n\n    if (opts.shadowMaps && opts.shadowMaps.length > 0) {\n      uniforms[\"shadow_uShadowMap\".concat(i)] = opts.shadowMaps[i];\n    } else {\n      uniforms[\"shadow_uShadowMap\".concat(i)] = opts.dummyShadowMap;\n    }\n  }\n\n  return uniforms;\n}\n\nexport default {\n  name: 'shadow',\n  dependencies: [project],\n  vs,\n  fs,\n  inject: {\n    'vs:DECKGL_FILTER_GL_POSITION': \"\\n    position = shadow_setVertexPosition(geometry.position);\\n    \",\n    'fs:DECKGL_FILTER_COLOR': \"\\n    color = shadow_filterShadowColor(color);\\n    \"\n  },\n  getUniforms: (opts = {}, context = {}) => {\n    if ('viewport' in opts && (opts.drawToShadowMap || opts.shadowMaps && opts.shadowMaps.length > 0)) {\n      return createShadowUniforms(opts, context);\n    }\n\n    return {};\n  }\n};\n//# sourceMappingURL=shadow.js.map","import { picking } from '@luma.gl/core';\nexport default {\n  inject: {\n    'vs:DECKGL_FILTER_GL_POSITION': \"\\n    // for picking depth values\\n    picking_setPickingAttribute(position.z / position.w);\\n  \",\n    'vs:DECKGL_FILTER_COLOR': \"\\n  picking_setPickingColor(geometry.pickingColor);\\n  \",\n    'fs:DECKGL_FILTER_COLOR': {\n      order: 99,\n      injection: \"\\n  // use highlight color if this fragment belongs to the selected object.\\n  color = picking_filterHighlightColor(color);\\n\\n  // use picking color if rendering to picking FBO.\\n  color = picking_filterPickingColor(color);\\n    \"\n    }\n  },\n  ...picking\n};\n//# sourceMappingURL=picking.js.map","import { ProgramManager } from '@luma.gl/core';\nimport { gouraudLighting, phongLighting } from '@luma.gl/core';\nimport project from './project/project';\nimport project32 from './project32/project32';\nimport shadow from './shadow/shadow';\nimport picking from './picking/picking';\nconst DEFAULT_MODULES = [project];\nconst SHADER_HOOKS = ['vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)', 'vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)', 'vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)', 'fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)'];\nexport function createProgramManager(gl) {\n  const programManager = ProgramManager.getDefaultProgramManager(gl);\n\n  for (const shaderModule of DEFAULT_MODULES) {\n    programManager.addDefaultModule(shaderModule);\n  }\n\n  for (const shaderHook of SHADER_HOOKS) {\n    programManager.addShaderHook(shaderHook);\n  }\n\n  return programManager;\n}\nexport { picking, project, project32, gouraudLighting, phongLighting, shadow };\n//# sourceMappingURL=index.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nconst DEFAULT_LIGHT_COLOR = [255, 255, 255];\nconst DEFAULT_LIGHT_INTENSITY = 1.0;\nlet idCount = 0;\nexport class AmbientLight {\n  constructor(props = {}) {\n    _defineProperty(this, \"id\", void 0);\n\n    _defineProperty(this, \"color\", void 0);\n\n    _defineProperty(this, \"intensity\", void 0);\n\n    _defineProperty(this, \"type\", 'ambient');\n\n    const {\n      color = DEFAULT_LIGHT_COLOR\n    } = props;\n    const {\n      intensity = DEFAULT_LIGHT_INTENSITY\n    } = props;\n    this.id = props.id || \"ambient-\".concat(idCount++);\n    this.color = color;\n    this.intensity = intensity;\n  }\n\n}\n//# sourceMappingURL=ambient-light.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { Vector3 } from '@math.gl/core';\nconst DEFAULT_LIGHT_COLOR = [255, 255, 255];\nconst DEFAULT_LIGHT_INTENSITY = 1.0;\nconst DEFAULT_LIGHT_DIRECTION = [0.0, 0.0, -1.0];\nlet idCount = 0;\nexport class DirectionalLight {\n  constructor(props = {}) {\n    _defineProperty(this, \"id\", void 0);\n\n    _defineProperty(this, \"color\", void 0);\n\n    _defineProperty(this, \"intensity\", void 0);\n\n    _defineProperty(this, \"type\", 'directional');\n\n    _defineProperty(this, \"direction\", void 0);\n\n    _defineProperty(this, \"shadow\", void 0);\n\n    const {\n      color = DEFAULT_LIGHT_COLOR\n    } = props;\n    const {\n      intensity = DEFAULT_LIGHT_INTENSITY\n    } = props;\n    const {\n      direction = DEFAULT_LIGHT_DIRECTION\n    } = props;\n    const {\n      _shadow = false\n    } = props;\n    this.id = props.id || \"directional-\".concat(idCount++);\n    this.color = color;\n    this.intensity = intensity;\n    this.type = 'directional';\n    this.direction = new Vector3(direction).normalize().toArray();\n    this.shadow = _shadow;\n  }\n\n  getProjectedLight(opts) {\n    return this;\n  }\n\n}\n//# sourceMappingURL=directional-light.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nexport default class Pass {\n  constructor(gl, props = {\n    id: 'pass'\n  }) {\n    _defineProperty(this, \"id\", void 0);\n\n    _defineProperty(this, \"gl\", void 0);\n\n    _defineProperty(this, \"props\", void 0);\n\n    const {\n      id\n    } = props;\n    this.id = id;\n    this.gl = gl;\n    this.props = { ...props\n    };\n  }\n\n  setProps(props) {\n    Object.assign(this.props, props);\n  }\n\n  render(params) {}\n\n  cleanup() {}\n\n}\n//# sourceMappingURL=pass.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport Pass from './pass';\nimport { clear, setParameters, withParameters, cssToDeviceRatio } from '@luma.gl/core';\nexport default class LayersPass extends Pass {\n  constructor(...args) {\n    super(...args);\n\n    _defineProperty(this, \"_lastRenderIndex\", -1);\n  }\n\n  render(options) {\n    const gl = this.gl;\n    setParameters(gl, {\n      framebuffer: options.target\n    });\n    return this._drawLayers(options);\n  }\n\n  _drawLayers(options) {\n    const {\n      target,\n      moduleParameters,\n      viewports,\n      views,\n      onViewportActive,\n      clearStack = true,\n      clearCanvas = true\n    } = options;\n    options.pass = options.pass || 'unknown';\n    const gl = this.gl;\n\n    if (clearCanvas) {\n      clearGLCanvas(gl);\n    }\n\n    if (clearStack) {\n      this._lastRenderIndex = -1;\n    }\n\n    const renderStats = [];\n\n    for (const viewport of viewports) {\n      const view = views && views[viewport.id];\n      onViewportActive(viewport);\n\n      const drawLayerParams = this._getDrawLayerParams(viewport, options);\n\n      const subViewports = viewport.subViewports || [viewport];\n\n      for (const subViewport of subViewports) {\n        const stats = this._drawLayersInViewport(gl, {\n          target,\n          moduleParameters,\n          viewport: subViewport,\n          view,\n          pass: options.pass,\n          layers: options.layers\n        }, drawLayerParams);\n\n        renderStats.push(stats);\n      }\n    }\n\n    return renderStats;\n  }\n\n  _getDrawLayerParams(viewport, {\n    layers,\n    pass,\n    layerFilter,\n    cullRect,\n    effects,\n    moduleParameters\n  }) {\n    const drawLayerParams = [];\n    const indexResolver = layerIndexResolver(this._lastRenderIndex + 1);\n    const drawContext = {\n      layer: layers[0],\n      viewport,\n      isPicking: pass.startsWith('picking'),\n      renderPass: pass,\n      cullRect\n    };\n    const layerFilterCache = {};\n\n    for (let layerIndex = 0; layerIndex < layers.length; layerIndex++) {\n      const layer = layers[layerIndex];\n\n      const shouldDrawLayer = this._shouldDrawLayer(layer, drawContext, layerFilter, layerFilterCache);\n\n      const layerParam = {\n        shouldDrawLayer\n      };\n\n      if (shouldDrawLayer) {\n        layerParam.layerRenderIndex = indexResolver(layer, shouldDrawLayer);\n        layerParam.moduleParameters = this._getModuleParameters(layer, effects, pass, moduleParameters);\n        layerParam.layerParameters = this.getLayerParameters(layer, layerIndex, viewport);\n      }\n\n      drawLayerParams[layerIndex] = layerParam;\n    }\n\n    return drawLayerParams;\n  }\n\n  _drawLayersInViewport(gl, {\n    layers,\n    moduleParameters: globalModuleParameters,\n    pass,\n    target,\n    viewport,\n    view\n  }, drawLayerParams) {\n    const glViewport = getGLViewport(gl, {\n      moduleParameters: globalModuleParameters,\n      target,\n      viewport\n    });\n\n    if (view && view.props.clear) {\n      const clearOpts = view.props.clear === true ? {\n        color: true,\n        depth: true\n      } : view.props.clear;\n      withParameters(gl, {\n        scissorTest: true,\n        scissor: glViewport\n      }, () => clear(gl, clearOpts));\n    }\n\n    const renderStatus = {\n      totalCount: layers.length,\n      visibleCount: 0,\n      compositeCount: 0,\n      pickableCount: 0\n    };\n    setParameters(gl, {\n      viewport: glViewport\n    });\n\n    for (let layerIndex = 0; layerIndex < layers.length; layerIndex++) {\n      const layer = layers[layerIndex];\n      const {\n        shouldDrawLayer,\n        layerRenderIndex,\n        moduleParameters,\n        layerParameters\n      } = drawLayerParams[layerIndex];\n\n      if (shouldDrawLayer && layer.props.pickable) {\n        renderStatus.pickableCount++;\n      }\n\n      if (layer.isComposite) {\n        renderStatus.compositeCount++;\n      } else if (shouldDrawLayer) {\n        renderStatus.visibleCount++;\n        this._lastRenderIndex = Math.max(this._lastRenderIndex, layerRenderIndex);\n        moduleParameters.viewport = viewport;\n\n        try {\n          layer._drawLayer({\n            moduleParameters,\n            uniforms: {\n              layerIndex: layerRenderIndex\n            },\n            parameters: layerParameters\n          });\n        } catch (err) {\n          layer.raiseError(err, \"drawing \".concat(layer, \" to \").concat(pass));\n        }\n      }\n    }\n\n    return renderStatus;\n  }\n\n  shouldDrawLayer(layer) {\n    return true;\n  }\n\n  getModuleParameters(layer, effects) {\n    return null;\n  }\n\n  getLayerParameters(layer, layerIndex, viewport) {\n    return layer.props.parameters;\n  }\n\n  _shouldDrawLayer(layer, drawContext, layerFilter, layerFilterCache) {\n    const shouldDrawLayer = layer.props.visible && this.shouldDrawLayer(layer);\n\n    if (!shouldDrawLayer) {\n      return false;\n    }\n\n    drawContext.layer = layer;\n    let parent = layer.parent;\n\n    while (parent) {\n      if (!parent.props.visible || !parent.filterSubLayer(drawContext)) {\n        return false;\n      }\n\n      drawContext.layer = parent;\n      parent = parent.parent;\n    }\n\n    if (layerFilter) {\n      const rootLayerId = drawContext.layer.id;\n\n      if (!(rootLayerId in layerFilterCache)) {\n        layerFilterCache[rootLayerId] = layerFilter(drawContext);\n      }\n\n      if (!layerFilterCache[rootLayerId]) {\n        return false;\n      }\n    }\n\n    layer.activateViewport(drawContext.viewport);\n    return true;\n  }\n\n  _getModuleParameters(layer, effects, pass, overrides) {\n    var _layer$internalState;\n\n    const moduleParameters = Object.assign(Object.create(((_layer$internalState = layer.internalState) === null || _layer$internalState === void 0 ? void 0 : _layer$internalState.propsInTransition) || layer.props), {\n      autoWrapLongitude: layer.wrapLongitude,\n      viewport: layer.context.viewport,\n      mousePosition: layer.context.mousePosition,\n      pickingActive: 0,\n      devicePixelRatio: cssToDeviceRatio(this.gl)\n    });\n\n    if (effects) {\n      for (const effect of effects) {\n        var _effect$getModulePara;\n\n        Object.assign(moduleParameters, (_effect$getModulePara = effect.getModuleParameters) === null || _effect$getModulePara === void 0 ? void 0 : _effect$getModulePara.call(effect, layer));\n      }\n    }\n\n    return Object.assign(moduleParameters, this.getModuleParameters(layer, effects), overrides);\n  }\n\n}\nexport function layerIndexResolver(startIndex = 0, layerIndices = {}) {\n  const resolvers = {};\n\n  const resolveLayerIndex = (layer, isDrawn) => {\n    const indexOverride = layer.props._offset;\n    const layerId = layer.id;\n    const parentId = layer.parent && layer.parent.id;\n    let index;\n\n    if (parentId && !(parentId in layerIndices)) {\n      resolveLayerIndex(layer.parent, false);\n    }\n\n    if (parentId in resolvers) {\n      const resolver = resolvers[parentId] = resolvers[parentId] || layerIndexResolver(layerIndices[parentId], layerIndices);\n      index = resolver(layer, isDrawn);\n      resolvers[layerId] = resolver;\n    } else if (Number.isFinite(indexOverride)) {\n      index = indexOverride + (layerIndices[parentId] || 0);\n      resolvers[layerId] = null;\n    } else {\n      index = startIndex;\n    }\n\n    if (isDrawn && index >= startIndex) {\n      startIndex = index + 1;\n    }\n\n    layerIndices[layerId] = index;\n    return index;\n  };\n\n  return resolveLayerIndex;\n}\n\nfunction getGLViewport(gl, {\n  moduleParameters,\n  target,\n  viewport\n}) {\n  const useTarget = target && target.id !== 'default-framebuffer';\n  const pixelRatio = moduleParameters && moduleParameters.devicePixelRatio || cssToDeviceRatio(gl);\n  const height = useTarget ? target.height : gl.drawingBufferHeight;\n  const dimensions = viewport;\n  return [dimensions.x * pixelRatio, height - (dimensions.y + dimensions.height) * pixelRatio, dimensions.width * pixelRatio, dimensions.height * pixelRatio];\n}\n\nfunction clearGLCanvas(gl) {\n  const width = gl.drawingBufferWidth;\n  const height = gl.drawingBufferHeight;\n  setParameters(gl, {\n    viewport: [0, 0, width, height]\n  });\n  gl.clear(16384 | 256);\n}\n//# sourceMappingURL=layers-pass.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { default as LayersPass } from './layers-pass';\nimport { Framebuffer, Texture2D, Renderbuffer, withParameters, cssToDeviceRatio } from '@luma.gl/core';\nexport default class ShadowPass extends LayersPass {\n  constructor(gl, props) {\n    super(gl, props);\n\n    _defineProperty(this, \"shadowMap\", void 0);\n\n    _defineProperty(this, \"depthBuffer\", void 0);\n\n    _defineProperty(this, \"fbo\", void 0);\n\n    this.shadowMap = new Texture2D(gl, {\n      width: 1,\n      height: 1,\n      parameters: {\n        [10241]: 9729,\n        [10240]: 9729,\n        [10242]: 33071,\n        [10243]: 33071\n      }\n    });\n    this.depthBuffer = new Renderbuffer(gl, {\n      format: 33189,\n      width: 1,\n      height: 1\n    });\n    this.fbo = new Framebuffer(gl, {\n      id: 'shadowmap',\n      width: 1,\n      height: 1,\n      attachments: {\n        [36064]: this.shadowMap,\n        [36096]: this.depthBuffer\n      }\n    });\n  }\n\n  render(params) {\n    const target = this.fbo;\n    withParameters(this.gl, {\n      depthRange: [0, 1],\n      depthTest: true,\n      blend: false,\n      clearColor: [1, 1, 1, 1]\n    }, () => {\n      const viewport = params.viewports[0];\n      const pixelRatio = cssToDeviceRatio(this.gl);\n      const width = viewport.width * pixelRatio;\n      const height = viewport.height * pixelRatio;\n\n      if (width !== target.width || height !== target.height) {\n        target.resize({\n          width,\n          height\n        });\n      }\n\n      super.render({ ...params,\n        target,\n        pass: 'shadow'\n      });\n    });\n  }\n\n  shouldDrawLayer(layer) {\n    return layer.props.shadowEnabled !== false;\n  }\n\n  getModuleParameters() {\n    return {\n      drawToShadowMap: true\n    };\n  }\n\n  delete() {\n    if (this.fbo) {\n      this.fbo.delete();\n      this.fbo = null;\n    }\n\n    if (this.shadowMap) {\n      this.shadowMap.delete();\n      this.shadowMap = null;\n    }\n\n    if (this.depthBuffer) {\n      this.depthBuffer.delete();\n      this.depthBuffer = null;\n    }\n  }\n\n}\n//# sourceMappingURL=shadow-pass.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { Texture2D, ProgramManager } from '@luma.gl/core';\nimport { AmbientLight } from './ambient-light';\nimport { DirectionalLight } from './directional-light';\nimport { Matrix4, Vector3 } from '@math.gl/core';\nimport ShadowPass from '../../passes/shadow-pass';\nimport shadow from '../../shaderlib/shadow/shadow';\nconst DEFAULT_AMBIENT_LIGHT_PROPS = {\n  color: [255, 255, 255],\n  intensity: 1.0\n};\nconst DEFAULT_DIRECTIONAL_LIGHT_PROPS = [{\n  color: [255, 255, 255],\n  intensity: 1.0,\n  direction: [-1, 3, -1]\n}, {\n  color: [255, 255, 255],\n  intensity: 0.9,\n  direction: [1, -8, -2.5]\n}];\nconst DEFAULT_SHADOW_COLOR = [0, 0, 0, 200 / 255];\nexport default class LightingEffect {\n  constructor(props = {}) {\n    _defineProperty(this, \"id\", 'lighting-effect');\n\n    _defineProperty(this, \"props\", null);\n\n    _defineProperty(this, \"shadowColor\", DEFAULT_SHADOW_COLOR);\n\n    _defineProperty(this, \"shadow\", void 0);\n\n    _defineProperty(this, \"ambientLight\", null);\n\n    _defineProperty(this, \"directionalLights\", []);\n\n    _defineProperty(this, \"pointLights\", []);\n\n    _defineProperty(this, \"shadowPasses\", []);\n\n    _defineProperty(this, \"shadowMaps\", []);\n\n    _defineProperty(this, \"dummyShadowMap\", null);\n\n    _defineProperty(this, \"programManager\", void 0);\n\n    _defineProperty(this, \"shadowMatrices\", void 0);\n\n    for (const key in props) {\n      const lightSource = props[key];\n\n      switch (lightSource.type) {\n        case 'ambient':\n          this.ambientLight = lightSource;\n          break;\n\n        case 'directional':\n          this.directionalLights.push(lightSource);\n          break;\n\n        case 'point':\n          this.pointLights.push(lightSource);\n          break;\n\n        default:\n      }\n    }\n\n    this._applyDefaultLights();\n\n    this.shadow = this.directionalLights.some(light => light.shadow);\n  }\n\n  preRender(gl, {\n    layers,\n    layerFilter,\n    viewports,\n    onViewportActive,\n    views\n  }) {\n    if (!this.shadow) return;\n    this.shadowMatrices = this._calculateMatrices();\n\n    if (this.shadowPasses.length === 0) {\n      this._createShadowPasses(gl);\n    }\n\n    if (!this.programManager) {\n      this.programManager = ProgramManager.getDefaultProgramManager(gl);\n\n      if (shadow) {\n        this.programManager.addDefaultModule(shadow);\n      }\n    }\n\n    if (!this.dummyShadowMap) {\n      this.dummyShadowMap = new Texture2D(gl, {\n        width: 1,\n        height: 1\n      });\n    }\n\n    for (let i = 0; i < this.shadowPasses.length; i++) {\n      const shadowPass = this.shadowPasses[i];\n      shadowPass.render({\n        layers,\n        layerFilter,\n        viewports,\n        onViewportActive,\n        views,\n        moduleParameters: {\n          shadowLightId: i,\n          dummyShadowMap: this.dummyShadowMap,\n          shadowMatrices: this.shadowMatrices\n        }\n      });\n    }\n  }\n\n  getModuleParameters(layer) {\n    const parameters = this.shadow ? {\n      shadowMaps: this.shadowMaps,\n      dummyShadowMap: this.dummyShadowMap,\n      shadowColor: this.shadowColor,\n      shadowMatrices: this.shadowMatrices\n    } : {};\n    parameters.lightSources = {\n      ambientLight: this.ambientLight,\n      directionalLights: this.directionalLights.map(directionalLight => directionalLight.getProjectedLight({\n        layer\n      })),\n      pointLights: this.pointLights.map(pointLight => pointLight.getProjectedLight({\n        layer\n      }))\n    };\n    return parameters;\n  }\n\n  cleanup() {\n    for (const shadowPass of this.shadowPasses) {\n      shadowPass.delete();\n    }\n\n    this.shadowPasses.length = 0;\n    this.shadowMaps.length = 0;\n\n    if (this.dummyShadowMap) {\n      this.dummyShadowMap.delete();\n      this.dummyShadowMap = null;\n    }\n\n    if (this.shadow && this.programManager) {\n      this.programManager.removeDefaultModule(shadow);\n      this.programManager = null;\n    }\n  }\n\n  _calculateMatrices() {\n    const lightMatrices = [];\n\n    for (const light of this.directionalLights) {\n      const viewMatrix = new Matrix4().lookAt({\n        eye: new Vector3(light.direction).negate()\n      });\n      lightMatrices.push(viewMatrix);\n    }\n\n    return lightMatrices;\n  }\n\n  _createShadowPasses(gl) {\n    for (let i = 0; i < this.directionalLights.length; i++) {\n      const shadowPass = new ShadowPass(gl);\n      this.shadowPasses[i] = shadowPass;\n      this.shadowMaps[i] = shadowPass.shadowMap;\n    }\n  }\n\n  _applyDefaultLights() {\n    const {\n      ambientLight,\n      pointLights,\n      directionalLights\n    } = this;\n\n    if (!ambientLight && pointLights.length === 0 && directionalLights.length === 0) {\n      this.ambientLight = new AmbientLight(DEFAULT_AMBIENT_LIGHT_PROPS);\n      this.directionalLights.push(new DirectionalLight(DEFAULT_DIRECTIONAL_LIGHT_PROPS[0]), new DirectionalLight(DEFAULT_DIRECTIONAL_LIGHT_PROPS[1]));\n    }\n  }\n\n}\n//# sourceMappingURL=lighting-effect.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nexport class TypedArrayManager {\n  constructor(options = {}) {\n    _defineProperty(this, \"_pool\", []);\n\n    _defineProperty(this, \"opts\", {\n      overAlloc: 2,\n      poolSize: 100\n    });\n\n    this.setOptions(options);\n  }\n\n  setOptions(options) {\n    Object.assign(this.opts, options);\n  }\n\n  allocate(typedArray, count, {\n    size = 1,\n    type,\n    padding = 0,\n    copy = false,\n    initialize = false,\n    maxCount\n  }) {\n    const Type = type || typedArray && typedArray.constructor || Float32Array;\n    const newSize = count * size + padding;\n\n    if (ArrayBuffer.isView(typedArray)) {\n      if (newSize <= typedArray.length) {\n        return typedArray;\n      }\n\n      if (newSize * typedArray.BYTES_PER_ELEMENT <= typedArray.buffer.byteLength) {\n        return new Type(typedArray.buffer, 0, newSize);\n      }\n    }\n\n    let maxSize = Infinity;\n\n    if (maxCount) {\n      maxSize = maxCount * size + padding;\n    }\n\n    const newArray = this._allocate(Type, newSize, initialize, maxSize);\n\n    if (typedArray && copy) {\n      newArray.set(typedArray);\n    } else if (!initialize) {\n      newArray.fill(0, 0, 4);\n    }\n\n    this._release(typedArray);\n\n    return newArray;\n  }\n\n  release(typedArray) {\n    this._release(typedArray);\n  }\n\n  _allocate(Type, size, initialize, maxSize) {\n    let sizeToAllocate = Math.max(Math.ceil(size * this.opts.overAlloc), 1);\n\n    if (sizeToAllocate > maxSize) {\n      sizeToAllocate = maxSize;\n    }\n\n    const pool = this._pool;\n    const byteLength = Type.BYTES_PER_ELEMENT * sizeToAllocate;\n    const i = pool.findIndex(b => b.byteLength >= byteLength);\n\n    if (i >= 0) {\n      const array = new Type(pool.splice(i, 1)[0], 0, sizeToAllocate);\n\n      if (initialize) {\n        array.fill(0);\n      }\n\n      return array;\n    }\n\n    return new Type(sizeToAllocate);\n  }\n\n  _release(typedArray) {\n    if (!ArrayBuffer.isView(typedArray)) {\n      return;\n    }\n\n    const pool = this._pool;\n    const {\n      buffer\n    } = typedArray;\n    const {\n      byteLength\n    } = buffer;\n    const i = pool.findIndex(b => b.byteLength >= byteLength);\n\n    if (i < 0) {\n      pool.push(buffer);\n    } else if (i > 0 || pool.length < this.opts.poolSize) {\n      pool.splice(i, 0, buffer);\n    }\n\n    if (pool.length > this.opts.poolSize) {\n      pool.shift();\n    }\n  }\n\n}\nexport default new TypedArrayManager();\n//# sourceMappingURL=typed-array-manager.js.map","import typedArrayManager from './typed-array-manager';\nimport { Vector3 } from '@math.gl/core';\nexport function createMat4() {\n  return [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\n}\nexport function mod(value, divisor) {\n  const modulus = value % divisor;\n  return modulus < 0 ? divisor + modulus : modulus;\n}\nexport function getCameraPosition(viewMatrixInverse) {\n  return [viewMatrixInverse[12], viewMatrixInverse[13], viewMatrixInverse[14]];\n}\nexport function getFrustumPlanes(viewProjectionMatrix) {\n  return {\n    left: getFrustumPlane(viewProjectionMatrix[3] + viewProjectionMatrix[0], viewProjectionMatrix[7] + viewProjectionMatrix[4], viewProjectionMatrix[11] + viewProjectionMatrix[8], viewProjectionMatrix[15] + viewProjectionMatrix[12]),\n    right: getFrustumPlane(viewProjectionMatrix[3] - viewProjectionMatrix[0], viewProjectionMatrix[7] - viewProjectionMatrix[4], viewProjectionMatrix[11] - viewProjectionMatrix[8], viewProjectionMatrix[15] - viewProjectionMatrix[12]),\n    bottom: getFrustumPlane(viewProjectionMatrix[3] + viewProjectionMatrix[1], viewProjectionMatrix[7] + viewProjectionMatrix[5], viewProjectionMatrix[11] + viewProjectionMatrix[9], viewProjectionMatrix[15] + viewProjectionMatrix[13]),\n    top: getFrustumPlane(viewProjectionMatrix[3] - viewProjectionMatrix[1], viewProjectionMatrix[7] - viewProjectionMatrix[5], viewProjectionMatrix[11] - viewProjectionMatrix[9], viewProjectionMatrix[15] - viewProjectionMatrix[13]),\n    near: getFrustumPlane(viewProjectionMatrix[3] + viewProjectionMatrix[2], viewProjectionMatrix[7] + viewProjectionMatrix[6], viewProjectionMatrix[11] + viewProjectionMatrix[10], viewProjectionMatrix[15] + viewProjectionMatrix[14]),\n    far: getFrustumPlane(viewProjectionMatrix[3] - viewProjectionMatrix[2], viewProjectionMatrix[7] - viewProjectionMatrix[6], viewProjectionMatrix[11] - viewProjectionMatrix[10], viewProjectionMatrix[15] - viewProjectionMatrix[14])\n  };\n}\nconst scratchVector = new Vector3();\n\nfunction getFrustumPlane(a, b, c, d) {\n  scratchVector.set(a, b, c);\n  const L = scratchVector.len();\n  return {\n    distance: d / L,\n    normal: new Vector3(-a / L, -b / L, -c / L)\n  };\n}\n\nexport function fp64LowPart(x) {\n  return x - Math.fround(x);\n}\nlet scratchArray;\nexport function toDoublePrecisionArray(typedArray, options) {\n  const {\n    size = 1,\n    startIndex = 0\n  } = options;\n  const endIndex = options.endIndex !== undefined ? options.endIndex : typedArray.length;\n  const count = (endIndex - startIndex) / size;\n  scratchArray = typedArrayManager.allocate(scratchArray, count, {\n    type: Float32Array,\n    size: size * 2\n  });\n  let sourceIndex = startIndex;\n  let targetIndex = 0;\n\n  while (sourceIndex < endIndex) {\n    for (let j = 0; j < size; j++) {\n      const value = typedArray[sourceIndex++];\n      scratchArray[targetIndex + j] = value;\n      scratchArray[targetIndex + j + size] = fp64LowPart(value);\n    }\n\n    targetIndex += size * 2;\n  }\n\n  return scratchArray.subarray(0, count * size * 2);\n}\n//# sourceMappingURL=math-utils.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport log from '../utils/log';\nimport { createMat4, getCameraPosition, getFrustumPlanes } from '../utils/math-utils';\nimport { Matrix4, Vector3, equals, clamp } from '@math.gl/core';\nimport * as mat4 from 'gl-matrix/mat4';\nimport { getDistanceScales, getMeterZoom, lngLatToWorld, worldToLngLat, worldToPixels, pixelsToWorld } from '@math.gl/web-mercator';\nimport { PROJECTION_MODE } from '../lib/constants';\nconst DEGREES_TO_RADIANS = Math.PI / 180;\nconst IDENTITY = createMat4();\nconst ZERO_VECTOR = [0, 0, 0];\nconst DEFAULT_DISTANCE_SCALES = {\n  unitsPerMeter: [1, 1, 1],\n  metersPerUnit: [1, 1, 1]\n};\n\nfunction createProjectionMatrix({\n  width,\n  height,\n  orthographic,\n  fovyRadians,\n  focalDistance,\n  padding,\n  near,\n  far\n}) {\n  const aspect = width / height;\n  const matrix = orthographic ? new Matrix4().orthographic({\n    fovy: fovyRadians,\n    aspect,\n    focalDistance,\n    near,\n    far\n  }) : new Matrix4().perspective({\n    fovy: fovyRadians,\n    aspect,\n    near,\n    far\n  });\n\n  if (padding) {\n    const {\n      left = 0,\n      right = 0,\n      top = 0,\n      bottom = 0\n    } = padding;\n    const offsetX = clamp((left + width - right) / 2, 0, width) - width / 2;\n    const offsetY = clamp((top + height - bottom) / 2, 0, height) - height / 2;\n    matrix[8] -= offsetX * 2 / width;\n    matrix[9] += offsetY * 2 / height;\n  }\n\n  return matrix;\n}\n\nexport default class Viewport {\n  constructor(opts = {}) {\n    _defineProperty(this, \"id\", void 0);\n\n    _defineProperty(this, \"x\", void 0);\n\n    _defineProperty(this, \"y\", void 0);\n\n    _defineProperty(this, \"width\", void 0);\n\n    _defineProperty(this, \"height\", void 0);\n\n    _defineProperty(this, \"isGeospatial\", void 0);\n\n    _defineProperty(this, \"zoom\", void 0);\n\n    _defineProperty(this, \"focalDistance\", void 0);\n\n    _defineProperty(this, \"position\", void 0);\n\n    _defineProperty(this, \"modelMatrix\", void 0);\n\n    _defineProperty(this, \"distanceScales\", void 0);\n\n    _defineProperty(this, \"scale\", void 0);\n\n    _defineProperty(this, \"center\", void 0);\n\n    _defineProperty(this, \"cameraPosition\", void 0);\n\n    _defineProperty(this, \"projectionMatrix\", void 0);\n\n    _defineProperty(this, \"viewMatrix\", void 0);\n\n    _defineProperty(this, \"viewMatrixUncentered\", void 0);\n\n    _defineProperty(this, \"viewMatrixInverse\", void 0);\n\n    _defineProperty(this, \"viewProjectionMatrix\", void 0);\n\n    _defineProperty(this, \"pixelProjectionMatrix\", void 0);\n\n    _defineProperty(this, \"pixelUnprojectionMatrix\", void 0);\n\n    _defineProperty(this, \"resolution\", void 0);\n\n    _defineProperty(this, \"_frustumPlanes\", {});\n\n    this.id = opts.id || this.constructor.displayName || 'viewport';\n    this.x = opts.x || 0;\n    this.y = opts.y || 0;\n    this.width = opts.width || 1;\n    this.height = opts.height || 1;\n    this.zoom = opts.zoom || 0;\n    this.distanceScales = opts.distanceScales || DEFAULT_DISTANCE_SCALES;\n    this.focalDistance = opts.focalDistance || 1;\n    this.position = opts.position || ZERO_VECTOR;\n    this.modelMatrix = opts.modelMatrix || null;\n    const {\n      longitude,\n      latitude\n    } = opts;\n    this.isGeospatial = Number.isFinite(latitude) && Number.isFinite(longitude);\n\n    this._initProps(opts);\n\n    this._initMatrices(opts);\n\n    this.equals = this.equals.bind(this);\n    this.project = this.project.bind(this);\n    this.unproject = this.unproject.bind(this);\n    this.projectPosition = this.projectPosition.bind(this);\n    this.unprojectPosition = this.unprojectPosition.bind(this);\n    this.projectFlat = this.projectFlat.bind(this);\n    this.unprojectFlat = this.unprojectFlat.bind(this);\n  }\n\n  get metersPerPixel() {\n    return this.distanceScales.metersPerUnit[2] / this.scale;\n  }\n\n  get projectionMode() {\n    if (this.isGeospatial) {\n      return this.zoom < 12 ? PROJECTION_MODE.WEB_MERCATOR : PROJECTION_MODE.WEB_MERCATOR_AUTO_OFFSET;\n    }\n\n    return PROJECTION_MODE.IDENTITY;\n  }\n\n  equals(viewport) {\n    if (!(viewport instanceof Viewport)) {\n      return false;\n    }\n\n    if (this === viewport) {\n      return true;\n    }\n\n    return viewport.width === this.width && viewport.height === this.height && viewport.scale === this.scale && equals(viewport.projectionMatrix, this.projectionMatrix) && equals(viewport.viewMatrix, this.viewMatrix);\n  }\n\n  project(xyz, {\n    topLeft = true\n  } = {}) {\n    const worldPosition = this.projectPosition(xyz);\n    const coord = worldToPixels(worldPosition, this.pixelProjectionMatrix);\n    const [x, y] = coord;\n    const y2 = topLeft ? y : this.height - y;\n    return xyz.length === 2 ? [x, y2] : [x, y2, coord[2]];\n  }\n\n  unproject(xyz, {\n    topLeft = true,\n    targetZ\n  } = {}) {\n    const [x, y, z] = xyz;\n    const y2 = topLeft ? y : this.height - y;\n    const targetZWorld = targetZ && targetZ * this.distanceScales.unitsPerMeter[2];\n    const coord = pixelsToWorld([x, y2, z], this.pixelUnprojectionMatrix, targetZWorld);\n    const [X, Y, Z] = this.unprojectPosition(coord);\n\n    if (Number.isFinite(z)) {\n      return [X, Y, Z];\n    }\n\n    return Number.isFinite(targetZ) ? [X, Y, targetZ] : [X, Y];\n  }\n\n  projectPosition(xyz) {\n    const [X, Y] = this.projectFlat(xyz);\n    const Z = (xyz[2] || 0) * this.distanceScales.unitsPerMeter[2];\n    return [X, Y, Z];\n  }\n\n  unprojectPosition(xyz) {\n    const [X, Y] = this.unprojectFlat(xyz);\n    const Z = (xyz[2] || 0) * this.distanceScales.metersPerUnit[2];\n    return [X, Y, Z];\n  }\n\n  projectFlat(xyz) {\n    if (this.isGeospatial) {\n      const result = lngLatToWorld(xyz);\n      result[1] = clamp(result[1], -318, 830);\n      return result;\n    }\n\n    return xyz;\n  }\n\n  unprojectFlat(xyz) {\n    if (this.isGeospatial) {\n      return worldToLngLat(xyz);\n    }\n\n    return xyz;\n  }\n\n  getBounds(options = {}) {\n    const unprojectOption = {\n      targetZ: options.z || 0\n    };\n    const topLeft = this.unproject([0, 0], unprojectOption);\n    const topRight = this.unproject([this.width, 0], unprojectOption);\n    const bottomLeft = this.unproject([0, this.height], unprojectOption);\n    const bottomRight = this.unproject([this.width, this.height], unprojectOption);\n    return [Math.min(topLeft[0], topRight[0], bottomLeft[0], bottomRight[0]), Math.min(topLeft[1], topRight[1], bottomLeft[1], bottomRight[1]), Math.max(topLeft[0], topRight[0], bottomLeft[0], bottomRight[0]), Math.max(topLeft[1], topRight[1], bottomLeft[1], bottomRight[1])];\n  }\n\n  getDistanceScales(coordinateOrigin) {\n    if (coordinateOrigin) {\n      return getDistanceScales({\n        longitude: coordinateOrigin[0],\n        latitude: coordinateOrigin[1],\n        highPrecision: true\n      });\n    }\n\n    return this.distanceScales;\n  }\n\n  containsPixel({\n    x,\n    y,\n    width = 1,\n    height = 1\n  }) {\n    return x < this.x + this.width && this.x < x + width && y < this.y + this.height && this.y < y + height;\n  }\n\n  getFrustumPlanes() {\n    if (this._frustumPlanes.near) {\n      return this._frustumPlanes;\n    }\n\n    Object.assign(this._frustumPlanes, getFrustumPlanes(this.viewProjectionMatrix));\n    return this._frustumPlanes;\n  }\n\n  panByPosition(coords, pixel) {\n    return null;\n  }\n\n  _initProps(opts) {\n    const longitude = opts.longitude;\n    const latitude = opts.latitude;\n\n    if (this.isGeospatial) {\n      if (!Number.isFinite(opts.zoom)) {\n        this.zoom = getMeterZoom({\n          latitude\n        }) + Math.log2(this.focalDistance);\n      }\n\n      this.distanceScales = opts.distanceScales || getDistanceScales({\n        latitude,\n        longitude\n      });\n    }\n\n    const scale = Math.pow(2, this.zoom);\n    this.scale = scale;\n    const {\n      position,\n      modelMatrix\n    } = opts;\n    let meterOffset = ZERO_VECTOR;\n\n    if (position) {\n      meterOffset = modelMatrix ? new Matrix4(modelMatrix).transformAsVector(position, []) : position;\n    }\n\n    if (this.isGeospatial) {\n      const center = this.projectPosition([longitude, latitude, 0]);\n      this.center = new Vector3(meterOffset).scale(this.distanceScales.unitsPerMeter).add(center);\n    } else {\n      this.center = this.projectPosition(meterOffset);\n    }\n  }\n\n  _initMatrices(opts) {\n    const {\n      viewMatrix = IDENTITY,\n      projectionMatrix = null,\n      orthographic = false,\n      fovyRadians,\n      fovy = 75,\n      near = 0.1,\n      far = 1000,\n      padding = null,\n      focalDistance = 1\n    } = opts;\n    this.viewMatrixUncentered = viewMatrix;\n    this.viewMatrix = new Matrix4().multiplyRight(viewMatrix).translate(new Vector3(this.center).negate());\n    this.projectionMatrix = projectionMatrix || createProjectionMatrix({\n      width: this.width,\n      height: this.height,\n      orthographic,\n      fovyRadians: fovyRadians || fovy * DEGREES_TO_RADIANS,\n      focalDistance,\n      padding,\n      near,\n      far\n    });\n    const vpm = createMat4();\n    mat4.multiply(vpm, vpm, this.projectionMatrix);\n    mat4.multiply(vpm, vpm, this.viewMatrix);\n    this.viewProjectionMatrix = vpm;\n    this.viewMatrixInverse = mat4.invert([], this.viewMatrix) || this.viewMatrix;\n    this.cameraPosition = getCameraPosition(this.viewMatrixInverse);\n    const viewportMatrix = createMat4();\n    const pixelProjectionMatrix = createMat4();\n    mat4.scale(viewportMatrix, viewportMatrix, [this.width / 2, -this.height / 2, 1]);\n    mat4.translate(viewportMatrix, viewportMatrix, [1, -1, 0]);\n    mat4.multiply(pixelProjectionMatrix, viewportMatrix, this.viewProjectionMatrix);\n    this.pixelProjectionMatrix = pixelProjectionMatrix;\n    this.pixelUnprojectionMatrix = mat4.invert(createMat4(), this.pixelProjectionMatrix);\n\n    if (!this.pixelUnprojectionMatrix) {\n      log.warn('Pixel project matrix not invertible')();\n    }\n  }\n\n}\n\n_defineProperty(Viewport, \"displayName\", 'Viewport');\n//# sourceMappingURL=viewport.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport Viewport from './viewport';\nimport { pixelsToWorld, getViewMatrix, addMetersToLngLat, getProjectionParameters, altitudeToFovy, fovyToAltitude, fitBounds, getBounds } from '@math.gl/web-mercator';\nimport * as vec2 from 'gl-matrix/vec2';\nimport { Matrix4 } from '@math.gl/core';\nconst TILE_SIZE = 512;\nconst EARTH_CIRCUMFERENCE = 40.03e6;\nconst DEGREES_TO_RADIANS = Math.PI / 180;\n\nfunction unitsPerMeter(latitude) {\n  const latCosine = Math.cos(latitude * DEGREES_TO_RADIANS);\n  return TILE_SIZE / EARTH_CIRCUMFERENCE / latCosine;\n}\n\nexport default class WebMercatorViewport extends Viewport {\n  constructor(opts = {}) {\n    const {\n      latitude = 0,\n      longitude = 0,\n      zoom = 0,\n      pitch = 0,\n      bearing = 0,\n      nearZMultiplier = 0.1,\n      farZMultiplier = 1.01,\n      orthographic = false,\n      projectionMatrix,\n      repeat = false,\n      worldOffset = 0,\n      legacyMeterSizes = false\n    } = opts;\n    let {\n      width,\n      height,\n      altitude = 1.5\n    } = opts;\n    const scale = Math.pow(2, zoom);\n    width = width || 1;\n    height = height || 1;\n    let fovy;\n    let projectionParameters = null;\n\n    if (projectionMatrix) {\n      altitude = projectionMatrix[5] / 2;\n      fovy = altitudeToFovy(altitude);\n    } else {\n      if (opts.fovy) {\n        fovy = opts.fovy;\n        altitude = fovyToAltitude(fovy);\n      } else {\n        fovy = altitudeToFovy(altitude);\n      }\n\n      projectionParameters = getProjectionParameters({\n        width,\n        height,\n        pitch,\n        fovy,\n        nearZMultiplier,\n        farZMultiplier\n      });\n    }\n\n    let viewMatrixUncentered = getViewMatrix({\n      height,\n      pitch,\n      bearing,\n      scale,\n      altitude\n    });\n\n    if (worldOffset) {\n      const viewOffset = new Matrix4().translate([512 * worldOffset, 0, 0]);\n      viewMatrixUncentered = viewOffset.multiplyLeft(viewMatrixUncentered);\n    }\n\n    super({ ...opts,\n      width,\n      height,\n      viewMatrix: viewMatrixUncentered,\n      longitude,\n      latitude,\n      zoom,\n      ...projectionParameters,\n      fovy,\n      focalDistance: altitude\n    });\n\n    _defineProperty(this, \"longitude\", void 0);\n\n    _defineProperty(this, \"latitude\", void 0);\n\n    _defineProperty(this, \"pitch\", void 0);\n\n    _defineProperty(this, \"bearing\", void 0);\n\n    _defineProperty(this, \"altitude\", void 0);\n\n    _defineProperty(this, \"fovy\", void 0);\n\n    _defineProperty(this, \"orthographic\", void 0);\n\n    _defineProperty(this, \"_subViewports\", void 0);\n\n    _defineProperty(this, \"_pseudoMeters\", void 0);\n\n    this.latitude = latitude;\n    this.longitude = longitude;\n    this.zoom = zoom;\n    this.pitch = pitch;\n    this.bearing = bearing;\n    this.altitude = altitude;\n    this.fovy = fovy;\n    this.orthographic = orthographic;\n    this._subViewports = repeat ? [] : null;\n    this._pseudoMeters = legacyMeterSizes;\n    Object.freeze(this);\n  }\n\n  get subViewports() {\n    if (this._subViewports && !this._subViewports.length) {\n      const bounds = this.getBounds();\n      const minOffset = Math.floor((bounds[0] + 180) / 360);\n      const maxOffset = Math.ceil((bounds[2] - 180) / 360);\n\n      for (let x = minOffset; x <= maxOffset; x++) {\n        const offsetViewport = x ? new WebMercatorViewport({ ...this,\n          worldOffset: x\n        }) : this;\n\n        this._subViewports.push(offsetViewport);\n      }\n    }\n\n    return this._subViewports;\n  }\n\n  projectPosition(xyz) {\n    if (this._pseudoMeters) {\n      return super.projectPosition(xyz);\n    }\n\n    const [X, Y] = this.projectFlat(xyz);\n    const Z = (xyz[2] || 0) * unitsPerMeter(xyz[1]);\n    return [X, Y, Z];\n  }\n\n  unprojectPosition(xyz) {\n    if (this._pseudoMeters) {\n      return super.unprojectPosition(xyz);\n    }\n\n    const [X, Y] = this.unprojectFlat(xyz);\n    const Z = (xyz[2] || 0) / unitsPerMeter(Y);\n    return [X, Y, Z];\n  }\n\n  addMetersToLngLat(lngLatZ, xyz) {\n    return addMetersToLngLat(lngLatZ, xyz);\n  }\n\n  panByPosition(coords, pixel) {\n    const fromLocation = pixelsToWorld(pixel, this.pixelUnprojectionMatrix);\n    const toLocation = this.projectFlat(coords);\n    const translate = vec2.add([], toLocation, vec2.negate([], fromLocation));\n    const newCenter = vec2.add([], this.center, translate);\n    const [longitude, latitude] = this.unprojectFlat(newCenter);\n    return {\n      longitude,\n      latitude\n    };\n  }\n\n  getBounds(options = {}) {\n    const corners = getBounds(this, options.z || 0);\n    return [Math.min(corners[0][0], corners[1][0], corners[2][0], corners[3][0]), Math.min(corners[0][1], corners[1][1], corners[2][1], corners[3][1]), Math.max(corners[0][0], corners[1][0], corners[2][0], corners[3][0]), Math.max(corners[0][1], corners[1][1], corners[2][1], corners[3][1])];\n  }\n\n  fitBounds(bounds, options = {}) {\n    const {\n      width,\n      height\n    } = this;\n    const {\n      longitude,\n      latitude,\n      zoom\n    } = fitBounds({\n      width,\n      height,\n      bounds,\n      ...options\n    });\n    return new WebMercatorViewport({\n      width,\n      height,\n      longitude,\n      latitude,\n      zoom\n    });\n  }\n\n}\n\n_defineProperty(WebMercatorViewport, \"displayName\", 'WebMercatorViewport');\n//# sourceMappingURL=web-mercator-viewport.js.map","import { COORDINATE_SYSTEM } from '../../lib/constants';\nimport { getOffsetOrigin } from './viewport-uniforms';\nimport WebMercatorViewport from '../../viewports/web-mercator-viewport';\nimport * as vec4 from 'gl-matrix/vec4';\nimport * as vec3 from 'gl-matrix/vec3';\nimport { addMetersToLngLat } from '@math.gl/web-mercator';\n\nfunction lngLatZToWorldPosition(lngLatZ, viewport, offsetMode = false) {\n  const p = viewport.projectPosition(lngLatZ);\n\n  if (offsetMode && viewport instanceof WebMercatorViewport) {\n    const [longitude, latitude, z = 0] = lngLatZ;\n    const distanceScales = viewport.getDistanceScales([longitude, latitude]);\n    p[2] = z * distanceScales.unitsPerMeter[2];\n  }\n\n  return p;\n}\n\nfunction normalizeParameters(opts) {\n  const {\n    viewport,\n    modelMatrix,\n    coordinateOrigin\n  } = opts;\n  let {\n    coordinateSystem,\n    fromCoordinateSystem,\n    fromCoordinateOrigin\n  } = opts;\n\n  if (coordinateSystem === COORDINATE_SYSTEM.DEFAULT) {\n    coordinateSystem = viewport.isGeospatial ? COORDINATE_SYSTEM.LNGLAT : COORDINATE_SYSTEM.CARTESIAN;\n  }\n\n  if (fromCoordinateSystem === undefined) {\n    fromCoordinateSystem = coordinateSystem;\n  }\n\n  if (fromCoordinateOrigin === undefined) {\n    fromCoordinateOrigin = coordinateOrigin;\n  }\n\n  return {\n    viewport,\n    coordinateSystem,\n    coordinateOrigin,\n    modelMatrix,\n    fromCoordinateSystem,\n    fromCoordinateOrigin\n  };\n}\n\nexport function getWorldPosition(position, {\n  viewport,\n  modelMatrix,\n  coordinateSystem,\n  coordinateOrigin,\n  offsetMode\n}) {\n  let [x, y, z = 0] = position;\n\n  if (modelMatrix) {\n    [x, y, z] = vec4.transformMat4([], [x, y, z, 1.0], modelMatrix);\n  }\n\n  switch (coordinateSystem) {\n    case COORDINATE_SYSTEM.LNGLAT:\n      return lngLatZToWorldPosition([x, y, z], viewport, offsetMode);\n\n    case COORDINATE_SYSTEM.LNGLAT_OFFSETS:\n      return lngLatZToWorldPosition([x + coordinateOrigin[0], y + coordinateOrigin[1], z + (coordinateOrigin[2] || 0)], viewport, offsetMode);\n\n    case COORDINATE_SYSTEM.METER_OFFSETS:\n      return lngLatZToWorldPosition(addMetersToLngLat(coordinateOrigin, [x, y, z]), viewport, offsetMode);\n\n    case COORDINATE_SYSTEM.CARTESIAN:\n    default:\n      return viewport.isGeospatial ? [x + coordinateOrigin[0], y + coordinateOrigin[1], z + coordinateOrigin[2]] : viewport.projectPosition([x, y, z]);\n  }\n}\nexport function projectPosition(position, params) {\n  const {\n    viewport,\n    coordinateSystem,\n    coordinateOrigin,\n    modelMatrix,\n    fromCoordinateSystem,\n    fromCoordinateOrigin\n  } = normalizeParameters(params);\n  const {\n    geospatialOrigin,\n    shaderCoordinateOrigin,\n    offsetMode\n  } = getOffsetOrigin(viewport, coordinateSystem, coordinateOrigin);\n  const worldPosition = getWorldPosition(position, {\n    viewport,\n    modelMatrix,\n    coordinateSystem: fromCoordinateSystem,\n    coordinateOrigin: fromCoordinateOrigin,\n    offsetMode\n  });\n\n  if (offsetMode) {\n    const positionCommonSpace = viewport.projectPosition(geospatialOrigin || shaderCoordinateOrigin);\n    vec3.sub(worldPosition, worldPosition, positionCommonSpace);\n  }\n\n  return worldPosition;\n}\n//# sourceMappingURL=project-functions.js.map","export const LIFECYCLE = {\n  NO_STATE: 'Awaiting state',\n  MATCHED: 'Matched. State transferred from previous layer',\n  INITIALIZED: 'Initialized',\n  AWAITING_GC: 'Discarded. Awaiting garbage collection',\n  AWAITING_FINALIZATION: 'No longer matched. Awaiting garbage collection',\n  FINALIZED: 'Finalized! Awaiting garbage collection'\n};\nexport const COMPONENT_SYMBOL = Symbol.for('component');\nexport const ASYNC_DEFAULTS_SYMBOL = Symbol.for('asyncPropDefaults');\nexport const ASYNC_ORIGINAL_SYMBOL = Symbol.for('asyncPropOriginal');\nexport const ASYNC_RESOLVED_SYMBOL = Symbol.for('asyncPropResolved');\n//# sourceMappingURL=constants.js.map","export function flatten(array, filter = () => true) {\n  if (!Array.isArray(array)) {\n    return filter(array) ? [array] : [];\n  }\n\n  return flattenArray(array, filter, []);\n}\n\nfunction flattenArray(array, filter, result) {\n  let index = -1;\n\n  while (++index < array.length) {\n    const value = array[index];\n\n    if (Array.isArray(value)) {\n      flattenArray(value, filter, result);\n    } else if (filter(value)) {\n      result.push(value);\n    }\n  }\n\n  return result;\n}\n\nexport function fillArray({\n  target,\n  source,\n  start = 0,\n  count = 1\n}) {\n  const length = source.length;\n  const total = count * length;\n  let copied = 0;\n\n  for (let i = start; copied < length; copied++) {\n    target[i++] = source[copied];\n  }\n\n  while (copied < total) {\n    if (copied < total - copied) {\n      target.copyWithin(start + copied, start, start + copied);\n      copied *= 2;\n    } else {\n      target.copyWithin(start + copied, start, start + total - copied);\n      copied = total;\n    }\n  }\n\n  return target;\n}\n//# sourceMappingURL=flatten.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { load } from '@loaders.gl/core';\nexport default class Resource {\n  constructor(id, data, context) {\n    _defineProperty(this, \"id\", void 0);\n\n    _defineProperty(this, \"context\", void 0);\n\n    _defineProperty(this, \"isLoaded\", void 0);\n\n    _defineProperty(this, \"persistent\", void 0);\n\n    _defineProperty(this, \"_loadCount\", 0);\n\n    _defineProperty(this, \"_subscribers\", new Set());\n\n    _defineProperty(this, \"_data\", void 0);\n\n    _defineProperty(this, \"_loader\", void 0);\n\n    _defineProperty(this, \"_error\", void 0);\n\n    _defineProperty(this, \"_content\", void 0);\n\n    this.id = id;\n    this.context = context;\n    this.setData(data);\n  }\n\n  subscribe(consumer) {\n    this._subscribers.add(consumer);\n  }\n\n  unsubscribe(consumer) {\n    this._subscribers.delete(consumer);\n  }\n\n  inUse() {\n    return this._subscribers.size > 0;\n  }\n\n  delete() {}\n\n  getData() {\n    return this.isLoaded ? this._error ? Promise.reject(this._error) : this._content : this._loader.then(() => this.getData());\n  }\n\n  setData(data, forceUpdate) {\n    if (data === this._data && !forceUpdate) {\n      return;\n    }\n\n    this._data = data;\n    const loadCount = ++this._loadCount;\n    let loader = data;\n\n    if (typeof data === 'string') {\n      loader = load(data);\n    }\n\n    if (loader instanceof Promise) {\n      this.isLoaded = false;\n      this._loader = loader.then(result => {\n        if (this._loadCount === loadCount) {\n          this.isLoaded = true;\n          this._error = undefined;\n          this._content = result;\n        }\n      }).catch(error => {\n        if (this._loadCount === loadCount) {\n          this.isLoaded = true;\n          this._error = error || true;\n        }\n      });\n    } else {\n      this.isLoaded = true;\n      this._error = undefined;\n      this._content = data;\n    }\n\n    for (const subscriber of this._subscribers) {\n      subscriber.onChange(this.getData());\n    }\n  }\n\n}\n//# sourceMappingURL=resource.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport Resource from './resource';\nexport default class ResourceManager {\n  constructor({\n    gl,\n    protocol\n  }) {\n    _defineProperty(this, \"protocol\", void 0);\n\n    _defineProperty(this, \"_context\", void 0);\n\n    _defineProperty(this, \"_resources\", void 0);\n\n    _defineProperty(this, \"_consumers\", void 0);\n\n    _defineProperty(this, \"_pruneRequest\", void 0);\n\n    this.protocol = protocol || 'resource://';\n    this._context = {\n      gl,\n      resourceManager: this\n    };\n    this._resources = {};\n    this._consumers = {};\n    this._pruneRequest = null;\n  }\n\n  contains(resourceId) {\n    if (resourceId.startsWith(this.protocol)) {\n      return true;\n    }\n\n    return resourceId in this._resources;\n  }\n\n  add({\n    resourceId,\n    data,\n    forceUpdate = false,\n    persistent = true\n  }) {\n    let res = this._resources[resourceId];\n\n    if (res) {\n      res.setData(data, forceUpdate);\n    } else {\n      res = new Resource(resourceId, data, this._context);\n      this._resources[resourceId] = res;\n    }\n\n    res.persistent = persistent;\n  }\n\n  remove(resourceId) {\n    const res = this._resources[resourceId];\n\n    if (res) {\n      res.delete();\n      delete this._resources[resourceId];\n    }\n  }\n\n  unsubscribe({\n    consumerId\n  }) {\n    const consumer = this._consumers[consumerId];\n\n    if (consumer) {\n      for (const requestId in consumer) {\n        const request = consumer[requestId];\n        const resource = this._resources[request.resourceId];\n\n        if (resource) {\n          resource.unsubscribe(request);\n        }\n      }\n\n      delete this._consumers[consumerId];\n      this.prune();\n    }\n  }\n\n  subscribe({\n    resourceId,\n    onChange,\n    consumerId,\n    requestId = 'default'\n  }) {\n    const {\n      _resources: resources,\n      protocol\n    } = this;\n\n    if (resourceId.startsWith(protocol)) {\n      resourceId = resourceId.replace(protocol, '');\n\n      if (!resources[resourceId]) {\n        this.add({\n          resourceId,\n          data: null,\n          persistent: false\n        });\n      }\n    }\n\n    const res = resources[resourceId];\n\n    this._track(consumerId, requestId, res, onChange);\n\n    if (res) {\n      return res.getData();\n    }\n\n    return undefined;\n  }\n\n  prune() {\n    if (!this._pruneRequest) {\n      this._pruneRequest = setTimeout(() => this._prune(), 0);\n    }\n  }\n\n  finalize() {\n    for (const key in this._resources) {\n      this._resources[key].delete();\n    }\n  }\n\n  _track(consumerId, requestId, resource, onChange) {\n    const consumers = this._consumers;\n    const consumer = consumers[consumerId] = consumers[consumerId] || {};\n    const request = consumer[requestId] || {};\n    const oldResource = request.resourceId && this._resources[request.resourceId];\n\n    if (oldResource) {\n      oldResource.unsubscribe(request);\n      this.prune();\n    }\n\n    if (resource) {\n      consumer[requestId] = request;\n      request.onChange = onChange;\n      request.resourceId = resource.id;\n      resource.subscribe(request);\n    }\n  }\n\n  _prune() {\n    this._pruneRequest = null;\n\n    for (const key of Object.keys(this._resources)) {\n      const res = this._resources[key];\n\n      if (!res.persistent && !res.inUse()) {\n        res.delete();\n        delete this._resources[key];\n      }\n    }\n  }\n\n}\n//# sourceMappingURL=resource-manager.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { Timeline } from '@luma.gl/core';\nimport { LIFECYCLE } from '../lifecycle/constants';\nimport log from '../utils/log';\nimport debug from '../debug';\nimport { flatten } from '../utils/flatten';\nimport { Stats } from '@probe.gl/stats';\nimport ResourceManager from './resource/resource-manager';\nimport Viewport from '../viewports/viewport';\nimport { createProgramManager } from '../shaderlib';\nconst TRACE_SET_LAYERS = 'layerManager.setLayers';\nconst TRACE_ACTIVATE_VIEWPORT = 'layerManager.activateViewport';\nexport default class LayerManager {\n  constructor(gl, {\n    deck,\n    stats,\n    viewport: _viewport,\n    timeline\n  } = {}) {\n    _defineProperty(this, \"layers\", void 0);\n\n    _defineProperty(this, \"context\", void 0);\n\n    _defineProperty(this, \"resourceManager\", void 0);\n\n    _defineProperty(this, \"_lastRenderedLayers\", []);\n\n    _defineProperty(this, \"_needsRedraw\", false);\n\n    _defineProperty(this, \"_needsUpdate\", false);\n\n    _defineProperty(this, \"_nextLayers\", null);\n\n    _defineProperty(this, \"_debug\", false);\n\n    _defineProperty(this, \"activateViewport\", viewport => {\n      debug(TRACE_ACTIVATE_VIEWPORT, this, viewport);\n\n      if (viewport) {\n        this.context.viewport = viewport;\n      }\n    });\n\n    this.layers = [];\n    this.resourceManager = new ResourceManager({\n      gl,\n      protocol: 'deck://'\n    });\n    this.context = {\n      mousePosition: null,\n      userData: {},\n      layerManager: this,\n      gl,\n      deck,\n      programManager: gl && createProgramManager(gl),\n      stats: stats || new Stats({\n        id: 'deck.gl'\n      }),\n      viewport: _viewport || new Viewport({\n        id: 'DEFAULT-INITIAL-VIEWPORT'\n      }),\n      timeline: timeline || new Timeline(),\n      resourceManager: this.resourceManager,\n      onError: undefined\n    };\n    Object.seal(this);\n  }\n\n  finalize() {\n    this.resourceManager.finalize();\n\n    for (const layer of this.layers) {\n      this._finalizeLayer(layer);\n    }\n  }\n\n  needsRedraw(opts = {\n    clearRedrawFlags: false\n  }) {\n    let redraw = this._needsRedraw;\n\n    if (opts.clearRedrawFlags) {\n      this._needsRedraw = false;\n    }\n\n    for (const layer of this.layers) {\n      const layerNeedsRedraw = layer.getNeedsRedraw(opts);\n      redraw = redraw || layerNeedsRedraw;\n    }\n\n    return redraw;\n  }\n\n  needsUpdate() {\n    if (this._nextLayers && this._nextLayers !== this._lastRenderedLayers) {\n      return 'layers changed';\n    }\n\n    return this._needsUpdate;\n  }\n\n  setNeedsRedraw(reason) {\n    this._needsRedraw = this._needsRedraw || reason;\n  }\n\n  setNeedsUpdate(reason) {\n    this._needsUpdate = this._needsUpdate || reason;\n  }\n\n  getLayers({\n    layerIds\n  } = {}) {\n    return layerIds ? this.layers.filter(layer => layerIds.find(layerId => layer.id.indexOf(layerId) === 0)) : this.layers;\n  }\n\n  setProps(props) {\n    if ('debug' in props) {\n      this._debug = props.debug;\n    }\n\n    if ('userData' in props) {\n      this.context.userData = props.userData;\n    }\n\n    if ('layers' in props) {\n      this._nextLayers = props.layers;\n    }\n\n    if ('onError' in props) {\n      this.context.onError = props.onError;\n    }\n  }\n\n  setLayers(newLayers, reason) {\n    debug(TRACE_SET_LAYERS, this, reason, newLayers);\n    this._lastRenderedLayers = newLayers;\n    const flatLayers = flatten(newLayers, Boolean);\n\n    for (const layer of flatLayers) {\n      layer.context = this.context;\n    }\n\n    this._updateLayers(this.layers, flatLayers);\n  }\n\n  updateLayers() {\n    const reason = this.needsUpdate();\n\n    if (reason) {\n      this.setNeedsRedraw(\"updating layers: \".concat(reason));\n      this.setLayers(this._nextLayers || this._lastRenderedLayers, reason);\n    }\n\n    this._nextLayers = null;\n  }\n\n  _handleError(stage, error, layer) {\n    layer.raiseError(error, \"\".concat(stage, \" of \").concat(layer));\n  }\n\n  _updateLayers(oldLayers, newLayers) {\n    const oldLayerMap = {};\n\n    for (const oldLayer of oldLayers) {\n      if (oldLayerMap[oldLayer.id]) {\n        log.warn(\"Multiple old layers with same id \".concat(oldLayer.id))();\n      } else {\n        oldLayerMap[oldLayer.id] = oldLayer;\n      }\n    }\n\n    const generatedLayers = [];\n\n    this._updateSublayersRecursively(newLayers, oldLayerMap, generatedLayers);\n\n    this._finalizeOldLayers(oldLayerMap);\n\n    let needsUpdate = false;\n\n    for (const layer of generatedLayers) {\n      if (layer.hasUniformTransition()) {\n        needsUpdate = \"Uniform transition in \".concat(layer);\n        break;\n      }\n    }\n\n    this._needsUpdate = needsUpdate;\n    this.layers = generatedLayers;\n  }\n\n  _updateSublayersRecursively(newLayers, oldLayerMap, generatedLayers) {\n    for (const newLayer of newLayers) {\n      newLayer.context = this.context;\n      const oldLayer = oldLayerMap[newLayer.id];\n\n      if (oldLayer === null) {\n        log.warn(\"Multiple new layers with same id \".concat(newLayer.id))();\n      }\n\n      oldLayerMap[newLayer.id] = null;\n      let sublayers = null;\n\n      try {\n        if (this._debug && oldLayer !== newLayer) {\n          newLayer.validateProps();\n        }\n\n        if (!oldLayer) {\n          this._initializeLayer(newLayer);\n        } else {\n          this._transferLayerState(oldLayer, newLayer);\n\n          this._updateLayer(newLayer);\n        }\n\n        generatedLayers.push(newLayer);\n        sublayers = newLayer.isComposite ? newLayer.getSubLayers() : null;\n      } catch (err) {\n        this._handleError('matching', err, newLayer);\n      }\n\n      if (sublayers) {\n        this._updateSublayersRecursively(sublayers, oldLayerMap, generatedLayers);\n      }\n    }\n  }\n\n  _finalizeOldLayers(oldLayerMap) {\n    for (const layerId in oldLayerMap) {\n      const layer = oldLayerMap[layerId];\n\n      if (layer) {\n        this._finalizeLayer(layer);\n      }\n    }\n  }\n\n  _initializeLayer(layer) {\n    try {\n      layer._initialize();\n\n      layer.lifecycle = LIFECYCLE.INITIALIZED;\n    } catch (err) {\n      this._handleError('initialization', err, layer);\n    }\n  }\n\n  _transferLayerState(oldLayer, newLayer) {\n    newLayer._transferState(oldLayer);\n\n    newLayer.lifecycle = LIFECYCLE.MATCHED;\n\n    if (newLayer !== oldLayer) {\n      oldLayer.lifecycle = LIFECYCLE.AWAITING_GC;\n    }\n  }\n\n  _updateLayer(layer) {\n    try {\n      layer._update();\n    } catch (err) {\n      this._handleError('update', err, layer);\n    }\n  }\n\n  _finalizeLayer(layer) {\n    this._needsRedraw = this._needsRedraw || \"finalized \".concat(layer);\n    layer.lifecycle = LIFECYCLE.AWAITING_FINALIZATION;\n\n    try {\n      layer._finalize();\n\n      layer.lifecycle = LIFECYCLE.FINALIZED;\n    } catch (err) {\n      this._handleError('finalization', err, layer);\n    }\n  }\n\n}\n//# sourceMappingURL=layer-manager.js.map","export function deepEqual(a, b) {\n  if (a === b) {\n    return true;\n  }\n\n  if (!a || !b) {\n    return false;\n  }\n\n  for (const key in a) {\n    const aValue = a[key];\n    const bValue = b[key];\n    const equals = aValue === bValue || Array.isArray(aValue) && Array.isArray(bValue) && deepEqual(aValue, bValue);\n\n    if (!equals) {\n      return false;\n    }\n  }\n\n  return true;\n}\n//# sourceMappingURL=deep-equal.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { deepEqual } from '../utils/deep-equal';\nimport log from '../utils/log';\nimport { flatten } from '../utils/flatten';\nexport default class ViewManager {\n  constructor(props) {\n    _defineProperty(this, \"width\", void 0);\n\n    _defineProperty(this, \"height\", void 0);\n\n    _defineProperty(this, \"views\", void 0);\n\n    _defineProperty(this, \"viewState\", void 0);\n\n    _defineProperty(this, \"controllers\", void 0);\n\n    _defineProperty(this, \"timeline\", void 0);\n\n    _defineProperty(this, \"_viewports\", void 0);\n\n    _defineProperty(this, \"_viewportMap\", void 0);\n\n    _defineProperty(this, \"_isUpdating\", void 0);\n\n    _defineProperty(this, \"_needsRedraw\", void 0);\n\n    _defineProperty(this, \"_needsUpdate\", void 0);\n\n    _defineProperty(this, \"_eventManager\", void 0);\n\n    _defineProperty(this, \"_eventCallbacks\", void 0);\n\n    this.views = [];\n    this.width = 100;\n    this.height = 100;\n    this.viewState = {};\n    this.controllers = {};\n    this.timeline = props.timeline;\n    this._viewports = [];\n    this._viewportMap = {};\n    this._isUpdating = false;\n    this._needsRedraw = 'First render';\n    this._needsUpdate = 'Initialize';\n    this._eventManager = props.eventManager;\n    this._eventCallbacks = {\n      onViewStateChange: props.onViewStateChange,\n      onInteractionStateChange: props.onInteractionStateChange\n    };\n    Object.seal(this);\n    this.setProps(props);\n  }\n\n  finalize() {\n    for (const key in this.controllers) {\n      const controller = this.controllers[key];\n\n      if (controller) {\n        controller.finalize();\n      }\n    }\n\n    this.controllers = {};\n  }\n\n  needsRedraw(opts = {\n    clearRedrawFlags: false\n  }) {\n    const redraw = this._needsRedraw;\n\n    if (opts.clearRedrawFlags) {\n      this._needsRedraw = false;\n    }\n\n    return redraw;\n  }\n\n  setNeedsUpdate(reason) {\n    this._needsUpdate = this._needsUpdate || reason;\n    this._needsRedraw = this._needsRedraw || reason;\n  }\n\n  updateViewStates() {\n    for (const viewId in this.controllers) {\n      const controller = this.controllers[viewId];\n\n      if (controller) {\n        controller.updateTransition();\n      }\n    }\n  }\n\n  getViewports(rect) {\n    if (rect) {\n      return this._viewports.filter(viewport => viewport.containsPixel(rect));\n    }\n\n    return this._viewports;\n  }\n\n  getViews() {\n    const viewMap = {};\n    this.views.forEach(view => {\n      viewMap[view.id] = view;\n    });\n    return viewMap;\n  }\n\n  getView(viewId) {\n    return this.views.find(view => view.id === viewId);\n  }\n\n  getViewState(viewOrViewId) {\n    const view = typeof viewOrViewId === 'string' ? this.getView(viewOrViewId) : viewOrViewId;\n    const viewState = view && this.viewState[view.getViewStateId()] || this.viewState;\n    return view ? view.filterViewState(viewState) : viewState;\n  }\n\n  getViewport(viewId) {\n    return this._viewportMap[viewId];\n  }\n\n  unproject(xyz, opts) {\n    const viewports = this.getViewports();\n    const pixel = {\n      x: xyz[0],\n      y: xyz[1]\n    };\n\n    for (let i = viewports.length - 1; i >= 0; --i) {\n      const viewport = viewports[i];\n\n      if (viewport.containsPixel(pixel)) {\n        const p = xyz.slice();\n        p[0] -= viewport.x;\n        p[1] -= viewport.y;\n        return viewport.unproject(p, opts);\n      }\n    }\n\n    return null;\n  }\n\n  setProps(props) {\n    if (props.views) {\n      this._setViews(props.views);\n    }\n\n    if (props.viewState) {\n      this._setViewState(props.viewState);\n    }\n\n    if ('width' in props || 'height' in props) {\n      this._setSize(props.width, props.height);\n    }\n\n    if (!this._isUpdating) {\n      this._update();\n    }\n  }\n\n  _update() {\n    this._isUpdating = true;\n\n    if (this._needsUpdate) {\n      this._needsUpdate = false;\n\n      this._rebuildViewports();\n    }\n\n    if (this._needsUpdate) {\n      this._needsUpdate = false;\n\n      this._rebuildViewports();\n    }\n\n    this._isUpdating = false;\n  }\n\n  _setSize(width, height) {\n    if (width !== this.width || height !== this.height) {\n      this.width = width;\n      this.height = height;\n      this.setNeedsUpdate('Size changed');\n    }\n  }\n\n  _setViews(views) {\n    views = flatten(views, Boolean);\n\n    const viewsChanged = this._diffViews(views, this.views);\n\n    if (viewsChanged) {\n      this.setNeedsUpdate('views changed');\n    }\n\n    this.views = views;\n  }\n\n  _setViewState(viewState) {\n    if (viewState) {\n      const viewStateChanged = !deepEqual(viewState, this.viewState);\n\n      if (viewStateChanged) {\n        this.setNeedsUpdate('viewState changed');\n      }\n\n      this.viewState = viewState;\n    } else {\n      log.warn('missing `viewState` or `initialViewState`')();\n    }\n  }\n\n  _onViewStateChange(viewId, event) {\n    if (this._eventCallbacks.onViewStateChange) {\n      this._eventCallbacks.onViewStateChange({ ...event,\n        viewId\n      });\n    }\n  }\n\n  _createController(view, props) {\n    const Controller = props.type;\n    const controller = new Controller({\n      timeline: this.timeline,\n      eventManager: this._eventManager,\n      onViewStateChange: this._onViewStateChange.bind(this, props.id),\n      onStateChange: this._eventCallbacks.onInteractionStateChange,\n      makeViewport: viewState => {\n        var _this$getView;\n\n        return (_this$getView = this.getView(view.id)) === null || _this$getView === void 0 ? void 0 : _this$getView.makeViewport({\n          viewState,\n          width: this.width,\n          height: this.height\n        });\n      }\n    });\n    return controller;\n  }\n\n  _updateController(view, viewState, viewport, controller) {\n    const controllerProps = view.controller;\n\n    if (controllerProps) {\n      const resolvedProps = { ...viewState,\n        ...controllerProps,\n        id: view.id,\n        x: viewport.x,\n        y: viewport.y,\n        width: viewport.width,\n        height: viewport.height\n      };\n\n      if (!controller) {\n        controller = this._createController(view, resolvedProps);\n      }\n\n      if (controller) {\n        controller.setProps(resolvedProps);\n      }\n\n      return controller;\n    }\n\n    return null;\n  }\n\n  _rebuildViewports() {\n    const {\n      views\n    } = this;\n    const oldControllers = this.controllers;\n    this._viewports = [];\n    this.controllers = {};\n    let invalidateControllers = false;\n\n    for (let i = views.length; i--;) {\n      const view = views[i];\n      const viewState = this.getViewState(view);\n      const viewport = view.makeViewport({\n        viewState,\n        width: this.width,\n        height: this.height\n      });\n      let oldController = oldControllers[view.id];\n      const hasController = Boolean(view.controller);\n\n      if (hasController && !oldController) {\n        invalidateControllers = true;\n      }\n\n      if ((invalidateControllers || !hasController) && oldController) {\n        oldController.finalize();\n        oldController = null;\n      }\n\n      this.controllers[view.id] = this._updateController(view, viewState, viewport, oldController);\n\n      this._viewports.unshift(viewport);\n    }\n\n    for (const id in oldControllers) {\n      const oldController = oldControllers[id];\n\n      if (oldController && !this.controllers[id]) {\n        oldController.finalize();\n      }\n    }\n\n    this._buildViewportMap();\n  }\n\n  _buildViewportMap() {\n    this._viewportMap = {};\n\n    this._viewports.forEach(viewport => {\n      if (viewport.id) {\n        this._viewportMap[viewport.id] = this._viewportMap[viewport.id] || viewport;\n      }\n    });\n  }\n\n  _diffViews(newViews, oldViews) {\n    if (newViews.length !== oldViews.length) {\n      return true;\n    }\n\n    return newViews.some((_, i) => !newViews[i].equals(oldViews[i]));\n  }\n\n}\n//# sourceMappingURL=view-manager.js.map","const PERCENT_OR_PIXELS_REGEX = /([0-9]+\\.?[0-9]*)(%|px)/;\nexport function parsePosition(value) {\n  switch (typeof value) {\n    case 'number':\n      return {\n        position: value,\n        relative: false\n      };\n\n    case 'string':\n      const match = PERCENT_OR_PIXELS_REGEX.exec(value);\n\n      if (match && match.length >= 3) {\n        const relative = match[2] === '%';\n        const position = parseFloat(match[1]);\n        return {\n          position: relative ? position / 100 : position,\n          relative\n        };\n      }\n\n    default:\n      throw new Error(\"Could not parse position string \".concat(value));\n  }\n}\nexport function getPosition(position, extent) {\n  return position.relative ? Math.round(position.position * extent) : position.position;\n}\n//# sourceMappingURL=positions.js.map","export default function assert(condition, message) {\n  if (!condition) {\n    throw new Error(message || 'deck.gl: assertion failed.');\n  }\n}\n//# sourceMappingURL=assert.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport Viewport from '../viewports/viewport';\nimport { parsePosition, getPosition } from '../utils/positions';\nimport { deepEqual } from '../utils/deep-equal';\nimport assert from '../utils/assert';\nexport default class View {\n  constructor(props) {\n    _defineProperty(this, \"id\", void 0);\n\n    _defineProperty(this, \"viewportInstance\", void 0);\n\n    _defineProperty(this, \"_x\", void 0);\n\n    _defineProperty(this, \"_y\", void 0);\n\n    _defineProperty(this, \"_width\", void 0);\n\n    _defineProperty(this, \"_height\", void 0);\n\n    _defineProperty(this, \"_padding\", void 0);\n\n    _defineProperty(this, \"props\", void 0);\n\n    const {\n      id,\n      x = 0,\n      y = 0,\n      width = '100%',\n      height = '100%',\n      padding = null,\n      viewportInstance\n    } = props || {};\n    assert(!viewportInstance || viewportInstance instanceof Viewport);\n    this.viewportInstance = viewportInstance;\n    this.id = id || this.constructor.displayName || 'view';\n    this.props = { ...props,\n      id: this.id\n    };\n    this._x = parsePosition(x);\n    this._y = parsePosition(y);\n    this._width = parsePosition(width);\n    this._height = parsePosition(height);\n    this._padding = padding && {\n      left: parsePosition(padding.left || 0),\n      right: parsePosition(padding.right || 0),\n      top: parsePosition(padding.top || 0),\n      bottom: parsePosition(padding.bottom || 0)\n    };\n    this.equals = this.equals.bind(this);\n    Object.seal(this);\n  }\n\n  equals(view) {\n    if (this === view) {\n      return true;\n    }\n\n    if (this.viewportInstance) {\n      return view.viewportInstance ? this.viewportInstance.equals(view.viewportInstance) : false;\n    }\n\n    return this.ViewportType === view.ViewportType && deepEqual(this.props, view.props);\n  }\n\n  makeViewport({\n    width,\n    height,\n    viewState\n  }) {\n    if (this.viewportInstance) {\n      return this.viewportInstance;\n    }\n\n    viewState = this.filterViewState(viewState);\n    const viewportDimensions = this.getDimensions({\n      width,\n      height\n    });\n    return new this.ViewportType({ ...viewState,\n      ...this.props,\n      ...viewportDimensions\n    });\n  }\n\n  getViewStateId() {\n    const {\n      viewState\n    } = this.props;\n\n    if (typeof viewState === 'string') {\n      return viewState;\n    }\n\n    return (viewState === null || viewState === void 0 ? void 0 : viewState.id) || this.id;\n  }\n\n  filterViewState(viewState) {\n    if (this.props.viewState && typeof this.props.viewState === 'object') {\n      if (!this.props.viewState.id) {\n        return this.props.viewState;\n      }\n\n      const newViewState = { ...viewState\n      };\n\n      for (const key in this.props.viewState) {\n        if (key !== 'id') {\n          newViewState[key] = this.props.viewState[key];\n        }\n      }\n\n      return newViewState;\n    }\n\n    return viewState;\n  }\n\n  getDimensions({\n    width,\n    height\n  }) {\n    const dimensions = {\n      x: getPosition(this._x, width),\n      y: getPosition(this._y, height),\n      width: getPosition(this._width, width),\n      height: getPosition(this._height, height)\n    };\n\n    if (this._padding) {\n      dimensions.padding = {\n        left: getPosition(this._padding.left, width),\n        top: getPosition(this._padding.top, height),\n        right: getPosition(this._padding.right, width),\n        bottom: getPosition(this._padding.bottom, height)\n      };\n    }\n\n    return dimensions;\n  }\n\n  get controller() {\n    const opts = this.props.controller;\n\n    if (!opts) {\n      return null;\n    }\n\n    if (opts === true) {\n      return {\n        type: this.ControllerType\n      };\n    }\n\n    if (typeof opts === 'function') {\n      return {\n        type: opts\n      };\n    }\n\n    return {\n      type: this.ControllerType,\n      ...opts\n    };\n  }\n\n}\n//# sourceMappingURL=view.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nexport default class Transition {\n  constructor(timeline) {\n    _defineProperty(this, \"_inProgress\", void 0);\n\n    _defineProperty(this, \"_handle\", void 0);\n\n    _defineProperty(this, \"_timeline\", void 0);\n\n    _defineProperty(this, \"time\", void 0);\n\n    _defineProperty(this, \"settings\", void 0);\n\n    this._inProgress = false;\n    this._handle = null;\n    this._timeline = timeline;\n    this.time = 0;\n    this.settings = {\n      duration: 0\n    };\n  }\n\n  get inProgress() {\n    return this._inProgress;\n  }\n\n  start(settings) {\n    var _this$settings$onStar, _this$settings;\n\n    this.cancel();\n    this.settings = settings;\n    this._inProgress = true;\n    (_this$settings$onStar = (_this$settings = this.settings).onStart) === null || _this$settings$onStar === void 0 ? void 0 : _this$settings$onStar.call(_this$settings, this);\n  }\n\n  end() {\n    if (this._inProgress) {\n      var _this$settings$onEnd, _this$settings2;\n\n      this._timeline.removeChannel(this._handle);\n\n      this._handle = null;\n      this._inProgress = false;\n      (_this$settings$onEnd = (_this$settings2 = this.settings).onEnd) === null || _this$settings$onEnd === void 0 ? void 0 : _this$settings$onEnd.call(_this$settings2, this);\n    }\n  }\n\n  cancel() {\n    if (this._inProgress) {\n      var _this$settings$onInte, _this$settings3;\n\n      (_this$settings$onInte = (_this$settings3 = this.settings).onInterrupt) === null || _this$settings$onInte === void 0 ? void 0 : _this$settings$onInte.call(_this$settings3, this);\n\n      this._timeline.removeChannel(this._handle);\n\n      this._handle = null;\n      this._inProgress = false;\n    }\n  }\n\n  update() {\n    var _this$settings$onUpda, _this$settings4;\n\n    if (!this._inProgress) {\n      return false;\n    }\n\n    if (this._handle === null) {\n      const {\n        _timeline: timeline,\n        settings\n      } = this;\n      this._handle = timeline.addChannel({\n        delay: timeline.getTime(),\n        duration: settings.duration\n      });\n    }\n\n    this.time = this._timeline.getTime(this._handle);\n\n    this._onUpdate();\n\n    (_this$settings$onUpda = (_this$settings4 = this.settings).onUpdate) === null || _this$settings$onUpda === void 0 ? void 0 : _this$settings$onUpda.call(_this$settings4, this);\n\n    if (this._timeline.isFinished(this._handle)) {\n      this.end();\n    }\n\n    return true;\n  }\n\n  _onUpdate() {}\n\n}\n//# sourceMappingURL=transition.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport Transition from '../transitions/transition';\n\nconst noop = () => {};\n\nexport const TRANSITION_EVENTS = {\n  BREAK: 1,\n  SNAP_TO_END: 2,\n  IGNORE: 3\n};\n\nconst DEFAULT_EASING = t => t;\n\nconst DEFAULT_INTERRUPTION = TRANSITION_EVENTS.BREAK;\nexport default class TransitionManager {\n  constructor(opts) {\n    _defineProperty(this, \"getControllerState\", void 0);\n\n    _defineProperty(this, \"props\", void 0);\n\n    _defineProperty(this, \"propsInTransition\", void 0);\n\n    _defineProperty(this, \"transition\", void 0);\n\n    _defineProperty(this, \"onViewStateChange\", void 0);\n\n    _defineProperty(this, \"onStateChange\", void 0);\n\n    _defineProperty(this, \"_onTransitionUpdate\", transition => {\n      const {\n        time,\n        settings: {\n          interpolator,\n          startProps,\n          endProps,\n          duration,\n          easing\n        }\n      } = transition;\n      const t = easing(time / duration);\n      const viewport = interpolator.interpolateProps(startProps, endProps, t);\n      this.propsInTransition = this.getControllerState({ ...this.props,\n        ...viewport\n      }).getViewportProps();\n      this.onViewStateChange({\n        viewState: this.propsInTransition,\n        oldViewState: this.props\n      });\n    });\n\n    this.getControllerState = opts.getControllerState;\n    this.propsInTransition = null;\n    this.transition = new Transition(opts.timeline);\n    this.onViewStateChange = opts.onViewStateChange || noop;\n    this.onStateChange = opts.onStateChange || noop;\n  }\n\n  finalize() {\n    this.transition.cancel();\n  }\n\n  getViewportInTransition() {\n    return this.propsInTransition;\n  }\n\n  processViewStateChange(nextProps) {\n    let transitionTriggered = false;\n    const currentProps = this.props;\n    this.props = nextProps;\n\n    if (!currentProps || this._shouldIgnoreViewportChange(currentProps, nextProps)) {\n      return false;\n    }\n\n    if (this._isTransitionEnabled(nextProps)) {\n      let startProps = currentProps;\n\n      if (this.transition.inProgress) {\n        const {\n          interruption,\n          endProps\n        } = this.transition.settings;\n        startProps = { ...currentProps,\n          ...(interruption === TRANSITION_EVENTS.SNAP_TO_END ? endProps : this.propsInTransition || currentProps)\n        };\n      }\n\n      this._triggerTransition(startProps, nextProps);\n\n      transitionTriggered = true;\n    } else {\n      this.transition.cancel();\n    }\n\n    return transitionTriggered;\n  }\n\n  updateTransition() {\n    this.transition.update();\n  }\n\n  _isTransitionEnabled(props) {\n    const {\n      transitionDuration,\n      transitionInterpolator\n    } = props;\n    return (transitionDuration > 0 || transitionDuration === 'auto') && Boolean(transitionInterpolator);\n  }\n\n  _isUpdateDueToCurrentTransition(props) {\n    if (this.transition.inProgress && this.propsInTransition) {\n      return this.transition.settings.interpolator.arePropsEqual(props, this.propsInTransition);\n    }\n\n    return false;\n  }\n\n  _shouldIgnoreViewportChange(currentProps, nextProps) {\n    if (this.transition.inProgress) {\n      return this.transition.settings.interruption === TRANSITION_EVENTS.IGNORE || this._isUpdateDueToCurrentTransition(nextProps);\n    }\n\n    if (this._isTransitionEnabled(nextProps)) {\n      return nextProps.transitionInterpolator.arePropsEqual(currentProps, nextProps);\n    }\n\n    return true;\n  }\n\n  _triggerTransition(startProps, endProps) {\n    const startViewstate = this.getControllerState(startProps);\n    const endViewStateProps = this.getControllerState(endProps).shortestPathFrom(startViewstate);\n    const transitionInterpolator = endProps.transitionInterpolator;\n    const duration = transitionInterpolator.getDuration ? transitionInterpolator.getDuration(startProps, endProps) : endProps.transitionDuration;\n\n    if (duration === 0) {\n      return;\n    }\n\n    const initialProps = transitionInterpolator.initializeProps(startProps, endViewStateProps);\n    this.propsInTransition = {};\n    const transitionSettings = {\n      duration,\n      easing: endProps.transitionEasing || DEFAULT_EASING,\n      interpolator: transitionInterpolator,\n      interruption: endProps.transitionInterruption || DEFAULT_INTERRUPTION,\n      startProps: initialProps.start,\n      endProps: initialProps.end,\n      onStart: endProps.onTransitionStart,\n      onUpdate: this._onTransitionUpdate,\n      onInterrupt: this._onTransitionEnd(endProps.onTransitionInterrupt),\n      onEnd: this._onTransitionEnd(endProps.onTransitionEnd)\n    };\n    this.transition.start(transitionSettings);\n    this.onStateChange({\n      inTransition: true\n    });\n    this.updateTransition();\n  }\n\n  _onTransitionEnd(callback) {\n    return transition => {\n      this.propsInTransition = null;\n      this.onStateChange({\n        inTransition: false,\n        isZooming: false,\n        isPanning: false,\n        isRotating: false\n      });\n      callback === null || callback === void 0 ? void 0 : callback(transition);\n    };\n  }\n\n}\n//# sourceMappingURL=transition-manager.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { equals } from '@math.gl/core';\nimport assert from '../utils/assert';\nexport default class TransitionInterpolator {\n  constructor(opts) {\n    _defineProperty(this, \"_propsToCompare\", void 0);\n\n    _defineProperty(this, \"_propsToExtract\", void 0);\n\n    _defineProperty(this, \"_requiredProps\", void 0);\n\n    const {\n      compare,\n      extract,\n      required\n    } = opts;\n    this._propsToCompare = compare;\n    this._propsToExtract = extract || compare;\n    this._requiredProps = required;\n  }\n\n  arePropsEqual(currentProps, nextProps) {\n    for (const key of this._propsToCompare) {\n      if (!(key in currentProps) || !(key in nextProps) || !equals(currentProps[key], nextProps[key])) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  initializeProps(startProps, endProps) {\n    const startViewStateProps = {};\n    const endViewStateProps = {};\n\n    for (const key of this._propsToExtract) {\n      if (key in startProps || key in endProps) {\n        startViewStateProps[key] = startProps[key];\n        endViewStateProps[key] = endProps[key];\n      }\n    }\n\n    this._checkRequiredProps(startViewStateProps);\n\n    this._checkRequiredProps(endViewStateProps);\n\n    return {\n      start: startViewStateProps,\n      end: endViewStateProps\n    };\n  }\n\n  getDuration(startProps, endProps) {\n    return endProps.transitionDuration;\n  }\n\n  _checkRequiredProps(props) {\n    if (!this._requiredProps) {\n      return;\n    }\n\n    this._requiredProps.forEach(propName => {\n      const value = props[propName];\n      assert(Number.isFinite(value) || Array.isArray(value), \"\".concat(propName, \" is required for transition\"));\n    });\n  }\n\n}\n//# sourceMappingURL=transition-interpolator.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport TransitionInterpolator from './transition-interpolator';\nimport { lerp } from '@math.gl/core';\nconst DEFAULT_PROPS = ['longitude', 'latitude', 'zoom', 'bearing', 'pitch'];\nconst DEFAULT_REQUIRED_PROPS = ['longitude', 'latitude', 'zoom'];\nexport default class LinearInterpolator extends TransitionInterpolator {\n  constructor(opts = {}) {\n    const transitionProps = Array.isArray(opts) ? opts : opts.transitionProps;\n    const normalizedOpts = Array.isArray(opts) ? {} : opts;\n    normalizedOpts.transitionProps = Array.isArray(transitionProps) ? {\n      compare: transitionProps,\n      required: transitionProps\n    } : transitionProps || {\n      compare: DEFAULT_PROPS,\n      required: DEFAULT_REQUIRED_PROPS\n    };\n    super(normalizedOpts.transitionProps);\n\n    _defineProperty(this, \"opts\", void 0);\n\n    this.opts = normalizedOpts;\n  }\n\n  initializeProps(startProps, endProps) {\n    const result = super.initializeProps(startProps, endProps);\n    const {\n      makeViewport,\n      around\n    } = this.opts;\n\n    if (makeViewport && around) {\n      const startViewport = makeViewport(startProps);\n      const endViewport = makeViewport(endProps);\n      const aroundPosition = startViewport.unproject(around);\n      result.start.around = around;\n      Object.assign(result.end, {\n        around: endViewport.project(aroundPosition),\n        aroundPosition,\n        width: endProps.width,\n        height: endProps.height\n      });\n    }\n\n    return result;\n  }\n\n  interpolateProps(startProps, endProps, t) {\n    const propsInTransition = {};\n\n    for (const key of this._propsToExtract) {\n      propsInTransition[key] = lerp(startProps[key] || 0, endProps[key] || 0, t);\n    }\n\n    if (endProps.aroundPosition && this.opts.makeViewport) {\n      const viewport = this.opts.makeViewport({ ...endProps,\n        ...propsInTransition\n      });\n      Object.assign(propsInTransition, viewport.panByPosition(endProps.aroundPosition, lerp(startProps.around, endProps.around, t)));\n    }\n\n    return propsInTransition;\n  }\n\n}\n//# sourceMappingURL=linear-interpolator.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport TransitionManager from './transition-manager';\nimport LinearInterpolator from '../transitions/linear-interpolator';\nconst NO_TRANSITION_PROPS = {\n  transitionDuration: 0\n};\nconst DEFAULT_INERTIA = 300;\n\nconst INERTIA_EASING = t => 1 - (1 - t) * (1 - t);\n\nconst EVENT_TYPES = {\n  WHEEL: ['wheel'],\n  PAN: ['panstart', 'panmove', 'panend'],\n  PINCH: ['pinchstart', 'pinchmove', 'pinchend'],\n  TRIPLE_PAN: ['tripanstart', 'tripanmove', 'tripanend'],\n  DOUBLE_TAP: ['doubletap'],\n  KEYBOARD: ['keydown']\n};\nconst pinchEventWorkaround = {};\nexport default class Controller {\n  constructor(opts) {\n    _defineProperty(this, \"props\", void 0);\n\n    _defineProperty(this, \"state\", {});\n\n    _defineProperty(this, \"transitionManager\", void 0);\n\n    _defineProperty(this, \"eventManager\", void 0);\n\n    _defineProperty(this, \"onViewStateChange\", void 0);\n\n    _defineProperty(this, \"onStateChange\", void 0);\n\n    _defineProperty(this, \"makeViewport\", void 0);\n\n    _defineProperty(this, \"_controllerState\", void 0);\n\n    _defineProperty(this, \"_events\", {});\n\n    _defineProperty(this, \"_interactionState\", {\n      isDragging: false\n    });\n\n    _defineProperty(this, \"_customEvents\", []);\n\n    _defineProperty(this, \"_eventStartBlocked\", null);\n\n    _defineProperty(this, \"_panMove\", false);\n\n    _defineProperty(this, \"invertPan\", false);\n\n    _defineProperty(this, \"dragMode\", 'rotate');\n\n    _defineProperty(this, \"inertia\", 0);\n\n    _defineProperty(this, \"scrollZoom\", true);\n\n    _defineProperty(this, \"dragPan\", true);\n\n    _defineProperty(this, \"dragRotate\", true);\n\n    _defineProperty(this, \"doubleClickZoom\", true);\n\n    _defineProperty(this, \"touchZoom\", true);\n\n    _defineProperty(this, \"touchRotate\", false);\n\n    _defineProperty(this, \"keyboard\", true);\n\n    this.transitionManager = new TransitionManager({ ...opts,\n      getControllerState: props => new this.ControllerState(props),\n      onViewStateChange: this._onTransition.bind(this),\n      onStateChange: this._setInteractionState.bind(this)\n    });\n    this.handleEvent = this.handleEvent.bind(this);\n    this.eventManager = opts.eventManager;\n\n    this.onViewStateChange = opts.onViewStateChange || (() => {});\n\n    this.onStateChange = opts.onStateChange || (() => {});\n\n    this.makeViewport = opts.makeViewport;\n  }\n\n  set events(customEvents) {\n    this.toggleEvents(this._customEvents, false);\n    this.toggleEvents(customEvents, true);\n    this._customEvents = customEvents;\n\n    if (this.props) {\n      this.setProps(this.props);\n    }\n  }\n\n  finalize() {\n    for (const eventName in this._events) {\n      if (this._events[eventName]) {\n        var _this$eventManager;\n\n        (_this$eventManager = this.eventManager) === null || _this$eventManager === void 0 ? void 0 : _this$eventManager.off(eventName, this.handleEvent);\n      }\n    }\n\n    this.transitionManager.finalize();\n  }\n\n  handleEvent(event) {\n    this._controllerState = undefined;\n    const eventStartBlocked = this._eventStartBlocked;\n\n    switch (event.type) {\n      case 'panstart':\n        return eventStartBlocked ? false : this._onPanStart(event);\n\n      case 'panmove':\n        return this._onPan(event);\n\n      case 'panend':\n        return this._onPanEnd(event);\n\n      case 'pinchstart':\n        return eventStartBlocked ? false : this._onPinchStart(event);\n\n      case 'pinchmove':\n        return this._onPinch(event);\n\n      case 'pinchend':\n        return this._onPinchEnd(event);\n\n      case 'tripanstart':\n        return eventStartBlocked ? false : this._onTriplePanStart(event);\n\n      case 'tripanmove':\n        return this._onTriplePan(event);\n\n      case 'tripanend':\n        return this._onTriplePanEnd(event);\n\n      case 'doubletap':\n        return this._onDoubleTap(event);\n\n      case 'wheel':\n        return this._onWheel(event);\n\n      case 'keydown':\n        return this._onKeyDown(event);\n\n      default:\n        return false;\n    }\n  }\n\n  get controllerState() {\n    this._controllerState = this._controllerState || new this.ControllerState({\n      makeViewport: this.makeViewport,\n      ...this.props,\n      ...this.state\n    });\n    return this._controllerState;\n  }\n\n  getCenter(event) {\n    const {\n      x,\n      y\n    } = this.props;\n    const {\n      offsetCenter\n    } = event;\n    return [offsetCenter.x - x, offsetCenter.y - y];\n  }\n\n  isPointInBounds(pos, event) {\n    const {\n      width,\n      height\n    } = this.props;\n\n    if (event && event.handled) {\n      return false;\n    }\n\n    const inside = pos[0] >= 0 && pos[0] <= width && pos[1] >= 0 && pos[1] <= height;\n\n    if (inside && event) {\n      event.stopPropagation();\n    }\n\n    return inside;\n  }\n\n  isFunctionKeyPressed(event) {\n    const {\n      srcEvent\n    } = event;\n    return Boolean(srcEvent.metaKey || srcEvent.altKey || srcEvent.ctrlKey || srcEvent.shiftKey);\n  }\n\n  isDragging() {\n    return this._interactionState.isDragging || false;\n  }\n\n  blockEvents(timeout) {\n    const timer = setTimeout(() => {\n      if (this._eventStartBlocked === timer) {\n        this._eventStartBlocked = null;\n      }\n    }, timeout);\n    this._eventStartBlocked = timer;\n  }\n\n  setProps(props) {\n    if (props.dragMode) {\n      this.dragMode = props.dragMode;\n    }\n\n    this.props = props;\n\n    if (!('transitionInterpolator' in props)) {\n      props.transitionInterpolator = this._getTransitionProps().transitionInterpolator;\n    }\n\n    this.transitionManager.processViewStateChange(props);\n    const {\n      inertia\n    } = props;\n    this.inertia = Number.isFinite(inertia) ? inertia : inertia === true ? DEFAULT_INERTIA : 0;\n    const {\n      scrollZoom = true,\n      dragPan = true,\n      dragRotate = true,\n      doubleClickZoom = true,\n      touchZoom = true,\n      touchRotate = false,\n      keyboard = true\n    } = props;\n    const isInteractive = Boolean(this.onViewStateChange);\n    this.toggleEvents(EVENT_TYPES.WHEEL, isInteractive && scrollZoom);\n    this.toggleEvents(EVENT_TYPES.PAN, isInteractive && (dragPan || dragRotate));\n    this.toggleEvents(EVENT_TYPES.PINCH, isInteractive && (touchZoom || touchRotate));\n    this.toggleEvents(EVENT_TYPES.TRIPLE_PAN, isInteractive && touchRotate);\n    this.toggleEvents(EVENT_TYPES.DOUBLE_TAP, isInteractive && doubleClickZoom);\n    this.toggleEvents(EVENT_TYPES.KEYBOARD, isInteractive && keyboard);\n    this.scrollZoom = scrollZoom;\n    this.dragPan = dragPan;\n    this.dragRotate = dragRotate;\n    this.doubleClickZoom = doubleClickZoom;\n    this.touchZoom = touchZoom;\n    this.touchRotate = touchRotate;\n    this.keyboard = keyboard;\n  }\n\n  updateTransition() {\n    this.transitionManager.updateTransition();\n  }\n\n  toggleEvents(eventNames, enabled) {\n    if (this.eventManager) {\n      eventNames.forEach(eventName => {\n        if (this._events[eventName] !== enabled) {\n          this._events[eventName] = enabled;\n\n          if (enabled) {\n            this.eventManager.on(eventName, this.handleEvent);\n          } else {\n            this.eventManager.off(eventName, this.handleEvent);\n          }\n        }\n      });\n    }\n  }\n\n  updateViewport(newControllerState, extraProps = null, interactionState = {}) {\n    const viewState = { ...newControllerState.getViewportProps(),\n      ...extraProps\n    };\n    const changed = this.controllerState !== newControllerState;\n    this.state = newControllerState.getState();\n\n    this._setInteractionState(interactionState);\n\n    if (changed) {\n      const oldViewState = this.controllerState && this.controllerState.getViewportProps();\n\n      if (this.onViewStateChange) {\n        this.onViewStateChange({\n          viewState,\n          interactionState: this._interactionState,\n          oldViewState\n        });\n      }\n    }\n  }\n\n  _onTransition(params) {\n    this.onViewStateChange({ ...params,\n      interactionState: this._interactionState\n    });\n  }\n\n  _setInteractionState(newStates) {\n    Object.assign(this._interactionState, newStates);\n    this.onStateChange(this._interactionState);\n  }\n\n  _onPanStart(event) {\n    const pos = this.getCenter(event);\n\n    if (!this.isPointInBounds(pos, event)) {\n      return false;\n    }\n\n    let alternateMode = this.isFunctionKeyPressed(event) || event.rightButton || false;\n\n    if (this.invertPan || this.dragMode === 'pan') {\n      alternateMode = !alternateMode;\n    }\n\n    const newControllerState = this.controllerState[alternateMode ? 'panStart' : 'rotateStart']({\n      pos\n    });\n    this._panMove = alternateMode;\n    this.updateViewport(newControllerState, NO_TRANSITION_PROPS, {\n      isDragging: true\n    });\n    return true;\n  }\n\n  _onPan(event) {\n    if (!this.isDragging()) {\n      return false;\n    }\n\n    return this._panMove ? this._onPanMove(event) : this._onPanRotate(event);\n  }\n\n  _onPanEnd(event) {\n    if (!this.isDragging()) {\n      return false;\n    }\n\n    return this._panMove ? this._onPanMoveEnd(event) : this._onPanRotateEnd(event);\n  }\n\n  _onPanMove(event) {\n    if (!this.dragPan) {\n      return false;\n    }\n\n    const pos = this.getCenter(event);\n    const newControllerState = this.controllerState.pan({\n      pos\n    });\n    this.updateViewport(newControllerState, NO_TRANSITION_PROPS, {\n      isDragging: true,\n      isPanning: true\n    });\n    return true;\n  }\n\n  _onPanMoveEnd(event) {\n    const {\n      inertia\n    } = this;\n\n    if (this.dragPan && inertia && event.velocity) {\n      const pos = this.getCenter(event);\n      const endPos = [pos[0] + event.velocityX * inertia / 2, pos[1] + event.velocityY * inertia / 2];\n      const newControllerState = this.controllerState.pan({\n        pos: endPos\n      }).panEnd();\n      this.updateViewport(newControllerState, { ...this._getTransitionProps(),\n        transitionDuration: inertia,\n        transitionEasing: INERTIA_EASING\n      }, {\n        isDragging: false,\n        isPanning: true\n      });\n    } else {\n      const newControllerState = this.controllerState.panEnd();\n      this.updateViewport(newControllerState, null, {\n        isDragging: false,\n        isPanning: false\n      });\n    }\n\n    return true;\n  }\n\n  _onPanRotate(event) {\n    if (!this.dragRotate) {\n      return false;\n    }\n\n    const pos = this.getCenter(event);\n    const newControllerState = this.controllerState.rotate({\n      pos\n    });\n    this.updateViewport(newControllerState, NO_TRANSITION_PROPS, {\n      isDragging: true,\n      isRotating: true\n    });\n    return true;\n  }\n\n  _onPanRotateEnd(event) {\n    const {\n      inertia\n    } = this;\n\n    if (this.dragRotate && inertia && event.velocity) {\n      const pos = this.getCenter(event);\n      const endPos = [pos[0] + event.velocityX * inertia / 2, pos[1] + event.velocityY * inertia / 2];\n      const newControllerState = this.controllerState.rotate({\n        pos: endPos\n      }).rotateEnd();\n      this.updateViewport(newControllerState, { ...this._getTransitionProps(),\n        transitionDuration: inertia,\n        transitionEasing: INERTIA_EASING\n      }, {\n        isDragging: false,\n        isRotating: true\n      });\n    } else {\n      const newControllerState = this.controllerState.rotateEnd();\n      this.updateViewport(newControllerState, null, {\n        isDragging: false,\n        isRotating: false\n      });\n    }\n\n    return true;\n  }\n\n  _onWheel(event) {\n    if (!this.scrollZoom) {\n      return false;\n    }\n\n    event.srcEvent.preventDefault();\n    const pos = this.getCenter(event);\n\n    if (!this.isPointInBounds(pos, event)) {\n      return false;\n    }\n\n    const {\n      speed = 0.01,\n      smooth = false\n    } = this.scrollZoom === true ? {} : this.scrollZoom;\n    const {\n      delta\n    } = event;\n    let scale = 2 / (1 + Math.exp(-Math.abs(delta * speed)));\n\n    if (delta < 0 && scale !== 0) {\n      scale = 1 / scale;\n    }\n\n    const newControllerState = this.controllerState.zoom({\n      pos,\n      scale\n    });\n    this.updateViewport(newControllerState, { ...this._getTransitionProps({\n        around: pos\n      }),\n      transitionDuration: smooth ? 250 : 1\n    }, {\n      isZooming: true,\n      isPanning: true\n    });\n    return true;\n  }\n\n  _onTriplePanStart(event) {\n    const pos = this.getCenter(event);\n\n    if (!this.isPointInBounds(pos, event)) {\n      return false;\n    }\n\n    const newControllerState = this.controllerState.rotateStart({\n      pos\n    });\n    this.updateViewport(newControllerState, NO_TRANSITION_PROPS, {\n      isDragging: true\n    });\n    return true;\n  }\n\n  _onTriplePan(event) {\n    if (!this.touchRotate) {\n      return false;\n    }\n\n    if (!this.isDragging()) {\n      return false;\n    }\n\n    const pos = this.getCenter(event);\n    pos[0] -= event.deltaX;\n    const newControllerState = this.controllerState.rotate({\n      pos\n    });\n    this.updateViewport(newControllerState, NO_TRANSITION_PROPS, {\n      isDragging: true,\n      isRotating: true\n    });\n    return true;\n  }\n\n  _onTriplePanEnd(event) {\n    if (!this.isDragging()) {\n      return false;\n    }\n\n    const {\n      inertia\n    } = this;\n\n    if (this.touchRotate && inertia && event.velocityY) {\n      const pos = this.getCenter(event);\n      const endPos = [pos[0], pos[1] += event.velocityY * inertia / 2];\n      const newControllerState = this.controllerState.rotate({\n        pos: endPos\n      });\n      this.updateViewport(newControllerState, { ...this._getTransitionProps(),\n        transitionDuration: inertia,\n        transitionEasing: INERTIA_EASING\n      }, {\n        isDragging: false,\n        isRotating: true\n      });\n      this.blockEvents(inertia);\n    } else {\n      const newControllerState = this.controllerState.rotateEnd();\n      this.updateViewport(newControllerState, null, {\n        isDragging: false,\n        isRotating: false\n      });\n    }\n\n    return true;\n  }\n\n  _onPinchStart(event) {\n    const pos = this.getCenter(event);\n\n    if (!this.isPointInBounds(pos, event)) {\n      return false;\n    }\n\n    const newControllerState = this.controllerState.zoomStart({\n      pos\n    }).rotateStart({\n      pos\n    });\n    pinchEventWorkaround._startPinchRotation = event.rotation;\n    pinchEventWorkaround._lastPinchEvent = event;\n    this.updateViewport(newControllerState, NO_TRANSITION_PROPS, {\n      isDragging: true\n    });\n    return true;\n  }\n\n  _onPinch(event) {\n    if (!this.touchZoom && !this.touchRotate) {\n      return false;\n    }\n\n    if (!this.isDragging()) {\n      return false;\n    }\n\n    let newControllerState = this.controllerState;\n\n    if (this.touchZoom) {\n      const {\n        scale\n      } = event;\n      const pos = this.getCenter(event);\n      newControllerState = newControllerState.zoom({\n        pos,\n        scale\n      });\n    }\n\n    if (this.touchRotate) {\n      const {\n        rotation\n      } = event;\n      newControllerState = newControllerState.rotate({\n        deltaAngleX: pinchEventWorkaround._startPinchRotation - rotation\n      });\n    }\n\n    this.updateViewport(newControllerState, NO_TRANSITION_PROPS, {\n      isDragging: true,\n      isPanning: this.touchZoom,\n      isZooming: this.touchZoom,\n      isRotating: this.touchRotate\n    });\n    pinchEventWorkaround._lastPinchEvent = event;\n    return true;\n  }\n\n  _onPinchEnd(event) {\n    if (!this.isDragging()) {\n      return false;\n    }\n\n    const {\n      inertia\n    } = this;\n    const {\n      _lastPinchEvent\n    } = pinchEventWorkaround;\n\n    if (this.touchZoom && inertia && _lastPinchEvent && event.scale !== _lastPinchEvent.scale) {\n      const pos = this.getCenter(event);\n      let newControllerState = this.controllerState.rotateEnd();\n      const z = Math.log2(event.scale);\n\n      const velocityZ = (z - Math.log2(_lastPinchEvent.scale)) / (event.deltaTime - _lastPinchEvent.deltaTime);\n\n      const endScale = Math.pow(2, z + velocityZ * inertia / 2);\n      newControllerState = newControllerState.zoom({\n        pos,\n        scale: endScale\n      }).zoomEnd();\n      this.updateViewport(newControllerState, { ...this._getTransitionProps({\n          around: pos\n        }),\n        transitionDuration: inertia,\n        transitionEasing: INERTIA_EASING\n      }, {\n        isDragging: false,\n        isPanning: this.touchZoom,\n        isZooming: this.touchZoom,\n        isRotating: false\n      });\n      this.blockEvents(inertia);\n    } else {\n      const newControllerState = this.controllerState.zoomEnd().rotateEnd();\n      this.updateViewport(newControllerState, null, {\n        isDragging: false,\n        isPanning: false,\n        isZooming: false,\n        isRotating: false\n      });\n    }\n\n    pinchEventWorkaround._startPinchRotation = null;\n    pinchEventWorkaround._lastPinchEvent = null;\n    return true;\n  }\n\n  _onDoubleTap(event) {\n    if (!this.doubleClickZoom) {\n      return false;\n    }\n\n    const pos = this.getCenter(event);\n\n    if (!this.isPointInBounds(pos, event)) {\n      return false;\n    }\n\n    const isZoomOut = this.isFunctionKeyPressed(event);\n    const newControllerState = this.controllerState.zoom({\n      pos,\n      scale: isZoomOut ? 0.5 : 2\n    });\n    this.updateViewport(newControllerState, this._getTransitionProps({\n      around: pos\n    }), {\n      isZooming: true,\n      isPanning: true\n    });\n    this.blockEvents(100);\n    return true;\n  }\n\n  _onKeyDown(event) {\n    if (!this.keyboard) {\n      return false;\n    }\n\n    const funcKey = this.isFunctionKeyPressed(event);\n    const {\n      zoomSpeed,\n      moveSpeed,\n      rotateSpeedX,\n      rotateSpeedY\n    } = this.keyboard === true ? {} : this.keyboard;\n    const {\n      controllerState\n    } = this;\n    let newControllerState;\n    const interactionState = {};\n\n    switch (event.srcEvent.code) {\n      case 'Minus':\n        newControllerState = funcKey ? controllerState.zoomOut(zoomSpeed).zoomOut(zoomSpeed) : controllerState.zoomOut(zoomSpeed);\n        interactionState.isZooming = true;\n        break;\n\n      case 'Equal':\n        newControllerState = funcKey ? controllerState.zoomIn(zoomSpeed).zoomIn(zoomSpeed) : controllerState.zoomIn(zoomSpeed);\n        interactionState.isZooming = true;\n        break;\n\n      case 'ArrowLeft':\n        if (funcKey) {\n          newControllerState = controllerState.rotateLeft(rotateSpeedX);\n          interactionState.isRotating = true;\n        } else {\n          newControllerState = controllerState.moveLeft(moveSpeed);\n          interactionState.isPanning = true;\n        }\n\n        break;\n\n      case 'ArrowRight':\n        if (funcKey) {\n          newControllerState = controllerState.rotateRight(rotateSpeedX);\n          interactionState.isRotating = true;\n        } else {\n          newControllerState = controllerState.moveRight(moveSpeed);\n          interactionState.isPanning = true;\n        }\n\n        break;\n\n      case 'ArrowUp':\n        if (funcKey) {\n          newControllerState = controllerState.rotateUp(rotateSpeedY);\n          interactionState.isRotating = true;\n        } else {\n          newControllerState = controllerState.moveUp(moveSpeed);\n          interactionState.isPanning = true;\n        }\n\n        break;\n\n      case 'ArrowDown':\n        if (funcKey) {\n          newControllerState = controllerState.rotateDown(rotateSpeedY);\n          interactionState.isRotating = true;\n        } else {\n          newControllerState = controllerState.moveDown(moveSpeed);\n          interactionState.isPanning = true;\n        }\n\n        break;\n\n      default:\n        return false;\n    }\n\n    this.updateViewport(newControllerState, this._getTransitionProps(), interactionState);\n    return true;\n  }\n\n  _getTransitionProps(opts) {\n    const {\n      transition\n    } = this;\n\n    if (!transition || !transition.transitionInterpolator) {\n      return NO_TRANSITION_PROPS;\n    }\n\n    return opts ? { ...transition,\n      transitionInterpolator: new LinearInterpolator({ ...opts,\n        ...transition.transitionInterpolator.opts,\n        makeViewport: this.controllerState.makeViewport\n      })\n    } : transition;\n  }\n\n}\n//# sourceMappingURL=controller.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nexport default class ViewState {\n  constructor(props, state) {\n    _defineProperty(this, \"_viewportProps\", void 0);\n\n    _defineProperty(this, \"_state\", void 0);\n\n    this._viewportProps = this.applyConstraints(props);\n    this._state = state;\n  }\n\n  getViewportProps() {\n    return this._viewportProps;\n  }\n\n  getState() {\n    return this._state;\n  }\n\n}\n//# sourceMappingURL=view-state.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { clamp } from '@math.gl/core';\nimport Controller from './controller';\nimport ViewState from './view-state';\nimport { normalizeViewportProps } from '@math.gl/web-mercator';\nimport assert from '../utils/assert';\nimport LinearInterpolator from '../transitions/linear-interpolator';\nconst PITCH_MOUSE_THRESHOLD = 5;\nconst PITCH_ACCEL = 1.2;\nexport class MapState extends ViewState {\n  constructor(options) {\n    const {\n      width,\n      height,\n      latitude,\n      longitude,\n      zoom,\n      bearing = 0,\n      pitch = 0,\n      altitude = 1.5,\n      position = [0, 0, 0],\n      maxZoom = 20,\n      minZoom = 0,\n      maxPitch = 60,\n      minPitch = 0,\n      startPanLngLat,\n      startZoomLngLat,\n      startRotatePos,\n      startBearing,\n      startPitch,\n      startZoom,\n      normalize = true\n    } = options;\n    assert(Number.isFinite(longitude));\n    assert(Number.isFinite(latitude));\n    assert(Number.isFinite(zoom));\n    super({\n      width,\n      height,\n      latitude,\n      longitude,\n      zoom,\n      bearing,\n      pitch,\n      altitude,\n      maxZoom,\n      minZoom,\n      maxPitch,\n      minPitch,\n      normalize,\n      position\n    }, {\n      startPanLngLat,\n      startZoomLngLat,\n      startRotatePos,\n      startBearing,\n      startPitch,\n      startZoom\n    });\n\n    _defineProperty(this, \"makeViewport\", void 0);\n\n    this.makeViewport = options.makeViewport;\n  }\n\n  panStart({\n    pos\n  }) {\n    return this._getUpdatedState({\n      startPanLngLat: this._unproject(pos)\n    });\n  }\n\n  pan({\n    pos,\n    startPos\n  }) {\n    const startPanLngLat = this.getState().startPanLngLat || this._unproject(startPos);\n\n    if (!startPanLngLat) {\n      return this;\n    }\n\n    const viewport = this.makeViewport(this.getViewportProps());\n    const newProps = viewport.panByPosition(startPanLngLat, pos);\n    return this._getUpdatedState(newProps);\n  }\n\n  panEnd() {\n    return this._getUpdatedState({\n      startPanLngLat: null\n    });\n  }\n\n  rotateStart({\n    pos\n  }) {\n    return this._getUpdatedState({\n      startRotatePos: pos,\n      startBearing: this.getViewportProps().bearing,\n      startPitch: this.getViewportProps().pitch\n    });\n  }\n\n  rotate({\n    pos,\n    deltaAngleX = 0,\n    deltaAngleY = 0\n  }) {\n    const {\n      startRotatePos,\n      startBearing,\n      startPitch\n    } = this.getState();\n\n    if (!startRotatePos || startBearing === undefined || startPitch === undefined) {\n      return this;\n    }\n\n    let newRotation;\n\n    if (pos) {\n      newRotation = this._getNewRotation(pos, startRotatePos, startPitch, startBearing);\n    } else {\n      newRotation = {\n        bearing: startBearing + deltaAngleX,\n        pitch: startPitch + deltaAngleY\n      };\n    }\n\n    return this._getUpdatedState(newRotation);\n  }\n\n  rotateEnd() {\n    return this._getUpdatedState({\n      startBearing: null,\n      startPitch: null\n    });\n  }\n\n  zoomStart({\n    pos\n  }) {\n    return this._getUpdatedState({\n      startZoomLngLat: this._unproject(pos),\n      startZoom: this.getViewportProps().zoom\n    });\n  }\n\n  zoom({\n    pos,\n    startPos,\n    scale\n  }) {\n    let {\n      startZoom,\n      startZoomLngLat\n    } = this.getState();\n\n    if (!startZoomLngLat) {\n      startZoom = this.getViewportProps().zoom;\n      startZoomLngLat = this._unproject(startPos) || this._unproject(pos);\n    }\n\n    if (!startZoomLngLat) {\n      return this;\n    }\n\n    const {\n      maxZoom,\n      minZoom\n    } = this.getViewportProps();\n    let zoom = startZoom + Math.log2(scale);\n    zoom = clamp(zoom, minZoom, maxZoom);\n    const zoomedViewport = this.makeViewport({ ...this.getViewportProps(),\n      zoom\n    });\n    return this._getUpdatedState({\n      zoom,\n      ...zoomedViewport.panByPosition(startZoomLngLat, pos)\n    });\n  }\n\n  zoomEnd() {\n    return this._getUpdatedState({\n      startZoomLngLat: null,\n      startZoom: null\n    });\n  }\n\n  zoomIn(speed = 2) {\n    return this._zoomFromCenter(speed);\n  }\n\n  zoomOut(speed = 2) {\n    return this._zoomFromCenter(1 / speed);\n  }\n\n  moveLeft(speed = 100) {\n    return this._panFromCenter([speed, 0]);\n  }\n\n  moveRight(speed = 100) {\n    return this._panFromCenter([-speed, 0]);\n  }\n\n  moveUp(speed = 100) {\n    return this._panFromCenter([0, speed]);\n  }\n\n  moveDown(speed = 100) {\n    return this._panFromCenter([0, -speed]);\n  }\n\n  rotateLeft(speed = 15) {\n    return this._getUpdatedState({\n      bearing: this.getViewportProps().bearing - speed\n    });\n  }\n\n  rotateRight(speed = 15) {\n    return this._getUpdatedState({\n      bearing: this.getViewportProps().bearing + speed\n    });\n  }\n\n  rotateUp(speed = 10) {\n    return this._getUpdatedState({\n      pitch: this.getViewportProps().pitch + speed\n    });\n  }\n\n  rotateDown(speed = 10) {\n    return this._getUpdatedState({\n      pitch: this.getViewportProps().pitch - speed\n    });\n  }\n\n  shortestPathFrom(viewState) {\n    const fromProps = viewState.getViewportProps();\n    const props = { ...this.getViewportProps()\n    };\n    const {\n      bearing,\n      longitude\n    } = props;\n\n    if (Math.abs(bearing - fromProps.bearing) > 180) {\n      props.bearing = bearing < 0 ? bearing + 360 : bearing - 360;\n    }\n\n    if (Math.abs(longitude - fromProps.longitude) > 180) {\n      props.longitude = longitude < 0 ? longitude + 360 : longitude - 360;\n    }\n\n    return props;\n  }\n\n  applyConstraints(props) {\n    const {\n      maxZoom,\n      minZoom,\n      zoom\n    } = props;\n    props.zoom = clamp(zoom, minZoom, maxZoom);\n    const {\n      maxPitch,\n      minPitch,\n      pitch\n    } = props;\n    props.pitch = clamp(pitch, minPitch, maxPitch);\n    const {\n      normalize = true\n    } = props;\n\n    if (normalize) {\n      Object.assign(props, normalizeViewportProps(props));\n    }\n\n    return props;\n  }\n\n  _zoomFromCenter(scale) {\n    const {\n      width,\n      height\n    } = this.getViewportProps();\n    return this.zoom({\n      pos: [width / 2, height / 2],\n      scale\n    });\n  }\n\n  _panFromCenter(offset) {\n    const {\n      width,\n      height\n    } = this.getViewportProps();\n    return this.pan({\n      startPos: [width / 2, height / 2],\n      pos: [width / 2 + offset[0], height / 2 + offset[1]]\n    });\n  }\n\n  _getUpdatedState(newProps) {\n    return new this.constructor({\n      makeViewport: this.makeViewport,\n      ...this.getViewportProps(),\n      ...this.getState(),\n      ...newProps\n    });\n  }\n\n  _unproject(pos) {\n    const viewport = this.makeViewport(this.getViewportProps());\n    return pos && viewport.unproject(pos);\n  }\n\n  _getNewRotation(pos, startPos, startPitch, startBearing) {\n    const deltaX = pos[0] - startPos[0];\n    const deltaY = pos[1] - startPos[1];\n    const centerY = pos[1];\n    const startY = startPos[1];\n    const {\n      width,\n      height\n    } = this.getViewportProps();\n    const deltaScaleX = deltaX / width;\n    let deltaScaleY = 0;\n\n    if (deltaY > 0) {\n      if (Math.abs(height - startY) > PITCH_MOUSE_THRESHOLD) {\n        deltaScaleY = deltaY / (startY - height) * PITCH_ACCEL;\n      }\n    } else if (deltaY < 0) {\n      if (startY > PITCH_MOUSE_THRESHOLD) {\n        deltaScaleY = 1 - centerY / startY;\n      }\n    }\n\n    deltaScaleY = clamp(deltaScaleY, -1, 1);\n    const {\n      minPitch,\n      maxPitch\n    } = this.getViewportProps();\n    const bearing = startBearing + 180 * deltaScaleX;\n    let pitch = startPitch;\n\n    if (deltaScaleY > 0) {\n      pitch = startPitch + deltaScaleY * (maxPitch - startPitch);\n    } else if (deltaScaleY < 0) {\n      pitch = startPitch - deltaScaleY * (minPitch - startPitch);\n    }\n\n    return {\n      pitch,\n      bearing\n    };\n  }\n\n}\nexport default class MapController extends Controller {\n  constructor(...args) {\n    super(...args);\n\n    _defineProperty(this, \"ControllerState\", MapState);\n\n    _defineProperty(this, \"transition\", {\n      transitionDuration: 300,\n      transitionInterpolator: new LinearInterpolator({\n        transitionProps: {\n          compare: ['longitude', 'latitude', 'zoom', 'bearing', 'pitch', 'position'],\n          required: ['longitude', 'latitude', 'zoom']\n        }\n      })\n    });\n\n    _defineProperty(this, \"dragMode\", 'pan');\n  }\n\n  setProps(props) {\n    props.position = props.position || [0, 0, 0];\n    const oldProps = this.props;\n    super.setProps(props);\n    const dimensionChanged = !oldProps || oldProps.height !== props.height;\n\n    if (dimensionChanged) {\n      this.updateViewport(new this.ControllerState({\n        makeViewport: this.makeViewport,\n        ...props,\n        ...this.state\n      }));\n    }\n  }\n\n}\n//# sourceMappingURL=map-controller.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport View from './view';\nimport WebMercatorViewport from '../viewports/web-mercator-viewport';\nimport MapController from '../controllers/map-controller';\nexport default class MapView extends View {\n  get ViewportType() {\n    return WebMercatorViewport;\n  }\n\n  get ControllerType() {\n    return MapController;\n  }\n\n}\n\n_defineProperty(MapView, \"displayName\", 'MapView');\n//# sourceMappingURL=map-view.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { Framebuffer, Texture2D, withParameters } from '@luma.gl/core';\nimport { OPERATION } from '../lib/constants';\nimport LayersPass from './layers-pass';\nexport default class MaskPass extends LayersPass {\n  constructor(gl, props) {\n    super(gl, props);\n\n    _defineProperty(this, \"maskMap\", void 0);\n\n    _defineProperty(this, \"fbo\", void 0);\n\n    const {\n      mapSize = 2048\n    } = props;\n    this.maskMap = new Texture2D(gl, {\n      width: mapSize,\n      height: mapSize,\n      parameters: {\n        [10241]: 9729,\n        [10240]: 9729,\n        [10242]: 33071,\n        [10243]: 33071\n      }\n    });\n    this.fbo = new Framebuffer(gl, {\n      id: 'maskmap',\n      width: mapSize,\n      height: mapSize,\n      attachments: {\n        [36064]: this.maskMap\n      }\n    });\n  }\n\n  render(options) {\n    const gl = this.gl;\n    const colorMask = [false, false, false, false];\n    colorMask[options.channel] = true;\n    return withParameters(gl, {\n      clearColor: [255, 255, 255, 255],\n      blend: true,\n      blendFunc: [0, 1],\n      blendEquation: 32778,\n      colorMask,\n      depthTest: false\n    }, () => super.render({ ...options,\n      target: this.fbo,\n      pass: 'mask'\n    }));\n  }\n\n  shouldDrawLayer(layer) {\n    return layer.props.operation === OPERATION.MASK;\n  }\n\n  delete() {\n    this.fbo.delete();\n    this.maskMap.delete();\n  }\n\n}\n//# sourceMappingURL=mask-pass.js.map","import Viewport from '../viewports/viewport';\nimport { Matrix4, clamp } from '@math.gl/core';\nimport { pixelsToWorld } from '@math.gl/web-mercator';\nimport * as vec2 from 'gl-matrix/vec2';\nconst viewMatrix = new Matrix4().lookAt({\n  eye: [0, 0, 1]\n});\n\nfunction getProjectionMatrix({\n  width,\n  height,\n  near,\n  far,\n  padding\n}) {\n  let left = -width / 2;\n  let right = width / 2;\n  let bottom = -height / 2;\n  let top = height / 2;\n\n  if (padding) {\n    const {\n      left: l = 0,\n      right: r = 0,\n      top: t = 0,\n      bottom: b = 0\n    } = padding;\n    const offsetX = clamp((l + width - r) / 2, 0, width) - width / 2;\n    const offsetY = clamp((t + height - b) / 2, 0, height) - height / 2;\n    left -= offsetX;\n    right -= offsetX;\n    bottom += offsetY;\n    top += offsetY;\n  }\n\n  return new Matrix4().ortho({\n    left,\n    right,\n    bottom,\n    top,\n    near,\n    far\n  });\n}\n\nexport default class OrthographicViewport extends Viewport {\n  constructor(props) {\n    const {\n      width,\n      height,\n      near = 0.1,\n      far = 1000,\n      zoom = 0,\n      target = [0, 0, 0],\n      padding = null,\n      flipY = true\n    } = props;\n    const zoomX = Array.isArray(zoom) ? zoom[0] : zoom;\n    const zoomY = Array.isArray(zoom) ? zoom[1] : zoom;\n    const zoom_ = Math.min(zoomX, zoomY);\n    const scale = Math.pow(2, zoom_);\n    let distanceScales;\n\n    if (zoomX !== zoomY) {\n      const scaleX = Math.pow(2, zoomX);\n      const scaleY = Math.pow(2, zoomY);\n      distanceScales = {\n        unitsPerMeter: [scaleX / scale, scaleY / scale, 1],\n        metersPerUnit: [scale / scaleX, scale / scaleY, 1]\n      };\n    }\n\n    super({ ...props,\n      longitude: undefined,\n      position: target,\n      viewMatrix: viewMatrix.clone().scale([scale, scale * (flipY ? -1 : 1), scale]),\n      projectionMatrix: getProjectionMatrix({\n        width: width || 1,\n        height: height || 1,\n        padding,\n        near,\n        far\n      }),\n      zoom: zoom_,\n      distanceScales\n    });\n  }\n\n  projectFlat([X, Y]) {\n    const {\n      unitsPerMeter\n    } = this.distanceScales;\n    return [X * unitsPerMeter[0], Y * unitsPerMeter[1]];\n  }\n\n  unprojectFlat([x, y]) {\n    const {\n      metersPerUnit\n    } = this.distanceScales;\n    return [x * metersPerUnit[0], y * metersPerUnit[1]];\n  }\n\n  panByPosition(coords, pixel) {\n    const fromLocation = pixelsToWorld(pixel, this.pixelUnprojectionMatrix);\n    const toLocation = this.projectFlat(coords);\n    const translate = vec2.add([], toLocation, vec2.negate([], fromLocation));\n    const newCenter = vec2.add([], this.center, translate);\n    return {\n      target: this.unprojectFlat(newCenter)\n    };\n  }\n\n}\n//# sourceMappingURL=orthographic-viewport.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { clamp } from '@math.gl/core';\nimport Controller from './controller';\nimport ViewState from './view-state';\nimport { mod } from '../utils/math-utils';\nimport LinearInterpolator from '../transitions/linear-interpolator';\nexport class OrbitState extends ViewState {\n  constructor(options) {\n    const {\n      width,\n      height,\n      rotationX = 0,\n      rotationOrbit = 0,\n      target = [0, 0, 0],\n      zoom = 0,\n      minRotationX = -90,\n      maxRotationX = 90,\n      minZoom = -Infinity,\n      maxZoom = Infinity,\n      startPanPosition,\n      startRotatePos,\n      startRotationX,\n      startRotationOrbit,\n      startZoomPosition,\n      startZoom\n    } = options;\n    super({\n      width,\n      height,\n      rotationX,\n      rotationOrbit,\n      target,\n      zoom,\n      minRotationX,\n      maxRotationX,\n      minZoom,\n      maxZoom\n    }, {\n      startPanPosition,\n      startRotatePos,\n      startRotationX,\n      startRotationOrbit,\n      startZoomPosition,\n      startZoom\n    });\n\n    _defineProperty(this, \"makeViewport\", void 0);\n\n    this.makeViewport = options.makeViewport;\n  }\n\n  panStart({\n    pos\n  }) {\n    return this._getUpdatedState({\n      startPanPosition: this._unproject(pos)\n    });\n  }\n\n  pan({\n    pos,\n    startPosition\n  }) {\n    const startPanPosition = this.getState().startPanPosition || startPosition;\n\n    if (!startPanPosition) {\n      return this;\n    }\n\n    const viewport = this.makeViewport(this.getViewportProps());\n    const newProps = viewport.panByPosition(startPanPosition, pos);\n    return this._getUpdatedState(newProps);\n  }\n\n  panEnd() {\n    return this._getUpdatedState({\n      startPanPosition: null\n    });\n  }\n\n  rotateStart({\n    pos\n  }) {\n    return this._getUpdatedState({\n      startRotatePos: pos,\n      startRotationX: this.getViewportProps().rotationX,\n      startRotationOrbit: this.getViewportProps().rotationOrbit\n    });\n  }\n\n  rotate({\n    pos,\n    deltaAngleX = 0,\n    deltaAngleY = 0\n  }) {\n    const {\n      startRotatePos,\n      startRotationX,\n      startRotationOrbit\n    } = this.getState();\n    const {\n      width,\n      height\n    } = this.getViewportProps();\n\n    if (!startRotatePos || startRotationX === undefined || startRotationOrbit === undefined) {\n      return this;\n    }\n\n    let newRotation;\n\n    if (pos) {\n      let deltaScaleX = (pos[0] - startRotatePos[0]) / width;\n      const deltaScaleY = (pos[1] - startRotatePos[1]) / height;\n\n      if (startRotationX < -90 || startRotationX > 90) {\n        deltaScaleX *= -1;\n      }\n\n      newRotation = {\n        rotationX: startRotationX + deltaScaleY * 180,\n        rotationOrbit: startRotationOrbit + deltaScaleX * 180\n      };\n    } else {\n      newRotation = {\n        rotationX: startRotationX + deltaAngleY,\n        rotationOrbit: startRotationOrbit + deltaAngleX\n      };\n    }\n\n    return this._getUpdatedState(newRotation);\n  }\n\n  rotateEnd() {\n    return this._getUpdatedState({\n      startRotationX: null,\n      startRotationOrbit: null\n    });\n  }\n\n  shortestPathFrom(viewState) {\n    const fromProps = viewState.getViewportProps();\n    const props = { ...this.getViewportProps()\n    };\n    const {\n      rotationOrbit\n    } = props;\n\n    if (Math.abs(rotationOrbit - fromProps.rotationOrbit) > 180) {\n      props.rotationOrbit = rotationOrbit < 0 ? rotationOrbit + 360 : rotationOrbit - 360;\n    }\n\n    return props;\n  }\n\n  zoomStart({\n    pos\n  }) {\n    return this._getUpdatedState({\n      startZoomPosition: this._unproject(pos),\n      startZoom: this.getViewportProps().zoom\n    });\n  }\n\n  zoom({\n    pos,\n    startPos,\n    scale\n  }) {\n    let {\n      startZoom,\n      startZoomPosition\n    } = this.getState();\n\n    if (!startZoomPosition) {\n      startZoom = this.getViewportProps().zoom;\n      startZoomPosition = this._unproject(startPos) || this._unproject(pos);\n    }\n\n    if (!startZoomPosition) {\n      return this;\n    }\n\n    const newZoom = this._calculateNewZoom({\n      scale,\n      startZoom\n    });\n\n    const zoomedViewport = this.makeViewport({ ...this.getViewportProps(),\n      zoom: newZoom\n    });\n    return this._getUpdatedState({\n      zoom: newZoom,\n      ...zoomedViewport.panByPosition(startZoomPosition, pos)\n    });\n  }\n\n  zoomEnd() {\n    return this._getUpdatedState({\n      startZoomPosition: null,\n      startZoom: null\n    });\n  }\n\n  zoomIn(speed = 2) {\n    return this._getUpdatedState({\n      zoom: this._calculateNewZoom({\n        scale: speed\n      })\n    });\n  }\n\n  zoomOut(speed = 2) {\n    return this._getUpdatedState({\n      zoom: this._calculateNewZoom({\n        scale: 1 / speed\n      })\n    });\n  }\n\n  moveLeft(speed = 50) {\n    return this._panFromCenter([-speed, 0]);\n  }\n\n  moveRight(speed = 50) {\n    return this._panFromCenter([speed, 0]);\n  }\n\n  moveUp(speed = 50) {\n    return this._panFromCenter([0, -speed]);\n  }\n\n  moveDown(speed = 50) {\n    return this._panFromCenter([0, speed]);\n  }\n\n  rotateLeft(speed = 15) {\n    return this._getUpdatedState({\n      rotationOrbit: this.getViewportProps().rotationOrbit - speed\n    });\n  }\n\n  rotateRight(speed = 15) {\n    return this._getUpdatedState({\n      rotationOrbit: this.getViewportProps().rotationOrbit + speed\n    });\n  }\n\n  rotateUp(speed = 10) {\n    return this._getUpdatedState({\n      rotationX: this.getViewportProps().rotationX - speed\n    });\n  }\n\n  rotateDown(speed = 10) {\n    return this._getUpdatedState({\n      rotationX: this.getViewportProps().rotationX + speed\n    });\n  }\n\n  _unproject(pos) {\n    const viewport = this.makeViewport(this.getViewportProps());\n    return pos && viewport.unproject(pos);\n  }\n\n  _calculateNewZoom({\n    scale,\n    startZoom\n  }) {\n    const {\n      maxZoom,\n      minZoom\n    } = this.getViewportProps();\n\n    if (startZoom === undefined) {\n      startZoom = this.getViewportProps().zoom;\n    }\n\n    const zoom = startZoom + Math.log2(scale);\n    return clamp(zoom, minZoom, maxZoom);\n  }\n\n  _panFromCenter(offset) {\n    const {\n      width,\n      height,\n      target\n    } = this.getViewportProps();\n    return this.pan({\n      startPosition: target,\n      pos: [width / 2 + offset[0], height / 2 + offset[1]]\n    });\n  }\n\n  _getUpdatedState(newProps) {\n    return new this.constructor({\n      makeViewport: this.makeViewport,\n      ...this.getViewportProps(),\n      ...this.getState(),\n      ...newProps\n    });\n  }\n\n  applyConstraints(props) {\n    const {\n      maxZoom,\n      minZoom,\n      zoom,\n      maxRotationX,\n      minRotationX,\n      rotationOrbit\n    } = props;\n    props.zoom = Array.isArray(zoom) ? [clamp(zoom[0], minZoom, maxZoom), clamp(zoom[1], minZoom, maxZoom)] : clamp(zoom, minZoom, maxZoom);\n    props.rotationX = clamp(props.rotationX, minRotationX, maxRotationX);\n\n    if (rotationOrbit < -180 || rotationOrbit > 180) {\n      props.rotationOrbit = mod(rotationOrbit + 180, 360) - 180;\n    }\n\n    return props;\n  }\n\n}\nexport default class OrbitController extends Controller {\n  constructor(...args) {\n    super(...args);\n\n    _defineProperty(this, \"ControllerState\", OrbitState);\n\n    _defineProperty(this, \"transition\", {\n      transitionDuration: 300,\n      transitionInterpolator: new LinearInterpolator({\n        transitionProps: {\n          compare: ['target', 'zoom', 'rotationX', 'rotationOrbit'],\n          required: ['target', 'zoom']\n        }\n      })\n    });\n  }\n\n}\n//# sourceMappingURL=orbit-controller.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { clamp } from '@math.gl/core';\nimport Controller from './controller';\nimport { OrbitState } from './orbit-controller';\nimport LinearInterpolator from '../transitions/linear-interpolator';\n\nclass OrthographicState extends OrbitState {\n  constructor(props) {\n    super(props);\n\n    _defineProperty(this, \"zoomAxis\", void 0);\n\n    this.zoomAxis = props.zoomAxis || 'all';\n  }\n\n  _calculateNewZoom({\n    scale,\n    startZoom\n  }) {\n    const {\n      maxZoom,\n      minZoom\n    } = this.getViewportProps();\n\n    if (startZoom === undefined) {\n      startZoom = this.getViewportProps().zoom;\n    }\n\n    let deltaZoom = Math.log2(scale);\n\n    if (Array.isArray(startZoom)) {\n      let [newZoomX, newZoomY] = startZoom;\n\n      switch (this.zoomAxis) {\n        case 'X':\n          newZoomX = clamp(newZoomX + deltaZoom, minZoom, maxZoom);\n          break;\n\n        case 'Y':\n          newZoomY = clamp(newZoomY + deltaZoom, minZoom, maxZoom);\n          break;\n\n        default:\n          let z = Math.min(newZoomX + deltaZoom, newZoomY + deltaZoom);\n\n          if (z < minZoom) {\n            deltaZoom += minZoom - z;\n          }\n\n          z = Math.max(newZoomX + deltaZoom, newZoomY + deltaZoom);\n\n          if (z > maxZoom) {\n            deltaZoom += maxZoom - z;\n          }\n\n          newZoomX += deltaZoom;\n          newZoomY += deltaZoom;\n      }\n\n      return [newZoomX, newZoomY];\n    }\n\n    return clamp(startZoom + deltaZoom, minZoom, maxZoom);\n  }\n\n}\n\nexport default class OrthographicController extends Controller {\n  constructor(...args) {\n    super(...args);\n\n    _defineProperty(this, \"ControllerState\", OrthographicState);\n\n    _defineProperty(this, \"transition\", {\n      transitionDuration: 300,\n      transitionInterpolator: new LinearInterpolator(['target', 'zoom'])\n    });\n\n    _defineProperty(this, \"dragMode\", 'pan');\n  }\n\n  _onPanRotate() {\n    return false;\n  }\n\n}\n//# sourceMappingURL=orthographic-controller.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport View from './view';\nimport OrthographicViewport from '../viewports/orthographic-viewport';\nimport OrthographicController from '../controllers/orthographic-controller';\nexport default class OrthographicView extends View {\n  get ViewportType() {\n    return OrthographicViewport;\n  }\n\n  get ControllerType() {\n    return OrthographicController;\n  }\n\n}\n\n_defineProperty(OrthographicView, \"displayName\", 'OrthographicView');\n//# sourceMappingURL=orthographic-view.js.map","import OrthographicView from '../../views/orthographic-view';\nimport WebMercatorViewport from '../../viewports/web-mercator-viewport';\nimport { fitBounds } from '@math.gl/web-mercator';\nexport function getMaskBounds({\n  layers,\n  viewport\n}) {\n  let bounds = null;\n\n  for (const layer of layers) {\n    const subLayerBounds = layer.getBounds();\n\n    if (subLayerBounds) {\n      if (bounds) {\n        bounds[0] = Math.min(bounds[0], subLayerBounds[0][0]);\n        bounds[1] = Math.min(bounds[1], subLayerBounds[0][1]);\n        bounds[2] = Math.max(bounds[2], subLayerBounds[1][0]);\n        bounds[3] = Math.max(bounds[3], subLayerBounds[1][1]);\n      } else {\n        bounds = [subLayerBounds[0][0], subLayerBounds[0][1], subLayerBounds[1][0], subLayerBounds[1][1]];\n      }\n    }\n  }\n\n  const viewportBounds = viewport.getBounds();\n\n  if (!bounds) {\n    return viewportBounds;\n  }\n\n  const paddedBounds = _doubleBounds(viewportBounds);\n\n  if (bounds[2] - bounds[0] < paddedBounds[2] - paddedBounds[0] || bounds[3] - bounds[1] < paddedBounds[3] - paddedBounds[1]) {\n    return bounds;\n  }\n\n  bounds[0] = Math.max(bounds[0], paddedBounds[0]);\n  bounds[1] = Math.max(bounds[1], paddedBounds[1]);\n  bounds[2] = Math.min(bounds[2], paddedBounds[2]);\n  bounds[3] = Math.min(bounds[3], paddedBounds[3]);\n  return bounds;\n}\nexport function getMaskViewport({\n  bounds,\n  viewport,\n  width,\n  height\n}) {\n  if (bounds[2] <= bounds[0] || bounds[3] <= bounds[1]) {\n    return null;\n  }\n\n  const padding = 1;\n  width -= padding * 2;\n  height -= padding * 2;\n\n  if (viewport instanceof WebMercatorViewport) {\n    const {\n      longitude,\n      latitude,\n      zoom\n    } = fitBounds({\n      width,\n      height,\n      bounds: [[bounds[0], bounds[1]], [bounds[2], bounds[3]]],\n      maxZoom: 20\n    });\n    return new WebMercatorViewport({\n      longitude,\n      latitude,\n      zoom,\n      x: padding,\n      y: padding,\n      width,\n      height\n    });\n  }\n\n  const center = [(bounds[0] + bounds[2]) / 2, (bounds[1] + bounds[3]) / 2, 0];\n  const scale = Math.min(20, width / (bounds[2] - bounds[0]), height / (bounds[3] - bounds[1]));\n  return new OrthographicView({\n    x: padding,\n    y: padding\n  }).makeViewport({\n    width,\n    height,\n    viewState: {\n      target: center,\n      zoom: Math.log2(scale)\n    }\n  });\n}\n\nfunction _doubleBounds(bounds) {\n  const size = {\n    x: bounds[2] - bounds[0],\n    y: bounds[3] - bounds[1]\n  };\n  const center = {\n    x: bounds[0] + 0.5 * size.x,\n    y: bounds[1] + 0.5 * size.y\n  };\n  return [center.x - size.x, center.y - size.y, center.x + size.x, center.y + size.y];\n}\n//# sourceMappingURL=utils.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { Texture2D } from '@luma.gl/core';\nimport { equals } from '@math.gl/core';\nimport MaskPass from '../../passes/mask-pass';\nimport { OPERATION } from '../../lib/constants';\nimport { getMaskBounds, getMaskViewport } from './utils';\nimport log from '../../utils/log';\nexport default class MaskEffect {\n  constructor() {\n    _defineProperty(this, \"id\", 'mask-effect');\n\n    _defineProperty(this, \"props\", null);\n\n    _defineProperty(this, \"useInPicking\", true);\n\n    _defineProperty(this, \"dummyMaskMap\", void 0);\n\n    _defineProperty(this, \"channels\", []);\n\n    _defineProperty(this, \"masks\", null);\n\n    _defineProperty(this, \"maskPass\", void 0);\n\n    _defineProperty(this, \"maskMap\", void 0);\n\n    _defineProperty(this, \"lastViewport\", void 0);\n  }\n\n  preRender(gl, {\n    layers,\n    layerFilter,\n    viewports,\n    onViewportActive,\n    views\n  }) {\n    if (!this.dummyMaskMap) {\n      this.dummyMaskMap = new Texture2D(gl, {\n        width: 1,\n        height: 1\n      });\n    }\n\n    const maskLayers = layers.filter(l => l.props.visible && l.props.operation === OPERATION.MASK);\n\n    if (maskLayers.length === 0) {\n      this.masks = null;\n      this.channels.length = 0;\n      return;\n    }\n\n    this.masks = {};\n\n    if (!this.maskPass) {\n      this.maskPass = new MaskPass(gl, {\n        id: 'default-mask'\n      });\n      this.maskMap = this.maskPass.maskMap;\n    }\n\n    const channelMap = this._sortMaskChannels(maskLayers);\n\n    const viewport = viewports[0];\n    const viewportChanged = !this.lastViewport || !this.lastViewport.equals(viewport);\n\n    for (const maskId in channelMap) {\n      this._renderChannel(channelMap[maskId], {\n        layerFilter,\n        onViewportActive,\n        views,\n        viewport,\n        viewportChanged\n      });\n    }\n  }\n\n  _renderChannel(channelInfo, {\n    layerFilter,\n    onViewportActive,\n    views,\n    viewport,\n    viewportChanged\n  }) {\n    const oldChannelInfo = this.channels[channelInfo.index];\n\n    if (!oldChannelInfo) {\n      return;\n    }\n\n    const maskChanged = channelInfo === oldChannelInfo || oldChannelInfo.layers.length !== channelInfo.layers.length || channelInfo.layerBounds.some((b, i) => b !== oldChannelInfo.layerBounds[i]);\n    channelInfo.bounds = oldChannelInfo.bounds;\n    channelInfo.maskBounds = oldChannelInfo.maskBounds;\n    this.channels[channelInfo.index] = channelInfo;\n\n    if (maskChanged || viewportChanged) {\n      this.lastViewport = viewport;\n      channelInfo.bounds = getMaskBounds({\n        layers: channelInfo.layers,\n        viewport\n      });\n\n      if (maskChanged || !equals(channelInfo.bounds, oldChannelInfo.bounds)) {\n        const {\n          maskPass,\n          maskMap\n        } = this;\n        const maskViewport = getMaskViewport({\n          bounds: channelInfo.bounds,\n          viewport,\n          width: maskMap.width,\n          height: maskMap.height\n        });\n        channelInfo.maskBounds = maskViewport ? maskViewport.getBounds() : [0, 0, 1, 1];\n        maskPass.render({\n          pass: 'mask',\n          channel: channelInfo.index,\n          layers: channelInfo.layers,\n          layerFilter,\n          viewports: maskViewport ? [maskViewport] : [],\n          onViewportActive,\n          views,\n          moduleParameters: {\n            devicePixelRatio: 1\n          }\n        });\n      }\n    }\n\n    this.masks[channelInfo.id] = {\n      index: channelInfo.index,\n      bounds: channelInfo.maskBounds,\n      coordinateOrigin: channelInfo.coordinateOrigin,\n      coordinateSystem: channelInfo.coordinateSystem\n    };\n  }\n\n  _sortMaskChannels(maskLayers) {\n    const channelMap = {};\n    let channelCount = 0;\n\n    for (const layer of maskLayers) {\n      const {\n        id\n      } = layer.root;\n      let channelInfo = channelMap[id];\n\n      if (!channelInfo) {\n        if (++channelCount > 4) {\n          log.warn('Too many mask layers. The max supported is 4')();\n          continue;\n        }\n\n        channelInfo = {\n          id,\n          index: this.channels.findIndex(c => (c === null || c === void 0 ? void 0 : c.id) === id),\n          layers: [],\n          layerBounds: [],\n          coordinateOrigin: layer.root.props.coordinateOrigin,\n          coordinateSystem: layer.root.props.coordinateSystem\n        };\n        channelMap[id] = channelInfo;\n      }\n\n      channelInfo.layers.push(layer);\n      channelInfo.layerBounds.push(layer.getBounds());\n    }\n\n    for (let i = 0; i < 4; i++) {\n      const channelInfo = this.channels[i];\n\n      if (!channelInfo || !(channelInfo.id in channelMap)) {\n        this.channels[i] = null;\n      }\n    }\n\n    for (const maskId in channelMap) {\n      const channelInfo = channelMap[maskId];\n\n      if (channelInfo.index < 0) {\n        channelInfo.index = this.channels.findIndex(c => !c);\n        this.channels[channelInfo.index] = channelInfo;\n      }\n    }\n\n    return channelMap;\n  }\n\n  getModuleParameters() {\n    return {\n      maskMap: this.masks ? this.maskMap : this.dummyMaskMap,\n      maskChannels: this.masks\n    };\n  }\n\n  cleanup() {\n    if (this.dummyMaskMap) {\n      this.dummyMaskMap.delete();\n      this.dummyMaskMap = undefined;\n    }\n\n    if (this.maskPass) {\n      this.maskPass.delete();\n      this.maskPass = undefined;\n      this.maskMap = undefined;\n    }\n\n    this.lastViewport = undefined;\n    this.masks = null;\n    this.channels.length = 0;\n  }\n\n}\n//# sourceMappingURL=mask-effect.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { deepEqual } from '../utils/deep-equal';\nimport LightingEffect from '../effects/lighting/lighting-effect';\nimport MaskEffect from '../effects/mask/mask-effect';\nconst DEFAULT_LIGHTING_EFFECT = new LightingEffect();\nexport default class EffectManager {\n  constructor() {\n    _defineProperty(this, \"effects\", void 0);\n\n    _defineProperty(this, \"_internalEffects\", void 0);\n\n    _defineProperty(this, \"_needsRedraw\", void 0);\n\n    this.effects = [];\n    this._internalEffects = [];\n    this._needsRedraw = 'Initial render';\n    this.setEffects();\n  }\n\n  setProps(props) {\n    if ('effects' in props) {\n      if (props.effects.length !== this.effects.length || !deepEqual(props.effects, this.effects)) {\n        this.setEffects(props.effects);\n        this._needsRedraw = 'effects changed';\n      }\n    }\n  }\n\n  needsRedraw(opts = {\n    clearRedrawFlags: false\n  }) {\n    const redraw = this._needsRedraw;\n\n    if (opts.clearRedrawFlags) {\n      this._needsRedraw = false;\n    }\n\n    return redraw;\n  }\n\n  getEffects() {\n    return this._internalEffects;\n  }\n\n  finalize() {\n    this.cleanup();\n  }\n\n  setEffects(effects = []) {\n    this.cleanup();\n    this.effects = effects;\n    this._internalEffects = effects.slice();\n\n    this._internalEffects.push(new MaskEffect());\n\n    if (!effects.some(effect => effect instanceof LightingEffect)) {\n      this._internalEffects.push(DEFAULT_LIGHTING_EFFECT);\n    }\n  }\n\n  cleanup() {\n    for (const effect of this.effects) {\n      effect.cleanup();\n    }\n\n    for (const effect of this._internalEffects) {\n      effect.cleanup();\n    }\n\n    this.effects.length = 0;\n    this._internalEffects.length = 0;\n  }\n\n}\n//# sourceMappingURL=effect-manager.js.map","import { OPERATION } from '../lib/constants';\nimport LayersPass from './layers-pass';\nexport default class DrawLayersPass extends LayersPass {\n  shouldDrawLayer(layer) {\n    return layer.props.operation === OPERATION.DRAW;\n  }\n\n}\n//# sourceMappingURL=draw-layers-pass.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport LayersPass from './layers-pass';\nimport { withParameters } from '@luma.gl/core';\nimport { OPERATION } from '../lib/constants';\nimport log from '../utils/log';\nconst PICKING_PARAMETERS = {\n  blendFunc: [1, 0, 32771, 0],\n  blendEquation: 32774\n};\nexport default class PickLayersPass extends LayersPass {\n  constructor(...args) {\n    super(...args);\n\n    _defineProperty(this, \"pickZ\", void 0);\n\n    _defineProperty(this, \"_colors\", null);\n  }\n\n  render(props) {\n    if (props.pickingFBO) {\n      return this._drawPickingBuffer(props);\n    }\n\n    return super.render(props);\n  }\n\n  _drawPickingBuffer({\n    layers,\n    layerFilter,\n    views,\n    viewports,\n    onViewportActive,\n    pickingFBO,\n    deviceRect: {\n      x,\n      y,\n      width,\n      height\n    },\n    cullRect,\n    effects,\n    pass = 'picking',\n    pickZ\n  }) {\n    const gl = this.gl;\n    this.pickZ = pickZ;\n    const encodedColors = pickZ ? null : {\n      byLayer: new Map(),\n      byAlpha: []\n    };\n    this._colors = encodedColors;\n    const renderStatus = withParameters(gl, {\n      scissorTest: true,\n      scissor: [x, y, width, height],\n      clearColor: [0, 0, 0, 0],\n      depthMask: true,\n      depthTest: true,\n      depthRange: [0, 1],\n      colorMask: [true, true, true, true],\n      ...PICKING_PARAMETERS,\n      blend: !pickZ\n    }, () => super.render({\n      target: pickingFBO,\n      layers,\n      layerFilter,\n      views,\n      viewports,\n      onViewportActive,\n      cullRect,\n      effects: effects === null || effects === void 0 ? void 0 : effects.filter(e => e.useInPicking),\n      pass\n    }));\n    this._colors = null;\n    const decodePickingColor = encodedColors && decodeColor.bind(null, encodedColors);\n    return {\n      decodePickingColor,\n      stats: renderStatus\n    };\n  }\n\n  shouldDrawLayer(layer) {\n    return layer.props.pickable && layer.props.operation === OPERATION.DRAW;\n  }\n\n  getModuleParameters() {\n    return {\n      pickingActive: 1,\n      pickingAttribute: this.pickZ,\n      lightSources: {}\n    };\n  }\n\n  getLayerParameters(layer, layerIndex, viewport) {\n    const pickParameters = { ...layer.props.parameters\n    };\n\n    if (!this._colors) {\n      pickParameters.blend = false;\n    } else {\n      Object.assign(pickParameters, PICKING_PARAMETERS);\n      pickParameters.blend = true;\n      pickParameters.blendColor = encodeColor(this._colors, layer, viewport);\n    }\n\n    return pickParameters;\n  }\n\n}\n\nfunction encodeColor(encoded, layer, viewport) {\n  const {\n    byLayer,\n    byAlpha\n  } = encoded;\n  let a;\n  let entry = byLayer.get(layer);\n\n  if (entry) {\n    entry.viewports.push(viewport);\n    a = entry.a;\n  } else {\n    a = byLayer.size + 1;\n\n    if (a <= 255) {\n      entry = {\n        a,\n        layer,\n        viewports: [viewport]\n      };\n      byLayer.set(layer, entry);\n      byAlpha[a] = entry;\n    } else {\n      log.warn('Too many pickable layers, only picking the first 255')();\n      a = 0;\n    }\n  }\n\n  return [0, 0, 0, a / 255];\n}\n\nfunction decodeColor(encoded, pickedColor) {\n  const entry = encoded.byAlpha[pickedColor[3]];\n  return entry && {\n    pickedLayer: entry.layer,\n    pickedViewports: entry.viewports,\n    pickedObjectIndex: entry.layer.decodePickingColor(pickedColor)\n  };\n}\n//# sourceMappingURL=pick-layers-pass.js.map","import debug from '../debug';\nimport DrawLayersPass from '../passes/draw-layers-pass';\nimport PickLayersPass from '../passes/pick-layers-pass';\nimport { Framebuffer } from '@luma.gl/core';\nconst TRACE_RENDER_LAYERS = 'deckRenderer.renderLayers';\nexport default class DeckRenderer {\n  constructor(gl) {\n    this.gl = gl;\n    this.layerFilter = null;\n    this.drawPickingColors = false;\n    this.drawLayersPass = new DrawLayersPass(gl);\n    this.pickLayersPass = new PickLayersPass(gl);\n    this.renderCount = 0;\n    this._needsRedraw = 'Initial render';\n    this.renderBuffers = [];\n    this.lastPostProcessEffect = null;\n  }\n\n  setProps(props) {\n    if ('layerFilter' in props && this.layerFilter !== props.layerFilter) {\n      this.layerFilter = props.layerFilter;\n      this._needsRedraw = 'layerFilter changed';\n    }\n\n    if ('drawPickingColors' in props && this.drawPickingColors !== props.drawPickingColors) {\n      this.drawPickingColors = props.drawPickingColors;\n      this._needsRedraw = 'drawPickingColors changed';\n    }\n  }\n\n  renderLayers(opts) {\n    const layerPass = this.drawPickingColors ? this.pickLayersPass : this.drawLayersPass;\n    opts.layerFilter = opts.layerFilter || this.layerFilter;\n    opts.effects = opts.effects || [];\n    opts.target = opts.target || Framebuffer.getDefaultFramebuffer(this.gl);\n\n    this._preRender(opts.effects, opts);\n\n    const outputBuffer = this.lastPostProcessEffect ? this.renderBuffers[0] : opts.target;\n    const renderStats = layerPass.render({ ...opts,\n      target: outputBuffer\n    });\n\n    this._postRender(opts.effects, opts);\n\n    this.renderCount++;\n    debug(TRACE_RENDER_LAYERS, this, renderStats, opts);\n  }\n\n  needsRedraw(opts = {\n    clearRedrawFlags: false\n  }) {\n    const redraw = this._needsRedraw;\n\n    if (opts.clearRedrawFlags) {\n      this._needsRedraw = false;\n    }\n\n    return redraw;\n  }\n\n  finalize() {\n    const {\n      renderBuffers\n    } = this;\n\n    for (const buffer of renderBuffers) {\n      buffer.delete();\n    }\n\n    renderBuffers.length = 0;\n  }\n\n  _preRender(effects, opts) {\n    let lastPostProcessEffect = null;\n\n    for (const effect of effects) {\n      effect.preRender(this.gl, opts);\n\n      if (effect.postRender) {\n        lastPostProcessEffect = effect;\n      }\n    }\n\n    if (lastPostProcessEffect) {\n      this._resizeRenderBuffers();\n    }\n\n    this.lastPostProcessEffect = lastPostProcessEffect;\n  }\n\n  _resizeRenderBuffers() {\n    const {\n      renderBuffers\n    } = this;\n\n    if (renderBuffers.length === 0) {\n      renderBuffers.push(new Framebuffer(this.gl), new Framebuffer(this.gl));\n    }\n\n    for (const buffer of renderBuffers) {\n      buffer.resize();\n    }\n  }\n\n  _postRender(effects, opts) {\n    const {\n      renderBuffers\n    } = this;\n    const params = {\n      inputBuffer: renderBuffers[0],\n      swapBuffer: renderBuffers[1],\n      target: null\n    };\n\n    for (const effect of effects) {\n      if (effect.postRender) {\n        if (effect === this.lastPostProcessEffect) {\n          params.target = opts.target;\n          effect.postRender(this.gl, params);\n          break;\n        }\n\n        const buffer = effect.postRender(this.gl, params);\n        params.inputBuffer = buffer;\n        params.swapBuffer = buffer === renderBuffers[0] ? renderBuffers[1] : renderBuffers[0];\n      }\n    }\n  }\n\n}\n//# sourceMappingURL=deck-renderer.js.map","import log from '../../utils/log';\nconst NO_PICKED_OBJECT = {\n  pickedColor: null,\n  pickedObjectIndex: -1\n};\nexport function getClosestObject({\n  pickedColors,\n  decodePickingColor,\n  deviceX,\n  deviceY,\n  deviceRadius,\n  deviceRect\n}) {\n  const {\n    x,\n    y,\n    width,\n    height\n  } = deviceRect;\n  let minSquareDistanceToCenter = deviceRadius * deviceRadius;\n  let closestPixelIndex = -1;\n  let i = 0;\n\n  for (let row = 0; row < height; row++) {\n    const dy = row + y - deviceY;\n    const dy2 = dy * dy;\n\n    if (dy2 > minSquareDistanceToCenter) {\n      i += 4 * width;\n    } else {\n      for (let col = 0; col < width; col++) {\n        const pickedLayerIndex = pickedColors[i + 3] - 1;\n\n        if (pickedLayerIndex >= 0) {\n          const dx = col + x - deviceX;\n          const d2 = dx * dx + dy2;\n\n          if (d2 <= minSquareDistanceToCenter) {\n            minSquareDistanceToCenter = d2;\n            closestPixelIndex = i;\n          }\n        }\n\n        i += 4;\n      }\n    }\n  }\n\n  if (closestPixelIndex >= 0) {\n    const pickedColor = pickedColors.slice(closestPixelIndex, closestPixelIndex + 4);\n    const pickedObject = decodePickingColor(pickedColor);\n\n    if (pickedObject) {\n      const dy = Math.floor(closestPixelIndex / 4 / width);\n      const dx = closestPixelIndex / 4 - dy * width;\n      return { ...pickedObject,\n        pickedColor,\n        pickedX: x + dx,\n        pickedY: y + dy\n      };\n    }\n\n    log.error('Picked non-existent layer. Is picking buffer corrupt?')();\n  }\n\n  return NO_PICKED_OBJECT;\n}\nexport function getUniqueObjects({\n  pickedColors,\n  decodePickingColor\n}) {\n  const uniqueColors = new Map();\n\n  if (pickedColors) {\n    for (let i = 0; i < pickedColors.length; i += 4) {\n      const pickedLayerIndex = pickedColors[i + 3] - 1;\n\n      if (pickedLayerIndex >= 0) {\n        const pickedColor = pickedColors.slice(i, i + 4);\n        const colorKey = pickedColor.join(',');\n\n        if (!uniqueColors.has(colorKey)) {\n          const pickedObject = decodePickingColor(pickedColor);\n\n          if (pickedObject) {\n            uniqueColors.set(colorKey, { ...pickedObject,\n              color: pickedColor\n            });\n          } else {\n            log.error('Picked non-existent layer. Is picking buffer corrupt?')();\n          }\n        }\n      }\n    }\n  }\n\n  return Array.from(uniqueColors.values());\n}\n//# sourceMappingURL=query-object.js.map","export function getEmptyPickingInfo({\n  pickInfo,\n  viewports,\n  pixelRatio,\n  x,\n  y,\n  z\n}) {\n  let pickedViewport = viewports[0];\n\n  if (viewports.length > 1) {\n    pickedViewport = getViewportFromCoordinates((pickInfo === null || pickInfo === void 0 ? void 0 : pickInfo.pickedViewports) || viewports, {\n      x,\n      y\n    });\n  }\n\n  let coordinate;\n\n  if (pickedViewport) {\n    const point = [x - pickedViewport.x, y - pickedViewport.y];\n\n    if (z !== undefined) {\n      point[2] = z;\n    }\n\n    coordinate = pickedViewport.unproject(point);\n  }\n\n  return {\n    color: null,\n    layer: null,\n    viewport: pickedViewport,\n    index: -1,\n    picked: false,\n    x,\n    y,\n    pixel: [x, y],\n    coordinate,\n    devicePixel: pickInfo && 'pickedX' in pickInfo ? [pickInfo.pickedX, pickInfo.pickedY] : undefined,\n    pixelRatio\n  };\n}\nexport function processPickInfo(opts) {\n  const {\n    pickInfo,\n    lastPickedInfo,\n    mode,\n    layers\n  } = opts;\n  const {\n    pickedColor,\n    pickedLayer,\n    pickedObjectIndex\n  } = pickInfo;\n  const affectedLayers = pickedLayer ? [pickedLayer] : [];\n\n  if (mode === 'hover') {\n    const lastPickedPixelIndex = lastPickedInfo.index;\n    const lastPickedLayerId = lastPickedInfo.layerId;\n    const pickedLayerId = pickedLayer ? pickedLayer.props.id : null;\n\n    if (pickedLayerId !== lastPickedLayerId || pickedObjectIndex !== lastPickedPixelIndex) {\n      if (pickedLayerId !== lastPickedLayerId) {\n        const lastPickedLayer = layers.find(layer => layer.props.id === lastPickedLayerId);\n\n        if (lastPickedLayer) {\n          affectedLayers.unshift(lastPickedLayer);\n        }\n      }\n\n      lastPickedInfo.layerId = pickedLayerId;\n      lastPickedInfo.index = pickedObjectIndex;\n      lastPickedInfo.info = null;\n    }\n  }\n\n  const baseInfo = getEmptyPickingInfo(opts);\n  const infos = new Map();\n  infos.set(null, baseInfo);\n  affectedLayers.forEach(layer => {\n    let info = { ...baseInfo\n    };\n\n    if (layer === pickedLayer) {\n      info.color = pickedColor;\n      info.index = pickedObjectIndex;\n      info.picked = true;\n    }\n\n    info = getLayerPickingInfo({\n      layer,\n      info,\n      mode\n    });\n    const rootLayer = info.layer;\n\n    if (layer === pickedLayer && mode === 'hover') {\n      lastPickedInfo.info = info;\n    }\n\n    infos.set(rootLayer.id, info);\n\n    if (mode === 'hover') {\n      rootLayer.updateAutoHighlight(info);\n    }\n  });\n  return infos;\n}\nexport function getLayerPickingInfo({\n  layer,\n  info,\n  mode\n}) {\n  while (layer && info) {\n    const sourceLayer = info.layer || null;\n    info.sourceLayer = sourceLayer;\n    info.layer = layer;\n    info = layer.getPickingInfo({\n      info,\n      mode,\n      sourceLayer\n    });\n    layer = layer.parent;\n  }\n\n  return info;\n}\n\nfunction getViewportFromCoordinates(viewports, pixel) {\n  for (let i = viewports.length - 1; i >= 0; i--) {\n    const viewport = viewports[i];\n\n    if (viewport.containsPixel(pixel)) {\n      return viewport;\n    }\n  }\n\n  return viewports[0];\n}\n//# sourceMappingURL=pick-info.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { Framebuffer, Texture2D, isWebGL2, readPixelsToArray, cssToDeviceRatio, cssToDevicePixels } from '@luma.gl/core';\nimport PickLayersPass from '../passes/pick-layers-pass';\nimport { getClosestObject, getUniqueObjects } from './picking/query-object';\nimport { processPickInfo, getLayerPickingInfo, getEmptyPickingInfo } from './picking/pick-info';\nexport default class DeckPicker {\n  constructor(gl) {\n    _defineProperty(this, \"gl\", void 0);\n\n    _defineProperty(this, \"pickingFBO\", void 0);\n\n    _defineProperty(this, \"depthFBO\", void 0);\n\n    _defineProperty(this, \"pickLayersPass\", void 0);\n\n    _defineProperty(this, \"layerFilter\", void 0);\n\n    _defineProperty(this, \"lastPickedInfo\", void 0);\n\n    _defineProperty(this, \"_pickable\", true);\n\n    this.gl = gl;\n    this.pickLayersPass = new PickLayersPass(gl);\n    this.lastPickedInfo = {\n      index: -1,\n      layerId: null,\n      info: null\n    };\n  }\n\n  setProps(props) {\n    if ('layerFilter' in props) {\n      this.layerFilter = props.layerFilter;\n    }\n\n    if ('_pickable' in props) {\n      this._pickable = props._pickable;\n    }\n  }\n\n  finalize() {\n    if (this.pickingFBO) {\n      this.pickingFBO.delete();\n    }\n\n    if (this.depthFBO) {\n      this.depthFBO.color.delete();\n      this.depthFBO.delete();\n    }\n  }\n\n  pickObject(opts) {\n    return this._pickClosestObject(opts);\n  }\n\n  pickObjects(opts) {\n    return this._pickVisibleObjects(opts);\n  }\n\n  getLastPickedObject({\n    x,\n    y,\n    layers,\n    viewports\n  }, lastPickedInfo = this.lastPickedInfo.info) {\n    const lastPickedLayerId = lastPickedInfo && lastPickedInfo.layer && lastPickedInfo.layer.id;\n    const lastPickedViewportId = lastPickedInfo && lastPickedInfo.viewport && lastPickedInfo.viewport.id;\n    const layer = lastPickedLayerId ? layers.find(l => l.id === lastPickedLayerId) : null;\n    const viewport = lastPickedViewportId && viewports.find(v => v.id === lastPickedViewportId) || viewports[0];\n    const coordinate = viewport && viewport.unproject([x - viewport.x, y - viewport.y]);\n    const info = {\n      x,\n      y,\n      viewport,\n      coordinate,\n      layer\n    };\n    return { ...lastPickedInfo,\n      ...info\n    };\n  }\n\n  _resizeBuffer() {\n    var _this$pickingFBO, _this$depthFBO;\n\n    const {\n      gl\n    } = this;\n\n    if (!this.pickingFBO) {\n      this.pickingFBO = new Framebuffer(gl);\n\n      if (Framebuffer.isSupported(gl, {\n        colorBufferFloat: true\n      })) {\n        const depthFBO = new Framebuffer(gl);\n        depthFBO.attach({\n          [36064]: new Texture2D(gl, {\n            format: isWebGL2(gl) ? 34836 : 6408,\n            type: 5126\n          })\n        });\n        this.depthFBO = depthFBO;\n      }\n    }\n\n    (_this$pickingFBO = this.pickingFBO) === null || _this$pickingFBO === void 0 ? void 0 : _this$pickingFBO.resize({\n      width: gl.canvas.width,\n      height: gl.canvas.height\n    });\n    (_this$depthFBO = this.depthFBO) === null || _this$depthFBO === void 0 ? void 0 : _this$depthFBO.resize({\n      width: gl.canvas.width,\n      height: gl.canvas.height\n    });\n  }\n\n  _getPickable(layers) {\n    if (this._pickable === false) {\n      return null;\n    }\n\n    const pickableLayers = layers.filter(layer => layer.isPickable() && !layer.isComposite);\n    return pickableLayers.length ? pickableLayers : null;\n  }\n\n  _pickClosestObject({\n    layers,\n    views,\n    viewports,\n    x,\n    y,\n    radius = 0,\n    depth = 1,\n    mode = 'query',\n    unproject3D,\n    onViewportActive,\n    effects\n  }) {\n    const pickableLayers = this._getPickable(layers);\n\n    const pixelRatio = cssToDeviceRatio(this.gl);\n\n    if (!pickableLayers) {\n      return {\n        result: [],\n        emptyInfo: getEmptyPickingInfo({\n          viewports,\n          x,\n          y,\n          pixelRatio\n        })\n      };\n    }\n\n    this._resizeBuffer();\n\n    const devicePixelRange = cssToDevicePixels(this.gl, [x, y], true);\n    const devicePixel = [devicePixelRange.x + Math.floor(devicePixelRange.width / 2), devicePixelRange.y + Math.floor(devicePixelRange.height / 2)];\n    const deviceRadius = Math.round(radius * pixelRatio);\n    const {\n      width,\n      height\n    } = this.pickingFBO;\n\n    const deviceRect = this._getPickingRect({\n      deviceX: devicePixel[0],\n      deviceY: devicePixel[1],\n      deviceRadius,\n      deviceWidth: width,\n      deviceHeight: height\n    });\n\n    const cullRect = {\n      x: x - radius,\n      y: y - radius,\n      width: radius * 2 + 1,\n      height: radius * 2 + 1\n    };\n    let infos;\n    const result = [];\n    const affectedLayers = new Set();\n\n    for (let i = 0; i < depth; i++) {\n      let pickInfo;\n\n      if (deviceRect) {\n        const pickedResult = this._drawAndSample({\n          layers: pickableLayers,\n          views,\n          viewports,\n          onViewportActive,\n          deviceRect,\n          cullRect,\n          effects,\n          pass: \"picking:\".concat(mode)\n        });\n\n        pickInfo = getClosestObject({ ...pickedResult,\n          deviceX: devicePixel[0],\n          deviceY: devicePixel[1],\n          deviceRadius,\n          deviceRect\n        });\n      } else {\n        pickInfo = {\n          pickedColor: null,\n          pickedObjectIndex: -1\n        };\n      }\n\n      let z;\n\n      if (pickInfo.pickedLayer && unproject3D && this.depthFBO) {\n        const pickedResultPass2 = this._drawAndSample({\n          layers: [pickInfo.pickedLayer],\n          views,\n          viewports,\n          onViewportActive,\n          deviceRect: {\n            x: pickInfo.pickedX,\n            y: pickInfo.pickedY,\n            width: 1,\n            height: 1\n          },\n          cullRect,\n          effects,\n          pass: \"picking:\".concat(mode, \":z\")\n        }, true);\n\n        z = pickedResultPass2.pickedColors[0];\n      }\n\n      if (pickInfo.pickedLayer && i + 1 < depth) {\n        affectedLayers.add(pickInfo.pickedLayer);\n        pickInfo.pickedLayer.disablePickingIndex(pickInfo.pickedObjectIndex);\n      }\n\n      infos = processPickInfo({\n        pickInfo,\n        lastPickedInfo: this.lastPickedInfo,\n        mode,\n        layers: pickableLayers,\n        viewports,\n        x,\n        y,\n        z,\n        pixelRatio\n      });\n\n      for (const info of infos.values()) {\n        if (info.layer) {\n          result.push(info);\n        }\n      }\n\n      if (!pickInfo.pickedColor) {\n        break;\n      }\n    }\n\n    for (const layer of affectedLayers) {\n      layer.restorePickingColors();\n    }\n\n    return {\n      result,\n      emptyInfo: infos.get(null)\n    };\n  }\n\n  _pickVisibleObjects({\n    layers,\n    views,\n    viewports,\n    x,\n    y,\n    width = 1,\n    height = 1,\n    mode = 'query',\n    maxObjects = null,\n    onViewportActive,\n    effects\n  }) {\n    const pickableLayers = this._getPickable(layers);\n\n    if (!pickableLayers) {\n      return [];\n    }\n\n    this._resizeBuffer();\n\n    const pixelRatio = cssToDeviceRatio(this.gl);\n    const leftTop = cssToDevicePixels(this.gl, [x, y], true);\n    const deviceLeft = leftTop.x;\n    const deviceTop = leftTop.y + leftTop.height;\n    const rightBottom = cssToDevicePixels(this.gl, [x + width, y + height], true);\n    const deviceRight = rightBottom.x + rightBottom.width;\n    const deviceBottom = rightBottom.y;\n    const deviceRect = {\n      x: deviceLeft,\n      y: deviceBottom,\n      width: deviceRight - deviceLeft,\n      height: deviceTop - deviceBottom\n    };\n\n    const pickedResult = this._drawAndSample({\n      layers: pickableLayers,\n      views,\n      viewports,\n      onViewportActive,\n      deviceRect,\n      cullRect: {\n        x,\n        y,\n        width,\n        height\n      },\n      effects,\n      pass: \"picking:\".concat(mode)\n    });\n\n    const pickInfos = getUniqueObjects(pickedResult);\n    const uniqueInfos = new Map();\n    const isMaxObjects = Number.isFinite(maxObjects);\n\n    for (let i = 0; i < pickInfos.length; i++) {\n      if (isMaxObjects && maxObjects && uniqueInfos.size >= maxObjects) {\n        break;\n      }\n\n      const pickInfo = pickInfos[i];\n      let info = {\n        color: pickInfo.pickedColor,\n        layer: null,\n        index: pickInfo.pickedObjectIndex,\n        picked: true,\n        x,\n        y,\n        pixelRatio\n      };\n      info = getLayerPickingInfo({\n        layer: pickInfo.pickedLayer,\n        info,\n        mode\n      });\n\n      if (!uniqueInfos.has(info.object)) {\n        uniqueInfos.set(info.object, info);\n      }\n    }\n\n    return Array.from(uniqueInfos.values());\n  }\n\n  _drawAndSample({\n    layers,\n    views,\n    viewports,\n    onViewportActive,\n    deviceRect,\n    cullRect,\n    effects,\n    pass\n  }, pickZ = false) {\n    const pickingFBO = pickZ ? this.depthFBO : this.pickingFBO;\n    const {\n      decodePickingColor\n    } = this.pickLayersPass.render({\n      layers,\n      layerFilter: this.layerFilter,\n      views,\n      viewports,\n      onViewportActive,\n      pickingFBO,\n      deviceRect,\n      cullRect,\n      effects,\n      pass,\n      pickZ\n    });\n    const {\n      x,\n      y,\n      width,\n      height\n    } = deviceRect;\n    const pickedColors = new (pickZ ? Float32Array : Uint8Array)(width * height * 4);\n    readPixelsToArray(pickingFBO, {\n      sourceX: x,\n      sourceY: y,\n      sourceWidth: width,\n      sourceHeight: height,\n      target: pickedColors\n    });\n    return {\n      pickedColors,\n      decodePickingColor\n    };\n  }\n\n  _getPickingRect({\n    deviceX,\n    deviceY,\n    deviceRadius,\n    deviceWidth,\n    deviceHeight\n  }) {\n    const x = Math.max(0, deviceX - deviceRadius);\n    const y = Math.max(0, deviceY - deviceRadius);\n    const width = Math.min(deviceWidth, deviceX + deviceRadius + 1) - x;\n    const height = Math.min(deviceHeight, deviceY + deviceRadius + 1) - y;\n\n    if (width <= 0 || height <= 0) {\n      return null;\n    }\n\n    return {\n      x,\n      y,\n      width,\n      height\n    };\n  }\n\n}\n//# sourceMappingURL=deck-picker.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nconst defaultStyle = {\n  zIndex: '1',\n  position: 'absolute',\n  pointerEvents: 'none',\n  color: '#a0a7b4',\n  backgroundColor: '#29323c',\n  padding: '10px',\n  top: '0',\n  left: '0',\n  display: 'none'\n};\nexport default class Tooltip {\n  constructor(canvas) {\n    _defineProperty(this, \"el\", null);\n\n    _defineProperty(this, \"isVisible\", false);\n\n    const canvasParent = canvas.parentElement;\n\n    if (canvasParent) {\n      this.el = document.createElement('div');\n      this.el.className = 'deck-tooltip';\n      Object.assign(this.el.style, defaultStyle);\n      canvasParent.appendChild(this.el);\n    }\n  }\n\n  setTooltip(displayInfo, x, y) {\n    const el = this.el;\n\n    if (!el) {\n      return;\n    }\n\n    if (typeof displayInfo === 'string') {\n      el.innerText = displayInfo;\n    } else if (!displayInfo) {\n      this.isVisible = false;\n      el.style.display = 'none';\n      return;\n    } else {\n      if (displayInfo.text) {\n        el.innerText = displayInfo.text;\n      }\n\n      if (displayInfo.html) {\n        el.innerHTML = displayInfo.html;\n      }\n\n      if (displayInfo.className) {\n        el.className = displayInfo.className;\n      }\n\n      Object.assign(el.style, displayInfo.style);\n    }\n\n    this.isVisible = true;\n    el.style.display = 'block';\n    el.style.transform = \"translate(\".concat(x, \"px, \").concat(y, \"px)\");\n  }\n\n  remove() {\n    if (this.el) {\n      this.el.remove();\n      this.el = null;\n    }\n  }\n\n}\n//# sourceMappingURL=tooltip.js.map","/*! Hammer.JS - v2.0.7 - 2016-04-22\n * http://hammerjs.github.io/\n *\n * Copyright (c) 2016 Jorik Tangelder;\n * Licensed under the MIT license */\n(function(window, document, exportName, undefined) {\n  'use strict';\n\nvar VENDOR_PREFIXES = ['', 'webkit', 'Moz', 'MS', 'ms', 'o'];\nvar TEST_ELEMENT = document.createElement('div');\n\nvar TYPE_FUNCTION = 'function';\n\nvar round = Math.round;\nvar abs = Math.abs;\nvar now = Date.now;\n\n/**\n * set a timeout with a given scope\n * @param {Function} fn\n * @param {Number} timeout\n * @param {Object} context\n * @returns {number}\n */\nfunction setTimeoutContext(fn, timeout, context) {\n    return setTimeout(bindFn(fn, context), timeout);\n}\n\n/**\n * if the argument is an array, we want to execute the fn on each entry\n * if it aint an array we don't want to do a thing.\n * this is used by all the methods that accept a single and array argument.\n * @param {*|Array} arg\n * @param {String} fn\n * @param {Object} [context]\n * @returns {Boolean}\n */\nfunction invokeArrayArg(arg, fn, context) {\n    if (Array.isArray(arg)) {\n        each(arg, context[fn], context);\n        return true;\n    }\n    return false;\n}\n\n/**\n * walk objects and arrays\n * @param {Object} obj\n * @param {Function} iterator\n * @param {Object} context\n */\nfunction each(obj, iterator, context) {\n    var i;\n\n    if (!obj) {\n        return;\n    }\n\n    if (obj.forEach) {\n        obj.forEach(iterator, context);\n    } else if (obj.length !== undefined) {\n        i = 0;\n        while (i < obj.length) {\n            iterator.call(context, obj[i], i, obj);\n            i++;\n        }\n    } else {\n        for (i in obj) {\n            obj.hasOwnProperty(i) && iterator.call(context, obj[i], i, obj);\n        }\n    }\n}\n\n/**\n * wrap a method with a deprecation warning and stack trace\n * @param {Function} method\n * @param {String} name\n * @param {String} message\n * @returns {Function} A new function wrapping the supplied method.\n */\nfunction deprecate(method, name, message) {\n    var deprecationMessage = 'DEPRECATED METHOD: ' + name + '\\n' + message + ' AT \\n';\n    return function() {\n        var e = new Error('get-stack-trace');\n        var stack = e && e.stack ? e.stack.replace(/^[^\\(]+?[\\n$]/gm, '')\n            .replace(/^\\s+at\\s+/gm, '')\n            .replace(/^Object.<anonymous>\\s*\\(/gm, '{anonymous}()@') : 'Unknown Stack Trace';\n\n        var log = window.console && (window.console.warn || window.console.log);\n        if (log) {\n            log.call(window.console, deprecationMessage, stack);\n        }\n        return method.apply(this, arguments);\n    };\n}\n\n/**\n * extend object.\n * means that properties in dest will be overwritten by the ones in src.\n * @param {Object} target\n * @param {...Object} objects_to_assign\n * @returns {Object} target\n */\nvar assign;\nif (typeof Object.assign !== 'function') {\n    assign = function assign(target) {\n        if (target === undefined || target === null) {\n            throw new TypeError('Cannot convert undefined or null to object');\n        }\n\n        var output = Object(target);\n        for (var index = 1; index < arguments.length; index++) {\n            var source = arguments[index];\n            if (source !== undefined && source !== null) {\n                for (var nextKey in source) {\n                    if (source.hasOwnProperty(nextKey)) {\n                        output[nextKey] = source[nextKey];\n                    }\n                }\n            }\n        }\n        return output;\n    };\n} else {\n    assign = Object.assign;\n}\n\n/**\n * extend object.\n * means that properties in dest will be overwritten by the ones in src.\n * @param {Object} dest\n * @param {Object} src\n * @param {Boolean} [merge=false]\n * @returns {Object} dest\n */\nvar extend = deprecate(function extend(dest, src, merge) {\n    var keys = Object.keys(src);\n    var i = 0;\n    while (i < keys.length) {\n        if (!merge || (merge && dest[keys[i]] === undefined)) {\n            dest[keys[i]] = src[keys[i]];\n        }\n        i++;\n    }\n    return dest;\n}, 'extend', 'Use `assign`.');\n\n/**\n * merge the values from src in the dest.\n * means that properties that exist in dest will not be overwritten by src\n * @param {Object} dest\n * @param {Object} src\n * @returns {Object} dest\n */\nvar merge = deprecate(function merge(dest, src) {\n    return extend(dest, src, true);\n}, 'merge', 'Use `assign`.');\n\n/**\n * simple class inheritance\n * @param {Function} child\n * @param {Function} base\n * @param {Object} [properties]\n */\nfunction inherit(child, base, properties) {\n    var baseP = base.prototype,\n        childP;\n\n    childP = child.prototype = Object.create(baseP);\n    childP.constructor = child;\n    childP._super = baseP;\n\n    if (properties) {\n        assign(childP, properties);\n    }\n}\n\n/**\n * simple function bind\n * @param {Function} fn\n * @param {Object} context\n * @returns {Function}\n */\nfunction bindFn(fn, context) {\n    return function boundFn() {\n        return fn.apply(context, arguments);\n    };\n}\n\n/**\n * let a boolean value also be a function that must return a boolean\n * this first item in args will be used as the context\n * @param {Boolean|Function} val\n * @param {Array} [args]\n * @returns {Boolean}\n */\nfunction boolOrFn(val, args) {\n    if (typeof val == TYPE_FUNCTION) {\n        return val.apply(args ? args[0] || undefined : undefined, args);\n    }\n    return val;\n}\n\n/**\n * use the val2 when val1 is undefined\n * @param {*} val1\n * @param {*} val2\n * @returns {*}\n */\nfunction ifUndefined(val1, val2) {\n    return (val1 === undefined) ? val2 : val1;\n}\n\n/**\n * addEventListener with multiple events at once\n * @param {EventTarget} target\n * @param {String} types\n * @param {Function} handler\n */\nfunction addEventListeners(target, types, handler) {\n    each(splitStr(types), function(type) {\n        target.addEventListener(type, handler, false);\n    });\n}\n\n/**\n * removeEventListener with multiple events at once\n * @param {EventTarget} target\n * @param {String} types\n * @param {Function} handler\n */\nfunction removeEventListeners(target, types, handler) {\n    each(splitStr(types), function(type) {\n        target.removeEventListener(type, handler, false);\n    });\n}\n\n/**\n * find if a node is in the given parent\n * @method hasParent\n * @param {HTMLElement} node\n * @param {HTMLElement} parent\n * @return {Boolean} found\n */\nfunction hasParent(node, parent) {\n    while (node) {\n        if (node == parent) {\n            return true;\n        }\n        node = node.parentNode;\n    }\n    return false;\n}\n\n/**\n * small indexOf wrapper\n * @param {String} str\n * @param {String} find\n * @returns {Boolean} found\n */\nfunction inStr(str, find) {\n    return str.indexOf(find) > -1;\n}\n\n/**\n * split string on whitespace\n * @param {String} str\n * @returns {Array} words\n */\nfunction splitStr(str) {\n    return str.trim().split(/\\s+/g);\n}\n\n/**\n * find if a array contains the object using indexOf or a simple polyFill\n * @param {Array} src\n * @param {String} find\n * @param {String} [findByKey]\n * @return {Boolean|Number} false when not found, or the index\n */\nfunction inArray(src, find, findByKey) {\n    if (src.indexOf && !findByKey) {\n        return src.indexOf(find);\n    } else {\n        var i = 0;\n        while (i < src.length) {\n            if ((findByKey && src[i][findByKey] == find) || (!findByKey && src[i] === find)) {\n                return i;\n            }\n            i++;\n        }\n        return -1;\n    }\n}\n\n/**\n * convert array-like objects to real arrays\n * @param {Object} obj\n * @returns {Array}\n */\nfunction toArray(obj) {\n    return Array.prototype.slice.call(obj, 0);\n}\n\n/**\n * unique array with objects based on a key (like 'id') or just by the array's value\n * @param {Array} src [{id:1},{id:2},{id:1}]\n * @param {String} [key]\n * @param {Boolean} [sort=False]\n * @returns {Array} [{id:1},{id:2}]\n */\nfunction uniqueArray(src, key, sort) {\n    var results = [];\n    var values = [];\n    var i = 0;\n\n    while (i < src.length) {\n        var val = key ? src[i][key] : src[i];\n        if (inArray(values, val) < 0) {\n            results.push(src[i]);\n        }\n        values[i] = val;\n        i++;\n    }\n\n    if (sort) {\n        if (!key) {\n            results = results.sort();\n        } else {\n            results = results.sort(function sortUniqueArray(a, b) {\n                return a[key] > b[key];\n            });\n        }\n    }\n\n    return results;\n}\n\n/**\n * get the prefixed property\n * @param {Object} obj\n * @param {String} property\n * @returns {String|Undefined} prefixed\n */\nfunction prefixed(obj, property) {\n    var prefix, prop;\n    var camelProp = property[0].toUpperCase() + property.slice(1);\n\n    var i = 0;\n    while (i < VENDOR_PREFIXES.length) {\n        prefix = VENDOR_PREFIXES[i];\n        prop = (prefix) ? prefix + camelProp : property;\n\n        if (prop in obj) {\n            return prop;\n        }\n        i++;\n    }\n    return undefined;\n}\n\n/**\n * get a unique id\n * @returns {number} uniqueId\n */\nvar _uniqueId = 1;\nfunction uniqueId() {\n    return _uniqueId++;\n}\n\n/**\n * get the window object of an element\n * @param {HTMLElement} element\n * @returns {DocumentView|Window}\n */\nfunction getWindowForElement(element) {\n    var doc = element.ownerDocument || element;\n    return (doc.defaultView || doc.parentWindow || window);\n}\n\nvar MOBILE_REGEX = /mobile|tablet|ip(ad|hone|od)|android/i;\n\nvar SUPPORT_TOUCH = ('ontouchstart' in window);\nvar SUPPORT_POINTER_EVENTS = prefixed(window, 'PointerEvent') !== undefined;\nvar SUPPORT_ONLY_TOUCH = SUPPORT_TOUCH && MOBILE_REGEX.test(navigator.userAgent);\n\nvar INPUT_TYPE_TOUCH = 'touch';\nvar INPUT_TYPE_PEN = 'pen';\nvar INPUT_TYPE_MOUSE = 'mouse';\nvar INPUT_TYPE_KINECT = 'kinect';\n\nvar COMPUTE_INTERVAL = 25;\n\nvar INPUT_START = 1;\nvar INPUT_MOVE = 2;\nvar INPUT_END = 4;\nvar INPUT_CANCEL = 8;\n\nvar DIRECTION_NONE = 1;\nvar DIRECTION_LEFT = 2;\nvar DIRECTION_RIGHT = 4;\nvar DIRECTION_UP = 8;\nvar DIRECTION_DOWN = 16;\n\nvar DIRECTION_HORIZONTAL = DIRECTION_LEFT | DIRECTION_RIGHT;\nvar DIRECTION_VERTICAL = DIRECTION_UP | DIRECTION_DOWN;\nvar DIRECTION_ALL = DIRECTION_HORIZONTAL | DIRECTION_VERTICAL;\n\nvar PROPS_XY = ['x', 'y'];\nvar PROPS_CLIENT_XY = ['clientX', 'clientY'];\n\n/**\n * create new input type manager\n * @param {Manager} manager\n * @param {Function} callback\n * @returns {Input}\n * @constructor\n */\nfunction Input(manager, callback) {\n    var self = this;\n    this.manager = manager;\n    this.callback = callback;\n    this.element = manager.element;\n    this.target = manager.options.inputTarget;\n\n    // smaller wrapper around the handler, for the scope and the enabled state of the manager,\n    // so when disabled the input events are completely bypassed.\n    this.domHandler = function(ev) {\n        if (boolOrFn(manager.options.enable, [manager])) {\n            self.handler(ev);\n        }\n    };\n\n    this.init();\n\n}\n\nInput.prototype = {\n    /**\n     * should handle the inputEvent data and trigger the callback\n     * @virtual\n     */\n    handler: function() { },\n\n    /**\n     * bind the events\n     */\n    init: function() {\n        this.evEl && addEventListeners(this.element, this.evEl, this.domHandler);\n        this.evTarget && addEventListeners(this.target, this.evTarget, this.domHandler);\n        this.evWin && addEventListeners(getWindowForElement(this.element), this.evWin, this.domHandler);\n    },\n\n    /**\n     * unbind the events\n     */\n    destroy: function() {\n        this.evEl && removeEventListeners(this.element, this.evEl, this.domHandler);\n        this.evTarget && removeEventListeners(this.target, this.evTarget, this.domHandler);\n        this.evWin && removeEventListeners(getWindowForElement(this.element), this.evWin, this.domHandler);\n    }\n};\n\n/**\n * create new input type manager\n * called by the Manager constructor\n * @param {Hammer} manager\n * @returns {Input}\n */\nfunction createInputInstance(manager) {\n    var Type;\n    var inputClass = manager.options.inputClass;\n\n    if (inputClass) {\n        Type = inputClass;\n    } else if (SUPPORT_POINTER_EVENTS) {\n        Type = PointerEventInput;\n    } else if (SUPPORT_ONLY_TOUCH) {\n        Type = TouchInput;\n    } else if (!SUPPORT_TOUCH) {\n        Type = MouseInput;\n    } else {\n        Type = TouchMouseInput;\n    }\n    return new (Type)(manager, inputHandler);\n}\n\n/**\n * handle input events\n * @param {Manager} manager\n * @param {String} eventType\n * @param {Object} input\n */\nfunction inputHandler(manager, eventType, input) {\n    var pointersLen = input.pointers.length;\n    var changedPointersLen = input.changedPointers.length;\n    var isFirst = (eventType & INPUT_START && (pointersLen - changedPointersLen === 0));\n    var isFinal = (eventType & (INPUT_END | INPUT_CANCEL) && (pointersLen - changedPointersLen === 0));\n\n    input.isFirst = !!isFirst;\n    input.isFinal = !!isFinal;\n\n    if (isFirst) {\n        manager.session = {};\n    }\n\n    // source event is the normalized value of the domEvents\n    // like 'touchstart, mouseup, pointerdown'\n    input.eventType = eventType;\n\n    // compute scale, rotation etc\n    computeInputData(manager, input);\n\n    // emit secret event\n    manager.emit('hammer.input', input);\n\n    manager.recognize(input);\n    manager.session.prevInput = input;\n}\n\n/**\n * extend the data with some usable properties like scale, rotate, velocity etc\n * @param {Object} manager\n * @param {Object} input\n */\nfunction computeInputData(manager, input) {\n    var session = manager.session;\n    var pointers = input.pointers;\n    var pointersLength = pointers.length;\n\n    // store the first input to calculate the distance and direction\n    if (!session.firstInput) {\n        session.firstInput = simpleCloneInputData(input);\n    }\n\n    // to compute scale and rotation we need to store the multiple touches\n    if (pointersLength > 1 && !session.firstMultiple) {\n        session.firstMultiple = simpleCloneInputData(input);\n    } else if (pointersLength === 1) {\n        session.firstMultiple = false;\n    }\n\n    var firstInput = session.firstInput;\n    var firstMultiple = session.firstMultiple;\n    var offsetCenter = firstMultiple ? firstMultiple.center : firstInput.center;\n\n    var center = input.center = getCenter(pointers);\n    input.timeStamp = now();\n    input.deltaTime = input.timeStamp - firstInput.timeStamp;\n\n    input.angle = getAngle(offsetCenter, center);\n    input.distance = getDistance(offsetCenter, center);\n\n    computeDeltaXY(session, input);\n    input.offsetDirection = getDirection(input.deltaX, input.deltaY);\n\n    var overallVelocity = getVelocity(input.deltaTime, input.deltaX, input.deltaY);\n    input.overallVelocityX = overallVelocity.x;\n    input.overallVelocityY = overallVelocity.y;\n    input.overallVelocity = (abs(overallVelocity.x) > abs(overallVelocity.y)) ? overallVelocity.x : overallVelocity.y;\n\n    input.scale = firstMultiple ? getScale(firstMultiple.pointers, pointers) : 1;\n    input.rotation = firstMultiple ? getRotation(firstMultiple.pointers, pointers) : 0;\n\n    input.maxPointers = !session.prevInput ? input.pointers.length : ((input.pointers.length >\n        session.prevInput.maxPointers) ? input.pointers.length : session.prevInput.maxPointers);\n\n    computeIntervalInputData(session, input);\n\n    // find the correct target\n    var target = manager.element;\n    if (hasParent(input.srcEvent.target, target)) {\n        target = input.srcEvent.target;\n    }\n    input.target = target;\n}\n\nfunction computeDeltaXY(session, input) {\n    var center = input.center;\n    var offset = session.offsetDelta || {};\n    var prevDelta = session.prevDelta || {};\n    var prevInput = session.prevInput || {};\n\n    if (input.eventType === INPUT_START || prevInput.eventType === INPUT_END) {\n        prevDelta = session.prevDelta = {\n            x: prevInput.deltaX || 0,\n            y: prevInput.deltaY || 0\n        };\n\n        offset = session.offsetDelta = {\n            x: center.x,\n            y: center.y\n        };\n    }\n\n    input.deltaX = prevDelta.x + (center.x - offset.x);\n    input.deltaY = prevDelta.y + (center.y - offset.y);\n}\n\n/**\n * velocity is calculated every x ms\n * @param {Object} session\n * @param {Object} input\n */\nfunction computeIntervalInputData(session, input) {\n    var last = session.lastInterval || input,\n        deltaTime = input.timeStamp - last.timeStamp,\n        velocity, velocityX, velocityY, direction;\n\n    if (input.eventType != INPUT_CANCEL && (deltaTime > COMPUTE_INTERVAL || last.velocity === undefined)) {\n        var deltaX = input.deltaX - last.deltaX;\n        var deltaY = input.deltaY - last.deltaY;\n\n        var v = getVelocity(deltaTime, deltaX, deltaY);\n        velocityX = v.x;\n        velocityY = v.y;\n        velocity = (abs(v.x) > abs(v.y)) ? v.x : v.y;\n        direction = getDirection(deltaX, deltaY);\n\n        session.lastInterval = input;\n    } else {\n        // use latest velocity info if it doesn't overtake a minimum period\n        velocity = last.velocity;\n        velocityX = last.velocityX;\n        velocityY = last.velocityY;\n        direction = last.direction;\n    }\n\n    input.velocity = velocity;\n    input.velocityX = velocityX;\n    input.velocityY = velocityY;\n    input.direction = direction;\n}\n\n/**\n * create a simple clone from the input used for storage of firstInput and firstMultiple\n * @param {Object} input\n * @returns {Object} clonedInputData\n */\nfunction simpleCloneInputData(input) {\n    // make a simple copy of the pointers because we will get a reference if we don't\n    // we only need clientXY for the calculations\n    var pointers = [];\n    var i = 0;\n    while (i < input.pointers.length) {\n        pointers[i] = {\n            clientX: round(input.pointers[i].clientX),\n            clientY: round(input.pointers[i].clientY)\n        };\n        i++;\n    }\n\n    return {\n        timeStamp: now(),\n        pointers: pointers,\n        center: getCenter(pointers),\n        deltaX: input.deltaX,\n        deltaY: input.deltaY\n    };\n}\n\n/**\n * get the center of all the pointers\n * @param {Array} pointers\n * @return {Object} center contains `x` and `y` properties\n */\nfunction getCenter(pointers) {\n    var pointersLength = pointers.length;\n\n    // no need to loop when only one touch\n    if (pointersLength === 1) {\n        return {\n            x: round(pointers[0].clientX),\n            y: round(pointers[0].clientY)\n        };\n    }\n\n    var x = 0, y = 0, i = 0;\n    while (i < pointersLength) {\n        x += pointers[i].clientX;\n        y += pointers[i].clientY;\n        i++;\n    }\n\n    return {\n        x: round(x / pointersLength),\n        y: round(y / pointersLength)\n    };\n}\n\n/**\n * calculate the velocity between two points. unit is in px per ms.\n * @param {Number} deltaTime\n * @param {Number} x\n * @param {Number} y\n * @return {Object} velocity `x` and `y`\n */\nfunction getVelocity(deltaTime, x, y) {\n    return {\n        x: x / deltaTime || 0,\n        y: y / deltaTime || 0\n    };\n}\n\n/**\n * get the direction between two points\n * @param {Number} x\n * @param {Number} y\n * @return {Number} direction\n */\nfunction getDirection(x, y) {\n    if (x === y) {\n        return DIRECTION_NONE;\n    }\n\n    if (abs(x) >= abs(y)) {\n        return x < 0 ? DIRECTION_LEFT : DIRECTION_RIGHT;\n    }\n    return y < 0 ? DIRECTION_UP : DIRECTION_DOWN;\n}\n\n/**\n * calculate the absolute distance between two points\n * @param {Object} p1 {x, y}\n * @param {Object} p2 {x, y}\n * @param {Array} [props] containing x and y keys\n * @return {Number} distance\n */\nfunction getDistance(p1, p2, props) {\n    if (!props) {\n        props = PROPS_XY;\n    }\n    var x = p2[props[0]] - p1[props[0]],\n        y = p2[props[1]] - p1[props[1]];\n\n    return Math.sqrt((x * x) + (y * y));\n}\n\n/**\n * calculate the angle between two coordinates\n * @param {Object} p1\n * @param {Object} p2\n * @param {Array} [props] containing x and y keys\n * @return {Number} angle\n */\nfunction getAngle(p1, p2, props) {\n    if (!props) {\n        props = PROPS_XY;\n    }\n    var x = p2[props[0]] - p1[props[0]],\n        y = p2[props[1]] - p1[props[1]];\n    return Math.atan2(y, x) * 180 / Math.PI;\n}\n\n/**\n * calculate the rotation degrees between two pointersets\n * @param {Array} start array of pointers\n * @param {Array} end array of pointers\n * @return {Number} rotation\n */\nfunction getRotation(start, end) {\n    return getAngle(end[1], end[0], PROPS_CLIENT_XY) + getAngle(start[1], start[0], PROPS_CLIENT_XY);\n}\n\n/**\n * calculate the scale factor between two pointersets\n * no scale is 1, and goes down to 0 when pinched together, and bigger when pinched out\n * @param {Array} start array of pointers\n * @param {Array} end array of pointers\n * @return {Number} scale\n */\nfunction getScale(start, end) {\n    return getDistance(end[0], end[1], PROPS_CLIENT_XY) / getDistance(start[0], start[1], PROPS_CLIENT_XY);\n}\n\nvar MOUSE_INPUT_MAP = {\n    mousedown: INPUT_START,\n    mousemove: INPUT_MOVE,\n    mouseup: INPUT_END\n};\n\nvar MOUSE_ELEMENT_EVENTS = 'mousedown';\nvar MOUSE_WINDOW_EVENTS = 'mousemove mouseup';\n\n/**\n * Mouse events input\n * @constructor\n * @extends Input\n */\nfunction MouseInput() {\n    this.evEl = MOUSE_ELEMENT_EVENTS;\n    this.evWin = MOUSE_WINDOW_EVENTS;\n\n    this.pressed = false; // mousedown state\n\n    Input.apply(this, arguments);\n}\n\ninherit(MouseInput, Input, {\n    /**\n     * handle mouse events\n     * @param {Object} ev\n     */\n    handler: function MEhandler(ev) {\n        var eventType = MOUSE_INPUT_MAP[ev.type];\n\n        // on start we want to have the left mouse button down\n        if (eventType & INPUT_START && ev.button === 0) {\n            this.pressed = true;\n        }\n\n        if (eventType & INPUT_MOVE && ev.which !== 1) {\n            eventType = INPUT_END;\n        }\n\n        // mouse must be down\n        if (!this.pressed) {\n            return;\n        }\n\n        if (eventType & INPUT_END) {\n            this.pressed = false;\n        }\n\n        this.callback(this.manager, eventType, {\n            pointers: [ev],\n            changedPointers: [ev],\n            pointerType: INPUT_TYPE_MOUSE,\n            srcEvent: ev\n        });\n    }\n});\n\nvar POINTER_INPUT_MAP = {\n    pointerdown: INPUT_START,\n    pointermove: INPUT_MOVE,\n    pointerup: INPUT_END,\n    pointercancel: INPUT_CANCEL,\n    pointerout: INPUT_CANCEL\n};\n\n// in IE10 the pointer types is defined as an enum\nvar IE10_POINTER_TYPE_ENUM = {\n    2: INPUT_TYPE_TOUCH,\n    3: INPUT_TYPE_PEN,\n    4: INPUT_TYPE_MOUSE,\n    5: INPUT_TYPE_KINECT // see https://twitter.com/jacobrossi/status/480596438489890816\n};\n\nvar POINTER_ELEMENT_EVENTS = 'pointerdown';\nvar POINTER_WINDOW_EVENTS = 'pointermove pointerup pointercancel';\n\n// IE10 has prefixed support, and case-sensitive\nif (window.MSPointerEvent && !window.PointerEvent) {\n    POINTER_ELEMENT_EVENTS = 'MSPointerDown';\n    POINTER_WINDOW_EVENTS = 'MSPointerMove MSPointerUp MSPointerCancel';\n}\n\n/**\n * Pointer events input\n * @constructor\n * @extends Input\n */\nfunction PointerEventInput() {\n    this.evEl = POINTER_ELEMENT_EVENTS;\n    this.evWin = POINTER_WINDOW_EVENTS;\n\n    Input.apply(this, arguments);\n\n    this.store = (this.manager.session.pointerEvents = []);\n}\n\ninherit(PointerEventInput, Input, {\n    /**\n     * handle mouse events\n     * @param {Object} ev\n     */\n    handler: function PEhandler(ev) {\n        var store = this.store;\n        var removePointer = false;\n\n        var eventTypeNormalized = ev.type.toLowerCase().replace('ms', '');\n        var eventType = POINTER_INPUT_MAP[eventTypeNormalized];\n        var pointerType = IE10_POINTER_TYPE_ENUM[ev.pointerType] || ev.pointerType;\n\n        var isTouch = (pointerType == INPUT_TYPE_TOUCH);\n\n        // get index of the event in the store\n        var storeIndex = inArray(store, ev.pointerId, 'pointerId');\n\n        // start and mouse must be down\n        if (eventType & INPUT_START && (ev.button === 0 || isTouch)) {\n            if (storeIndex < 0) {\n                store.push(ev);\n                storeIndex = store.length - 1;\n            }\n        } else if (eventType & (INPUT_END | INPUT_CANCEL)) {\n            removePointer = true;\n        }\n\n        // it not found, so the pointer hasn't been down (so it's probably a hover)\n        if (storeIndex < 0) {\n            return;\n        }\n\n        // update the event in the store\n        store[storeIndex] = ev;\n\n        this.callback(this.manager, eventType, {\n            pointers: store,\n            changedPointers: [ev],\n            pointerType: pointerType,\n            srcEvent: ev\n        });\n\n        if (removePointer) {\n            // remove from the store\n            store.splice(storeIndex, 1);\n        }\n    }\n});\n\nvar SINGLE_TOUCH_INPUT_MAP = {\n    touchstart: INPUT_START,\n    touchmove: INPUT_MOVE,\n    touchend: INPUT_END,\n    touchcancel: INPUT_CANCEL\n};\n\nvar SINGLE_TOUCH_TARGET_EVENTS = 'touchstart';\nvar SINGLE_TOUCH_WINDOW_EVENTS = 'touchstart touchmove touchend touchcancel';\n\n/**\n * Touch events input\n * @constructor\n * @extends Input\n */\nfunction SingleTouchInput() {\n    this.evTarget = SINGLE_TOUCH_TARGET_EVENTS;\n    this.evWin = SINGLE_TOUCH_WINDOW_EVENTS;\n    this.started = false;\n\n    Input.apply(this, arguments);\n}\n\ninherit(SingleTouchInput, Input, {\n    handler: function TEhandler(ev) {\n        var type = SINGLE_TOUCH_INPUT_MAP[ev.type];\n\n        // should we handle the touch events?\n        if (type === INPUT_START) {\n            this.started = true;\n        }\n\n        if (!this.started) {\n            return;\n        }\n\n        var touches = normalizeSingleTouches.call(this, ev, type);\n\n        // when done, reset the started state\n        if (type & (INPUT_END | INPUT_CANCEL) && touches[0].length - touches[1].length === 0) {\n            this.started = false;\n        }\n\n        this.callback(this.manager, type, {\n            pointers: touches[0],\n            changedPointers: touches[1],\n            pointerType: INPUT_TYPE_TOUCH,\n            srcEvent: ev\n        });\n    }\n});\n\n/**\n * @this {TouchInput}\n * @param {Object} ev\n * @param {Number} type flag\n * @returns {undefined|Array} [all, changed]\n */\nfunction normalizeSingleTouches(ev, type) {\n    var all = toArray(ev.touches);\n    var changed = toArray(ev.changedTouches);\n\n    if (type & (INPUT_END | INPUT_CANCEL)) {\n        all = uniqueArray(all.concat(changed), 'identifier', true);\n    }\n\n    return [all, changed];\n}\n\nvar TOUCH_INPUT_MAP = {\n    touchstart: INPUT_START,\n    touchmove: INPUT_MOVE,\n    touchend: INPUT_END,\n    touchcancel: INPUT_CANCEL\n};\n\nvar TOUCH_TARGET_EVENTS = 'touchstart touchmove touchend touchcancel';\n\n/**\n * Multi-user touch events input\n * @constructor\n * @extends Input\n */\nfunction TouchInput() {\n    this.evTarget = TOUCH_TARGET_EVENTS;\n    this.targetIds = {};\n\n    Input.apply(this, arguments);\n}\n\ninherit(TouchInput, Input, {\n    handler: function MTEhandler(ev) {\n        var type = TOUCH_INPUT_MAP[ev.type];\n        var touches = getTouches.call(this, ev, type);\n        if (!touches) {\n            return;\n        }\n\n        this.callback(this.manager, type, {\n            pointers: touches[0],\n            changedPointers: touches[1],\n            pointerType: INPUT_TYPE_TOUCH,\n            srcEvent: ev\n        });\n    }\n});\n\n/**\n * @this {TouchInput}\n * @param {Object} ev\n * @param {Number} type flag\n * @returns {undefined|Array} [all, changed]\n */\nfunction getTouches(ev, type) {\n    var allTouches = toArray(ev.touches);\n    var targetIds = this.targetIds;\n\n    // when there is only one touch, the process can be simplified\n    if (type & (INPUT_START | INPUT_MOVE) && allTouches.length === 1) {\n        targetIds[allTouches[0].identifier] = true;\n        return [allTouches, allTouches];\n    }\n\n    var i,\n        targetTouches,\n        changedTouches = toArray(ev.changedTouches),\n        changedTargetTouches = [],\n        target = this.target;\n\n    // get target touches from touches\n    targetTouches = allTouches.filter(function(touch) {\n        return hasParent(touch.target, target);\n    });\n\n    // collect touches\n    if (type === INPUT_START) {\n        i = 0;\n        while (i < targetTouches.length) {\n            targetIds[targetTouches[i].identifier] = true;\n            i++;\n        }\n    }\n\n    // filter changed touches to only contain touches that exist in the collected target ids\n    i = 0;\n    while (i < changedTouches.length) {\n        if (targetIds[changedTouches[i].identifier]) {\n            changedTargetTouches.push(changedTouches[i]);\n        }\n\n        // cleanup removed touches\n        if (type & (INPUT_END | INPUT_CANCEL)) {\n            delete targetIds[changedTouches[i].identifier];\n        }\n        i++;\n    }\n\n    if (!changedTargetTouches.length) {\n        return;\n    }\n\n    return [\n        // merge targetTouches with changedTargetTouches so it contains ALL touches, including 'end' and 'cancel'\n        uniqueArray(targetTouches.concat(changedTargetTouches), 'identifier', true),\n        changedTargetTouches\n    ];\n}\n\n/**\n * Combined touch and mouse input\n *\n * Touch has a higher priority then mouse, and while touching no mouse events are allowed.\n * This because touch devices also emit mouse events while doing a touch.\n *\n * @constructor\n * @extends Input\n */\n\nvar DEDUP_TIMEOUT = 2500;\nvar DEDUP_DISTANCE = 25;\n\nfunction TouchMouseInput() {\n    Input.apply(this, arguments);\n\n    var handler = bindFn(this.handler, this);\n    this.touch = new TouchInput(this.manager, handler);\n    this.mouse = new MouseInput(this.manager, handler);\n\n    this.primaryTouch = null;\n    this.lastTouches = [];\n}\n\ninherit(TouchMouseInput, Input, {\n    /**\n     * handle mouse and touch events\n     * @param {Hammer} manager\n     * @param {String} inputEvent\n     * @param {Object} inputData\n     */\n    handler: function TMEhandler(manager, inputEvent, inputData) {\n        var isTouch = (inputData.pointerType == INPUT_TYPE_TOUCH),\n            isMouse = (inputData.pointerType == INPUT_TYPE_MOUSE);\n\n        if (isMouse && inputData.sourceCapabilities && inputData.sourceCapabilities.firesTouchEvents) {\n            return;\n        }\n\n        // when we're in a touch event, record touches to  de-dupe synthetic mouse event\n        if (isTouch) {\n            recordTouches.call(this, inputEvent, inputData);\n        } else if (isMouse && isSyntheticEvent.call(this, inputData)) {\n            return;\n        }\n\n        this.callback(manager, inputEvent, inputData);\n    },\n\n    /**\n     * remove the event listeners\n     */\n    destroy: function destroy() {\n        this.touch.destroy();\n        this.mouse.destroy();\n    }\n});\n\nfunction recordTouches(eventType, eventData) {\n    if (eventType & INPUT_START) {\n        this.primaryTouch = eventData.changedPointers[0].identifier;\n        setLastTouch.call(this, eventData);\n    } else if (eventType & (INPUT_END | INPUT_CANCEL)) {\n        setLastTouch.call(this, eventData);\n    }\n}\n\nfunction setLastTouch(eventData) {\n    var touch = eventData.changedPointers[0];\n\n    if (touch.identifier === this.primaryTouch) {\n        var lastTouch = {x: touch.clientX, y: touch.clientY};\n        this.lastTouches.push(lastTouch);\n        var lts = this.lastTouches;\n        var removeLastTouch = function() {\n            var i = lts.indexOf(lastTouch);\n            if (i > -1) {\n                lts.splice(i, 1);\n            }\n        };\n        setTimeout(removeLastTouch, DEDUP_TIMEOUT);\n    }\n}\n\nfunction isSyntheticEvent(eventData) {\n    var x = eventData.srcEvent.clientX, y = eventData.srcEvent.clientY;\n    for (var i = 0; i < this.lastTouches.length; i++) {\n        var t = this.lastTouches[i];\n        var dx = Math.abs(x - t.x), dy = Math.abs(y - t.y);\n        if (dx <= DEDUP_DISTANCE && dy <= DEDUP_DISTANCE) {\n            return true;\n        }\n    }\n    return false;\n}\n\nvar PREFIXED_TOUCH_ACTION = prefixed(TEST_ELEMENT.style, 'touchAction');\nvar NATIVE_TOUCH_ACTION = PREFIXED_TOUCH_ACTION !== undefined;\n\n// magical touchAction value\nvar TOUCH_ACTION_COMPUTE = 'compute';\nvar TOUCH_ACTION_AUTO = 'auto';\nvar TOUCH_ACTION_MANIPULATION = 'manipulation'; // not implemented\nvar TOUCH_ACTION_NONE = 'none';\nvar TOUCH_ACTION_PAN_X = 'pan-x';\nvar TOUCH_ACTION_PAN_Y = 'pan-y';\nvar TOUCH_ACTION_MAP = getTouchActionProps();\n\n/**\n * Touch Action\n * sets the touchAction property or uses the js alternative\n * @param {Manager} manager\n * @param {String} value\n * @constructor\n */\nfunction TouchAction(manager, value) {\n    this.manager = manager;\n    this.set(value);\n}\n\nTouchAction.prototype = {\n    /**\n     * set the touchAction value on the element or enable the polyfill\n     * @param {String} value\n     */\n    set: function(value) {\n        // find out the touch-action by the event handlers\n        if (value == TOUCH_ACTION_COMPUTE) {\n            value = this.compute();\n        }\n\n        if (NATIVE_TOUCH_ACTION && this.manager.element.style && TOUCH_ACTION_MAP[value]) {\n            this.manager.element.style[PREFIXED_TOUCH_ACTION] = value;\n        }\n        this.actions = value.toLowerCase().trim();\n    },\n\n    /**\n     * just re-set the touchAction value\n     */\n    update: function() {\n        this.set(this.manager.options.touchAction);\n    },\n\n    /**\n     * compute the value for the touchAction property based on the recognizer's settings\n     * @returns {String} value\n     */\n    compute: function() {\n        var actions = [];\n        each(this.manager.recognizers, function(recognizer) {\n            if (boolOrFn(recognizer.options.enable, [recognizer])) {\n                actions = actions.concat(recognizer.getTouchAction());\n            }\n        });\n        return cleanTouchActions(actions.join(' '));\n    },\n\n    /**\n     * this method is called on each input cycle and provides the preventing of the browser behavior\n     * @param {Object} input\n     */\n    preventDefaults: function(input) {\n        var srcEvent = input.srcEvent;\n        var direction = input.offsetDirection;\n\n        // if the touch action did prevented once this session\n        if (this.manager.session.prevented) {\n            srcEvent.preventDefault();\n            return;\n        }\n\n        var actions = this.actions;\n        var hasNone = inStr(actions, TOUCH_ACTION_NONE) && !TOUCH_ACTION_MAP[TOUCH_ACTION_NONE];\n        var hasPanY = inStr(actions, TOUCH_ACTION_PAN_Y) && !TOUCH_ACTION_MAP[TOUCH_ACTION_PAN_Y];\n        var hasPanX = inStr(actions, TOUCH_ACTION_PAN_X) && !TOUCH_ACTION_MAP[TOUCH_ACTION_PAN_X];\n\n        if (hasNone) {\n            //do not prevent defaults if this is a tap gesture\n\n            var isTapPointer = input.pointers.length === 1;\n            var isTapMovement = input.distance < 2;\n            var isTapTouchTime = input.deltaTime < 250;\n\n            if (isTapPointer && isTapMovement && isTapTouchTime) {\n                return;\n            }\n        }\n\n        if (hasPanX && hasPanY) {\n            // `pan-x pan-y` means browser handles all scrolling/panning, do not prevent\n            return;\n        }\n\n        if (hasNone ||\n            (hasPanY && direction & DIRECTION_HORIZONTAL) ||\n            (hasPanX && direction & DIRECTION_VERTICAL)) {\n            return this.preventSrc(srcEvent);\n        }\n    },\n\n    /**\n     * call preventDefault to prevent the browser's default behavior (scrolling in most cases)\n     * @param {Object} srcEvent\n     */\n    preventSrc: function(srcEvent) {\n        this.manager.session.prevented = true;\n        srcEvent.preventDefault();\n    }\n};\n\n/**\n * when the touchActions are collected they are not a valid value, so we need to clean things up. *\n * @param {String} actions\n * @returns {*}\n */\nfunction cleanTouchActions(actions) {\n    // none\n    if (inStr(actions, TOUCH_ACTION_NONE)) {\n        return TOUCH_ACTION_NONE;\n    }\n\n    var hasPanX = inStr(actions, TOUCH_ACTION_PAN_X);\n    var hasPanY = inStr(actions, TOUCH_ACTION_PAN_Y);\n\n    // if both pan-x and pan-y are set (different recognizers\n    // for different directions, e.g. horizontal pan but vertical swipe?)\n    // we need none (as otherwise with pan-x pan-y combined none of these\n    // recognizers will work, since the browser would handle all panning\n    if (hasPanX && hasPanY) {\n        return TOUCH_ACTION_NONE;\n    }\n\n    // pan-x OR pan-y\n    if (hasPanX || hasPanY) {\n        return hasPanX ? TOUCH_ACTION_PAN_X : TOUCH_ACTION_PAN_Y;\n    }\n\n    // manipulation\n    if (inStr(actions, TOUCH_ACTION_MANIPULATION)) {\n        return TOUCH_ACTION_MANIPULATION;\n    }\n\n    return TOUCH_ACTION_AUTO;\n}\n\nfunction getTouchActionProps() {\n    if (!NATIVE_TOUCH_ACTION) {\n        return false;\n    }\n    var touchMap = {};\n    var cssSupports = window.CSS && window.CSS.supports;\n    ['auto', 'manipulation', 'pan-y', 'pan-x', 'pan-x pan-y', 'none'].forEach(function(val) {\n\n        // If css.supports is not supported but there is native touch-action assume it supports\n        // all values. This is the case for IE 10 and 11.\n        touchMap[val] = cssSupports ? window.CSS.supports('touch-action', val) : true;\n    });\n    return touchMap;\n}\n\n/**\n * Recognizer flow explained; *\n * All recognizers have the initial state of POSSIBLE when a input session starts.\n * The definition of a input session is from the first input until the last input, with all it's movement in it. *\n * Example session for mouse-input: mousedown -> mousemove -> mouseup\n *\n * On each recognizing cycle (see Manager.recognize) the .recognize() method is executed\n * which determines with state it should be.\n *\n * If the recognizer has the state FAILED, CANCELLED or RECOGNIZED (equals ENDED), it is reset to\n * POSSIBLE to give it another change on the next cycle.\n *\n *               Possible\n *                  |\n *            +-----+---------------+\n *            |                     |\n *      +-----+-----+               |\n *      |           |               |\n *   Failed      Cancelled          |\n *                          +-------+------+\n *                          |              |\n *                      Recognized       Began\n *                                         |\n *                                      Changed\n *                                         |\n *                                  Ended/Recognized\n */\nvar STATE_POSSIBLE = 1;\nvar STATE_BEGAN = 2;\nvar STATE_CHANGED = 4;\nvar STATE_ENDED = 8;\nvar STATE_RECOGNIZED = STATE_ENDED;\nvar STATE_CANCELLED = 16;\nvar STATE_FAILED = 32;\n\n/**\n * Recognizer\n * Every recognizer needs to extend from this class.\n * @constructor\n * @param {Object} options\n */\nfunction Recognizer(options) {\n    this.options = assign({}, this.defaults, options || {});\n\n    this.id = uniqueId();\n\n    this.manager = null;\n\n    // default is enable true\n    this.options.enable = ifUndefined(this.options.enable, true);\n\n    this.state = STATE_POSSIBLE;\n\n    this.simultaneous = {};\n    this.requireFail = [];\n}\n\nRecognizer.prototype = {\n    /**\n     * @virtual\n     * @type {Object}\n     */\n    defaults: {},\n\n    /**\n     * set options\n     * @param {Object} options\n     * @return {Recognizer}\n     */\n    set: function(options) {\n        assign(this.options, options);\n\n        // also update the touchAction, in case something changed about the directions/enabled state\n        this.manager && this.manager.touchAction.update();\n        return this;\n    },\n\n    /**\n     * recognize simultaneous with an other recognizer.\n     * @param {Recognizer} otherRecognizer\n     * @returns {Recognizer} this\n     */\n    recognizeWith: function(otherRecognizer) {\n        if (invokeArrayArg(otherRecognizer, 'recognizeWith', this)) {\n            return this;\n        }\n\n        var simultaneous = this.simultaneous;\n        otherRecognizer = getRecognizerByNameIfManager(otherRecognizer, this);\n        if (!simultaneous[otherRecognizer.id]) {\n            simultaneous[otherRecognizer.id] = otherRecognizer;\n            otherRecognizer.recognizeWith(this);\n        }\n        return this;\n    },\n\n    /**\n     * drop the simultaneous link. it doesnt remove the link on the other recognizer.\n     * @param {Recognizer} otherRecognizer\n     * @returns {Recognizer} this\n     */\n    dropRecognizeWith: function(otherRecognizer) {\n        if (invokeArrayArg(otherRecognizer, 'dropRecognizeWith', this)) {\n            return this;\n        }\n\n        otherRecognizer = getRecognizerByNameIfManager(otherRecognizer, this);\n        delete this.simultaneous[otherRecognizer.id];\n        return this;\n    },\n\n    /**\n     * recognizer can only run when an other is failing\n     * @param {Recognizer} otherRecognizer\n     * @returns {Recognizer} this\n     */\n    requireFailure: function(otherRecognizer) {\n        if (invokeArrayArg(otherRecognizer, 'requireFailure', this)) {\n            return this;\n        }\n\n        var requireFail = this.requireFail;\n        otherRecognizer = getRecognizerByNameIfManager(otherRecognizer, this);\n        if (inArray(requireFail, otherRecognizer) === -1) {\n            requireFail.push(otherRecognizer);\n            otherRecognizer.requireFailure(this);\n        }\n        return this;\n    },\n\n    /**\n     * drop the requireFailure link. it does not remove the link on the other recognizer.\n     * @param {Recognizer} otherRecognizer\n     * @returns {Recognizer} this\n     */\n    dropRequireFailure: function(otherRecognizer) {\n        if (invokeArrayArg(otherRecognizer, 'dropRequireFailure', this)) {\n            return this;\n        }\n\n        otherRecognizer = getRecognizerByNameIfManager(otherRecognizer, this);\n        var index = inArray(this.requireFail, otherRecognizer);\n        if (index > -1) {\n            this.requireFail.splice(index, 1);\n        }\n        return this;\n    },\n\n    /**\n     * has require failures boolean\n     * @returns {boolean}\n     */\n    hasRequireFailures: function() {\n        return this.requireFail.length > 0;\n    },\n\n    /**\n     * if the recognizer can recognize simultaneous with an other recognizer\n     * @param {Recognizer} otherRecognizer\n     * @returns {Boolean}\n     */\n    canRecognizeWith: function(otherRecognizer) {\n        return !!this.simultaneous[otherRecognizer.id];\n    },\n\n    /**\n     * You should use `tryEmit` instead of `emit` directly to check\n     * that all the needed recognizers has failed before emitting.\n     * @param {Object} input\n     */\n    emit: function(input) {\n        var self = this;\n        var state = this.state;\n\n        function emit(event) {\n            self.manager.emit(event, input);\n        }\n\n        // 'panstart' and 'panmove'\n        if (state < STATE_ENDED) {\n            emit(self.options.event + stateStr(state));\n        }\n\n        emit(self.options.event); // simple 'eventName' events\n\n        if (input.additionalEvent) { // additional event(panleft, panright, pinchin, pinchout...)\n            emit(input.additionalEvent);\n        }\n\n        // panend and pancancel\n        if (state >= STATE_ENDED) {\n            emit(self.options.event + stateStr(state));\n        }\n    },\n\n    /**\n     * Check that all the require failure recognizers has failed,\n     * if true, it emits a gesture event,\n     * otherwise, setup the state to FAILED.\n     * @param {Object} input\n     */\n    tryEmit: function(input) {\n        if (this.canEmit()) {\n            return this.emit(input);\n        }\n        // it's failing anyway\n        this.state = STATE_FAILED;\n    },\n\n    /**\n     * can we emit?\n     * @returns {boolean}\n     */\n    canEmit: function() {\n        var i = 0;\n        while (i < this.requireFail.length) {\n            if (!(this.requireFail[i].state & (STATE_FAILED | STATE_POSSIBLE))) {\n                return false;\n            }\n            i++;\n        }\n        return true;\n    },\n\n    /**\n     * update the recognizer\n     * @param {Object} inputData\n     */\n    recognize: function(inputData) {\n        // make a new copy of the inputData\n        // so we can change the inputData without messing up the other recognizers\n        var inputDataClone = assign({}, inputData);\n\n        // is is enabled and allow recognizing?\n        if (!boolOrFn(this.options.enable, [this, inputDataClone])) {\n            this.reset();\n            this.state = STATE_FAILED;\n            return;\n        }\n\n        // reset when we've reached the end\n        if (this.state & (STATE_RECOGNIZED | STATE_CANCELLED | STATE_FAILED)) {\n            this.state = STATE_POSSIBLE;\n        }\n\n        this.state = this.process(inputDataClone);\n\n        // the recognizer has recognized a gesture\n        // so trigger an event\n        if (this.state & (STATE_BEGAN | STATE_CHANGED | STATE_ENDED | STATE_CANCELLED)) {\n            this.tryEmit(inputDataClone);\n        }\n    },\n\n    /**\n     * return the state of the recognizer\n     * the actual recognizing happens in this method\n     * @virtual\n     * @param {Object} inputData\n     * @returns {Const} STATE\n     */\n    process: function(inputData) { }, // jshint ignore:line\n\n    /**\n     * return the preferred touch-action\n     * @virtual\n     * @returns {Array}\n     */\n    getTouchAction: function() { },\n\n    /**\n     * called when the gesture isn't allowed to recognize\n     * like when another is being recognized or it is disabled\n     * @virtual\n     */\n    reset: function() { }\n};\n\n/**\n * get a usable string, used as event postfix\n * @param {Const} state\n * @returns {String} state\n */\nfunction stateStr(state) {\n    if (state & STATE_CANCELLED) {\n        return 'cancel';\n    } else if (state & STATE_ENDED) {\n        return 'end';\n    } else if (state & STATE_CHANGED) {\n        return 'move';\n    } else if (state & STATE_BEGAN) {\n        return 'start';\n    }\n    return '';\n}\n\n/**\n * direction cons to string\n * @param {Const} direction\n * @returns {String}\n */\nfunction directionStr(direction) {\n    if (direction == DIRECTION_DOWN) {\n        return 'down';\n    } else if (direction == DIRECTION_UP) {\n        return 'up';\n    } else if (direction == DIRECTION_LEFT) {\n        return 'left';\n    } else if (direction == DIRECTION_RIGHT) {\n        return 'right';\n    }\n    return '';\n}\n\n/**\n * get a recognizer by name if it is bound to a manager\n * @param {Recognizer|String} otherRecognizer\n * @param {Recognizer} recognizer\n * @returns {Recognizer}\n */\nfunction getRecognizerByNameIfManager(otherRecognizer, recognizer) {\n    var manager = recognizer.manager;\n    if (manager) {\n        return manager.get(otherRecognizer);\n    }\n    return otherRecognizer;\n}\n\n/**\n * This recognizer is just used as a base for the simple attribute recognizers.\n * @constructor\n * @extends Recognizer\n */\nfunction AttrRecognizer() {\n    Recognizer.apply(this, arguments);\n}\n\ninherit(AttrRecognizer, Recognizer, {\n    /**\n     * @namespace\n     * @memberof AttrRecognizer\n     */\n    defaults: {\n        /**\n         * @type {Number}\n         * @default 1\n         */\n        pointers: 1\n    },\n\n    /**\n     * Used to check if it the recognizer receives valid input, like input.distance > 10.\n     * @memberof AttrRecognizer\n     * @param {Object} input\n     * @returns {Boolean} recognized\n     */\n    attrTest: function(input) {\n        var optionPointers = this.options.pointers;\n        return optionPointers === 0 || input.pointers.length === optionPointers;\n    },\n\n    /**\n     * Process the input and return the state for the recognizer\n     * @memberof AttrRecognizer\n     * @param {Object} input\n     * @returns {*} State\n     */\n    process: function(input) {\n        var state = this.state;\n        var eventType = input.eventType;\n\n        var isRecognized = state & (STATE_BEGAN | STATE_CHANGED);\n        var isValid = this.attrTest(input);\n\n        // on cancel input and we've recognized before, return STATE_CANCELLED\n        if (isRecognized && (eventType & INPUT_CANCEL || !isValid)) {\n            return state | STATE_CANCELLED;\n        } else if (isRecognized || isValid) {\n            if (eventType & INPUT_END) {\n                return state | STATE_ENDED;\n            } else if (!(state & STATE_BEGAN)) {\n                return STATE_BEGAN;\n            }\n            return state | STATE_CHANGED;\n        }\n        return STATE_FAILED;\n    }\n});\n\n/**\n * Pan\n * Recognized when the pointer is down and moved in the allowed direction.\n * @constructor\n * @extends AttrRecognizer\n */\nfunction PanRecognizer() {\n    AttrRecognizer.apply(this, arguments);\n\n    this.pX = null;\n    this.pY = null;\n}\n\ninherit(PanRecognizer, AttrRecognizer, {\n    /**\n     * @namespace\n     * @memberof PanRecognizer\n     */\n    defaults: {\n        event: 'pan',\n        threshold: 10,\n        pointers: 1,\n        direction: DIRECTION_ALL\n    },\n\n    getTouchAction: function() {\n        var direction = this.options.direction;\n        var actions = [];\n        if (direction & DIRECTION_HORIZONTAL) {\n            actions.push(TOUCH_ACTION_PAN_Y);\n        }\n        if (direction & DIRECTION_VERTICAL) {\n            actions.push(TOUCH_ACTION_PAN_X);\n        }\n        return actions;\n    },\n\n    directionTest: function(input) {\n        var options = this.options;\n        var hasMoved = true;\n        var distance = input.distance;\n        var direction = input.direction;\n        var x = input.deltaX;\n        var y = input.deltaY;\n\n        // lock to axis?\n        if (!(direction & options.direction)) {\n            if (options.direction & DIRECTION_HORIZONTAL) {\n                direction = (x === 0) ? DIRECTION_NONE : (x < 0) ? DIRECTION_LEFT : DIRECTION_RIGHT;\n                hasMoved = x != this.pX;\n                distance = Math.abs(input.deltaX);\n            } else {\n                direction = (y === 0) ? DIRECTION_NONE : (y < 0) ? DIRECTION_UP : DIRECTION_DOWN;\n                hasMoved = y != this.pY;\n                distance = Math.abs(input.deltaY);\n            }\n        }\n        input.direction = direction;\n        return hasMoved && distance > options.threshold && direction & options.direction;\n    },\n\n    attrTest: function(input) {\n        return AttrRecognizer.prototype.attrTest.call(this, input) &&\n            (this.state & STATE_BEGAN || (!(this.state & STATE_BEGAN) && this.directionTest(input)));\n    },\n\n    emit: function(input) {\n\n        this.pX = input.deltaX;\n        this.pY = input.deltaY;\n\n        var direction = directionStr(input.direction);\n\n        if (direction) {\n            input.additionalEvent = this.options.event + direction;\n        }\n        this._super.emit.call(this, input);\n    }\n});\n\n/**\n * Pinch\n * Recognized when two or more pointers are moving toward (zoom-in) or away from each other (zoom-out).\n * @constructor\n * @extends AttrRecognizer\n */\nfunction PinchRecognizer() {\n    AttrRecognizer.apply(this, arguments);\n}\n\ninherit(PinchRecognizer, AttrRecognizer, {\n    /**\n     * @namespace\n     * @memberof PinchRecognizer\n     */\n    defaults: {\n        event: 'pinch',\n        threshold: 0,\n        pointers: 2\n    },\n\n    getTouchAction: function() {\n        return [TOUCH_ACTION_NONE];\n    },\n\n    attrTest: function(input) {\n        return this._super.attrTest.call(this, input) &&\n            (Math.abs(input.scale - 1) > this.options.threshold || this.state & STATE_BEGAN);\n    },\n\n    emit: function(input) {\n        if (input.scale !== 1) {\n            var inOut = input.scale < 1 ? 'in' : 'out';\n            input.additionalEvent = this.options.event + inOut;\n        }\n        this._super.emit.call(this, input);\n    }\n});\n\n/**\n * Press\n * Recognized when the pointer is down for x ms without any movement.\n * @constructor\n * @extends Recognizer\n */\nfunction PressRecognizer() {\n    Recognizer.apply(this, arguments);\n\n    this._timer = null;\n    this._input = null;\n}\n\ninherit(PressRecognizer, Recognizer, {\n    /**\n     * @namespace\n     * @memberof PressRecognizer\n     */\n    defaults: {\n        event: 'press',\n        pointers: 1,\n        time: 251, // minimal time of the pointer to be pressed\n        threshold: 9 // a minimal movement is ok, but keep it low\n    },\n\n    getTouchAction: function() {\n        return [TOUCH_ACTION_AUTO];\n    },\n\n    process: function(input) {\n        var options = this.options;\n        var validPointers = input.pointers.length === options.pointers;\n        var validMovement = input.distance < options.threshold;\n        var validTime = input.deltaTime > options.time;\n\n        this._input = input;\n\n        // we only allow little movement\n        // and we've reached an end event, so a tap is possible\n        if (!validMovement || !validPointers || (input.eventType & (INPUT_END | INPUT_CANCEL) && !validTime)) {\n            this.reset();\n        } else if (input.eventType & INPUT_START) {\n            this.reset();\n            this._timer = setTimeoutContext(function() {\n                this.state = STATE_RECOGNIZED;\n                this.tryEmit();\n            }, options.time, this);\n        } else if (input.eventType & INPUT_END) {\n            return STATE_RECOGNIZED;\n        }\n        return STATE_FAILED;\n    },\n\n    reset: function() {\n        clearTimeout(this._timer);\n    },\n\n    emit: function(input) {\n        if (this.state !== STATE_RECOGNIZED) {\n            return;\n        }\n\n        if (input && (input.eventType & INPUT_END)) {\n            this.manager.emit(this.options.event + 'up', input);\n        } else {\n            this._input.timeStamp = now();\n            this.manager.emit(this.options.event, this._input);\n        }\n    }\n});\n\n/**\n * Rotate\n * Recognized when two or more pointer are moving in a circular motion.\n * @constructor\n * @extends AttrRecognizer\n */\nfunction RotateRecognizer() {\n    AttrRecognizer.apply(this, arguments);\n}\n\ninherit(RotateRecognizer, AttrRecognizer, {\n    /**\n     * @namespace\n     * @memberof RotateRecognizer\n     */\n    defaults: {\n        event: 'rotate',\n        threshold: 0,\n        pointers: 2\n    },\n\n    getTouchAction: function() {\n        return [TOUCH_ACTION_NONE];\n    },\n\n    attrTest: function(input) {\n        return this._super.attrTest.call(this, input) &&\n            (Math.abs(input.rotation) > this.options.threshold || this.state & STATE_BEGAN);\n    }\n});\n\n/**\n * Swipe\n * Recognized when the pointer is moving fast (velocity), with enough distance in the allowed direction.\n * @constructor\n * @extends AttrRecognizer\n */\nfunction SwipeRecognizer() {\n    AttrRecognizer.apply(this, arguments);\n}\n\ninherit(SwipeRecognizer, AttrRecognizer, {\n    /**\n     * @namespace\n     * @memberof SwipeRecognizer\n     */\n    defaults: {\n        event: 'swipe',\n        threshold: 10,\n        velocity: 0.3,\n        direction: DIRECTION_HORIZONTAL | DIRECTION_VERTICAL,\n        pointers: 1\n    },\n\n    getTouchAction: function() {\n        return PanRecognizer.prototype.getTouchAction.call(this);\n    },\n\n    attrTest: function(input) {\n        var direction = this.options.direction;\n        var velocity;\n\n        if (direction & (DIRECTION_HORIZONTAL | DIRECTION_VERTICAL)) {\n            velocity = input.overallVelocity;\n        } else if (direction & DIRECTION_HORIZONTAL) {\n            velocity = input.overallVelocityX;\n        } else if (direction & DIRECTION_VERTICAL) {\n            velocity = input.overallVelocityY;\n        }\n\n        return this._super.attrTest.call(this, input) &&\n            direction & input.offsetDirection &&\n            input.distance > this.options.threshold &&\n            input.maxPointers == this.options.pointers &&\n            abs(velocity) > this.options.velocity && input.eventType & INPUT_END;\n    },\n\n    emit: function(input) {\n        var direction = directionStr(input.offsetDirection);\n        if (direction) {\n            this.manager.emit(this.options.event + direction, input);\n        }\n\n        this.manager.emit(this.options.event, input);\n    }\n});\n\n/**\n * A tap is ecognized when the pointer is doing a small tap/click. Multiple taps are recognized if they occur\n * between the given interval and position. The delay option can be used to recognize multi-taps without firing\n * a single tap.\n *\n * The eventData from the emitted event contains the property `tapCount`, which contains the amount of\n * multi-taps being recognized.\n * @constructor\n * @extends Recognizer\n */\nfunction TapRecognizer() {\n    Recognizer.apply(this, arguments);\n\n    // previous time and center,\n    // used for tap counting\n    this.pTime = false;\n    this.pCenter = false;\n\n    this._timer = null;\n    this._input = null;\n    this.count = 0;\n}\n\ninherit(TapRecognizer, Recognizer, {\n    /**\n     * @namespace\n     * @memberof PinchRecognizer\n     */\n    defaults: {\n        event: 'tap',\n        pointers: 1,\n        taps: 1,\n        interval: 300, // max time between the multi-tap taps\n        time: 250, // max time of the pointer to be down (like finger on the screen)\n        threshold: 9, // a minimal movement is ok, but keep it low\n        posThreshold: 10 // a multi-tap can be a bit off the initial position\n    },\n\n    getTouchAction: function() {\n        return [TOUCH_ACTION_MANIPULATION];\n    },\n\n    process: function(input) {\n        var options = this.options;\n\n        var validPointers = input.pointers.length === options.pointers;\n        var validMovement = input.distance < options.threshold;\n        var validTouchTime = input.deltaTime < options.time;\n\n        this.reset();\n\n        if ((input.eventType & INPUT_START) && (this.count === 0)) {\n            return this.failTimeout();\n        }\n\n        // we only allow little movement\n        // and we've reached an end event, so a tap is possible\n        if (validMovement && validTouchTime && validPointers) {\n            if (input.eventType != INPUT_END) {\n                return this.failTimeout();\n            }\n\n            var validInterval = this.pTime ? (input.timeStamp - this.pTime < options.interval) : true;\n            var validMultiTap = !this.pCenter || getDistance(this.pCenter, input.center) < options.posThreshold;\n\n            this.pTime = input.timeStamp;\n            this.pCenter = input.center;\n\n            if (!validMultiTap || !validInterval) {\n                this.count = 1;\n            } else {\n                this.count += 1;\n            }\n\n            this._input = input;\n\n            // if tap count matches we have recognized it,\n            // else it has began recognizing...\n            var tapCount = this.count % options.taps;\n            if (tapCount === 0) {\n                // no failing requirements, immediately trigger the tap event\n                // or wait as long as the multitap interval to trigger\n                if (!this.hasRequireFailures()) {\n                    return STATE_RECOGNIZED;\n                } else {\n                    this._timer = setTimeoutContext(function() {\n                        this.state = STATE_RECOGNIZED;\n                        this.tryEmit();\n                    }, options.interval, this);\n                    return STATE_BEGAN;\n                }\n            }\n        }\n        return STATE_FAILED;\n    },\n\n    failTimeout: function() {\n        this._timer = setTimeoutContext(function() {\n            this.state = STATE_FAILED;\n        }, this.options.interval, this);\n        return STATE_FAILED;\n    },\n\n    reset: function() {\n        clearTimeout(this._timer);\n    },\n\n    emit: function() {\n        if (this.state == STATE_RECOGNIZED) {\n            this._input.tapCount = this.count;\n            this.manager.emit(this.options.event, this._input);\n        }\n    }\n});\n\n/**\n * Simple way to create a manager with a default set of recognizers.\n * @param {HTMLElement} element\n * @param {Object} [options]\n * @constructor\n */\nfunction Hammer(element, options) {\n    options = options || {};\n    options.recognizers = ifUndefined(options.recognizers, Hammer.defaults.preset);\n    return new Manager(element, options);\n}\n\n/**\n * @const {string}\n */\nHammer.VERSION = '2.0.7';\n\n/**\n * default settings\n * @namespace\n */\nHammer.defaults = {\n    /**\n     * set if DOM events are being triggered.\n     * But this is slower and unused by simple implementations, so disabled by default.\n     * @type {Boolean}\n     * @default false\n     */\n    domEvents: false,\n\n    /**\n     * The value for the touchAction property/fallback.\n     * When set to `compute` it will magically set the correct value based on the added recognizers.\n     * @type {String}\n     * @default compute\n     */\n    touchAction: TOUCH_ACTION_COMPUTE,\n\n    /**\n     * @type {Boolean}\n     * @default true\n     */\n    enable: true,\n\n    /**\n     * EXPERIMENTAL FEATURE -- can be removed/changed\n     * Change the parent input target element.\n     * If Null, then it is being set the to main element.\n     * @type {Null|EventTarget}\n     * @default null\n     */\n    inputTarget: null,\n\n    /**\n     * force an input class\n     * @type {Null|Function}\n     * @default null\n     */\n    inputClass: null,\n\n    /**\n     * Default recognizer setup when calling `Hammer()`\n     * When creating a new Manager these will be skipped.\n     * @type {Array}\n     */\n    preset: [\n        // RecognizerClass, options, [recognizeWith, ...], [requireFailure, ...]\n        [RotateRecognizer, {enable: false}],\n        [PinchRecognizer, {enable: false}, ['rotate']],\n        [SwipeRecognizer, {direction: DIRECTION_HORIZONTAL}],\n        [PanRecognizer, {direction: DIRECTION_HORIZONTAL}, ['swipe']],\n        [TapRecognizer],\n        [TapRecognizer, {event: 'doubletap', taps: 2}, ['tap']],\n        [PressRecognizer]\n    ],\n\n    /**\n     * Some CSS properties can be used to improve the working of Hammer.\n     * Add them to this method and they will be set when creating a new Manager.\n     * @namespace\n     */\n    cssProps: {\n        /**\n         * Disables text selection to improve the dragging gesture. Mainly for desktop browsers.\n         * @type {String}\n         * @default 'none'\n         */\n        userSelect: 'none',\n\n        /**\n         * Disable the Windows Phone grippers when pressing an element.\n         * @type {String}\n         * @default 'none'\n         */\n        touchSelect: 'none',\n\n        /**\n         * Disables the default callout shown when you touch and hold a touch target.\n         * On iOS, when you touch and hold a touch target such as a link, Safari displays\n         * a callout containing information about the link. This property allows you to disable that callout.\n         * @type {String}\n         * @default 'none'\n         */\n        touchCallout: 'none',\n\n        /**\n         * Specifies whether zooming is enabled. Used by IE10>\n         * @type {String}\n         * @default 'none'\n         */\n        contentZooming: 'none',\n\n        /**\n         * Specifies that an entire element should be draggable instead of its contents. Mainly for desktop browsers.\n         * @type {String}\n         * @default 'none'\n         */\n        userDrag: 'none',\n\n        /**\n         * Overrides the highlight color shown when the user taps a link or a JavaScript\n         * clickable element in iOS. This property obeys the alpha value, if specified.\n         * @type {String}\n         * @default 'rgba(0,0,0,0)'\n         */\n        tapHighlightColor: 'rgba(0,0,0,0)'\n    }\n};\n\nvar STOP = 1;\nvar FORCED_STOP = 2;\n\n/**\n * Manager\n * @param {HTMLElement} element\n * @param {Object} [options]\n * @constructor\n */\nfunction Manager(element, options) {\n    this.options = assign({}, Hammer.defaults, options || {});\n\n    this.options.inputTarget = this.options.inputTarget || element;\n\n    this.handlers = {};\n    this.session = {};\n    this.recognizers = [];\n    this.oldCssProps = {};\n\n    this.element = element;\n    this.input = createInputInstance(this);\n    this.touchAction = new TouchAction(this, this.options.touchAction);\n\n    toggleCssProps(this, true);\n\n    each(this.options.recognizers, function(item) {\n        var recognizer = this.add(new (item[0])(item[1]));\n        item[2] && recognizer.recognizeWith(item[2]);\n        item[3] && recognizer.requireFailure(item[3]);\n    }, this);\n}\n\nManager.prototype = {\n    /**\n     * set options\n     * @param {Object} options\n     * @returns {Manager}\n     */\n    set: function(options) {\n        assign(this.options, options);\n\n        // Options that need a little more setup\n        if (options.touchAction) {\n            this.touchAction.update();\n        }\n        if (options.inputTarget) {\n            // Clean up existing event listeners and reinitialize\n            this.input.destroy();\n            this.input.target = options.inputTarget;\n            this.input.init();\n        }\n        return this;\n    },\n\n    /**\n     * stop recognizing for this session.\n     * This session will be discarded, when a new [input]start event is fired.\n     * When forced, the recognizer cycle is stopped immediately.\n     * @param {Boolean} [force]\n     */\n    stop: function(force) {\n        this.session.stopped = force ? FORCED_STOP : STOP;\n    },\n\n    /**\n     * run the recognizers!\n     * called by the inputHandler function on every movement of the pointers (touches)\n     * it walks through all the recognizers and tries to detect the gesture that is being made\n     * @param {Object} inputData\n     */\n    recognize: function(inputData) {\n        var session = this.session;\n        if (session.stopped) {\n            return;\n        }\n\n        // run the touch-action polyfill\n        this.touchAction.preventDefaults(inputData);\n\n        var recognizer;\n        var recognizers = this.recognizers;\n\n        // this holds the recognizer that is being recognized.\n        // so the recognizer's state needs to be BEGAN, CHANGED, ENDED or RECOGNIZED\n        // if no recognizer is detecting a thing, it is set to `null`\n        var curRecognizer = session.curRecognizer;\n\n        // reset when the last recognizer is recognized\n        // or when we're in a new session\n        if (!curRecognizer || (curRecognizer && curRecognizer.state & STATE_RECOGNIZED)) {\n            curRecognizer = session.curRecognizer = null;\n        }\n\n        var i = 0;\n        while (i < recognizers.length) {\n            recognizer = recognizers[i];\n\n            // find out if we are allowed try to recognize the input for this one.\n            // 1.   allow if the session is NOT forced stopped (see the .stop() method)\n            // 2.   allow if we still haven't recognized a gesture in this session, or the this recognizer is the one\n            //      that is being recognized.\n            // 3.   allow if the recognizer is allowed to run simultaneous with the current recognized recognizer.\n            //      this can be setup with the `recognizeWith()` method on the recognizer.\n            if (session.stopped !== FORCED_STOP && ( // 1\n                    !curRecognizer || recognizer == curRecognizer || // 2\n                    recognizer.canRecognizeWith(curRecognizer))) { // 3\n                recognizer.recognize(inputData);\n            } else {\n                recognizer.reset();\n            }\n\n            // if the recognizer has been recognizing the input as a valid gesture, we want to store this one as the\n            // current active recognizer. but only if we don't already have an active recognizer\n            if (!curRecognizer && recognizer.state & (STATE_BEGAN | STATE_CHANGED | STATE_ENDED)) {\n                curRecognizer = session.curRecognizer = recognizer;\n            }\n            i++;\n        }\n    },\n\n    /**\n     * get a recognizer by its event name.\n     * @param {Recognizer|String} recognizer\n     * @returns {Recognizer|Null}\n     */\n    get: function(recognizer) {\n        if (recognizer instanceof Recognizer) {\n            return recognizer;\n        }\n\n        var recognizers = this.recognizers;\n        for (var i = 0; i < recognizers.length; i++) {\n            if (recognizers[i].options.event == recognizer) {\n                return recognizers[i];\n            }\n        }\n        return null;\n    },\n\n    /**\n     * add a recognizer to the manager\n     * existing recognizers with the same event name will be removed\n     * @param {Recognizer} recognizer\n     * @returns {Recognizer|Manager}\n     */\n    add: function(recognizer) {\n        if (invokeArrayArg(recognizer, 'add', this)) {\n            return this;\n        }\n\n        // remove existing\n        var existing = this.get(recognizer.options.event);\n        if (existing) {\n            this.remove(existing);\n        }\n\n        this.recognizers.push(recognizer);\n        recognizer.manager = this;\n\n        this.touchAction.update();\n        return recognizer;\n    },\n\n    /**\n     * remove a recognizer by name or instance\n     * @param {Recognizer|String} recognizer\n     * @returns {Manager}\n     */\n    remove: function(recognizer) {\n        if (invokeArrayArg(recognizer, 'remove', this)) {\n            return this;\n        }\n\n        recognizer = this.get(recognizer);\n\n        // let's make sure this recognizer exists\n        if (recognizer) {\n            var recognizers = this.recognizers;\n            var index = inArray(recognizers, recognizer);\n\n            if (index !== -1) {\n                recognizers.splice(index, 1);\n                this.touchAction.update();\n            }\n        }\n\n        return this;\n    },\n\n    /**\n     * bind event\n     * @param {String} events\n     * @param {Function} handler\n     * @returns {EventEmitter} this\n     */\n    on: function(events, handler) {\n        if (events === undefined) {\n            return;\n        }\n        if (handler === undefined) {\n            return;\n        }\n\n        var handlers = this.handlers;\n        each(splitStr(events), function(event) {\n            handlers[event] = handlers[event] || [];\n            handlers[event].push(handler);\n        });\n        return this;\n    },\n\n    /**\n     * unbind event, leave emit blank to remove all handlers\n     * @param {String} events\n     * @param {Function} [handler]\n     * @returns {EventEmitter} this\n     */\n    off: function(events, handler) {\n        if (events === undefined) {\n            return;\n        }\n\n        var handlers = this.handlers;\n        each(splitStr(events), function(event) {\n            if (!handler) {\n                delete handlers[event];\n            } else {\n                handlers[event] && handlers[event].splice(inArray(handlers[event], handler), 1);\n            }\n        });\n        return this;\n    },\n\n    /**\n     * emit event to the listeners\n     * @param {String} event\n     * @param {Object} data\n     */\n    emit: function(event, data) {\n        // we also want to trigger dom events\n        if (this.options.domEvents) {\n            triggerDomEvent(event, data);\n        }\n\n        // no handlers, so skip it all\n        var handlers = this.handlers[event] && this.handlers[event].slice();\n        if (!handlers || !handlers.length) {\n            return;\n        }\n\n        data.type = event;\n        data.preventDefault = function() {\n            data.srcEvent.preventDefault();\n        };\n\n        var i = 0;\n        while (i < handlers.length) {\n            handlers[i](data);\n            i++;\n        }\n    },\n\n    /**\n     * destroy the manager and unbinds all events\n     * it doesn't unbind dom events, that is the user own responsibility\n     */\n    destroy: function() {\n        this.element && toggleCssProps(this, false);\n\n        this.handlers = {};\n        this.session = {};\n        this.input.destroy();\n        this.element = null;\n    }\n};\n\n/**\n * add/remove the css properties as defined in manager.options.cssProps\n * @param {Manager} manager\n * @param {Boolean} add\n */\nfunction toggleCssProps(manager, add) {\n    var element = manager.element;\n    if (!element.style) {\n        return;\n    }\n    var prop;\n    each(manager.options.cssProps, function(value, name) {\n        prop = prefixed(element.style, name);\n        if (add) {\n            manager.oldCssProps[prop] = element.style[prop];\n            element.style[prop] = value;\n        } else {\n            element.style[prop] = manager.oldCssProps[prop] || '';\n        }\n    });\n    if (!add) {\n        manager.oldCssProps = {};\n    }\n}\n\n/**\n * trigger dom event\n * @param {String} event\n * @param {Object} data\n */\nfunction triggerDomEvent(event, data) {\n    var gestureEvent = document.createEvent('Event');\n    gestureEvent.initEvent(event, true, true);\n    gestureEvent.gesture = data;\n    data.target.dispatchEvent(gestureEvent);\n}\n\nassign(Hammer, {\n    INPUT_START: INPUT_START,\n    INPUT_MOVE: INPUT_MOVE,\n    INPUT_END: INPUT_END,\n    INPUT_CANCEL: INPUT_CANCEL,\n\n    STATE_POSSIBLE: STATE_POSSIBLE,\n    STATE_BEGAN: STATE_BEGAN,\n    STATE_CHANGED: STATE_CHANGED,\n    STATE_ENDED: STATE_ENDED,\n    STATE_RECOGNIZED: STATE_RECOGNIZED,\n    STATE_CANCELLED: STATE_CANCELLED,\n    STATE_FAILED: STATE_FAILED,\n\n    DIRECTION_NONE: DIRECTION_NONE,\n    DIRECTION_LEFT: DIRECTION_LEFT,\n    DIRECTION_RIGHT: DIRECTION_RIGHT,\n    DIRECTION_UP: DIRECTION_UP,\n    DIRECTION_DOWN: DIRECTION_DOWN,\n    DIRECTION_HORIZONTAL: DIRECTION_HORIZONTAL,\n    DIRECTION_VERTICAL: DIRECTION_VERTICAL,\n    DIRECTION_ALL: DIRECTION_ALL,\n\n    Manager: Manager,\n    Input: Input,\n    TouchAction: TouchAction,\n\n    TouchInput: TouchInput,\n    MouseInput: MouseInput,\n    PointerEventInput: PointerEventInput,\n    TouchMouseInput: TouchMouseInput,\n    SingleTouchInput: SingleTouchInput,\n\n    Recognizer: Recognizer,\n    AttrRecognizer: AttrRecognizer,\n    Tap: TapRecognizer,\n    Pan: PanRecognizer,\n    Swipe: SwipeRecognizer,\n    Pinch: PinchRecognizer,\n    Rotate: RotateRecognizer,\n    Press: PressRecognizer,\n\n    on: addEventListeners,\n    off: removeEventListeners,\n    each: each,\n    merge: merge,\n    extend: extend,\n    assign: assign,\n    inherit: inherit,\n    bindFn: bindFn,\n    prefixed: prefixed\n});\n\n// this prevents errors when Hammer is loaded in the presence of an AMD\n//  style loader but by script tag, not by the loader.\nvar freeGlobal = (typeof window !== 'undefined' ? window : (typeof self !== 'undefined' ? self : {})); // jshint ignore:line\nfreeGlobal.Hammer = Hammer;\n\nif (typeof define === 'function' && define.amd) {\n    define(function() {\n        return Hammer;\n    });\n} else if (typeof module != 'undefined' && module.exports) {\n    module.exports = Hammer;\n} else {\n    window[exportName] = Hammer;\n}\n\n})(window, document, 'Hammer');\n","/**\n * This file contains overrides the default\n * hammer.js functions to add our own utility\n */\n/* eslint-disable */\n/* Hammer.js constants */\nconst INPUT_START = 1;\nconst INPUT_MOVE = 2;\nconst INPUT_END = 4;\nconst MOUSE_INPUT_MAP = {\n    mousedown: INPUT_START,\n    mousemove: INPUT_MOVE,\n    mouseup: INPUT_END\n};\n/**\n * Helper function that returns true if any element in an array meets given criteria.\n * Because older browsers do not support `Array.prototype.some`\n * @params array {Array}\n * @params predict {Function}\n */\nfunction some(array, predict) {\n    for (let i = 0; i < array.length; i++) {\n        if (predict(array[i])) {\n            return true;\n        }\n    }\n    return false;\n}\n/* eslint-disable no-invalid-this */\nexport function enhancePointerEventInput(PointerEventInput) {\n    const oldHandler = PointerEventInput.prototype.handler;\n    // overrides PointerEventInput.handler to accept right mouse button\n    PointerEventInput.prototype.handler = function handler(ev) {\n        const store = this.store;\n        // Allow non-left mouse buttons through\n        if (ev.button > 0 && ev.type === 'pointerdown') {\n            if (!some(store, e => e.pointerId === ev.pointerId)) {\n                store.push(ev);\n            }\n        }\n        oldHandler.call(this, ev);\n    };\n}\n// overrides MouseInput.handler to accept right mouse button\nexport function enhanceMouseInput(MouseInput) {\n    MouseInput.prototype.handler = function handler(ev) {\n        let eventType = MOUSE_INPUT_MAP[ev.type];\n        // on start we want to have the mouse button down\n        if (eventType & INPUT_START && ev.button >= 0) {\n            this.pressed = true;\n        }\n        if (eventType & INPUT_MOVE && ev.which === 0) {\n            eventType = INPUT_END;\n        }\n        // mouse must be down\n        if (!this.pressed) {\n            return;\n        }\n        if (eventType & INPUT_END) {\n            this.pressed = false;\n        }\n        this.callback(this.manager, eventType, {\n            pointers: [ev],\n            changedPointers: [ev],\n            pointerType: 'mouse',\n            srcEvent: ev\n        });\n    };\n}\n//# sourceMappingURL=hammer-overrides.js.map","import * as hammerjs from 'hammerjs';\nimport { enhancePointerEventInput, enhanceMouseInput } from './hammer-overrides';\nenhancePointerEventInput(hammerjs.PointerEventInput);\nenhanceMouseInput(hammerjs.MouseInput);\nexport const Manager = hammerjs.Manager;\nexport default hammerjs;\n//# sourceMappingURL=hammer.browser.js.map","export default class Input {\n    constructor(element, callback, options) {\n        this.element = element;\n        this.callback = callback;\n        this.options = { enable: true, ...options };\n    }\n}\n//# sourceMappingURL=input.js.map","import Hammer from './utils/hammer';\n// This module contains constants that must be conditionally required\n// due to `window`/`document` references downstream.\nexport const RECOGNIZERS = Hammer\n    ? [\n        [Hammer.Pan, { event: 'tripan', pointers: 3, threshold: 0, enable: false }],\n        [Hammer.Rotate, { enable: false }],\n        [Hammer.Pinch, { enable: false }],\n        [Hammer.Swipe, { enable: false }],\n        [Hammer.Pan, { threshold: 0, enable: false }],\n        [Hammer.Press, { enable: false }],\n        [Hammer.Tap, { event: 'doubletap', taps: 2, enable: false }],\n        // TODO - rename to 'tap' and 'singletap' in the next major release\n        [Hammer.Tap, { event: 'anytap', enable: false }],\n        [Hammer.Tap, { enable: false }]\n    ]\n    : null;\n// Recognize the following gestures even if a given recognizer succeeds\nexport const RECOGNIZER_COMPATIBLE_MAP = {\n    tripan: ['rotate', 'pinch', 'pan'],\n    rotate: ['pinch'],\n    pinch: ['pan'],\n    pan: ['press', 'doubletap', 'anytap', 'tap'],\n    doubletap: ['anytap'],\n    anytap: ['tap']\n};\n// Recognize the folling gestures only if a given recognizer fails\nexport const RECOGNIZER_FALLBACK_MAP = {\n    doubletap: ['tap']\n};\n/**\n * Only one set of basic input events will be fired by Hammer.js:\n * either pointer, touch, or mouse, depending on system support.\n * In order to enable an application to be agnostic of system support,\n * alias basic input events into \"classes\" of events: down, move, and up.\n * See `_onBasicInput()` for usage of these aliases.\n */\nexport const BASIC_EVENT_ALIASES = {\n    pointerdown: 'pointerdown',\n    pointermove: 'pointermove',\n    pointerup: 'pointerup',\n    touchstart: 'pointerdown',\n    touchmove: 'pointermove',\n    touchend: 'pointerup',\n    mousedown: 'pointerdown',\n    mousemove: 'pointermove',\n    mouseup: 'pointerup'\n};\nexport const INPUT_EVENT_TYPES = {\n    KEY_EVENTS: ['keydown', 'keyup'],\n    MOUSE_EVENTS: ['mousedown', 'mousemove', 'mouseup', 'mouseover', 'mouseout', 'mouseleave'],\n    WHEEL_EVENTS: [\n        // Chrome, Safari\n        'wheel',\n        // IE\n        'mousewheel'\n    ]\n};\n/**\n * \"Gestural\" events are those that have semantic meaning beyond the basic input event,\n * e.g. a click or tap is a sequence of `down` and `up` events with no `move` event in between.\n * Hammer.js handles these with its Recognizer system;\n * this block maps event names to the Recognizers required to detect the events.\n */\nexport const EVENT_RECOGNIZER_MAP = {\n    tap: 'tap',\n    anytap: 'anytap',\n    doubletap: 'doubletap',\n    press: 'press',\n    pinch: 'pinch',\n    pinchin: 'pinch',\n    pinchout: 'pinch',\n    pinchstart: 'pinch',\n    pinchmove: 'pinch',\n    pinchend: 'pinch',\n    pinchcancel: 'pinch',\n    rotate: 'rotate',\n    rotatestart: 'rotate',\n    rotatemove: 'rotate',\n    rotateend: 'rotate',\n    rotatecancel: 'rotate',\n    tripan: 'tripan',\n    tripanstart: 'tripan',\n    tripanmove: 'tripan',\n    tripanup: 'tripan',\n    tripandown: 'tripan',\n    tripanleft: 'tripan',\n    tripanright: 'tripan',\n    tripanend: 'tripan',\n    tripancancel: 'tripan',\n    pan: 'pan',\n    panstart: 'pan',\n    panmove: 'pan',\n    panup: 'pan',\n    pandown: 'pan',\n    panleft: 'pan',\n    panright: 'pan',\n    panend: 'pan',\n    pancancel: 'pan',\n    swipe: 'swipe',\n    swipeleft: 'swipe',\n    swiperight: 'swipe',\n    swipeup: 'swipe',\n    swipedown: 'swipe'\n};\n/**\n * Map gestural events typically provided by browsers\n * that are not reported in 'hammer.input' events\n * to corresponding Hammer.js gestures.\n */\nexport const GESTURE_EVENT_ALIASES = {\n    click: 'tap',\n    anyclick: 'anytap',\n    dblclick: 'doubletap',\n    mousedown: 'pointerdown',\n    mousemove: 'pointermove',\n    mouseup: 'pointerup',\n    mouseover: 'pointerover',\n    mouseout: 'pointerout',\n    mouseleave: 'pointerleave'\n};\n//# sourceMappingURL=constants.js.map","// Purpose: include this in your module to avoids adding dependencies on\n// micro modules like 'global'\n/* global window, global, document, navigator */\nexport const userAgent = typeof navigator !== 'undefined' && navigator.userAgent ? navigator.userAgent.toLowerCase() : '';\nconst window_ = typeof window !== 'undefined' ? window : global;\nconst global_ = typeof global !== 'undefined' ? global : window;\nconst document_ = typeof document !== 'undefined' ? document : {};\nexport { window_ as window, global_ as global, document_ as document };\n/*\n * Detect whether passive option is supported by the current browser.\n * https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener\n   #Safely_detecting_option_support\n */\nlet passiveSupported = false;\n/* eslint-disable accessor-pairs, no-empty */\ntry {\n    const options = {\n        // This function will be called when the browser\n        // attempts to access the passive property.\n        get passive() {\n            passiveSupported = true;\n            return true;\n        }\n    };\n    window_.addEventListener('test', null, options);\n    window_.removeEventListener('test', null);\n}\ncatch (err) {\n    passiveSupported = false;\n}\nexport { passiveSupported };\n//# sourceMappingURL=globals.js.map","import Input from './input';\nimport { INPUT_EVENT_TYPES } from '../constants';\nimport { window, userAgent, passiveSupported } from '../utils/globals';\nconst firefox = userAgent.indexOf('firefox') !== -1;\nconst { WHEEL_EVENTS } = INPUT_EVENT_TYPES;\nconst EVENT_TYPE = 'wheel';\n// Constants for normalizing input delta\nconst WHEEL_DELTA_MAGIC_SCALER = 4.000244140625;\nconst WHEEL_DELTA_PER_LINE = 40;\n// Slow down zoom if shift key is held for more precise zooming\nconst SHIFT_MULTIPLIER = 0.25;\nexport default class WheelInput extends Input {\n    constructor(element, callback, options) {\n        super(element, callback, options);\n        /* eslint-disable complexity, max-statements */\n        this.handleEvent = (event) => {\n            if (!this.options.enable) {\n                return;\n            }\n            let value = event.deltaY;\n            if (window.WheelEvent) {\n                // Firefox doubles the values on retina screens...\n                if (firefox && event.deltaMode === window.WheelEvent.DOM_DELTA_PIXEL) {\n                    value /= window.devicePixelRatio;\n                }\n                if (event.deltaMode === window.WheelEvent.DOM_DELTA_LINE) {\n                    value *= WHEEL_DELTA_PER_LINE;\n                }\n            }\n            if (value !== 0 && value % WHEEL_DELTA_MAGIC_SCALER === 0) {\n                // This one is definitely a mouse wheel event.\n                // Normalize this value to match trackpad.\n                value = Math.floor(value / WHEEL_DELTA_MAGIC_SCALER);\n            }\n            if (event.shiftKey && value) {\n                value = value * SHIFT_MULTIPLIER;\n            }\n            this.callback({\n                type: EVENT_TYPE,\n                center: {\n                    x: event.clientX,\n                    y: event.clientY\n                },\n                delta: -value,\n                srcEvent: event,\n                pointerType: 'mouse',\n                target: event.target\n            });\n        };\n        this.events = (this.options.events || []).concat(WHEEL_EVENTS);\n        this.events.forEach(event => element.addEventListener(event, this.handleEvent, passiveSupported ? { passive: false } : false));\n    }\n    destroy() {\n        this.events.forEach(event => this.element.removeEventListener(event, this.handleEvent));\n    }\n    /**\n     * Enable this input (begin processing events)\n     * if the specified event type is among those handled by this input.\n     */\n    enableEventType(eventType, enabled) {\n        if (eventType === EVENT_TYPE) {\n            this.options.enable = enabled;\n        }\n    }\n}\n//# sourceMappingURL=wheel-input.js.map","import Input from './input';\nimport { INPUT_EVENT_TYPES } from '../constants';\nconst { MOUSE_EVENTS } = INPUT_EVENT_TYPES;\nconst MOVE_EVENT_TYPE = 'pointermove';\nconst OVER_EVENT_TYPE = 'pointerover';\nconst OUT_EVENT_TYPE = 'pointerout';\nconst ENTER_EVENT_TYPE = 'pointerenter';\nconst LEAVE_EVENT_TYPE = 'pointerleave';\n/**\n * Hammer.js swallows 'move' events (for pointer/touch/mouse)\n * when the pointer is not down. This class sets up a handler\n * specifically for these events to work around this limitation.\n * Note that this could be extended to more intelligently handle\n * move events across input types, e.g. storing multiple simultaneous\n * pointer/touch events, calculating speed/direction, etc.\n */\nexport default class MoveInput extends Input {\n    constructor(element, callback, options) {\n        super(element, callback, options);\n        this.handleEvent = (event) => {\n            this.handleOverEvent(event);\n            this.handleOutEvent(event);\n            this.handleEnterEvent(event);\n            this.handleLeaveEvent(event);\n            this.handleMoveEvent(event);\n        };\n        this.pressed = false;\n        const { enable } = this.options;\n        this.enableMoveEvent = enable;\n        this.enableLeaveEvent = enable;\n        this.enableEnterEvent = enable;\n        this.enableOutEvent = enable;\n        this.enableOverEvent = enable;\n        this.events = (this.options.events || []).concat(MOUSE_EVENTS);\n        this.events.forEach(event => element.addEventListener(event, this.handleEvent));\n    }\n    destroy() {\n        this.events.forEach(event => this.element.removeEventListener(event, this.handleEvent));\n    }\n    /**\n     * Enable this input (begin processing events)\n     * if the specified event type is among those handled by this input.\n     */\n    enableEventType(eventType, enabled) {\n        if (eventType === MOVE_EVENT_TYPE) {\n            this.enableMoveEvent = enabled;\n        }\n        if (eventType === OVER_EVENT_TYPE) {\n            this.enableOverEvent = enabled;\n        }\n        if (eventType === OUT_EVENT_TYPE) {\n            this.enableOutEvent = enabled;\n        }\n        if (eventType === ENTER_EVENT_TYPE) {\n            this.enableEnterEvent = enabled;\n        }\n        if (eventType === LEAVE_EVENT_TYPE) {\n            this.enableLeaveEvent = enabled;\n        }\n    }\n    handleOverEvent(event) {\n        if (this.enableOverEvent) {\n            if (event.type === 'mouseover') {\n                this._emit(OVER_EVENT_TYPE, event);\n            }\n        }\n    }\n    handleOutEvent(event) {\n        if (this.enableOutEvent) {\n            if (event.type === 'mouseout') {\n                this._emit(OUT_EVENT_TYPE, event);\n            }\n        }\n    }\n    handleEnterEvent(event) {\n        if (this.enableEnterEvent) {\n            if (event.type === 'mouseenter') {\n                this._emit(ENTER_EVENT_TYPE, event);\n            }\n        }\n    }\n    handleLeaveEvent(event) {\n        if (this.enableLeaveEvent) {\n            if (event.type === 'mouseleave') {\n                this._emit(LEAVE_EVENT_TYPE, event);\n            }\n        }\n    }\n    handleMoveEvent(event) {\n        if (this.enableMoveEvent) {\n            switch (event.type) {\n                case 'mousedown':\n                    if (event.button >= 0) {\n                        // Button is down\n                        this.pressed = true;\n                    }\n                    break;\n                case 'mousemove':\n                    // Move events use `which` to track the button being pressed\n                    if (event.which === 0) {\n                        // Button is not down\n                        this.pressed = false;\n                    }\n                    if (!this.pressed) {\n                        // Drag events are emitted by hammer already\n                        // we just need to emit the move event on hover\n                        this._emit(MOVE_EVENT_TYPE, event);\n                    }\n                    break;\n                case 'mouseup':\n                    this.pressed = false;\n                    break;\n                default:\n            }\n        }\n    }\n    _emit(type, event) {\n        this.callback({\n            type,\n            center: {\n                x: event.clientX,\n                y: event.clientY\n            },\n            srcEvent: event,\n            pointerType: 'mouse',\n            target: event.target\n        });\n    }\n}\n//# sourceMappingURL=move-input.js.map","import Input from './input';\nimport { INPUT_EVENT_TYPES } from '../constants';\nconst { KEY_EVENTS } = INPUT_EVENT_TYPES;\nconst DOWN_EVENT_TYPE = 'keydown';\nconst UP_EVENT_TYPE = 'keyup';\nexport default class KeyInput extends Input {\n    constructor(element, callback, options) {\n        super(element, callback, options);\n        this.handleEvent = (event) => {\n            // Ignore if focused on text input\n            const targetElement = (event.target || event.srcElement);\n            if ((targetElement.tagName === 'INPUT' && targetElement.type === 'text') ||\n                targetElement.tagName === 'TEXTAREA') {\n                return;\n            }\n            if (this.enableDownEvent && event.type === 'keydown') {\n                this.callback({\n                    type: DOWN_EVENT_TYPE,\n                    srcEvent: event,\n                    key: event.key,\n                    target: event.target\n                });\n            }\n            if (this.enableUpEvent && event.type === 'keyup') {\n                this.callback({\n                    type: UP_EVENT_TYPE,\n                    srcEvent: event,\n                    key: event.key,\n                    target: event.target\n                });\n            }\n        };\n        this.enableDownEvent = this.options.enable;\n        this.enableUpEvent = this.options.enable;\n        this.events = (this.options.events || []).concat(KEY_EVENTS);\n        element.tabIndex = this.options.tabIndex || 0;\n        element.style.outline = 'none';\n        this.events.forEach(event => element.addEventListener(event, this.handleEvent));\n    }\n    destroy() {\n        this.events.forEach(event => this.element.removeEventListener(event, this.handleEvent));\n    }\n    /**\n     * Enable this input (begin processing events)\n     * if the specified event type is among those handled by this input.\n     */\n    enableEventType(eventType, enabled) {\n        if (eventType === DOWN_EVENT_TYPE) {\n            this.enableDownEvent = enabled;\n        }\n        if (eventType === UP_EVENT_TYPE) {\n            this.enableUpEvent = enabled;\n        }\n    }\n}\n//# sourceMappingURL=key-input.js.map","import Input from './input';\nconst EVENT_TYPE = 'contextmenu';\nexport default class ContextmenuInput extends Input {\n    constructor(element, callback, options) {\n        super(element, callback, options);\n        this.handleEvent = (event) => {\n            if (!this.options.enable) {\n                return;\n            }\n            this.callback({\n                type: EVENT_TYPE,\n                center: {\n                    x: event.clientX,\n                    y: event.clientY\n                },\n                srcEvent: event,\n                pointerType: 'mouse',\n                target: event.target\n            });\n        };\n        element.addEventListener('contextmenu', this.handleEvent);\n    }\n    destroy() {\n        this.element.removeEventListener('contextmenu', this.handleEvent);\n    }\n    /**\n     * Enable this input (begin processing events)\n     * if the specified event type is among those handled by this input.\n     */\n    enableEventType(eventType, enabled) {\n        if (eventType === EVENT_TYPE) {\n            this.options.enable = enabled;\n        }\n    }\n}\n//# sourceMappingURL=contextmenu-input.js.map","/* Constants */\nconst DOWN_EVENT = 1;\nconst MOVE_EVENT = 2;\nconst UP_EVENT = 4;\nconst MOUSE_EVENTS = {\n    pointerdown: DOWN_EVENT,\n    pointermove: MOVE_EVENT,\n    pointerup: UP_EVENT,\n    mousedown: DOWN_EVENT,\n    mousemove: MOVE_EVENT,\n    mouseup: UP_EVENT\n};\n// MouseEvent.which https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent/which\nconst MOUSE_EVENT_WHICH_LEFT = 1;\nconst MOUSE_EVENT_WHICH_MIDDLE = 2;\nconst MOUSE_EVENT_WHICH_RIGHT = 3;\n// MouseEvent.button https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent/button\nconst MOUSE_EVENT_BUTTON_LEFT = 0;\nconst MOUSE_EVENT_BUTTON_MIDDLE = 1;\nconst MOUSE_EVENT_BUTTON_RIGHT = 2;\n// MouseEvent.buttons https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent/buttons\nconst MOUSE_EVENT_BUTTONS_LEFT_MASK = 1;\nconst MOUSE_EVENT_BUTTONS_RIGHT_MASK = 2;\nconst MOUSE_EVENT_BUTTONS_MIDDLE_MASK = 4;\n/**\n * Extract the involved mouse button\n */\nexport function whichButtons(event) {\n    const eventType = MOUSE_EVENTS[event.srcEvent.type];\n    if (!eventType) {\n        // Not a mouse evet\n        return null;\n    }\n    const { buttons, button, which } = event.srcEvent;\n    let leftButton = false;\n    let middleButton = false;\n    let rightButton = false;\n    if (\n    // button is up, need to find out which one was pressed before\n    eventType === UP_EVENT ||\n        // moving but does not support `buttons` API\n        (eventType === MOVE_EVENT && !Number.isFinite(buttons))) {\n        leftButton = which === MOUSE_EVENT_WHICH_LEFT;\n        middleButton = which === MOUSE_EVENT_WHICH_MIDDLE;\n        rightButton = which === MOUSE_EVENT_WHICH_RIGHT;\n    }\n    else if (eventType === MOVE_EVENT) {\n        leftButton = Boolean(buttons & MOUSE_EVENT_BUTTONS_LEFT_MASK);\n        middleButton = Boolean(buttons & MOUSE_EVENT_BUTTONS_MIDDLE_MASK);\n        rightButton = Boolean(buttons & MOUSE_EVENT_BUTTONS_RIGHT_MASK);\n    }\n    else if (eventType === DOWN_EVENT) {\n        leftButton = button === MOUSE_EVENT_BUTTON_LEFT;\n        middleButton = button === MOUSE_EVENT_BUTTON_MIDDLE;\n        rightButton = button === MOUSE_EVENT_BUTTON_RIGHT;\n    }\n    return { leftButton, middleButton, rightButton };\n}\n/**\n * Calculate event position relative to the root element\n */\nexport function getOffsetPosition(event, rootElement) {\n    const center = event.center;\n    // `center` is a hammer.js event property\n    if (!center) {\n        // Not a gestural event\n        return null;\n    }\n    const rect = rootElement.getBoundingClientRect();\n    // Fix scale for map affected by a CSS transform.\n    // See https://stackoverflow.com/a/26893663/3528533\n    const scaleX = rect.width / rootElement.offsetWidth || 1;\n    const scaleY = rect.height / rootElement.offsetHeight || 1;\n    // Calculate center relative to the root element\n    const offsetCenter = {\n        x: (center.x - rect.left - rootElement.clientLeft) / scaleX,\n        y: (center.y - rect.top - rootElement.clientTop) / scaleY\n    };\n    return { center, offsetCenter };\n}\n//# sourceMappingURL=event-utils.js.map","import { whichButtons, getOffsetPosition } from './event-utils';\nconst DEFAULT_OPTIONS = {\n    srcElement: 'root',\n    priority: 0\n};\nexport default class EventRegistrar {\n    constructor(eventManager) {\n        /**\n         * Handles hammerjs event\n         */\n        this.handleEvent = (event) => {\n            if (this.isEmpty()) {\n                return;\n            }\n            const mjolnirEvent = this._normalizeEvent(event);\n            let target = event.srcEvent.target;\n            while (target && target !== mjolnirEvent.rootElement) {\n                this._emit(mjolnirEvent, target);\n                if (mjolnirEvent.handled) {\n                    return;\n                }\n                target = target.parentNode;\n            }\n            this._emit(mjolnirEvent, 'root');\n        };\n        this.eventManager = eventManager;\n        this.handlers = [];\n        // Element -> handler map\n        this.handlersByElement = new Map();\n        this._active = false;\n    }\n    // Returns true if there are no non-passive handlers\n    isEmpty() {\n        return !this._active;\n    }\n    add(type, handler, options, once = false, passive = false) {\n        const { handlers, handlersByElement } = this;\n        let opts = DEFAULT_OPTIONS;\n        if (typeof options === 'string' || (options && options.addEventListener)) {\n            // is DOM element, backward compatibility\n            // @ts-ignore\n            opts = { ...DEFAULT_OPTIONS, srcElement: options };\n        }\n        else if (options) {\n            opts = { ...DEFAULT_OPTIONS, ...options };\n        }\n        let entries = handlersByElement.get(opts.srcElement);\n        if (!entries) {\n            entries = [];\n            handlersByElement.set(opts.srcElement, entries);\n        }\n        const entry = {\n            type,\n            handler,\n            srcElement: opts.srcElement,\n            priority: opts.priority\n        };\n        if (once) {\n            entry.once = true;\n        }\n        if (passive) {\n            entry.passive = true;\n        }\n        handlers.push(entry);\n        this._active = this._active || !entry.passive;\n        // Sort handlers by descending priority\n        // Handlers with the same priority are excuted in the order of registration\n        let insertPosition = entries.length - 1;\n        while (insertPosition >= 0) {\n            if (entries[insertPosition].priority >= entry.priority) {\n                break;\n            }\n            insertPosition--;\n        }\n        entries.splice(insertPosition + 1, 0, entry);\n    }\n    remove(type, handler) {\n        const { handlers, handlersByElement } = this;\n        for (let i = handlers.length - 1; i >= 0; i--) {\n            const entry = handlers[i];\n            if (entry.type === type && entry.handler === handler) {\n                handlers.splice(i, 1);\n                const entries = handlersByElement.get(entry.srcElement);\n                entries.splice(entries.indexOf(entry), 1);\n                if (entries.length === 0) {\n                    handlersByElement.delete(entry.srcElement);\n                }\n            }\n        }\n        this._active = handlers.some(entry => !entry.passive);\n    }\n    /**\n     * Invoke handlers on a particular element\n     */\n    _emit(event, srcElement) {\n        const entries = this.handlersByElement.get(srcElement);\n        if (entries) {\n            let immediatePropagationStopped = false;\n            // Prevents the current event from bubbling up\n            const stopPropagation = () => {\n                event.handled = true;\n            };\n            // Prevent any remaining listeners from being called\n            const stopImmediatePropagation = () => {\n                event.handled = true;\n                immediatePropagationStopped = true;\n            };\n            const entriesToRemove = [];\n            for (let i = 0; i < entries.length; i++) {\n                const { type, handler, once } = entries[i];\n                handler({\n                    ...event,\n                    // @ts-ignore\n                    type,\n                    stopPropagation,\n                    stopImmediatePropagation\n                });\n                if (once) {\n                    entriesToRemove.push(entries[i]);\n                }\n                if (immediatePropagationStopped) {\n                    break;\n                }\n            }\n            for (let i = 0; i < entriesToRemove.length; i++) {\n                const { type, handler } = entriesToRemove[i];\n                this.remove(type, handler);\n            }\n        }\n    }\n    /**\n     * Normalizes hammerjs and custom events to have predictable fields.\n     */\n    _normalizeEvent(event) {\n        const rootElement = this.eventManager.getElement();\n        return {\n            ...event,\n            ...whichButtons(event),\n            ...getOffsetPosition(event, rootElement),\n            preventDefault: () => {\n                event.srcEvent.preventDefault();\n            },\n            stopImmediatePropagation: null,\n            stopPropagation: null,\n            handled: false,\n            rootElement\n        };\n    }\n}\n//# sourceMappingURL=event-registrar.js.map","import { Manager } from './utils/hammer';\nimport WheelInput from './inputs/wheel-input';\nimport MoveInput from './inputs/move-input';\nimport KeyInput from './inputs/key-input';\nimport ContextmenuInput from './inputs/contextmenu-input';\nimport EventRegistrar from './utils/event-registrar';\nimport { BASIC_EVENT_ALIASES, EVENT_RECOGNIZER_MAP, GESTURE_EVENT_ALIASES, RECOGNIZERS, RECOGNIZER_COMPATIBLE_MAP, RECOGNIZER_FALLBACK_MAP } from './constants';\nconst DEFAULT_OPTIONS = {\n    // event handlers\n    events: null,\n    // custom recognizers\n    recognizers: null,\n    recognizerOptions: {},\n    // Manager class\n    Manager,\n    // allow browser default touch action\n    // https://github.com/uber/react-map-gl/issues/506\n    touchAction: 'none',\n    tabIndex: 0\n};\n// Unified API for subscribing to events about both\n// basic input events (e.g. 'mousemove', 'touchstart', 'wheel')\n// and gestural input (e.g. 'click', 'tap', 'panstart').\n// Delegates gesture related event registration and handling to Hammer.js.\nexport default class EventManager {\n    constructor(element = null, options) {\n        /**\n         * Handle basic events using the 'hammer.input' Hammer.js API:\n         * Before running Recognizers, Hammer emits a 'hammer.input' event\n         * with the basic event info. This function emits all basic events\n         * aliased to the \"class\" of event received.\n         * See constants.BASIC_EVENT_CLASSES basic event class definitions.\n         */\n        this._onBasicInput = (event) => {\n            const { srcEvent } = event;\n            const alias = BASIC_EVENT_ALIASES[srcEvent.type];\n            if (alias) {\n                // fire all events aliased to srcEvent.type\n                this.manager.emit(alias, event);\n            }\n        };\n        /**\n         * Handle events not supported by Hammer.js,\n         * and pipe back out through same (Hammer) channel used by other events.\n         */\n        this._onOtherEvent = (event) => {\n            // console.log('onotherevent', event.type, event)\n            this.manager.emit(event.type, event);\n        };\n        this.options = { ...DEFAULT_OPTIONS, ...options };\n        this.events = new Map();\n        this.setElement(element);\n        // Register all passed events.\n        const { events } = this.options;\n        if (events) {\n            this.on(events);\n        }\n    }\n    getElement() {\n        return this.element;\n    }\n    setElement(element) {\n        if (this.element) {\n            // unregister all events\n            this.destroy();\n        }\n        this.element = element;\n        if (!element) {\n            return;\n        }\n        const { options } = this;\n        const ManagerClass = options.Manager;\n        this.manager = new ManagerClass(element, {\n            touchAction: options.touchAction,\n            recognizers: options.recognizers || RECOGNIZERS\n        }).on('hammer.input', this._onBasicInput);\n        if (!options.recognizers) {\n            // Set default recognize withs\n            // http://hammerjs.github.io/recognize-with/\n            Object.keys(RECOGNIZER_COMPATIBLE_MAP).forEach(name => {\n                const recognizer = this.manager.get(name);\n                if (recognizer) {\n                    RECOGNIZER_COMPATIBLE_MAP[name].forEach(otherName => {\n                        recognizer.recognizeWith(otherName);\n                    });\n                }\n            });\n        }\n        // Set recognizer options\n        for (const recognizerName in options.recognizerOptions) {\n            const recognizer = this.manager.get(recognizerName);\n            if (recognizer) {\n                const recognizerOption = options.recognizerOptions[recognizerName];\n                // `enable` is managed by the event registrations\n                delete recognizerOption.enable;\n                recognizer.set(recognizerOption);\n            }\n        }\n        // Handle events not handled by Hammer.js:\n        // - mouse wheel\n        // - pointer/touch/mouse move\n        this.wheelInput = new WheelInput(element, this._onOtherEvent, {\n            enable: false\n        });\n        this.moveInput = new MoveInput(element, this._onOtherEvent, {\n            enable: false\n        });\n        this.keyInput = new KeyInput(element, this._onOtherEvent, {\n            enable: false,\n            tabIndex: options.tabIndex\n        });\n        this.contextmenuInput = new ContextmenuInput(element, this._onOtherEvent, {\n            enable: false\n        });\n        // Register all existing events\n        for (const [eventAlias, eventRegistrar] of this.events) {\n            if (!eventRegistrar.isEmpty()) {\n                // Enable recognizer for this event.\n                this._toggleRecognizer(eventRegistrar.recognizerName, true);\n                this.manager.on(eventAlias, eventRegistrar.handleEvent);\n            }\n        }\n    }\n    // Tear down internal event management implementations.\n    destroy() {\n        if (this.element) {\n            // wheelInput etc. are created in setElement() and therefore\n            // cannot exist if there is no element\n            this.wheelInput.destroy();\n            this.moveInput.destroy();\n            this.keyInput.destroy();\n            this.contextmenuInput.destroy();\n            this.manager.destroy();\n            this.wheelInput = null;\n            this.moveInput = null;\n            this.keyInput = null;\n            this.contextmenuInput = null;\n            this.manager = null;\n            this.element = null;\n        }\n    }\n    /** Register an event handler function to be called on `event` */\n    on(event, handler, opts) {\n        this._addEventHandler(event, handler, opts, false);\n    }\n    once(event, handler, opts) {\n        this._addEventHandler(event, handler, opts, true);\n    }\n    watch(event, handler, opts) {\n        this._addEventHandler(event, handler, opts, false, true);\n    }\n    off(event, handler) {\n        this._removeEventHandler(event, handler);\n    }\n    /*\n     * Enable/disable recognizer for the given event\n     */\n    _toggleRecognizer(name, enabled) {\n        const { manager } = this;\n        if (!manager) {\n            return;\n        }\n        const recognizer = manager.get(name);\n        // @ts-ignore\n        if (recognizer && recognizer.options.enable !== enabled) {\n            recognizer.set({ enable: enabled });\n            const fallbackRecognizers = RECOGNIZER_FALLBACK_MAP[name];\n            if (fallbackRecognizers && !this.options.recognizers) {\n                // Set default require failures\n                // http://hammerjs.github.io/require-failure/\n                fallbackRecognizers.forEach(otherName => {\n                    const otherRecognizer = manager.get(otherName);\n                    if (enabled) {\n                        // Wait for this recognizer to fail\n                        otherRecognizer.requireFailure(name);\n                        /**\n                         * This seems to be a bug in hammerjs:\n                         * requireFailure() adds both ways\n                         * dropRequireFailure() only drops one way\n                         * https://github.com/hammerjs/hammer.js/blob/master/src/recognizerjs/\n                           recognizer-constructor.js#L136\n                         */\n                        recognizer.dropRequireFailure(otherName);\n                    }\n                    else {\n                        // Do not wait for this recognizer to fail\n                        otherRecognizer.dropRequireFailure(name);\n                    }\n                });\n            }\n        }\n        this.wheelInput.enableEventType(name, enabled);\n        this.moveInput.enableEventType(name, enabled);\n        this.keyInput.enableEventType(name, enabled);\n        this.contextmenuInput.enableEventType(name, enabled);\n    }\n    /**\n     * Process the event registration for a single event + handler.\n     */\n    _addEventHandler(event, handler, opts, once, passive) {\n        if (typeof event !== 'string') {\n            // @ts-ignore\n            opts = handler;\n            // If `event` is a map, call `on()` for each entry.\n            for (const eventName in event) {\n                this._addEventHandler(eventName, event[eventName], opts, once, passive);\n            }\n            return;\n        }\n        const { manager, events } = this;\n        // Alias to a recognized gesture as necessary.\n        const eventAlias = GESTURE_EVENT_ALIASES[event] || event;\n        let eventRegistrar = events.get(eventAlias);\n        if (!eventRegistrar) {\n            eventRegistrar = new EventRegistrar(this);\n            events.set(eventAlias, eventRegistrar);\n            // Enable recognizer for this event.\n            eventRegistrar.recognizerName = EVENT_RECOGNIZER_MAP[eventAlias] || eventAlias;\n            // Listen to the event\n            if (manager) {\n                manager.on(eventAlias, eventRegistrar.handleEvent);\n            }\n        }\n        eventRegistrar.add(event, handler, opts, once, passive);\n        if (!eventRegistrar.isEmpty()) {\n            this._toggleRecognizer(eventRegistrar.recognizerName, true);\n        }\n    }\n    /**\n     * Process the event deregistration for a single event + handler.\n     */\n    _removeEventHandler(event, handler) {\n        if (typeof event !== 'string') {\n            // If `event` is a map, call `off()` for each entry.\n            for (const eventName in event) {\n                this._removeEventHandler(eventName, event[eventName]);\n            }\n            return;\n        }\n        const { events } = this;\n        // Alias to a recognized gesture as necessary.\n        const eventAlias = GESTURE_EVENT_ALIASES[event] || event;\n        const eventRegistrar = events.get(eventAlias);\n        if (!eventRegistrar) {\n            return;\n        }\n        eventRegistrar.remove(event, handler);\n        if (eventRegistrar.isEmpty()) {\n            const { recognizerName } = eventRegistrar;\n            // Disable recognizer if no more handlers are attached to its events\n            let isRecognizerUsed = false;\n            for (const eh of events.values()) {\n                if (eh.recognizerName === recognizerName && !eh.isEmpty()) {\n                    isRecognizerUsed = true;\n                    break;\n                }\n            }\n            if (!isRecognizerUsed) {\n                this._toggleRecognizer(recognizerName, false);\n            }\n        }\n    }\n}\n//# sourceMappingURL=event-manager.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport LayerManager from './layer-manager';\nimport ViewManager from './view-manager';\nimport MapView from '../views/map-view';\nimport EffectManager from './effect-manager';\nimport DeckRenderer from './deck-renderer';\nimport DeckPicker from './deck-picker';\nimport Tooltip from './tooltip';\nimport log from '../utils/log';\nimport { deepEqual } from '../utils/deep-equal';\nimport typedArrayManager from '../utils/typed-array-manager';\nimport deckGlobal from './init';\nimport { getBrowser } from '@probe.gl/env';\nimport { AnimationLoop, createGLContext, instrumentGLContext, setParameters, Timeline, lumaStats } from '@luma.gl/core';\nimport { Stats } from '@probe.gl/stats';\nimport { EventManager } from 'mjolnir.js';\nimport assert from '../utils/assert';\nimport { EVENTS } from './constants';\n\nfunction noop() {}\n\nconst getCursor = ({\n  isDragging\n}) => isDragging ? 'grabbing' : 'grab';\n\nconst defaultProps = {\n  id: '',\n  width: '100%',\n  height: '100%',\n  style: null,\n  viewState: null,\n  initialViewState: null,\n  pickingRadius: 0,\n  layerFilter: null,\n  glOptions: {},\n  parameters: {},\n  parent: null,\n  gl: null,\n  canvas: null,\n  layers: [],\n  effects: [],\n  views: null,\n  controller: null,\n  useDevicePixels: true,\n  touchAction: 'none',\n  eventRecognizerOptions: {},\n  _framebuffer: null,\n  _animate: false,\n  _pickable: true,\n  _typedArrayManagerProps: {},\n  _customRender: null,\n  onWebGLInitialized: noop,\n  onResize: noop,\n  onViewStateChange: noop,\n  onInteractionStateChange: noop,\n  onBeforeRender: noop,\n  onAfterRender: noop,\n  onLoad: noop,\n  onError: error => log.error(error.message)(),\n  onHover: null,\n  onClick: null,\n  onDragStart: null,\n  onDrag: null,\n  onDragEnd: null,\n  _onMetrics: null,\n  getCursor,\n  getTooltip: null,\n  debug: false,\n  drawPickingColors: false\n};\nexport default class Deck {\n  constructor(props) {\n    _defineProperty(this, \"props\", void 0);\n\n    _defineProperty(this, \"width\", 0);\n\n    _defineProperty(this, \"height\", 0);\n\n    _defineProperty(this, \"userData\", {});\n\n    _defineProperty(this, \"canvas\", null);\n\n    _defineProperty(this, \"viewManager\", null);\n\n    _defineProperty(this, \"layerManager\", null);\n\n    _defineProperty(this, \"effectManager\", null);\n\n    _defineProperty(this, \"deckRenderer\", null);\n\n    _defineProperty(this, \"deckPicker\", null);\n\n    _defineProperty(this, \"eventManager\", null);\n\n    _defineProperty(this, \"tooltip\", null);\n\n    _defineProperty(this, \"metrics\", void 0);\n\n    _defineProperty(this, \"animationLoop\", void 0);\n\n    _defineProperty(this, \"stats\", void 0);\n\n    _defineProperty(this, \"viewState\", void 0);\n\n    _defineProperty(this, \"cursorState\", void 0);\n\n    _defineProperty(this, \"_needsRedraw\", void 0);\n\n    _defineProperty(this, \"_pickRequest\", void 0);\n\n    _defineProperty(this, \"_lastPointerDownInfo\", null);\n\n    _defineProperty(this, \"_metricsCounter\", void 0);\n\n    _defineProperty(this, \"_onPointerMove\", event => {\n      const {\n        _pickRequest\n      } = this;\n\n      if (event.type === 'pointerleave') {\n        _pickRequest.x = -1;\n        _pickRequest.y = -1;\n        _pickRequest.radius = 0;\n      } else if (event.leftButton || event.rightButton) {\n        return;\n      } else {\n        const pos = event.offsetCenter;\n\n        if (!pos) {\n          return;\n        }\n\n        _pickRequest.x = pos.x;\n        _pickRequest.y = pos.y;\n        _pickRequest.radius = this.props.pickingRadius;\n      }\n\n      if (this.layerManager) {\n        this.layerManager.context.mousePosition = {\n          x: _pickRequest.x,\n          y: _pickRequest.y\n        };\n      }\n\n      _pickRequest.event = event;\n    });\n\n    _defineProperty(this, \"_onEvent\", event => {\n      const eventOptions = EVENTS[event.type];\n      const pos = event.offsetCenter;\n\n      if (!eventOptions || !pos || !this.layerManager) {\n        return;\n      }\n\n      const layers = this.layerManager.getLayers();\n      const info = this.deckPicker.getLastPickedObject({\n        x: pos.x,\n        y: pos.y,\n        layers,\n        viewports: this.getViewports(pos)\n      }, this._lastPointerDownInfo);\n      const {\n        layer\n      } = info;\n      const layerHandler = layer && (layer[eventOptions.handler] || layer.props[eventOptions.handler]);\n      const rootHandler = this.props[eventOptions.handler];\n      let handled = false;\n\n      if (layerHandler) {\n        handled = layerHandler.call(layer, info, event);\n      }\n\n      if (!handled && rootHandler) {\n        rootHandler(info, event);\n      }\n    });\n\n    _defineProperty(this, \"_onPointerDown\", event => {\n      const pos = event.offsetCenter;\n\n      const pickedInfo = this._pick('pickObject', 'pickObject Time', {\n        x: pos.x,\n        y: pos.y,\n        radius: this.props.pickingRadius\n      });\n\n      this._lastPointerDownInfo = pickedInfo.result[0] || pickedInfo.emptyInfo;\n    });\n\n    this.props = { ...defaultProps,\n      ...props\n    };\n    props = this.props;\n    this._needsRedraw = 'Initial render';\n    this._pickRequest = {\n      mode: 'hover',\n      x: -1,\n      y: -1,\n      radius: 0,\n      event: null\n    };\n    this.cursorState = {\n      isHovering: false,\n      isDragging: false\n    };\n\n    if (props.viewState && props.initialViewState) {\n      log.warn('View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.')();\n    }\n\n    if (getBrowser() === 'IE') {\n      log.warn('IE 11 is not supported')();\n    }\n\n    this.viewState = props.initialViewState;\n\n    if (!props.gl) {\n      if (typeof document !== 'undefined') {\n        this.canvas = this._createCanvas(props);\n      }\n    }\n\n    this.animationLoop = this._createAnimationLoop(props);\n    this.stats = new Stats({\n      id: 'deck.gl'\n    });\n    this.metrics = {\n      fps: 0,\n      setPropsTime: 0,\n      updateAttributesTime: 0,\n      framesRedrawn: 0,\n      pickTime: 0,\n      pickCount: 0,\n      gpuTime: 0,\n      gpuTimePerFrame: 0,\n      cpuTime: 0,\n      cpuTimePerFrame: 0,\n      bufferMemory: 0,\n      textureMemory: 0,\n      renderbufferMemory: 0,\n      gpuMemory: 0\n    };\n    this._metricsCounter = 0;\n    this.setProps(props);\n\n    if (props._typedArrayManagerProps) {\n      typedArrayManager.setOptions(props._typedArrayManagerProps);\n    }\n\n    this.animationLoop.start();\n  }\n\n  finalize() {\n    var _this$layerManager, _this$viewManager, _this$effectManager, _this$deckRenderer, _this$deckPicker, _this$eventManager, _this$tooltip;\n\n    this.animationLoop.stop();\n    this.animationLoop = null;\n    this._lastPointerDownInfo = null;\n    (_this$layerManager = this.layerManager) === null || _this$layerManager === void 0 ? void 0 : _this$layerManager.finalize();\n    this.layerManager = null;\n    (_this$viewManager = this.viewManager) === null || _this$viewManager === void 0 ? void 0 : _this$viewManager.finalize();\n    this.viewManager = null;\n    (_this$effectManager = this.effectManager) === null || _this$effectManager === void 0 ? void 0 : _this$effectManager.finalize();\n    this.effectManager = null;\n    (_this$deckRenderer = this.deckRenderer) === null || _this$deckRenderer === void 0 ? void 0 : _this$deckRenderer.finalize();\n    this.deckRenderer = null;\n    (_this$deckPicker = this.deckPicker) === null || _this$deckPicker === void 0 ? void 0 : _this$deckPicker.finalize();\n    this.deckPicker = null;\n    (_this$eventManager = this.eventManager) === null || _this$eventManager === void 0 ? void 0 : _this$eventManager.destroy();\n    this.eventManager = null;\n    (_this$tooltip = this.tooltip) === null || _this$tooltip === void 0 ? void 0 : _this$tooltip.remove();\n    this.tooltip = null;\n\n    if (!this.props.canvas && !this.props.gl && this.canvas) {\n      var _this$canvas$parentEl;\n\n      (_this$canvas$parentEl = this.canvas.parentElement) === null || _this$canvas$parentEl === void 0 ? void 0 : _this$canvas$parentEl.removeChild(this.canvas);\n      this.canvas = null;\n    }\n  }\n\n  setProps(props) {\n    this.stats.get('setProps Time').timeStart();\n\n    if ('onLayerHover' in props) {\n      log.removed('onLayerHover', 'onHover')();\n    }\n\n    if ('onLayerClick' in props) {\n      log.removed('onLayerClick', 'onClick')();\n    }\n\n    if (props.initialViewState && !deepEqual(this.props.initialViewState, props.initialViewState)) {\n      this.viewState = props.initialViewState;\n    }\n\n    Object.assign(this.props, props);\n\n    this._setCanvasSize(this.props);\n\n    const resolvedProps = Object.create(this.props);\n    Object.assign(resolvedProps, {\n      views: this._getViews(),\n      width: this.width,\n      height: this.height,\n      viewState: this._getViewState()\n    });\n    this.animationLoop.setProps(resolvedProps);\n\n    if (this.layerManager) {\n      this.viewManager.setProps(resolvedProps);\n      this.layerManager.activateViewport(this.getViewports()[0]);\n      this.layerManager.setProps(resolvedProps);\n      this.effectManager.setProps(resolvedProps);\n      this.deckRenderer.setProps(resolvedProps);\n      this.deckPicker.setProps(resolvedProps);\n    }\n\n    this.stats.get('setProps Time').timeEnd();\n  }\n\n  needsRedraw(opts = {\n    clearRedrawFlags: false\n  }) {\n    if (!this.layerManager) {\n      return false;\n    }\n\n    if (this.props._animate) {\n      return 'Deck._animate';\n    }\n\n    let redraw = this._needsRedraw;\n\n    if (opts.clearRedrawFlags) {\n      this._needsRedraw = false;\n    }\n\n    const viewManagerNeedsRedraw = this.viewManager.needsRedraw(opts);\n    const layerManagerNeedsRedraw = this.layerManager.needsRedraw(opts);\n    const effectManagerNeedsRedraw = this.effectManager.needsRedraw(opts);\n    const deckRendererNeedsRedraw = this.deckRenderer.needsRedraw(opts);\n    redraw = redraw || viewManagerNeedsRedraw || layerManagerNeedsRedraw || effectManagerNeedsRedraw || deckRendererNeedsRedraw;\n    return redraw;\n  }\n\n  redraw(reason) {\n    if (!this.layerManager) {\n      return;\n    }\n\n    let redrawReason = this.needsRedraw({\n      clearRedrawFlags: true\n    });\n    redrawReason = reason || redrawReason;\n\n    if (!redrawReason) {\n      return;\n    }\n\n    this.stats.get('Redraw Count').incrementCount();\n\n    if (this.props._customRender) {\n      this.props._customRender(redrawReason);\n    } else {\n      this._drawLayers(redrawReason);\n    }\n  }\n\n  get isInitialized() {\n    return this.viewManager !== null;\n  }\n\n  getViews() {\n    assert(this.viewManager);\n    return this.viewManager.views;\n  }\n\n  getViewports(rect) {\n    assert(this.viewManager);\n    return this.viewManager.getViewports(rect);\n  }\n\n  pickObject(opts) {\n    const infos = this._pick('pickObject', 'pickObject Time', opts).result;\n\n    return infos.length ? infos[0] : null;\n  }\n\n  pickMultipleObjects(opts) {\n    opts.depth = opts.depth || 10;\n    return this._pick('pickObject', 'pickMultipleObjects Time', opts).result;\n  }\n\n  pickObjects(opts) {\n    return this._pick('pickObjects', 'pickObjects Time', opts);\n  }\n\n  _addResources(resources, forceUpdate = false) {\n    for (const id in resources) {\n      this.layerManager.resourceManager.add({\n        resourceId: id,\n        data: resources[id],\n        forceUpdate\n      });\n    }\n  }\n\n  _removeResources(resourceIds) {\n    for (const id of resourceIds) {\n      this.layerManager.resourceManager.remove(id);\n    }\n  }\n\n  _pick(method, statKey, opts) {\n    assert(this.deckPicker);\n    const {\n      stats\n    } = this;\n    stats.get('Pick Count').incrementCount();\n    stats.get(statKey).timeStart();\n    const infos = this.deckPicker[method]({\n      layers: this.layerManager.getLayers(opts),\n      views: this.viewManager.getViews(),\n      viewports: this.getViewports(opts),\n      onViewportActive: this.layerManager.activateViewport,\n      effects: this.effectManager.getEffects(),\n      ...opts\n    });\n    stats.get(statKey).timeEnd();\n    return infos;\n  }\n\n  _createCanvas(props) {\n    let canvas = props.canvas;\n\n    if (typeof canvas === 'string') {\n      canvas = document.getElementById(canvas);\n      assert(canvas);\n    }\n\n    if (!canvas) {\n      canvas = document.createElement('canvas');\n      canvas.id = props.id || 'deckgl-overlay';\n      const parent = props.parent || document.body;\n      parent.appendChild(canvas);\n    }\n\n    Object.assign(canvas.style, props.style);\n    return canvas;\n  }\n\n  _setCanvasSize(props) {\n    if (!this.canvas) {\n      return;\n    }\n\n    const {\n      width,\n      height\n    } = props;\n\n    if (width || width === 0) {\n      const cssWidth = Number.isFinite(width) ? \"\".concat(width, \"px\") : width;\n      this.canvas.style.width = cssWidth;\n    }\n\n    if (height || height === 0) {\n      var _props$style;\n\n      const cssHeight = Number.isFinite(height) ? \"\".concat(height, \"px\") : height;\n      this.canvas.style.position = ((_props$style = props.style) === null || _props$style === void 0 ? void 0 : _props$style.position) || 'absolute';\n      this.canvas.style.height = cssHeight;\n    }\n  }\n\n  _updateCanvasSize() {\n    const {\n      canvas\n    } = this;\n\n    if (!canvas) {\n      return;\n    }\n\n    const newWidth = canvas.clientWidth || canvas.width;\n    const newHeight = canvas.clientHeight || canvas.height;\n\n    if (newWidth !== this.width || newHeight !== this.height) {\n      var _this$viewManager2;\n\n      this.width = newWidth;\n      this.height = newHeight;\n      (_this$viewManager2 = this.viewManager) === null || _this$viewManager2 === void 0 ? void 0 : _this$viewManager2.setProps({\n        width: newWidth,\n        height: newHeight\n      });\n      this.props.onResize({\n        width: newWidth,\n        height: newHeight\n      });\n    }\n  }\n\n  _createAnimationLoop(props) {\n    const {\n      width,\n      height,\n      gl,\n      glOptions,\n      debug,\n      onError,\n      onBeforeRender,\n      onAfterRender,\n      useDevicePixels\n    } = props;\n    return new AnimationLoop({\n      width,\n      height,\n      useDevicePixels,\n      autoResizeViewport: false,\n      gl,\n      onCreateContext: opts => createGLContext({ ...glOptions,\n        ...opts,\n        canvas: this.canvas,\n        debug,\n        onContextLost: () => this._onContextLost()\n      }),\n      onInitialize: context => this._setGLContext(context.gl),\n      onRender: this._onRenderFrame.bind(this),\n      onBeforeRender,\n      onAfterRender,\n      onError\n    });\n  }\n\n  _getViewState() {\n    return this.props.viewState || this.viewState;\n  }\n\n  _getViews() {\n    let views = this.props.views || [new MapView({\n      id: 'default-view'\n    })];\n    views = Array.isArray(views) ? views : [views];\n\n    if (views.length && this.props.controller) {\n      views[0].props.controller = this.props.controller;\n    }\n\n    return views;\n  }\n\n  _onContextLost() {\n    const {\n      onError\n    } = this.props;\n\n    if (this.animationLoop && onError) {\n      onError(new Error('WebGL context is lost'));\n    }\n  }\n\n  _pickAndCallback() {\n    const {\n      _pickRequest\n    } = this;\n\n    if (_pickRequest.event) {\n      const {\n        result,\n        emptyInfo\n      } = this._pick('pickObject', 'pickObject Time', _pickRequest);\n\n      this.cursorState.isHovering = result.length > 0;\n      let pickedInfo = emptyInfo;\n      let handled = false;\n\n      for (const info of result) {\n        var _info$layer;\n\n        pickedInfo = info;\n        handled = ((_info$layer = info.layer) === null || _info$layer === void 0 ? void 0 : _info$layer.onHover(info, _pickRequest.event)) || handled;\n      }\n\n      if (!handled && this.props.onHover) {\n        this.props.onHover(pickedInfo, _pickRequest.event);\n      }\n\n      if (this.props.getTooltip && this.tooltip) {\n        const displayInfo = this.props.getTooltip(pickedInfo);\n        this.tooltip.setTooltip(displayInfo, pickedInfo.x, pickedInfo.y);\n      }\n\n      _pickRequest.event = null;\n    }\n  }\n\n  _updateCursor() {\n    const container = this.props.parent || this.canvas;\n\n    if (container) {\n      container.style.cursor = this.props.getCursor(this.cursorState);\n    }\n  }\n\n  _setGLContext(gl) {\n    if (this.layerManager) {\n      return;\n    }\n\n    if (!this.canvas) {\n      this.canvas = gl.canvas;\n      instrumentGLContext(gl, {\n        enable: true,\n        copyState: true\n      });\n    }\n\n    this.tooltip = new Tooltip(this.canvas);\n    setParameters(gl, {\n      blend: true,\n      blendFunc: [770, 771, 1, 771],\n      polygonOffsetFill: true,\n      depthTest: true,\n      depthFunc: 515\n    });\n    this.props.onWebGLInitialized(gl);\n    const timeline = new Timeline();\n    timeline.play();\n    this.animationLoop.attachTimeline(timeline);\n    this.eventManager = new EventManager(this.props.parent || gl.canvas, {\n      touchAction: this.props.touchAction,\n      recognizerOptions: this.props.eventRecognizerOptions,\n      events: {\n        pointerdown: this._onPointerDown,\n        pointermove: this._onPointerMove,\n        pointerleave: this._onPointerMove\n      }\n    });\n\n    for (const eventType in EVENTS) {\n      this.eventManager.on(eventType, this._onEvent);\n    }\n\n    this.viewManager = new ViewManager({\n      timeline,\n      eventManager: this.eventManager,\n      onViewStateChange: this._onViewStateChange.bind(this),\n      onInteractionStateChange: this._onInteractionStateChange.bind(this),\n      views: this._getViews(),\n      viewState: this._getViewState(),\n      width: this.width,\n      height: this.height\n    });\n    const viewport = this.viewManager.getViewports()[0];\n    this.layerManager = new LayerManager(gl, {\n      deck: this,\n      stats: this.stats,\n      viewport,\n      timeline\n    });\n    this.effectManager = new EffectManager();\n    this.deckRenderer = new DeckRenderer(gl);\n    this.deckPicker = new DeckPicker(gl);\n    this.setProps(this.props);\n\n    this._updateCanvasSize();\n\n    this.props.onLoad();\n  }\n\n  _drawLayers(redrawReason, renderOptions) {\n    const {\n      gl\n    } = this.layerManager.context;\n    setParameters(gl, this.props.parameters);\n    this.props.onBeforeRender({\n      gl\n    });\n    this.deckRenderer.renderLayers({\n      target: this.props._framebuffer,\n      layers: this.layerManager.getLayers(),\n      viewports: this.viewManager.getViewports(),\n      onViewportActive: this.layerManager.activateViewport,\n      views: this.viewManager.getViews(),\n      pass: 'screen',\n      redrawReason,\n      effects: this.effectManager.getEffects(),\n      ...renderOptions\n    });\n    this.props.onAfterRender({\n      gl\n    });\n  }\n\n  _onRenderFrame(animationProps) {\n    this._getFrameStats();\n\n    if (this._metricsCounter++ % 60 === 0) {\n      this._getMetrics();\n\n      this.stats.reset();\n      log.table(4, this.metrics)();\n\n      if (this.props._onMetrics) {\n        this.props._onMetrics(this.metrics);\n      }\n    }\n\n    this._updateCanvasSize();\n\n    this._updateCursor();\n\n    if (this.tooltip.isVisible && this.viewManager.needsRedraw()) {\n      this.tooltip.setTooltip(null);\n    }\n\n    this.layerManager.updateLayers();\n\n    this._pickAndCallback();\n\n    this.redraw();\n\n    if (this.viewManager) {\n      this.viewManager.updateViewStates();\n    }\n  }\n\n  _onViewStateChange(params) {\n    const viewState = this.props.onViewStateChange(params) || params.viewState;\n\n    if (this.viewState) {\n      this.viewState = { ...this.viewState,\n        [params.viewId]: viewState\n      };\n\n      if (!this.props.viewState) {\n        if (this.viewManager) {\n          this.viewManager.setProps({\n            viewState: this.viewState\n          });\n        }\n      }\n    }\n  }\n\n  _onInteractionStateChange(interactionState) {\n    this.cursorState.isDragging = interactionState.isDragging || false;\n    this.props.onInteractionStateChange(interactionState);\n  }\n\n  _getFrameStats() {\n    const {\n      stats\n    } = this;\n    stats.get('frameRate').timeEnd();\n    stats.get('frameRate').timeStart();\n    const animationLoopStats = this.animationLoop.stats;\n    stats.get('GPU Time').addTime(animationLoopStats.get('GPU Time').lastTiming);\n    stats.get('CPU Time').addTime(animationLoopStats.get('CPU Time').lastTiming);\n  }\n\n  _getMetrics() {\n    const {\n      metrics,\n      stats\n    } = this;\n    metrics.fps = stats.get('frameRate').getHz();\n    metrics.setPropsTime = stats.get('setProps Time').time;\n    metrics.updateAttributesTime = stats.get('Update Attributes').time;\n    metrics.framesRedrawn = stats.get('Redraw Count').count;\n    metrics.pickTime = stats.get('pickObject Time').time + stats.get('pickMultipleObjects Time').time + stats.get('pickObjects Time').time;\n    metrics.pickCount = stats.get('Pick Count').count;\n    metrics.gpuTime = stats.get('GPU Time').time;\n    metrics.cpuTime = stats.get('CPU Time').time;\n    metrics.gpuTimePerFrame = stats.get('GPU Time').getAverageTime();\n    metrics.cpuTimePerFrame = stats.get('CPU Time').getAverageTime();\n    const memoryStats = lumaStats.get('Memory Usage');\n    metrics.bufferMemory = memoryStats.get('Buffer Memory').count;\n    metrics.textureMemory = memoryStats.get('Texture Memory').count;\n    metrics.renderbufferMemory = memoryStats.get('Renderbuffer Memory').count;\n    metrics.gpuMemory = memoryStats.get('GPU Memory').count;\n  }\n\n}\n\n_defineProperty(Deck, \"defaultProps\", defaultProps);\n\n_defineProperty(Deck, \"VERSION\", deckGlobal.VERSION);\n//# sourceMappingURL=deck.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nexport default class ShaderAttribute {\n  constructor(dataColumn, opts) {\n    _defineProperty(this, \"opts\", void 0);\n\n    _defineProperty(this, \"source\", void 0);\n\n    this.opts = opts;\n    this.source = dataColumn;\n  }\n\n  get value() {\n    return this.source.value;\n  }\n\n  getValue() {\n    const buffer = this.source.getBuffer();\n    const accessor = this.getAccessor();\n\n    if (buffer) {\n      return [buffer, accessor];\n    }\n\n    const {\n      value\n    } = this.source;\n    const {\n      size\n    } = accessor;\n    let constantValue = value;\n\n    if (value && value.length !== size) {\n      constantValue = new Float32Array(size);\n      const index = accessor.elementOffset || 0;\n\n      for (let i = 0; i < size; ++i) {\n        constantValue[i] = value[index + i];\n      }\n    }\n\n    return constantValue;\n  }\n\n  getAccessor() {\n    return { ...this.source.getAccessor(),\n      ...this.opts\n    };\n  }\n\n}\n//# sourceMappingURL=shader-attribute.js.map","export function glArrayFromType(glType) {\n  switch (glType) {\n    case 5126:\n      return Float32Array;\n\n    case 5130:\n      return Float64Array;\n\n    case 5123:\n    case 33635:\n    case 32819:\n    case 32820:\n      return Uint16Array;\n\n    case 5125:\n      return Uint32Array;\n\n    case 5121:\n      return Uint8ClampedArray;\n\n    case 5120:\n      return Int8Array;\n\n    case 5122:\n      return Int16Array;\n\n    case 5124:\n      return Int32Array;\n\n    default:\n      throw new Error('Unknown GL type');\n  }\n}\n//# sourceMappingURL=gl-utils.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { hasFeature, FEATURES, Buffer } from '@luma.gl/core';\nimport ShaderAttribute from './shader-attribute';\nimport { glArrayFromType } from './gl-utils';\nimport typedArrayManager from '../../utils/typed-array-manager';\nimport { toDoublePrecisionArray } from '../../utils/math-utils';\nimport log from '../../utils/log';\n\nfunction getStride(accessor) {\n  return accessor.stride || accessor.size * accessor.bytesPerElement;\n}\n\nfunction resolveShaderAttribute(baseAccessor, shaderAttributeOptions) {\n  if (shaderAttributeOptions.offset) {\n    log.removed('shaderAttribute.offset', 'vertexOffset, elementOffset')();\n  }\n\n  const stride = getStride(baseAccessor);\n  const vertexOffset = shaderAttributeOptions.vertexOffset !== undefined ? shaderAttributeOptions.vertexOffset : baseAccessor.vertexOffset || 0;\n  const elementOffset = shaderAttributeOptions.elementOffset || 0;\n  const offset = vertexOffset * stride + elementOffset * baseAccessor.bytesPerElement + (baseAccessor.offset || 0);\n  return { ...shaderAttributeOptions,\n    offset,\n    stride\n  };\n}\n\nfunction resolveDoublePrecisionShaderAttributes(baseAccessor, shaderAttributeOptions) {\n  const resolvedOptions = resolveShaderAttribute(baseAccessor, shaderAttributeOptions);\n  return {\n    high: resolvedOptions,\n    low: { ...resolvedOptions,\n      offset: resolvedOptions.offset + baseAccessor.size * 4\n    }\n  };\n}\n\nexport default class DataColumn {\n  constructor(gl, opts, state) {\n    _defineProperty(this, \"gl\", void 0);\n\n    _defineProperty(this, \"id\", void 0);\n\n    _defineProperty(this, \"size\", void 0);\n\n    _defineProperty(this, \"settings\", void 0);\n\n    _defineProperty(this, \"value\", void 0);\n\n    _defineProperty(this, \"doublePrecision\", void 0);\n\n    _defineProperty(this, \"_buffer\", void 0);\n\n    _defineProperty(this, \"state\", void 0);\n\n    this.gl = gl;\n    this.id = opts.id || '';\n    this.size = opts.size || 1;\n    const logicalType = opts.logicalType || opts.type;\n    const doublePrecision = logicalType === 5130;\n    let {\n      defaultValue\n    } = opts;\n    defaultValue = Number.isFinite(defaultValue) ? [defaultValue] : defaultValue || new Array(this.size).fill(0);\n    let bufferType;\n\n    if (doublePrecision) {\n      bufferType = 5126;\n    } else if (!logicalType && opts.isIndexed) {\n      bufferType = gl && hasFeature(gl, FEATURES.ELEMENT_INDEX_UINT32) ? 5125 : 5123;\n    } else {\n      bufferType = logicalType || 5126;\n    }\n\n    let defaultType = glArrayFromType(logicalType || bufferType || 5126);\n    this.doublePrecision = doublePrecision;\n\n    if (doublePrecision && opts.fp64 === false) {\n      defaultType = Float32Array;\n    }\n\n    this.value = null;\n    this.settings = { ...opts,\n      defaultType,\n      defaultValue: defaultValue,\n      logicalType,\n      type: bufferType,\n      size: this.size,\n      bytesPerElement: defaultType.BYTES_PER_ELEMENT\n    };\n    this.state = { ...state,\n      externalBuffer: null,\n      bufferAccessor: this.settings,\n      allocatedValue: null,\n      numInstances: 0,\n      bounds: null,\n      constant: false\n    };\n    this._buffer = null;\n  }\n\n  get isConstant() {\n    return this.state.constant;\n  }\n\n  get buffer() {\n    if (!this._buffer) {\n      const {\n        isIndexed,\n        type\n      } = this.settings;\n      this._buffer = new Buffer(this.gl, {\n        id: this.id,\n        target: isIndexed ? 34963 : 34962,\n        accessor: {\n          type\n        }\n      });\n    }\n\n    return this._buffer;\n  }\n\n  get byteOffset() {\n    const accessor = this.getAccessor();\n\n    if (accessor.vertexOffset) {\n      return accessor.vertexOffset * getStride(accessor);\n    }\n\n    return 0;\n  }\n\n  get numInstances() {\n    return this.state.numInstances;\n  }\n\n  set numInstances(n) {\n    this.state.numInstances = n;\n  }\n\n  delete() {\n    if (this._buffer) {\n      this._buffer.delete();\n\n      this._buffer = null;\n    }\n\n    typedArrayManager.release(this.state.allocatedValue);\n  }\n\n  getShaderAttributes(id, options) {\n    if (this.doublePrecision) {\n      const shaderAttributes = {};\n      const isBuffer64Bit = this.value instanceof Float64Array;\n      const doubleShaderAttributeDefs = resolveDoublePrecisionShaderAttributes(this.getAccessor(), options || {});\n      shaderAttributes[id] = new ShaderAttribute(this, doubleShaderAttributeDefs.high);\n      shaderAttributes[\"\".concat(id, \"64Low\")] = isBuffer64Bit ? new ShaderAttribute(this, doubleShaderAttributeDefs.low) : new Float32Array(this.size);\n      return shaderAttributes;\n    }\n\n    if (options) {\n      const shaderAttributeDef = resolveShaderAttribute(this.getAccessor(), options);\n      return {\n        [id]: new ShaderAttribute(this, shaderAttributeDef)\n      };\n    }\n\n    return {\n      [id]: this\n    };\n  }\n\n  getBuffer() {\n    if (this.state.constant) {\n      return null;\n    }\n\n    return this.state.externalBuffer || this._buffer;\n  }\n\n  getValue() {\n    if (this.state.constant) {\n      return this.value;\n    }\n\n    return [this.getBuffer(), this.getAccessor()];\n  }\n\n  getAccessor() {\n    return this.state.bufferAccessor;\n  }\n\n  getBounds() {\n    if (this.state.bounds) {\n      return this.state.bounds;\n    }\n\n    let result = null;\n\n    if (this.state.constant && this.value) {\n      const min = Array.from(this.value);\n      result = [min, min];\n    } else {\n      const {\n        value,\n        numInstances,\n        size\n      } = this;\n      const len = numInstances * size;\n\n      if (value && len && value.length >= len) {\n        const min = new Array(size).fill(Infinity);\n        const max = new Array(size).fill(-Infinity);\n\n        for (let i = 0; i < len;) {\n          for (let j = 0; j < size; j++) {\n            const v = value[i++];\n            if (v < min[j]) min[j] = v;\n            if (v > max[j]) max[j] = v;\n          }\n        }\n\n        result = [min, max];\n      }\n    }\n\n    this.state.bounds = result;\n    return result;\n  }\n\n  setData(data) {\n    const {\n      state\n    } = this;\n    let opts;\n\n    if (ArrayBuffer.isView(data)) {\n      opts = {\n        value: data\n      };\n    } else if (data instanceof Buffer) {\n      opts = {\n        buffer: data\n      };\n    } else {\n      opts = data;\n    }\n\n    const accessor = { ...this.settings,\n      ...opts\n    };\n    state.bufferAccessor = accessor;\n    state.bounds = null;\n\n    if (opts.constant) {\n      let value = opts.value;\n      value = this._normalizeValue(value, [], 0);\n\n      if (this.settings.normalized) {\n        value = this.normalizeConstant(value);\n      }\n\n      const hasChanged = !state.constant || !this._areValuesEqual(value, this.value);\n\n      if (!hasChanged) {\n        return false;\n      }\n\n      state.externalBuffer = null;\n      state.constant = true;\n      this.value = value;\n    } else if (opts.buffer) {\n      const buffer = opts.buffer;\n      state.externalBuffer = buffer;\n      state.constant = false;\n      this.value = opts.value || null;\n      const isBuffer64Bit = opts.value instanceof Float64Array;\n      accessor.type = opts.type || buffer.accessor.type;\n      accessor.bytesPerElement = buffer.accessor.BYTES_PER_ELEMENT * (isBuffer64Bit ? 2 : 1);\n      accessor.stride = getStride(accessor);\n    } else if (opts.value) {\n      this._checkExternalBuffer(opts);\n\n      let value = opts.value;\n      state.externalBuffer = null;\n      state.constant = false;\n      this.value = value;\n      accessor.bytesPerElement = value.BYTES_PER_ELEMENT;\n      accessor.stride = getStride(accessor);\n      const {\n        buffer,\n        byteOffset\n      } = this;\n\n      if (this.doublePrecision && value instanceof Float64Array) {\n        value = toDoublePrecisionArray(value, accessor);\n      }\n\n      const requiredBufferSize = value.byteLength + byteOffset + accessor.stride * 2;\n\n      if (buffer.byteLength < requiredBufferSize) {\n        buffer.reallocate(requiredBufferSize);\n      }\n\n      buffer.setAccessor(null);\n      buffer.subData({\n        data: value,\n        offset: byteOffset\n      });\n      accessor.type = opts.type || buffer.accessor.type;\n    }\n\n    return true;\n  }\n\n  updateSubBuffer(opts = {}) {\n    this.state.bounds = null;\n    const value = this.value;\n    const {\n      startOffset = 0,\n      endOffset\n    } = opts;\n    this.buffer.subData({\n      data: this.doublePrecision && value instanceof Float64Array ? toDoublePrecisionArray(value, {\n        size: this.size,\n        startIndex: startOffset,\n        endIndex: endOffset\n      }) : value.subarray(startOffset, endOffset),\n      offset: startOffset * value.BYTES_PER_ELEMENT + this.byteOffset\n    });\n  }\n\n  allocate(numInstances, copy = false) {\n    const {\n      state\n    } = this;\n    const oldValue = state.allocatedValue;\n    const value = typedArrayManager.allocate(oldValue, numInstances + 1, {\n      size: this.size,\n      type: this.settings.defaultType,\n      copy\n    });\n    this.value = value;\n    const {\n      buffer,\n      byteOffset\n    } = this;\n\n    if (buffer.byteLength < value.byteLength + byteOffset) {\n      buffer.reallocate(value.byteLength + byteOffset);\n\n      if (copy && oldValue) {\n        buffer.subData({\n          data: oldValue instanceof Float64Array ? toDoublePrecisionArray(oldValue, this) : oldValue,\n          offset: byteOffset\n        });\n      }\n    }\n\n    state.allocatedValue = value;\n    state.constant = false;\n    state.externalBuffer = null;\n    state.bufferAccessor = this.settings;\n    return true;\n  }\n\n  _checkExternalBuffer(opts) {\n    const {\n      value\n    } = opts;\n\n    if (!ArrayBuffer.isView(value)) {\n      throw new Error(\"Attribute \".concat(this.id, \" value is not TypedArray\"));\n    }\n\n    const ArrayType = this.settings.defaultType;\n    let illegalArrayType = false;\n\n    if (this.doublePrecision) {\n      illegalArrayType = value.BYTES_PER_ELEMENT < 4;\n    }\n\n    if (illegalArrayType) {\n      throw new Error(\"Attribute \".concat(this.id, \" does not support \").concat(value.constructor.name));\n    }\n\n    if (!(value instanceof ArrayType) && this.settings.normalized && !('normalized' in opts)) {\n      log.warn(\"Attribute \".concat(this.id, \" is normalized\"))();\n    }\n  }\n\n  normalizeConstant(value) {\n    switch (this.settings.type) {\n      case 5120:\n        return new Float32Array(value).map(x => (x + 128) / 255 * 2 - 1);\n\n      case 5122:\n        return new Float32Array(value).map(x => (x + 32768) / 65535 * 2 - 1);\n\n      case 5121:\n        return new Float32Array(value).map(x => x / 255);\n\n      case 5123:\n        return new Float32Array(value).map(x => x / 65535);\n\n      default:\n        return value;\n    }\n  }\n\n  _normalizeValue(value, out, start) {\n    const {\n      defaultValue,\n      size\n    } = this.settings;\n\n    if (Number.isFinite(value)) {\n      out[start] = value;\n      return out;\n    }\n\n    if (!value) {\n      out[start] = defaultValue[0];\n      return out;\n    }\n\n    switch (size) {\n      case 4:\n        out[start + 3] = Number.isFinite(value[3]) ? value[3] : defaultValue[3];\n\n      case 3:\n        out[start + 2] = Number.isFinite(value[2]) ? value[2] : defaultValue[2];\n\n      case 2:\n        out[start + 1] = Number.isFinite(value[1]) ? value[1] : defaultValue[1];\n\n      case 1:\n        out[start + 0] = Number.isFinite(value[0]) ? value[0] : defaultValue[0];\n        break;\n\n      default:\n        let i = size;\n\n        while (--i >= 0) {\n          out[start + i] = Number.isFinite(value[i]) ? value[i] : defaultValue[i];\n        }\n\n    }\n\n    return out;\n  }\n\n  _areValuesEqual(value1, value2) {\n    if (!value1 || !value2) {\n      return false;\n    }\n\n    const {\n      size\n    } = this;\n\n    for (let i = 0; i < size; i++) {\n      if (value1[i] !== value2[i]) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n}\n//# sourceMappingURL=data-column.js.map","const EMPTY_ARRAY = [];\nconst placeholderArray = [];\nexport function createIterable(data, startRow = 0, endRow = Infinity) {\n  let iterable = EMPTY_ARRAY;\n  const objectInfo = {\n    index: -1,\n    data,\n    target: []\n  };\n\n  if (!data) {\n    iterable = EMPTY_ARRAY;\n  } else if (typeof data[Symbol.iterator] === 'function') {\n    iterable = data;\n  } else if (data.length > 0) {\n    placeholderArray.length = data.length;\n    iterable = placeholderArray;\n  }\n\n  if (startRow > 0 || Number.isFinite(endRow)) {\n    iterable = (Array.isArray(iterable) ? iterable : Array.from(iterable)).slice(startRow, endRow);\n    objectInfo.index = startRow - 1;\n  }\n\n  return {\n    iterable,\n    objectInfo\n  };\n}\nexport function isAsyncIterable(data) {\n  return data && data[Symbol.asyncIterator];\n}\nexport function getAccessorFromBuffer(typedArray, options) {\n  const {\n    size,\n    stride,\n    offset,\n    startIndices,\n    nested\n  } = options;\n  const bytesPerElement = typedArray.BYTES_PER_ELEMENT;\n  const elementStride = stride ? stride / bytesPerElement : size;\n  const elementOffset = offset ? offset / bytesPerElement : 0;\n  const vertexCount = Math.floor((typedArray.length - elementOffset) / elementStride);\n  return (_, {\n    index,\n    target\n  }) => {\n    if (!startIndices) {\n      const sourceIndex = index * elementStride + elementOffset;\n\n      for (let j = 0; j < size; j++) {\n        target[j] = typedArray[sourceIndex + j];\n      }\n\n      return target;\n    }\n\n    const startIndex = startIndices[index];\n    const endIndex = startIndices[index + 1] || vertexCount;\n    let result;\n\n    if (nested) {\n      result = new Array(endIndex - startIndex);\n\n      for (let i = startIndex; i < endIndex; i++) {\n        const sourceIndex = i * elementStride + elementOffset;\n        target = new Array(size);\n\n        for (let j = 0; j < size; j++) {\n          target[j] = typedArray[sourceIndex + j];\n        }\n\n        result[i - startIndex] = target;\n      }\n    } else if (elementStride === size) {\n      result = typedArray.subarray(startIndex * size + elementOffset, endIndex * size + elementOffset);\n    } else {\n      result = new typedArray.constructor((endIndex - startIndex) * size);\n      let targetIndex = 0;\n\n      for (let i = startIndex; i < endIndex; i++) {\n        const sourceIndex = i * elementStride + elementOffset;\n\n        for (let j = 0; j < size; j++) {\n          result[targetIndex++] = typedArray[sourceIndex + j];\n        }\n      }\n    }\n\n    return result;\n  };\n}\n//# sourceMappingURL=iterable-utils.js.map","export const EMPTY = [];\nexport const FULL = [[0, Infinity]];\nexport function add(rangeList, range) {\n  if (rangeList === FULL) {\n    return rangeList;\n  }\n\n  if (range[0] < 0) {\n    range[0] = 0;\n  }\n\n  if (range[0] >= range[1]) {\n    return rangeList;\n  }\n\n  const newRangeList = [];\n  const len = rangeList.length;\n  let insertPosition = 0;\n\n  for (let i = 0; i < len; i++) {\n    const range0 = rangeList[i];\n\n    if (range0[1] < range[0]) {\n      newRangeList.push(range0);\n      insertPosition = i + 1;\n    } else if (range0[0] > range[1]) {\n      newRangeList.push(range0);\n    } else {\n      range = [Math.min(range0[0], range[0]), Math.max(range0[1], range[1])];\n    }\n  }\n\n  newRangeList.splice(insertPosition, 0, range);\n  return newRangeList;\n}\n//# sourceMappingURL=range.js.map","function padArrayChunk(options) {\n  const {\n    source,\n    target,\n    start = 0,\n    size,\n    getData\n  } = options;\n  const end = options.end || target.length;\n  const sourceLength = source.length;\n  const targetLength = end - start;\n\n  if (sourceLength > targetLength) {\n    target.set(source.subarray(0, targetLength), start);\n    return;\n  }\n\n  target.set(source, start);\n\n  if (!getData) {\n    return;\n  }\n\n  let i = sourceLength;\n\n  while (i < targetLength) {\n    const datum = getData(i, source);\n\n    for (let j = 0; j < size; j++) {\n      target[start + i] = datum[j] || 0;\n      i++;\n    }\n  }\n}\n\nexport function padArray({\n  source,\n  target,\n  size,\n  getData,\n  sourceStartIndices,\n  targetStartIndices\n}) {\n  if (!Array.isArray(targetStartIndices)) {\n    padArrayChunk({\n      source,\n      target,\n      size,\n      getData\n    });\n    return target;\n  }\n\n  let sourceIndex = 0;\n  let targetIndex = 0;\n\n  const getChunkData = getData && ((i, chunk) => getData(i + targetIndex, chunk));\n\n  const n = Math.min(sourceStartIndices.length, targetStartIndices.length);\n\n  for (let i = 1; i < n; i++) {\n    const nextSourceIndex = sourceStartIndices[i] * size;\n    const nextTargetIndex = targetStartIndices[i] * size;\n    padArrayChunk({\n      source: source.subarray(sourceIndex, nextSourceIndex),\n      target,\n      start: targetIndex,\n      end: nextTargetIndex,\n      size,\n      getData: getChunkData\n    });\n    sourceIndex = nextSourceIndex;\n    targetIndex = nextTargetIndex;\n  }\n\n  if (targetIndex < target.length) {\n    padArrayChunk({\n      source: [],\n      target,\n      start: targetIndex,\n      size,\n      getData: getChunkData\n    });\n  }\n\n  return target;\n}\n//# sourceMappingURL=array-utils.js.map","import { padArray } from '../../utils/array-utils';\nconst DEFAULT_TRANSITION_SETTINGS = {\n  interpolation: {\n    duration: 0,\n    easing: t => t\n  },\n  spring: {\n    stiffness: 0.05,\n    damping: 0.5\n  }\n};\nexport function normalizeTransitionSettings(userSettings, layerSettings) {\n  if (!userSettings) {\n    return null;\n  }\n\n  if (Number.isFinite(userSettings)) {\n    userSettings = {\n      type: 'interpolation',\n      duration: userSettings\n    };\n  }\n\n  const type = userSettings.type || 'interpolation';\n  return { ...DEFAULT_TRANSITION_SETTINGS[type],\n    ...layerSettings,\n    ...userSettings,\n    type\n  };\n}\nexport function getSourceBufferAttribute(gl, attribute) {\n  const buffer = attribute.getBuffer();\n\n  if (buffer) {\n    return [buffer, {\n      divisor: 0,\n      size: attribute.size,\n      normalized: attribute.settings.normalized\n    }];\n  }\n\n  return attribute.value;\n}\nexport function getAttributeTypeFromSize(size) {\n  switch (size) {\n    case 1:\n      return 'float';\n\n    case 2:\n      return 'vec2';\n\n    case 3:\n      return 'vec3';\n\n    case 4:\n      return 'vec4';\n\n    default:\n      throw new Error(\"No defined attribute type for size \\\"\".concat(size, \"\\\"\"));\n  }\n}\nexport function cycleBuffers(buffers) {\n  buffers.push(buffers.shift());\n}\nexport function getAttributeBufferLength(attribute, numInstances) {\n  const {\n    doublePrecision,\n    settings,\n    value,\n    size\n  } = attribute;\n  const multiplier = doublePrecision && value instanceof Float64Array ? 2 : 1;\n  return (settings.noAlloc ? value.length : numInstances * size) * multiplier;\n}\nexport function padBuffer({\n  buffer,\n  numInstances,\n  attribute,\n  fromLength,\n  fromStartIndices,\n  getData = x => x\n}) {\n  const precisionMultiplier = attribute.doublePrecision && attribute.value instanceof Float64Array ? 2 : 1;\n  const size = attribute.size * precisionMultiplier;\n  const byteOffset = attribute.byteOffset;\n  const toStartIndices = attribute.startIndices;\n  const hasStartIndices = fromStartIndices && toStartIndices;\n  const toLength = getAttributeBufferLength(attribute, numInstances);\n  const isConstant = attribute.isConstant;\n\n  if (!hasStartIndices && fromLength >= toLength) {\n    return;\n  }\n\n  const toData = isConstant ? attribute.value : attribute.getBuffer().getData({\n    srcByteOffset: byteOffset\n  });\n\n  if (attribute.settings.normalized && !isConstant) {\n    const getter = getData;\n\n    getData = (value, chunk) => attribute.normalizeConstant(getter(value, chunk));\n  }\n\n  const getMissingData = isConstant ? (i, chunk) => getData(toData, chunk) : (i, chunk) => getData(toData.subarray(i, i + size), chunk);\n  const source = buffer.getData({\n    length: fromLength\n  });\n  const data = new Float32Array(toLength);\n  padArray({\n    source,\n    target: data,\n    sourceStartIndices: fromStartIndices,\n    targetStartIndices: toStartIndices,\n    size,\n    getData: getMissingData\n  });\n\n  if (buffer.byteLength < data.byteLength + byteOffset) {\n    buffer.reallocate(data.byteLength + byteOffset);\n  }\n\n  buffer.subData({\n    data,\n    offset: byteOffset\n  });\n}\n//# sourceMappingURL=attribute-transition-utils.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport DataColumn from './data-column';\nimport assert from '../../utils/assert';\nimport { createIterable, getAccessorFromBuffer } from '../../utils/iterable-utils';\nimport { fillArray } from '../../utils/flatten';\nimport * as range from '../../utils/range';\nimport { normalizeTransitionSettings } from './attribute-transition-utils';\nexport default class Attribute extends DataColumn {\n  constructor(gl, opts) {\n    super(gl, opts, {\n      startIndices: null,\n      lastExternalBuffer: null,\n      binaryValue: null,\n      binaryAccessor: null,\n      needsUpdate: true,\n      needsRedraw: false,\n      updateRanges: range.FULL\n    });\n\n    _defineProperty(this, \"constant\", false);\n\n    this.settings.update = opts.update || (opts.accessor ? this._autoUpdater : undefined);\n    Object.seal(this.settings);\n    Object.seal(this.state);\n\n    this._validateAttributeUpdaters();\n  }\n\n  get startIndices() {\n    return this.state.startIndices;\n  }\n\n  set startIndices(layout) {\n    this.state.startIndices = layout;\n  }\n\n  needsUpdate() {\n    return this.state.needsUpdate;\n  }\n\n  needsRedraw({\n    clearChangedFlags = false\n  } = {}) {\n    const needsRedraw = this.state.needsRedraw;\n    this.state.needsRedraw = needsRedraw && !clearChangedFlags;\n    return needsRedraw;\n  }\n\n  getUpdateTriggers() {\n    const {\n      accessor\n    } = this.settings;\n    return [this.id].concat(typeof accessor !== 'function' && accessor || []);\n  }\n\n  supportsTransition() {\n    return Boolean(this.settings.transition);\n  }\n\n  getTransitionSetting(opts) {\n    if (!opts || !this.supportsTransition()) {\n      return null;\n    }\n\n    const {\n      accessor\n    } = this.settings;\n    const layerSettings = this.settings.transition;\n    const userSettings = Array.isArray(accessor) ? opts[accessor.find(a => opts[a])] : opts[accessor];\n    return normalizeTransitionSettings(userSettings, layerSettings);\n  }\n\n  setNeedsUpdate(reason = this.id, dataRange) {\n    this.state.needsUpdate = this.state.needsUpdate || reason;\n    this.setNeedsRedraw(reason);\n\n    if (dataRange) {\n      const {\n        startRow = 0,\n        endRow = Infinity\n      } = dataRange;\n      this.state.updateRanges = range.add(this.state.updateRanges, [startRow, endRow]);\n    } else {\n      this.state.updateRanges = range.FULL;\n    }\n  }\n\n  clearNeedsUpdate() {\n    this.state.needsUpdate = false;\n    this.state.updateRanges = range.EMPTY;\n  }\n\n  setNeedsRedraw(reason = this.id) {\n    this.state.needsRedraw = this.state.needsRedraw || reason;\n  }\n\n  allocate(numInstances) {\n    const {\n      state,\n      settings\n    } = this;\n\n    if (settings.noAlloc) {\n      return false;\n    }\n\n    if (settings.update) {\n      super.allocate(numInstances, state.updateRanges !== range.FULL);\n      return true;\n    }\n\n    return false;\n  }\n\n  updateBuffer({\n    numInstances,\n    data,\n    props,\n    context\n  }) {\n    if (!this.needsUpdate()) {\n      return false;\n    }\n\n    const {\n      state: {\n        updateRanges\n      },\n      settings: {\n        update,\n        noAlloc\n      }\n    } = this;\n    let updated = true;\n\n    if (update) {\n      for (const [startRow, endRow] of updateRanges) {\n        update.call(context, this, {\n          data,\n          startRow,\n          endRow,\n          props,\n          numInstances\n        });\n      }\n\n      if (!this.value) {} else if (this.constant || this.buffer.byteLength < this.value.byteLength + this.byteOffset) {\n        this.setData({\n          value: this.value,\n          constant: this.constant\n        });\n        this.constant = false;\n      } else {\n        for (const [startRow, endRow] of updateRanges) {\n          const startOffset = Number.isFinite(startRow) ? this.getVertexOffset(startRow) : 0;\n          const endOffset = Number.isFinite(endRow) ? this.getVertexOffset(endRow) : noAlloc || !Number.isFinite(numInstances) ? this.value.length : numInstances * this.size;\n          super.updateSubBuffer({\n            startOffset,\n            endOffset\n          });\n        }\n      }\n\n      this._checkAttributeArray();\n    } else {\n      updated = false;\n    }\n\n    this.clearNeedsUpdate();\n    this.setNeedsRedraw();\n    return updated;\n  }\n\n  setConstantValue(value) {\n    if (value === undefined || typeof value === 'function') {\n      return false;\n    }\n\n    const hasChanged = this.setData({\n      constant: true,\n      value\n    });\n\n    if (hasChanged) {\n      this.setNeedsRedraw();\n    }\n\n    this.clearNeedsUpdate();\n    return true;\n  }\n\n  setExternalBuffer(buffer) {\n    const {\n      state\n    } = this;\n\n    if (!buffer) {\n      state.lastExternalBuffer = null;\n      return false;\n    }\n\n    this.clearNeedsUpdate();\n\n    if (state.lastExternalBuffer === buffer) {\n      return true;\n    }\n\n    state.lastExternalBuffer = buffer;\n    this.setNeedsRedraw();\n    this.setData(buffer);\n    return true;\n  }\n\n  setBinaryValue(buffer, startIndices = null) {\n    const {\n      state,\n      settings\n    } = this;\n\n    if (!buffer) {\n      state.binaryValue = null;\n      state.binaryAccessor = null;\n      return false;\n    }\n\n    if (settings.noAlloc) {\n      return false;\n    }\n\n    if (state.binaryValue === buffer) {\n      this.clearNeedsUpdate();\n      return true;\n    }\n\n    state.binaryValue = buffer;\n    this.setNeedsRedraw();\n    const needsUpdate = settings.transform || startIndices !== this.startIndices;\n\n    if (needsUpdate) {\n      if (ArrayBuffer.isView(buffer)) {\n        buffer = {\n          value: buffer\n        };\n      }\n\n      const binaryValue = buffer;\n      assert(ArrayBuffer.isView(binaryValue.value), \"invalid \".concat(settings.accessor));\n      const needsNormalize = Boolean(binaryValue.size) && binaryValue.size !== this.size;\n      state.binaryAccessor = getAccessorFromBuffer(binaryValue.value, {\n        size: binaryValue.size || this.size,\n        stride: binaryValue.stride,\n        offset: binaryValue.offset,\n        startIndices: startIndices,\n        nested: needsNormalize\n      });\n      return false;\n    }\n\n    this.clearNeedsUpdate();\n    this.setData(buffer);\n    return true;\n  }\n\n  getVertexOffset(row) {\n    const {\n      startIndices\n    } = this;\n    const vertexIndex = startIndices ? startIndices[row] : row;\n    return vertexIndex * this.size;\n  }\n\n  getShaderAttributes() {\n    const shaderAttributeDefs = this.settings.shaderAttributes || {\n      [this.id]: null\n    };\n    const shaderAttributes = {};\n\n    for (const shaderAttributeName in shaderAttributeDefs) {\n      Object.assign(shaderAttributes, super.getShaderAttributes(shaderAttributeName, shaderAttributeDefs[shaderAttributeName]));\n    }\n\n    return shaderAttributes;\n  }\n\n  _autoUpdater(attribute, {\n    data,\n    startRow,\n    endRow,\n    props,\n    numInstances\n  }) {\n    if (attribute.constant) {\n      return;\n    }\n\n    const {\n      settings,\n      state,\n      value,\n      size,\n      startIndices\n    } = attribute;\n    const {\n      accessor,\n      transform\n    } = settings;\n    const accessorFunc = state.binaryAccessor || (typeof accessor === 'function' ? accessor : props[accessor]);\n    assert(typeof accessorFunc === 'function', \"accessor \\\"\".concat(accessor, \"\\\" is not a function\"));\n    let i = attribute.getVertexOffset(startRow);\n    const {\n      iterable,\n      objectInfo\n    } = createIterable(data, startRow, endRow);\n\n    for (const object of iterable) {\n      objectInfo.index++;\n      let objectValue = accessorFunc(object, objectInfo);\n\n      if (transform) {\n        objectValue = transform.call(this, objectValue);\n      }\n\n      if (startIndices) {\n        const numVertices = (objectInfo.index < startIndices.length - 1 ? startIndices[objectInfo.index + 1] : numInstances) - startIndices[objectInfo.index];\n\n        if (objectValue && Array.isArray(objectValue[0])) {\n          let startIndex = i;\n\n          for (const item of objectValue) {\n            attribute._normalizeValue(item, value, startIndex);\n\n            startIndex += size;\n          }\n        } else if (objectValue && objectValue.length > size) {\n          value.set(objectValue, i);\n        } else {\n          attribute._normalizeValue(objectValue, objectInfo.target, 0);\n\n          fillArray({\n            target: value,\n            source: objectInfo.target,\n            start: i,\n            count: numVertices\n          });\n        }\n\n        i += numVertices * size;\n      } else {\n        attribute._normalizeValue(objectValue, value, i);\n\n        i += size;\n      }\n    }\n  }\n\n  _validateAttributeUpdaters() {\n    const {\n      settings\n    } = this;\n    const hasUpdater = settings.noAlloc || typeof settings.update === 'function';\n\n    if (!hasUpdater) {\n      throw new Error(\"Attribute \".concat(this.id, \" missing update or accessor\"));\n    }\n  }\n\n  _checkAttributeArray() {\n    const {\n      value\n    } = this;\n    const limit = Math.min(4, this.size);\n\n    if (value && value.length >= limit) {\n      let valid = true;\n\n      switch (limit) {\n        case 4:\n          valid = valid && Number.isFinite(value[3]);\n\n        case 3:\n          valid = valid && Number.isFinite(value[2]);\n\n        case 2:\n          valid = valid && Number.isFinite(value[1]);\n\n        case 1:\n          valid = valid && Number.isFinite(value[0]);\n          break;\n\n        default:\n          valid = false;\n      }\n\n      if (!valid) {\n        throw new Error(\"Illegal attribute generated for \".concat(this.id));\n      }\n    }\n  }\n\n}\n//# sourceMappingURL=attribute.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { Buffer, Transform } from '@luma.gl/core';\nimport Attribute from '../lib/attribute/attribute';\nimport { padBuffer, getAttributeTypeFromSize, getSourceBufferAttribute, getAttributeBufferLength, cycleBuffers } from '../lib/attribute/attribute-transition-utils';\nimport Transition from './transition';\nexport default class GPUInterpolationTransition {\n  constructor({\n    gl,\n    attribute,\n    timeline\n  }) {\n    _defineProperty(this, \"gl\", void 0);\n\n    _defineProperty(this, \"type\", 'interpolation');\n\n    _defineProperty(this, \"attributeInTransition\", void 0);\n\n    _defineProperty(this, \"settings\", void 0);\n\n    _defineProperty(this, \"attribute\", void 0);\n\n    _defineProperty(this, \"transition\", void 0);\n\n    _defineProperty(this, \"currentStartIndices\", void 0);\n\n    _defineProperty(this, \"currentLength\", void 0);\n\n    _defineProperty(this, \"transform\", void 0);\n\n    _defineProperty(this, \"buffers\", void 0);\n\n    this.gl = gl;\n    this.transition = new Transition(timeline);\n    this.attribute = attribute;\n    this.attributeInTransition = new Attribute(gl, attribute.settings);\n    this.currentStartIndices = attribute.startIndices;\n    this.currentLength = 0;\n    this.transform = getTransform(gl, attribute);\n    const bufferOpts = {\n      byteLength: 0,\n      usage: 35050\n    };\n    this.buffers = [new Buffer(gl, bufferOpts), new Buffer(gl, bufferOpts)];\n  }\n\n  get inProgress() {\n    return this.transition.inProgress;\n  }\n\n  start(transitionSettings, numInstances) {\n    if (transitionSettings.duration <= 0) {\n      this.transition.cancel();\n      return;\n    }\n\n    this.settings = transitionSettings;\n    const {\n      gl,\n      buffers,\n      attribute\n    } = this;\n    cycleBuffers(buffers);\n    const padBufferOpts = {\n      numInstances,\n      attribute,\n      fromLength: this.currentLength,\n      fromStartIndices: this.currentStartIndices,\n      getData: transitionSettings.enter\n    };\n\n    for (const buffer of buffers) {\n      padBuffer({\n        buffer,\n        ...padBufferOpts\n      });\n    }\n\n    this.currentStartIndices = attribute.startIndices;\n    this.currentLength = getAttributeBufferLength(attribute, numInstances);\n    this.attributeInTransition.setData({\n      buffer: buffers[1],\n      value: attribute.value\n    });\n    this.transition.start(transitionSettings);\n    this.transform.update({\n      elementCount: Math.floor(this.currentLength / attribute.size),\n      sourceBuffers: {\n        aFrom: buffers[0],\n        aTo: getSourceBufferAttribute(gl, attribute)\n      },\n      feedbackBuffers: {\n        vCurrent: buffers[1]\n      }\n    });\n  }\n\n  update() {\n    const updated = this.transition.update();\n\n    if (updated) {\n      const {\n        duration,\n        easing\n      } = this.settings;\n      const {\n        time\n      } = this.transition;\n      let t = time / duration;\n\n      if (easing) {\n        t = easing(t);\n      }\n\n      this.transform.run({\n        uniforms: {\n          time: t\n        }\n      });\n    }\n\n    return updated;\n  }\n\n  cancel() {\n    this.transition.cancel();\n    this.transform.delete();\n\n    for (const buffer of this.buffers) {\n      buffer.delete();\n    }\n\n    this.buffers.length = 0;\n  }\n\n}\nconst vs = \"\\n#define SHADER_NAME interpolation-transition-vertex-shader\\n\\nuniform float time;\\nattribute ATTRIBUTE_TYPE aFrom;\\nattribute ATTRIBUTE_TYPE aTo;\\nvarying ATTRIBUTE_TYPE vCurrent;\\n\\nvoid main(void) {\\n  vCurrent = mix(aFrom, aTo, time);\\n  gl_Position = vec4(0.0);\\n}\\n\";\n\nfunction getTransform(gl, attribute) {\n  const attributeType = getAttributeTypeFromSize(attribute.size);\n  return new Transform(gl, {\n    vs,\n    defines: {\n      ATTRIBUTE_TYPE: attributeType\n    },\n    varyings: ['vCurrent']\n  });\n}\n//# sourceMappingURL=gpu-interpolation-transition.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { Buffer, Transform, Framebuffer, Texture2D, readPixelsToArray } from '@luma.gl/core';\nimport { padBuffer, getAttributeTypeFromSize, getSourceBufferAttribute, getAttributeBufferLength, cycleBuffers } from '../lib/attribute/attribute-transition-utils';\nimport Attribute from '../lib/attribute/attribute';\nimport Transition from './transition';\nexport default class GPUSpringTransition {\n  constructor({\n    gl,\n    attribute,\n    timeline\n  }) {\n    _defineProperty(this, \"gl\", void 0);\n\n    _defineProperty(this, \"type\", 'spring');\n\n    _defineProperty(this, \"attributeInTransition\", void 0);\n\n    _defineProperty(this, \"settings\", void 0);\n\n    _defineProperty(this, \"attribute\", void 0);\n\n    _defineProperty(this, \"transition\", void 0);\n\n    _defineProperty(this, \"currentStartIndices\", void 0);\n\n    _defineProperty(this, \"currentLength\", void 0);\n\n    _defineProperty(this, \"texture\", void 0);\n\n    _defineProperty(this, \"framebuffer\", void 0);\n\n    _defineProperty(this, \"transform\", void 0);\n\n    _defineProperty(this, \"buffers\", void 0);\n\n    this.gl = gl;\n    this.type = 'spring';\n    this.transition = new Transition(timeline);\n    this.attribute = attribute;\n    this.attributeInTransition = new Attribute(gl, { ...attribute.settings,\n      normalized: false\n    });\n    this.currentStartIndices = attribute.startIndices;\n    this.currentLength = 0;\n    this.texture = getTexture(gl);\n    this.framebuffer = getFramebuffer(gl, this.texture);\n    this.transform = getTransform(gl, attribute, this.framebuffer);\n    const bufferOpts = {\n      byteLength: 0,\n      usage: 35050\n    };\n    this.buffers = [new Buffer(gl, bufferOpts), new Buffer(gl, bufferOpts), new Buffer(gl, bufferOpts)];\n  }\n\n  get inProgress() {\n    return this.transition.inProgress;\n  }\n\n  start(transitionSettings, numInstances) {\n    const {\n      gl,\n      buffers,\n      attribute\n    } = this;\n    const padBufferOpts = {\n      numInstances,\n      attribute,\n      fromLength: this.currentLength,\n      fromStartIndices: this.currentStartIndices,\n      getData: transitionSettings.enter\n    };\n\n    for (const buffer of buffers) {\n      padBuffer({\n        buffer,\n        ...padBufferOpts\n      });\n    }\n\n    this.settings = transitionSettings;\n    this.currentStartIndices = attribute.startIndices;\n    this.currentLength = getAttributeBufferLength(attribute, numInstances);\n    this.attributeInTransition.setData({\n      buffer: buffers[1],\n      value: attribute.value\n    });\n    this.transition.start({ ...transitionSettings,\n      duration: Infinity\n    });\n    this.transform.update({\n      elementCount: Math.floor(this.currentLength / attribute.size),\n      sourceBuffers: {\n        aTo: getSourceBufferAttribute(gl, attribute)\n      }\n    });\n  }\n\n  update() {\n    const {\n      buffers,\n      transform,\n      framebuffer,\n      transition\n    } = this;\n    const updated = transition.update();\n\n    if (!updated) {\n      return false;\n    }\n\n    const settings = this.settings;\n    transform.update({\n      sourceBuffers: {\n        aPrev: buffers[0],\n        aCur: buffers[1]\n      },\n      feedbackBuffers: {\n        vNext: buffers[2]\n      }\n    });\n    transform.run({\n      framebuffer,\n      discard: false,\n      clearRenderTarget: true,\n      uniforms: {\n        stiffness: settings.stiffness,\n        damping: settings.damping\n      },\n      parameters: {\n        depthTest: false,\n        blend: true,\n        viewport: [0, 0, 1, 1],\n        blendFunc: [1, 1],\n        blendEquation: [32776, 32776]\n      }\n    });\n    cycleBuffers(buffers);\n    this.attributeInTransition.setData({\n      buffer: buffers[1],\n      value: this.attribute.value\n    });\n    const isTransitioning = readPixelsToArray(framebuffer)[0] > 0;\n\n    if (!isTransitioning) {\n      transition.end();\n    }\n\n    return true;\n  }\n\n  cancel() {\n    this.transition.cancel();\n    this.transform.delete();\n\n    for (const buffer of this.buffers) {\n      buffer.delete();\n    }\n\n    this.buffers.length = 0;\n    this.texture.delete();\n    this.framebuffer.delete();\n  }\n\n}\n\nfunction getTransform(gl, attribute, framebuffer) {\n  const attributeType = getAttributeTypeFromSize(attribute.size);\n  return new Transform(gl, {\n    framebuffer,\n    vs: \"\\n#define SHADER_NAME spring-transition-vertex-shader\\n\\n#define EPSILON 0.00001\\n\\nuniform float stiffness;\\nuniform float damping;\\nattribute ATTRIBUTE_TYPE aPrev;\\nattribute ATTRIBUTE_TYPE aCur;\\nattribute ATTRIBUTE_TYPE aTo;\\nvarying ATTRIBUTE_TYPE vNext;\\nvarying float vIsTransitioningFlag;\\n\\nATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {\\n  ATTRIBUTE_TYPE velocity = cur - prev;\\n  ATTRIBUTE_TYPE delta = dest - cur;\\n  ATTRIBUTE_TYPE spring = delta * stiffness;\\n  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;\\n  return spring + damper + velocity + cur;\\n}\\n\\nvoid main(void) {\\n  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;\\n  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;\\n\\n  vNext = getNextValue(aCur, aPrev, aTo);\\n  gl_Position = vec4(0, 0, 0, 1);\\n  gl_PointSize = 100.0;\\n}\\n\",\n    fs: \"\\n#define SHADER_NAME spring-transition-is-transitioning-fragment-shader\\n\\nvarying float vIsTransitioningFlag;\\n\\nvoid main(void) {\\n  if (vIsTransitioningFlag == 0.0) {\\n    discard;\\n  }\\n  gl_FragColor = vec4(1.0);\\n}\",\n    defines: {\n      ATTRIBUTE_TYPE: attributeType\n    },\n    varyings: ['vNext']\n  });\n}\n\nfunction getTexture(gl) {\n  return new Texture2D(gl, {\n    data: new Uint8Array(4),\n    format: 6408,\n    type: 5121,\n    border: 0,\n    mipmaps: false,\n    dataFormat: 6408,\n    width: 1,\n    height: 1\n  });\n}\n\nfunction getFramebuffer(gl, texture) {\n  return new Framebuffer(gl, {\n    id: 'spring-transition-is-transitioning-framebuffer',\n    width: 1,\n    height: 1,\n    attachments: {\n      [36064]: texture\n    }\n  });\n}\n//# sourceMappingURL=gpu-spring-transition.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { Transform } from '@luma.gl/core';\nimport GPUInterpolationTransition from '../../transitions/gpu-interpolation-transition';\nimport GPUSpringTransition from '../../transitions/gpu-spring-transition';\nimport log from '../../utils/log';\nconst TRANSITION_TYPES = {\n  interpolation: GPUInterpolationTransition,\n  spring: GPUSpringTransition\n};\nexport default class AttributeTransitionManager {\n  constructor(gl, {\n    id,\n    timeline\n  }) {\n    _defineProperty(this, \"id\", void 0);\n\n    _defineProperty(this, \"isSupported\", void 0);\n\n    _defineProperty(this, \"gl\", void 0);\n\n    _defineProperty(this, \"timeline\", void 0);\n\n    _defineProperty(this, \"transitions\", void 0);\n\n    _defineProperty(this, \"needsRedraw\", void 0);\n\n    _defineProperty(this, \"numInstances\", void 0);\n\n    this.id = id;\n    this.gl = gl;\n    this.timeline = timeline;\n    this.transitions = {};\n    this.needsRedraw = false;\n    this.numInstances = 1;\n    this.isSupported = Transform.isSupported(gl);\n  }\n\n  finalize() {\n    for (const attributeName in this.transitions) {\n      this._removeTransition(attributeName);\n    }\n  }\n\n  update({\n    attributes,\n    transitions,\n    numInstances\n  }) {\n    this.numInstances = numInstances || 1;\n\n    for (const attributeName in attributes) {\n      const attribute = attributes[attributeName];\n      const settings = attribute.getTransitionSetting(transitions);\n      if (!settings) continue;\n\n      this._updateAttribute(attributeName, attribute, settings);\n    }\n\n    for (const attributeName in this.transitions) {\n      const attribute = attributes[attributeName];\n\n      if (!attribute || !attribute.getTransitionSetting(transitions)) {\n        this._removeTransition(attributeName);\n      }\n    }\n  }\n\n  hasAttribute(attributeName) {\n    const transition = this.transitions[attributeName];\n    return transition && transition.inProgress;\n  }\n\n  getAttributes() {\n    const animatedAttributes = {};\n\n    for (const attributeName in this.transitions) {\n      const transition = this.transitions[attributeName];\n\n      if (transition.inProgress) {\n        animatedAttributes[attributeName] = transition.attributeInTransition;\n      }\n    }\n\n    return animatedAttributes;\n  }\n\n  run() {\n    if (!this.isSupported || this.numInstances === 0) {\n      return false;\n    }\n\n    for (const attributeName in this.transitions) {\n      const updated = this.transitions[attributeName].update();\n\n      if (updated) {\n        this.needsRedraw = true;\n      }\n    }\n\n    const needsRedraw = this.needsRedraw;\n    this.needsRedraw = false;\n    return needsRedraw;\n  }\n\n  _removeTransition(attributeName) {\n    this.transitions[attributeName].cancel();\n    delete this.transitions[attributeName];\n  }\n\n  _updateAttribute(attributeName, attribute, settings) {\n    const transition = this.transitions[attributeName];\n    let isNew = !transition || transition.type !== settings.type;\n\n    if (isNew) {\n      if (!this.isSupported) {\n        log.warn(\"WebGL2 not supported by this browser. Transition for \".concat(attributeName, \" is disabled.\"))();\n        return;\n      }\n\n      if (transition) {\n        this._removeTransition(attributeName);\n      }\n\n      const TransitionType = TRANSITION_TYPES[settings.type];\n\n      if (TransitionType) {\n        this.transitions[attributeName] = new TransitionType({\n          attribute,\n          timeline: this.timeline,\n          gl: this.gl\n        });\n      } else {\n        log.error(\"unsupported transition type '\".concat(settings.type, \"'\"))();\n        isNew = false;\n      }\n    }\n\n    if (isNew || attribute.needsRedraw()) {\n      this.needsRedraw = true;\n      this.transitions[attributeName].start(settings, this.numInstances);\n    }\n  }\n\n}\n//# sourceMappingURL=attribute-transition-manager.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport Attribute from './attribute';\nimport log from '../../utils/log';\nimport debug from '../../debug';\nimport AttributeTransitionManager from './attribute-transition-manager';\nconst TRACE_INVALIDATE = 'attributeManager.invalidate';\nconst TRACE_UPDATE_START = 'attributeManager.updateStart';\nconst TRACE_UPDATE_END = 'attributeManager.updateEnd';\nconst TRACE_ATTRIBUTE_UPDATE_START = 'attribute.updateStart';\nconst TRACE_ATTRIBUTE_ALLOCATE = 'attribute.allocate';\nconst TRACE_ATTRIBUTE_UPDATE_END = 'attribute.updateEnd';\nexport default class AttributeManager {\n  constructor(gl, {\n    id = 'attribute-manager',\n    stats,\n    timeline\n  } = {}) {\n    _defineProperty(this, \"id\", void 0);\n\n    _defineProperty(this, \"gl\", void 0);\n\n    _defineProperty(this, \"attributes\", void 0);\n\n    _defineProperty(this, \"updateTriggers\", void 0);\n\n    _defineProperty(this, \"needsRedraw\", void 0);\n\n    _defineProperty(this, \"userData\", void 0);\n\n    _defineProperty(this, \"stats\", void 0);\n\n    _defineProperty(this, \"attributeTransitionManager\", void 0);\n\n    this.id = id;\n    this.gl = gl;\n    this.attributes = {};\n    this.updateTriggers = {};\n    this.needsRedraw = true;\n    this.userData = {};\n    this.stats = stats;\n    this.attributeTransitionManager = new AttributeTransitionManager(gl, {\n      id: \"\".concat(id, \"-transitions\"),\n      timeline\n    });\n    Object.seal(this);\n  }\n\n  finalize() {\n    for (const attributeName in this.attributes) {\n      this.attributes[attributeName].delete();\n    }\n\n    this.attributeTransitionManager.finalize();\n  }\n\n  getNeedsRedraw(opts = {\n    clearRedrawFlags: false\n  }) {\n    const redraw = this.needsRedraw;\n    this.needsRedraw = this.needsRedraw && !opts.clearRedrawFlags;\n    return redraw && this.id;\n  }\n\n  setNeedsRedraw() {\n    this.needsRedraw = true;\n  }\n\n  add(attributes) {\n    this._add(attributes);\n  }\n\n  addInstanced(attributes) {\n    this._add(attributes, {\n      instanced: 1\n    });\n  }\n\n  remove(attributeNameArray) {\n    for (const name of attributeNameArray) {\n      if (this.attributes[name] !== undefined) {\n        this.attributes[name].delete();\n        delete this.attributes[name];\n      }\n    }\n  }\n\n  invalidate(triggerName, dataRange) {\n    const invalidatedAttributes = this._invalidateTrigger(triggerName, dataRange);\n\n    debug(TRACE_INVALIDATE, this, triggerName, invalidatedAttributes);\n  }\n\n  invalidateAll(dataRange) {\n    for (const attributeName in this.attributes) {\n      this.attributes[attributeName].setNeedsUpdate(attributeName, dataRange);\n    }\n\n    debug(TRACE_INVALIDATE, this, 'all');\n  }\n\n  update({\n    data,\n    numInstances,\n    startIndices = null,\n    transitions,\n    props = {},\n    buffers = {},\n    context = {}\n  }) {\n    let updated = false;\n    debug(TRACE_UPDATE_START, this);\n\n    if (this.stats) {\n      this.stats.get('Update Attributes').timeStart();\n    }\n\n    for (const attributeName in this.attributes) {\n      const attribute = this.attributes[attributeName];\n      const accessorName = attribute.settings.accessor;\n      attribute.startIndices = startIndices;\n      attribute.numInstances = numInstances;\n\n      if (props[attributeName]) {\n        log.removed(\"props.\".concat(attributeName), \"data.attributes.\".concat(attributeName))();\n      }\n\n      if (attribute.setExternalBuffer(buffers[attributeName])) {} else if (attribute.setBinaryValue(typeof accessorName === 'string' ? buffers[accessorName] : undefined, data.startIndices)) {} else if (typeof accessorName === 'string' && !buffers[accessorName] && attribute.setConstantValue(props[accessorName])) {} else if (attribute.needsUpdate()) {\n        updated = true;\n\n        this._updateAttribute({\n          attribute,\n          numInstances,\n          data,\n          props,\n          context\n        });\n      }\n\n      this.needsRedraw = this.needsRedraw || attribute.needsRedraw();\n    }\n\n    if (updated) {\n      debug(TRACE_UPDATE_END, this, numInstances);\n    }\n\n    if (this.stats) {\n      this.stats.get('Update Attributes').timeEnd();\n    }\n\n    this.attributeTransitionManager.update({\n      attributes: this.attributes,\n      numInstances,\n      transitions\n    });\n  }\n\n  updateTransition() {\n    const {\n      attributeTransitionManager\n    } = this;\n    const transitionUpdated = attributeTransitionManager.run();\n    this.needsRedraw = this.needsRedraw || transitionUpdated;\n    return transitionUpdated;\n  }\n\n  getAttributes() {\n    return this.attributes;\n  }\n\n  getChangedAttributes(opts = {\n    clearChangedFlags: false\n  }) {\n    const {\n      attributes,\n      attributeTransitionManager\n    } = this;\n    const changedAttributes = { ...attributeTransitionManager.getAttributes()\n    };\n\n    for (const attributeName in attributes) {\n      const attribute = attributes[attributeName];\n\n      if (attribute.needsRedraw(opts) && !attributeTransitionManager.hasAttribute(attributeName)) {\n        changedAttributes[attributeName] = attribute;\n      }\n    }\n\n    return changedAttributes;\n  }\n\n  getShaderAttributes(attributes, excludeAttributes = {}) {\n    if (!attributes) {\n      attributes = this.getAttributes();\n    }\n\n    const shaderAttributes = {};\n\n    for (const attributeName in attributes) {\n      if (!excludeAttributes[attributeName]) {\n        Object.assign(shaderAttributes, attributes[attributeName].getShaderAttributes());\n      }\n    }\n\n    return shaderAttributes;\n  }\n\n  _add(attributes, extraProps = {}) {\n    for (const attributeName in attributes) {\n      const attribute = attributes[attributeName];\n      this.attributes[attributeName] = this._createAttribute(attributeName, attribute, extraProps);\n    }\n\n    this._mapUpdateTriggersToAttributes();\n  }\n\n  _createAttribute(name, attribute, extraProps) {\n    const props = { ...attribute,\n      id: name,\n      size: attribute.isIndexed && 1 || attribute.size || 1,\n      divisor: extraProps.instanced ? 1 : attribute.divisor || 0\n    };\n    return new Attribute(this.gl, props);\n  }\n\n  _mapUpdateTriggersToAttributes() {\n    const triggers = {};\n\n    for (const attributeName in this.attributes) {\n      const attribute = this.attributes[attributeName];\n      attribute.getUpdateTriggers().forEach(triggerName => {\n        if (!triggers[triggerName]) {\n          triggers[triggerName] = [];\n        }\n\n        triggers[triggerName].push(attributeName);\n      });\n    }\n\n    this.updateTriggers = triggers;\n  }\n\n  _invalidateTrigger(triggerName, dataRange) {\n    const {\n      attributes,\n      updateTriggers\n    } = this;\n    const invalidatedAttributes = updateTriggers[triggerName];\n\n    if (invalidatedAttributes) {\n      invalidatedAttributes.forEach(name => {\n        const attribute = attributes[name];\n\n        if (attribute) {\n          attribute.setNeedsUpdate(attribute.id, dataRange);\n        }\n      });\n    }\n\n    return invalidatedAttributes;\n  }\n\n  _updateAttribute(opts) {\n    const {\n      attribute,\n      numInstances\n    } = opts;\n    debug(TRACE_ATTRIBUTE_UPDATE_START, attribute);\n\n    if (attribute.constant) {\n      attribute.setConstantValue(attribute.value);\n      return;\n    }\n\n    if (attribute.allocate(numInstances)) {\n      debug(TRACE_ATTRIBUTE_ALLOCATE, attribute, numInstances);\n    }\n\n    const updated = attribute.updateBuffer(opts);\n\n    if (updated) {\n      this.needsRedraw = true;\n      debug(TRACE_ATTRIBUTE_UPDATE_END, attribute, numInstances);\n    }\n  }\n\n}\n//# sourceMappingURL=attribute-manager.js.map","import { lerp } from '@math.gl/core';\nimport Transition from './transition';\nexport default class CPUInterpolationTransition extends Transition {\n  get value() {\n    return this._value;\n  }\n\n  _onUpdate() {\n    const {\n      time,\n      settings: {\n        fromValue,\n        toValue,\n        duration,\n        easing\n      }\n    } = this;\n    const t = easing(time / duration);\n    this._value = lerp(fromValue, toValue, t);\n  }\n\n}\n//# sourceMappingURL=cpu-interpolation-transition.js.map","import Transition from './transition';\nconst EPSILON = 1e-5;\n\nfunction updateSpringElement(prev, cur, dest, damping, stiffness) {\n  const velocity = cur - prev;\n  const delta = dest - cur;\n  const spring = delta * stiffness;\n  const damper = -velocity * damping;\n  return spring + damper + velocity + cur;\n}\n\nfunction updateSpring(prev, cur, dest, damping, stiffness) {\n  if (Array.isArray(dest)) {\n    const next = [];\n\n    for (let i = 0; i < dest.length; i++) {\n      next[i] = updateSpringElement(prev[i], cur[i], dest[i], damping, stiffness);\n    }\n\n    return next;\n  }\n\n  return updateSpringElement(prev, cur, dest, damping, stiffness);\n}\n\nfunction distance(value1, value2) {\n  if (Array.isArray(value1)) {\n    let distanceSquare = 0;\n\n    for (let i = 0; i < value1.length; i++) {\n      const d = value1[i] - value2[i];\n      distanceSquare += d * d;\n    }\n\n    return Math.sqrt(distanceSquare);\n  }\n\n  return Math.abs(value1 - value2);\n}\n\nexport default class CPUSpringTransition extends Transition {\n  get value() {\n    return this._currValue;\n  }\n\n  _onUpdate() {\n    const {\n      fromValue,\n      toValue,\n      damping,\n      stiffness\n    } = this.settings;\n    const {\n      _prevValue = fromValue,\n      _currValue = fromValue\n    } = this;\n    let nextValue = updateSpring(_prevValue, _currValue, toValue, damping, stiffness);\n    const delta = distance(nextValue, toValue);\n    const velocity = distance(nextValue, _currValue);\n\n    if (delta < EPSILON && velocity < EPSILON) {\n      nextValue = toValue;\n      this.end();\n    }\n\n    this._prevValue = _currValue;\n    this._currValue = nextValue;\n  }\n\n}\n//# sourceMappingURL=cpu-spring-transition.js.map","import { normalizeTransitionSettings } from './attribute/attribute-transition-utils';\nimport CPUInterpolationTransition from '../transitions/cpu-interpolation-transition';\nimport CPUSpringTransition from '../transitions/cpu-spring-transition';\nimport log from '../utils/log';\nconst TRANSITION_TYPES = {\n  interpolation: CPUInterpolationTransition,\n  spring: CPUSpringTransition\n};\nexport default class UniformTransitionManager {\n  constructor(timeline) {\n    this.transitions = new Map();\n    this.timeline = timeline;\n  }\n\n  get active() {\n    return this.transitions.size > 0;\n  }\n\n  add(key, fromValue, toValue, settings) {\n    const {\n      transitions\n    } = this;\n\n    if (transitions.has(key)) {\n      const transition = transitions.get(key);\n      const {\n        value = transition.settings.fromValue\n      } = transition;\n      fromValue = value;\n      this.remove(key);\n    }\n\n    settings = normalizeTransitionSettings(settings);\n\n    if (!settings) {\n      return;\n    }\n\n    const TransitionType = TRANSITION_TYPES[settings.type];\n\n    if (!TransitionType) {\n      log.error(\"unsupported transition type '\".concat(settings.type, \"'\"))();\n      return;\n    }\n\n    const transition = new TransitionType(this.timeline);\n    transition.start({ ...settings,\n      fromValue,\n      toValue\n    });\n    transitions.set(key, transition);\n  }\n\n  remove(key) {\n    const {\n      transitions\n    } = this;\n\n    if (transitions.has(key)) {\n      transitions.get(key).cancel();\n      transitions.delete(key);\n    }\n  }\n\n  update() {\n    const propsInTransition = {};\n\n    for (const [key, transition] of this.transitions) {\n      transition.update();\n      propsInTransition[key] = transition.value;\n\n      if (!transition.inProgress) {\n        this.remove(key);\n      }\n    }\n\n    return propsInTransition;\n  }\n\n  clear() {\n    for (const key of this.transitions.keys()) {\n      this.remove(key);\n    }\n  }\n\n}\n//# sourceMappingURL=uniform-transition-manager.js.map","import { COMPONENT_SYMBOL } from './constants';\nexport function validateProps(props) {\n  const propTypes = getPropTypes(props);\n\n  for (const propName in propTypes) {\n    const propType = propTypes[propName];\n    const {\n      validate\n    } = propType;\n\n    if (validate && !validate(props[propName], propType)) {\n      throw new Error(\"Invalid prop \".concat(propName, \": \").concat(props[propName]));\n    }\n  }\n}\nexport function diffProps(props, oldProps) {\n  const propsChangedReason = compareProps({\n    newProps: props,\n    oldProps,\n    propTypes: getPropTypes(props),\n    ignoreProps: {\n      data: null,\n      updateTriggers: null,\n      extensions: null,\n      transitions: null\n    }\n  });\n  const dataChangedReason = diffDataProps(props, oldProps);\n  let updateTriggersChangedReason = false;\n\n  if (!dataChangedReason) {\n    updateTriggersChangedReason = diffUpdateTriggers(props, oldProps);\n  }\n\n  return {\n    dataChanged: dataChangedReason,\n    propsChanged: propsChangedReason,\n    updateTriggersChanged: updateTriggersChangedReason,\n    extensionsChanged: diffExtensions(props, oldProps),\n    transitionsChanged: diffTransitions(props, oldProps)\n  };\n}\n\nfunction diffTransitions(props, oldProps) {\n  if (!props.transitions) {\n    return false;\n  }\n\n  const result = {};\n  const propTypes = getPropTypes(props);\n  let changed = false;\n\n  for (const key in props.transitions) {\n    const propType = propTypes[key];\n    const type = propType && propType.type;\n    const isTransitionable = type === 'number' || type === 'color' || type === 'array';\n\n    if (isTransitionable && comparePropValues(props[key], oldProps[key], propType)) {\n      result[key] = true;\n      changed = true;\n    }\n  }\n\n  return changed ? result : false;\n}\n\nexport function compareProps({\n  newProps,\n  oldProps,\n  ignoreProps = {},\n  propTypes = {},\n  triggerName = 'props'\n}) {\n  if (oldProps === newProps) {\n    return false;\n  }\n\n  if (typeof newProps !== 'object' || newProps === null) {\n    return \"\".concat(triggerName, \" changed shallowly\");\n  }\n\n  if (typeof oldProps !== 'object' || oldProps === null) {\n    return \"\".concat(triggerName, \" changed shallowly\");\n  }\n\n  for (const key of Object.keys(newProps)) {\n    if (!(key in ignoreProps)) {\n      if (!(key in oldProps)) {\n        return \"\".concat(triggerName, \".\").concat(key, \" added\");\n      }\n\n      const changed = comparePropValues(newProps[key], oldProps[key], propTypes[key]);\n\n      if (changed) {\n        return \"\".concat(triggerName, \".\").concat(key, \" \").concat(changed);\n      }\n    }\n  }\n\n  for (const key of Object.keys(oldProps)) {\n    if (!(key in ignoreProps)) {\n      if (!(key in newProps)) {\n        return \"\".concat(triggerName, \".\").concat(key, \" dropped\");\n      }\n\n      if (!Object.hasOwnProperty.call(newProps, key)) {\n        const changed = comparePropValues(newProps[key], oldProps[key], propTypes[key]);\n\n        if (changed) {\n          return \"\".concat(triggerName, \".\").concat(key, \" \").concat(changed);\n        }\n      }\n    }\n  }\n\n  return false;\n}\n\nfunction comparePropValues(newProp, oldProp, propType) {\n  let equal = propType && propType.equal;\n\n  if (equal && !equal(newProp, oldProp, propType)) {\n    return 'changed deeply';\n  }\n\n  if (!equal) {\n    equal = newProp && oldProp && newProp.equals;\n\n    if (equal && !equal.call(newProp, oldProp)) {\n      return 'changed deeply';\n    }\n  }\n\n  if (!equal && oldProp !== newProp) {\n    return 'changed shallowly';\n  }\n\n  return null;\n}\n\nfunction diffDataProps(props, oldProps) {\n  if (oldProps === null) {\n    return 'oldProps is null, initial diff';\n  }\n\n  let dataChanged = false;\n  const {\n    dataComparator,\n    _dataDiff\n  } = props;\n\n  if (dataComparator) {\n    if (!dataComparator(props.data, oldProps.data)) {\n      dataChanged = 'Data comparator detected a change';\n    }\n  } else if (props.data !== oldProps.data) {\n    dataChanged = 'A new data container was supplied';\n  }\n\n  if (dataChanged && _dataDiff) {\n    dataChanged = _dataDiff(props.data, oldProps.data) || dataChanged;\n  }\n\n  return dataChanged;\n}\n\nfunction diffUpdateTriggers(props, oldProps) {\n  if (oldProps === null) {\n    return {\n      all: true\n    };\n  }\n\n  if ('all' in props.updateTriggers) {\n    const diffReason = diffUpdateTrigger(props, oldProps, 'all');\n\n    if (diffReason) {\n      return {\n        all: true\n      };\n    }\n  }\n\n  const reason = {};\n  let changed = false;\n\n  for (const triggerName in props.updateTriggers) {\n    if (triggerName !== 'all') {\n      const diffReason = diffUpdateTrigger(props, oldProps, triggerName);\n\n      if (diffReason) {\n        reason[triggerName] = true;\n        changed = true;\n      }\n    }\n  }\n\n  return changed ? reason : false;\n}\n\nfunction diffExtensions(props, oldProps) {\n  if (oldProps === null) {\n    return true;\n  }\n\n  const oldExtensions = oldProps.extensions;\n  const {\n    extensions\n  } = props;\n\n  if (extensions === oldExtensions) {\n    return false;\n  }\n\n  if (!oldExtensions || !extensions) {\n    return true;\n  }\n\n  if (extensions.length !== oldExtensions.length) {\n    return true;\n  }\n\n  for (let i = 0; i < extensions.length; i++) {\n    if (!extensions[i].equals(oldExtensions[i])) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nfunction diffUpdateTrigger(props, oldProps, triggerName) {\n  let newTriggers = props.updateTriggers[triggerName];\n  newTriggers = newTriggers === undefined || newTriggers === null ? {} : newTriggers;\n  let oldTriggers = oldProps.updateTriggers[triggerName];\n  oldTriggers = oldTriggers === undefined || oldTriggers === null ? {} : oldTriggers;\n  const diffReason = compareProps({\n    oldProps: oldTriggers,\n    newProps: newTriggers,\n    triggerName\n  });\n  return diffReason;\n}\n\nfunction getPropTypes(props) {\n  const layer = props[COMPONENT_SYMBOL];\n  const LayerType = layer && layer.constructor;\n  return LayerType ? LayerType._propTypes : {};\n}\n//# sourceMappingURL=props.js.map","const ERR_NOT_OBJECT = 'count(): argument not an object';\nconst ERR_NOT_CONTAINER = 'count(): argument not a container';\nexport function count(container) {\n  if (!isObject(container)) {\n    throw new Error(ERR_NOT_OBJECT);\n  }\n\n  if (typeof container.count === 'function') {\n    return container.count();\n  }\n\n  if (Number.isFinite(container.size)) {\n    return container.size;\n  }\n\n  if (Number.isFinite(container.length)) {\n    return container.length;\n  }\n\n  if (isPlainObject(container)) {\n    return Object.keys(container).length;\n  }\n\n  throw new Error(ERR_NOT_CONTAINER);\n}\n\nfunction isPlainObject(value) {\n  return value !== null && typeof value === 'object' && value.constructor === Object;\n}\n\nfunction isObject(value) {\n  return value !== null && typeof value === 'object';\n}\n//# sourceMappingURL=count.js.map","export function mergeShaders(target, source) {\n  if (!source) {\n    return target;\n  }\n\n  const result = { ...target,\n    ...source\n  };\n\n  if ('defines' in source) {\n    result.defines = { ...target.defines,\n      ...source.defines\n    };\n  }\n\n  if ('modules' in source) {\n    result.modules = (target.modules || []).concat(source.modules);\n\n    if (source.modules.some(module => module.name === 'project64')) {\n      const index = result.modules.findIndex(module => module.name === 'project32');\n\n      if (index >= 0) {\n        result.modules.splice(index, 1);\n      }\n    }\n  }\n\n  if ('inject' in source) {\n    if (!target.inject) {\n      result.inject = source.inject;\n    } else {\n      const mergedInjection = { ...target.inject\n      };\n\n      for (const key in source.inject) {\n        mergedInjection[key] = (mergedInjection[key] || '') + source.inject[key];\n      }\n\n      result.inject = mergedInjection;\n    }\n  }\n\n  return result;\n}\n//# sourceMappingURL=shader.js.map","import { Texture2D } from '@luma.gl/core';\nconst DEFAULT_TEXTURE_PARAMETERS = {\n  [10241]: 9987,\n  [10240]: 9729,\n  [10242]: 33071,\n  [10243]: 33071\n};\nconst internalTextures = {};\nexport function createTexture(layer, image) {\n  const gl = layer.context && layer.context.gl;\n\n  if (!gl || !image) {\n    return null;\n  }\n\n  if (image instanceof Texture2D) {\n    return image;\n  } else if (image.constructor && image.constructor.name !== 'Object') {\n    image = {\n      data: image\n    };\n  }\n\n  let specialTextureParameters = null;\n\n  if (image.compressed) {\n    specialTextureParameters = {\n      [10241]: image.data.length > 1 ? 9985 : 9729\n    };\n  }\n\n  const texture = new Texture2D(gl, { ...image,\n    parameters: { ...DEFAULT_TEXTURE_PARAMETERS,\n      ...specialTextureParameters,\n      ...layer.props.textureParameters\n    }\n  });\n  internalTextures[texture.id] = true;\n  return texture;\n}\nexport function destroyTexture(texture) {\n  if (!texture || !(texture instanceof Texture2D)) {\n    return;\n  }\n\n  if (internalTextures[texture.id]) {\n    texture.delete();\n    delete internalTextures[texture.id];\n  }\n}\n//# sourceMappingURL=texture.js.map","import { createTexture, destroyTexture } from '../utils/texture';\nimport { deepEqual } from '../utils/deep-equal';\nconst TYPE_DEFINITIONS = {\n  boolean: {\n    validate(value, propType) {\n      return true;\n    },\n\n    equal(value1, value2, propType) {\n      return Boolean(value1) === Boolean(value2);\n    }\n\n  },\n  number: {\n    validate(value, propType) {\n      return Number.isFinite(value) && (!('max' in propType) || value <= propType.max) && (!('min' in propType) || value >= propType.min);\n    }\n\n  },\n  color: {\n    validate(value, propType) {\n      return propType.optional && !value || isArray(value) && (value.length === 3 || value.length === 4);\n    },\n\n    equal(value1, value2, propType) {\n      return arrayEqual(value1, value2);\n    }\n\n  },\n  accessor: {\n    validate(value, propType) {\n      const valueType = getTypeOf(value);\n      return valueType === 'function' || valueType === getTypeOf(propType.value);\n    },\n\n    equal(value1, value2, propType) {\n      if (typeof value2 === 'function') {\n        return true;\n      }\n\n      return arrayEqual(value1, value2);\n    }\n\n  },\n  array: {\n    validate(value, propType) {\n      return propType.optional && !value || isArray(value);\n    },\n\n    equal(value1, value2, propType) {\n      return propType.compare ? arrayEqual(value1, value2) : value1 === value2;\n    }\n\n  },\n  object: {\n    equal(value1, value2, propType) {\n      return propType.compare ? deepEqual(value1, value2) : value1 === value2;\n    }\n\n  },\n  function: {\n    validate(value, propType) {\n      return propType.optional && !value || typeof value === 'function';\n    },\n\n    equal(value1, value2, propType) {\n      return !propType.compare || value1 === value2;\n    }\n\n  },\n  data: {\n    transform: (value, propType, component) => {\n      const {\n        dataTransform\n      } = component.props;\n      return dataTransform && value ? dataTransform(value) : value;\n    }\n  },\n  image: {\n    transform: (value, propType, component) => {\n      return createTexture(component, value);\n    },\n    release: value => {\n      destroyTexture(value);\n    }\n  }\n};\n\nfunction arrayEqual(array1, array2) {\n  if (array1 === array2) {\n    return true;\n  }\n\n  if (!isArray(array1) || !isArray(array2)) {\n    return false;\n  }\n\n  const len = array1.length;\n\n  if (len !== array2.length) {\n    return false;\n  }\n\n  for (let i = 0; i < len; i++) {\n    if (array1[i] !== array2[i]) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nexport function parsePropTypes(propDefs) {\n  const propTypes = {};\n  const defaultProps = {};\n  const deprecatedProps = {};\n\n  for (const [propName, propDef] of Object.entries(propDefs)) {\n    const deprecated = propDef === null || propDef === void 0 ? void 0 : propDef.deprecatedFor;\n\n    if (deprecated) {\n      deprecatedProps[propName] = Array.isArray(deprecated) ? deprecated : [deprecated];\n    } else {\n      const propType = parsePropType(propName, propDef);\n      propTypes[propName] = propType;\n      defaultProps[propName] = propType.value;\n    }\n  }\n\n  return {\n    propTypes,\n    defaultProps,\n    deprecatedProps\n  };\n}\n\nfunction parsePropType(name, propDef) {\n  switch (getTypeOf(propDef)) {\n    case 'object':\n      return normalizePropDefinition(name, propDef);\n\n    case 'array':\n      return normalizePropDefinition(name, {\n        type: 'array',\n        value: propDef,\n        compare: false\n      });\n\n    case 'boolean':\n      return normalizePropDefinition(name, {\n        type: 'boolean',\n        value: propDef\n      });\n\n    case 'number':\n      return normalizePropDefinition(name, {\n        type: 'number',\n        value: propDef\n      });\n\n    case 'function':\n      return normalizePropDefinition(name, {\n        type: 'function',\n        value: propDef,\n        compare: true\n      });\n\n    default:\n      return {\n        name,\n        type: 'unknown',\n        value: propDef\n      };\n  }\n}\n\nfunction normalizePropDefinition(name, propDef) {\n  if (!('type' in propDef)) {\n    if (!('value' in propDef)) {\n      return {\n        name,\n        type: 'object',\n        value: propDef\n      };\n    }\n\n    return {\n      name,\n      type: getTypeOf(propDef.value),\n      ...propDef\n    };\n  }\n\n  return {\n    name,\n    ...TYPE_DEFINITIONS[propDef.type],\n    ...propDef\n  };\n}\n\nfunction isArray(value) {\n  return Array.isArray(value) || ArrayBuffer.isView(value);\n}\n\nfunction getTypeOf(value) {\n  if (isArray(value)) {\n    return 'array';\n  }\n\n  if (value === null) {\n    return 'null';\n  }\n\n  return typeof value;\n}\n//# sourceMappingURL=prop-types.js.map","import log from '../utils/log';\nimport { isAsyncIterable } from '../utils/iterable-utils';\nimport { parsePropTypes } from './prop-types';\nimport { COMPONENT_SYMBOL, ASYNC_ORIGINAL_SYMBOL, ASYNC_RESOLVED_SYMBOL, ASYNC_DEFAULTS_SYMBOL } from './constants';\nexport function createProps(component, propObjects) {\n  const propsPrototype = getPropsPrototype(component.constructor);\n  const propsInstance = Object.create(propsPrototype);\n  propsInstance[COMPONENT_SYMBOL] = component;\n  propsInstance[ASYNC_ORIGINAL_SYMBOL] = {};\n  propsInstance[ASYNC_RESOLVED_SYMBOL] = {};\n\n  for (let i = 0; i < propObjects.length; ++i) {\n    const props = propObjects[i];\n\n    for (const key in props) {\n      propsInstance[key] = props[key];\n    }\n  }\n\n  Object.freeze(propsInstance);\n  return propsInstance;\n}\n\nfunction getPropsPrototype(componentClass) {\n  const defaultProps = getOwnProperty(componentClass, '_mergedDefaultProps');\n\n  if (!defaultProps) {\n    createPropsPrototypeAndTypes(componentClass);\n    return componentClass._mergedDefaultProps;\n  }\n\n  return defaultProps;\n}\n\nfunction createPropsPrototypeAndTypes(componentClass) {\n  const parent = componentClass.prototype;\n\n  if (!parent) {\n    return;\n  }\n\n  const parentClass = Object.getPrototypeOf(componentClass);\n  const parentDefaultProps = getPropsPrototype(parentClass);\n  const componentDefaultProps = getOwnProperty(componentClass, 'defaultProps') || {};\n  const componentPropDefs = parsePropTypes(componentDefaultProps);\n  const defaultProps = createPropsPrototype(componentPropDefs.defaultProps, parentDefaultProps, componentClass);\n  const propTypes = { ...parentClass._propTypes,\n    ...componentPropDefs.propTypes\n  };\n  addAsyncPropsToPropPrototype(defaultProps, propTypes);\n  const deprecatedProps = { ...parentClass._deprecatedProps,\n    ...componentPropDefs.deprecatedProps\n  };\n  addDeprecatedPropsToPropPrototype(defaultProps, deprecatedProps);\n  componentClass._mergedDefaultProps = defaultProps;\n  componentClass._propTypes = propTypes;\n  componentClass._deprecatedProps = deprecatedProps;\n}\n\nfunction createPropsPrototype(props, parentProps, componentClass) {\n  const defaultProps = Object.create(null);\n  Object.assign(defaultProps, parentProps, props);\n  const id = getComponentName(componentClass);\n  delete props.id;\n  Object.defineProperties(defaultProps, {\n    id: {\n      writable: true,\n      value: id\n    }\n  });\n  return defaultProps;\n}\n\nfunction addDeprecatedPropsToPropPrototype(defaultProps, deprecatedProps) {\n  for (const propName in deprecatedProps) {\n    Object.defineProperty(defaultProps, propName, {\n      enumerable: false,\n\n      set(newValue) {\n        const nameStr = \"\".concat(this.id, \": \").concat(propName);\n\n        for (const newPropName of deprecatedProps[propName]) {\n          if (!hasOwnProperty(this, newPropName)) {\n            this[newPropName] = newValue;\n          }\n        }\n\n        log.deprecated(nameStr, deprecatedProps[propName].join('/'))();\n      }\n\n    });\n  }\n}\n\nfunction addAsyncPropsToPropPrototype(defaultProps, propTypes) {\n  const defaultValues = {};\n  const descriptors = {};\n\n  for (const propName in propTypes) {\n    const propType = propTypes[propName];\n    const {\n      name,\n      value\n    } = propType;\n\n    if (propType.async) {\n      defaultValues[name] = value;\n      descriptors[name] = getDescriptorForAsyncProp(name);\n    }\n  }\n\n  defaultProps[ASYNC_DEFAULTS_SYMBOL] = defaultValues;\n  defaultProps[ASYNC_ORIGINAL_SYMBOL] = {};\n  Object.defineProperties(defaultProps, descriptors);\n}\n\nfunction getDescriptorForAsyncProp(name) {\n  return {\n    enumerable: true,\n\n    set(newValue) {\n      if (typeof newValue === 'string' || newValue instanceof Promise || isAsyncIterable(newValue)) {\n        this[ASYNC_ORIGINAL_SYMBOL][name] = newValue;\n      } else {\n        this[ASYNC_RESOLVED_SYMBOL][name] = newValue;\n      }\n    },\n\n    get() {\n      if (this[ASYNC_RESOLVED_SYMBOL]) {\n        if (name in this[ASYNC_RESOLVED_SYMBOL]) {\n          const value = this[ASYNC_RESOLVED_SYMBOL][name];\n          return value || this[ASYNC_DEFAULTS_SYMBOL][name];\n        }\n\n        if (name in this[ASYNC_ORIGINAL_SYMBOL]) {\n          const state = this[COMPONENT_SYMBOL] && this[COMPONENT_SYMBOL].internalState;\n\n          if (state && state.hasAsyncProp(name)) {\n            return state.getAsyncProp(name) || this[ASYNC_DEFAULTS_SYMBOL][name];\n          }\n        }\n      }\n\n      return this[ASYNC_DEFAULTS_SYMBOL][name];\n    }\n\n  };\n}\n\nfunction hasOwnProperty(object, prop) {\n  return Object.prototype.hasOwnProperty.call(object, prop);\n}\n\nfunction getOwnProperty(object, prop) {\n  return hasOwnProperty(object, prop) && object[prop];\n}\n\nfunction getComponentName(componentClass) {\n  const componentName = getOwnProperty(componentClass, 'layerName') || getOwnProperty(componentClass, 'componentName');\n\n  if (!componentName) {\n    log.once(0, \"\".concat(componentClass.name, \".componentName not specified\"))();\n  }\n\n  return componentName || componentClass.name;\n}\n//# sourceMappingURL=create-props.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { COMPONENT_SYMBOL, ASYNC_ORIGINAL_SYMBOL, ASYNC_RESOLVED_SYMBOL, ASYNC_DEFAULTS_SYMBOL } from './constants';\nimport { createProps } from './create-props';\nlet counter = 0;\nexport default class Component {\n  constructor(...propObjects) {\n    _defineProperty(this, \"id\", void 0);\n\n    _defineProperty(this, \"props\", void 0);\n\n    _defineProperty(this, \"count\", void 0);\n\n    this.props = createProps(this, propObjects);\n    this.id = this.props.id;\n    this.count = counter++;\n  }\n\n  clone(newProps) {\n    const {\n      props\n    } = this;\n    const asyncProps = {};\n\n    for (const key in props[ASYNC_DEFAULTS_SYMBOL]) {\n      if (key in props[ASYNC_RESOLVED_SYMBOL]) {\n        asyncProps[key] = props[ASYNC_RESOLVED_SYMBOL][key];\n      } else if (key in props[ASYNC_ORIGINAL_SYMBOL]) {\n        asyncProps[key] = props[ASYNC_ORIGINAL_SYMBOL][key];\n      }\n    }\n\n    return new this.constructor({ ...props,\n      ...asyncProps,\n      ...newProps\n    });\n  }\n\n}\n\n_defineProperty(Component, \"componentName\", 'Component');\n\n_defineProperty(Component, \"defaultProps\", {});\n//# sourceMappingURL=component.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { isAsyncIterable } from '../utils/iterable-utils';\nimport { ASYNC_ORIGINAL_SYMBOL, ASYNC_RESOLVED_SYMBOL, ASYNC_DEFAULTS_SYMBOL } from './constants';\nconst EMPTY_PROPS = Object.freeze({});\nexport default class ComponentState {\n  constructor(component) {\n    _defineProperty(this, \"component\", void 0);\n\n    _defineProperty(this, \"onAsyncPropUpdated\", void 0);\n\n    _defineProperty(this, \"asyncProps\", void 0);\n\n    _defineProperty(this, \"oldProps\", void 0);\n\n    _defineProperty(this, \"oldAsyncProps\", void 0);\n\n    this.component = component;\n    this.asyncProps = {};\n\n    this.onAsyncPropUpdated = () => {};\n\n    this.oldProps = null;\n    this.oldAsyncProps = null;\n  }\n\n  finalize() {\n    for (const propName in this.asyncProps) {\n      const asyncProp = this.asyncProps[propName];\n\n      if (asyncProp && asyncProp.type && asyncProp.type.release) {\n        asyncProp.type.release(asyncProp.resolvedValue, asyncProp.type, this.component);\n      }\n    }\n  }\n\n  getOldProps() {\n    return this.oldAsyncProps || this.oldProps || EMPTY_PROPS;\n  }\n\n  resetOldProps() {\n    this.oldAsyncProps = null;\n    this.oldProps = this.component.props;\n  }\n\n  hasAsyncProp(propName) {\n    return propName in this.asyncProps;\n  }\n\n  getAsyncProp(propName) {\n    const asyncProp = this.asyncProps[propName];\n    return asyncProp && asyncProp.resolvedValue;\n  }\n\n  isAsyncPropLoading(propName) {\n    if (propName) {\n      const asyncProp = this.asyncProps[propName];\n      return Boolean(asyncProp && asyncProp.pendingLoadCount > 0 && asyncProp.pendingLoadCount !== asyncProp.resolvedLoadCount);\n    }\n\n    for (const key in this.asyncProps) {\n      if (this.isAsyncPropLoading(key)) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  reloadAsyncProp(propName, value) {\n    this._watchPromise(propName, Promise.resolve(value));\n  }\n\n  setAsyncProps(props) {\n    const resolvedValues = props[ASYNC_RESOLVED_SYMBOL] || {};\n    const originalValues = props[ASYNC_ORIGINAL_SYMBOL] || props;\n    const defaultValues = props[ASYNC_DEFAULTS_SYMBOL] || {};\n\n    for (const propName in resolvedValues) {\n      const value = resolvedValues[propName];\n\n      this._createAsyncPropData(propName, defaultValues[propName]);\n\n      this._updateAsyncProp(propName, value);\n\n      resolvedValues[propName] = this.getAsyncProp(propName);\n    }\n\n    for (const propName in originalValues) {\n      const value = originalValues[propName];\n\n      this._createAsyncPropData(propName, defaultValues[propName]);\n\n      this._updateAsyncProp(propName, value);\n    }\n  }\n\n  _fetch(propName, url) {\n    return null;\n  }\n\n  _onResolve(propName, value) {}\n\n  _onError(propName, error) {}\n\n  _updateAsyncProp(propName, value) {\n    if (!this._didAsyncInputValueChange(propName, value)) {\n      return;\n    }\n\n    if (typeof value === 'string') {\n      value = this._fetch(propName, value);\n    }\n\n    if (value instanceof Promise) {\n      this._watchPromise(propName, value);\n\n      return;\n    }\n\n    if (isAsyncIterable(value)) {\n      this._resolveAsyncIterable(propName, value);\n\n      return;\n    }\n\n    this._setPropValue(propName, value);\n  }\n\n  _freezeAsyncOldProps() {\n    if (!this.oldAsyncProps && this.oldProps) {\n      this.oldAsyncProps = Object.create(this.oldProps);\n\n      for (const propName in this.asyncProps) {\n        Object.defineProperty(this.oldAsyncProps, propName, {\n          enumerable: true,\n          value: this.oldProps[propName]\n        });\n      }\n    }\n  }\n\n  _didAsyncInputValueChange(propName, value) {\n    const asyncProp = this.asyncProps[propName];\n\n    if (value === asyncProp.resolvedValue || value === asyncProp.lastValue) {\n      return false;\n    }\n\n    asyncProp.lastValue = value;\n    return true;\n  }\n\n  _setPropValue(propName, value) {\n    this._freezeAsyncOldProps();\n\n    const asyncProp = this.asyncProps[propName];\n\n    if (asyncProp) {\n      value = this._postProcessValue(asyncProp, value);\n      asyncProp.resolvedValue = value;\n      asyncProp.pendingLoadCount++;\n      asyncProp.resolvedLoadCount = asyncProp.pendingLoadCount;\n    }\n  }\n\n  _setAsyncPropValue(propName, value, loadCount) {\n    const asyncProp = this.asyncProps[propName];\n\n    if (asyncProp && loadCount >= asyncProp.resolvedLoadCount && value !== undefined) {\n      this._freezeAsyncOldProps();\n\n      asyncProp.resolvedValue = value;\n      asyncProp.resolvedLoadCount = loadCount;\n      this.onAsyncPropUpdated(propName, value);\n    }\n  }\n\n  _watchPromise(propName, promise) {\n    const asyncProp = this.asyncProps[propName];\n\n    if (asyncProp) {\n      asyncProp.pendingLoadCount++;\n      const loadCount = asyncProp.pendingLoadCount;\n      promise.then(data => {\n        data = this._postProcessValue(asyncProp, data);\n\n        this._setAsyncPropValue(propName, data, loadCount);\n\n        this._onResolve(propName, data);\n      }).catch(error => {\n        this._onError(propName, error);\n      });\n    }\n  }\n\n  async _resolveAsyncIterable(propName, iterable) {\n    if (propName !== 'data') {\n      this._setPropValue(propName, iterable);\n\n      return;\n    }\n\n    const asyncProp = this.asyncProps[propName];\n\n    if (!asyncProp) {\n      return;\n    }\n\n    asyncProp.pendingLoadCount++;\n    const loadCount = asyncProp.pendingLoadCount;\n    let data = [];\n    let count = 0;\n\n    for await (const chunk of iterable) {\n      const {\n        dataTransform\n      } = this.component.props;\n\n      if (dataTransform) {\n        data = dataTransform(chunk, data);\n      } else {\n        data = data.concat(chunk);\n      }\n\n      Object.defineProperty(data, '__diff', {\n        enumerable: false,\n        value: [{\n          startRow: count,\n          endRow: data.length\n        }]\n      });\n      count = data.length;\n\n      this._setAsyncPropValue(propName, data, loadCount);\n    }\n\n    this._onResolve(propName, data);\n  }\n\n  _postProcessValue(asyncProp, value) {\n    const propType = asyncProp.type;\n\n    if (propType) {\n      if (propType.release) {\n        propType.release(asyncProp.resolvedValue, propType, this.component);\n      }\n\n      if (propType.transform) {\n        return propType.transform(value, propType, this.component);\n      }\n    }\n\n    return value;\n  }\n\n  _createAsyncPropData(propName, defaultValue) {\n    const asyncProp = this.asyncProps[propName];\n\n    if (!asyncProp) {\n      const propTypes = this.component && this.component.constructor._propTypes;\n      this.asyncProps[propName] = {\n        type: propTypes && propTypes[propName],\n        lastValue: null,\n        resolvedValue: defaultValue,\n        pendingLoadCount: 0,\n        resolvedLoadCount: 0\n      };\n    }\n  }\n\n}\n//# sourceMappingURL=component-state.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport ComponentState from '../lifecycle/component-state';\nexport default class LayerState extends ComponentState {\n  constructor({\n    attributeManager,\n    layer\n  }) {\n    super(layer);\n\n    _defineProperty(this, \"attributeManager\", void 0);\n\n    _defineProperty(this, \"needsRedraw\", void 0);\n\n    _defineProperty(this, \"needsUpdate\", void 0);\n\n    _defineProperty(this, \"subLayers\", void 0);\n\n    _defineProperty(this, \"usesPickingColorCache\", void 0);\n\n    _defineProperty(this, \"changeFlags\", void 0);\n\n    _defineProperty(this, \"viewport\", void 0);\n\n    _defineProperty(this, \"uniformTransitions\", void 0);\n\n    _defineProperty(this, \"propsInTransition\", void 0);\n\n    this.attributeManager = attributeManager;\n    this.needsRedraw = true;\n    this.needsUpdate = true;\n    this.subLayers = null;\n    this.usesPickingColorCache = false;\n  }\n\n  get layer() {\n    return this.component;\n  }\n\n  set layer(layer) {\n    this.component = layer;\n  }\n\n  _fetch(propName, url) {\n    const fetch = this.component.props.fetch;\n\n    if (fetch) {\n      return fetch(url, {\n        propName,\n        layer: this.layer\n      });\n    }\n\n    return super._fetch(propName, url);\n  }\n\n  _onResolve(propName, value) {\n    const onDataLoad = this.component.props.onDataLoad;\n\n    if (propName === 'data' && onDataLoad) {\n      onDataLoad(value, {\n        propName,\n        layer: this.layer\n      });\n    }\n  }\n\n  _onError(propName, error) {\n    this.layer.raiseError(error, \"loading \".concat(propName, \" of \").concat(this.layer));\n  }\n\n}\n//# sourceMappingURL=layer-state.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { COORDINATE_SYSTEM, OPERATION } from './constants';\nimport AttributeManager from './attribute/attribute-manager';\nimport UniformTransitionManager from './uniform-transition-manager';\nimport { diffProps, validateProps } from '../lifecycle/props';\nimport { LIFECYCLE } from '../lifecycle/constants';\nimport { count } from '../utils/count';\nimport log from '../utils/log';\nimport debug from '../debug';\nimport { withParameters, setParameters } from '@luma.gl/core';\nimport assert from '../utils/assert';\nimport memoize from '../utils/memoize';\nimport { mergeShaders } from '../utils/shader';\nimport { projectPosition, getWorldPosition } from '../shaderlib/project/project-functions';\nimport typedArrayManager from '../utils/typed-array-manager';\nimport Component from '../lifecycle/component';\nimport LayerState from './layer-state';\nimport { worldToPixels } from '@math.gl/web-mercator';\nimport { load } from '@loaders.gl/core';\nconst TRACE_CHANGE_FLAG = 'layer.changeFlag';\nconst TRACE_INITIALIZE = 'layer.initialize';\nconst TRACE_UPDATE = 'layer.update';\nconst TRACE_FINALIZE = 'layer.finalize';\nconst TRACE_MATCHED = 'layer.matched';\nconst MAX_PICKING_COLOR_CACHE_SIZE = 2 ** 24 - 1;\nconst EMPTY_ARRAY = Object.freeze([]);\nconst areViewportsEqual = memoize(({\n  oldViewport,\n  viewport\n}) => {\n  return oldViewport.equals(viewport);\n});\nlet pickingColorCache = new Uint8ClampedArray(0);\nconst defaultProps = {\n  data: {\n    type: 'data',\n    value: EMPTY_ARRAY,\n    async: true\n  },\n  dataComparator: {\n    type: 'function',\n    value: null,\n    compare: false,\n    optional: true\n  },\n  _dataDiff: {\n    type: 'function',\n    value: data => data && data.__diff,\n    compare: false,\n    optional: true\n  },\n  dataTransform: {\n    type: 'function',\n    value: null,\n    compare: false,\n    optional: true\n  },\n  onDataLoad: {\n    type: 'function',\n    value: null,\n    compare: false,\n    optional: true\n  },\n  onError: {\n    type: 'function',\n    value: null,\n    compare: false,\n    optional: true\n  },\n  fetch: {\n    type: 'function',\n    value: (url, {\n      propName,\n      layer,\n      loaders,\n      loadOptions,\n      signal\n    }) => {\n      const {\n        resourceManager\n      } = layer.context;\n      loadOptions = loadOptions || layer.getLoadOptions();\n      loaders = loaders || layer.props.loaders;\n\n      if (signal) {\n        var _loadOptions;\n\n        loadOptions = { ...loadOptions,\n          fetch: { ...((_loadOptions = loadOptions) === null || _loadOptions === void 0 ? void 0 : _loadOptions.fetch),\n            signal\n          }\n        };\n      }\n\n      let inResourceManager = resourceManager.contains(url);\n\n      if (!inResourceManager && !loadOptions) {\n        resourceManager.add({\n          resourceId: url,\n          data: load(url, loaders),\n          persistent: false\n        });\n        inResourceManager = true;\n      }\n\n      if (inResourceManager) {\n        return resourceManager.subscribe({\n          resourceId: url,\n          onChange: data => {\n            var _layer$internalState;\n\n            return (_layer$internalState = layer.internalState) === null || _layer$internalState === void 0 ? void 0 : _layer$internalState.reloadAsyncProp(propName, data);\n          },\n          consumerId: layer.id,\n          requestId: propName\n        });\n      }\n\n      return load(url, loaders, loadOptions);\n    },\n    compare: false\n  },\n  updateTriggers: {},\n  visible: true,\n  pickable: false,\n  opacity: {\n    type: 'number',\n    min: 0,\n    max: 1,\n    value: 1\n  },\n  operation: OPERATION.DRAW,\n  onHover: {\n    type: 'function',\n    value: null,\n    compare: false,\n    optional: true\n  },\n  onClick: {\n    type: 'function',\n    value: null,\n    compare: false,\n    optional: true\n  },\n  onDragStart: {\n    type: 'function',\n    value: null,\n    compare: false,\n    optional: true\n  },\n  onDrag: {\n    type: 'function',\n    value: null,\n    compare: false,\n    optional: true\n  },\n  onDragEnd: {\n    type: 'function',\n    value: null,\n    compare: false,\n    optional: true\n  },\n  coordinateSystem: COORDINATE_SYSTEM.DEFAULT,\n  coordinateOrigin: {\n    type: 'array',\n    value: [0, 0, 0],\n    compare: true\n  },\n  modelMatrix: {\n    type: 'array',\n    value: null,\n    compare: true,\n    optional: true\n  },\n  wrapLongitude: false,\n  positionFormat: 'XYZ',\n  colorFormat: 'RGBA',\n  parameters: {\n    type: 'object',\n    value: {},\n    optional: true,\n    compare: true\n  },\n  transitions: null,\n  extensions: [],\n  loaders: {\n    type: 'array',\n    value: [],\n    optional: true,\n    compare: true\n  },\n  getPolygonOffset: {\n    type: 'function',\n    value: ({\n      layerIndex\n    }) => [0, -layerIndex * 100],\n    compare: false\n  },\n  highlightedObjectIndex: null,\n  autoHighlight: false,\n  highlightColor: {\n    type: 'accessor',\n    value: [0, 0, 128, 128]\n  }\n};\nexport default class Layer extends Component {\n  constructor(...args) {\n    super(...args);\n\n    _defineProperty(this, \"internalState\", null);\n\n    _defineProperty(this, \"lifecycle\", LIFECYCLE.NO_STATE);\n\n    _defineProperty(this, \"context\", void 0);\n\n    _defineProperty(this, \"state\", void 0);\n\n    _defineProperty(this, \"parent\", null);\n  }\n\n  get root() {\n    let layer = this;\n\n    while (layer.parent) {\n      layer = layer.parent;\n    }\n\n    return layer;\n  }\n\n  toString() {\n    const className = this.constructor.layerName || this.constructor.name;\n    return \"\".concat(className, \"({id: '\").concat(this.props.id, \"'})\");\n  }\n\n  project(xyz) {\n    assert(this.internalState);\n    const viewport = this.internalState.viewport || this.context.viewport;\n    const worldPosition = getWorldPosition(xyz, {\n      viewport,\n      modelMatrix: this.props.modelMatrix,\n      coordinateOrigin: this.props.coordinateOrigin,\n      coordinateSystem: this.props.coordinateSystem\n    });\n    const [x, y, z] = worldToPixels(worldPosition, viewport.pixelProjectionMatrix);\n    return xyz.length === 2 ? [x, y] : [x, y, z];\n  }\n\n  unproject(xy) {\n    assert(this.internalState);\n    const viewport = this.internalState.viewport || this.context.viewport;\n    return viewport.unproject(xy);\n  }\n\n  projectPosition(xyz, params) {\n    assert(this.internalState);\n    const viewport = this.internalState.viewport || this.context.viewport;\n    return projectPosition(xyz, {\n      viewport,\n      modelMatrix: this.props.modelMatrix,\n      coordinateOrigin: this.props.coordinateOrigin,\n      coordinateSystem: this.props.coordinateSystem,\n      ...params\n    });\n  }\n\n  get isComposite() {\n    return false;\n  }\n\n  setState(partialState) {\n    this.setChangeFlags({\n      stateChanged: true\n    });\n    Object.assign(this.state, partialState);\n    this.setNeedsRedraw();\n  }\n\n  setNeedsRedraw() {\n    if (this.internalState) {\n      this.internalState.needsRedraw = true;\n    }\n  }\n\n  setNeedsUpdate() {\n    if (this.internalState) {\n      this.context.layerManager.setNeedsUpdate(String(this));\n      this.internalState.needsUpdate = true;\n    }\n  }\n\n  get isLoaded() {\n    return this.internalState ? !this.internalState.isAsyncPropLoading() : false;\n  }\n\n  get wrapLongitude() {\n    return this.props.wrapLongitude;\n  }\n\n  isPickable() {\n    return this.props.pickable && this.props.visible;\n  }\n\n  getModels() {\n    return this.state && (this.state.models || this.state.model && [this.state.model]) || [];\n  }\n\n  setModuleParameters(moduleParameters) {\n    for (const model of this.getModels()) {\n      model.updateModuleSettings(moduleParameters);\n    }\n  }\n\n  getAttributeManager() {\n    return this.internalState && this.internalState.attributeManager;\n  }\n\n  getCurrentLayer() {\n    return this.internalState && this.internalState.layer;\n  }\n\n  getLoadOptions() {\n    return this.props.loadOptions;\n  }\n\n  use64bitPositions() {\n    const {\n      coordinateSystem\n    } = this.props;\n    return coordinateSystem === COORDINATE_SYSTEM.DEFAULT || coordinateSystem === COORDINATE_SYSTEM.LNGLAT || coordinateSystem === COORDINATE_SYSTEM.CARTESIAN;\n  }\n\n  onHover(info, pickingEvent) {\n    if (this.props.onHover) {\n      return this.props.onHover(info, pickingEvent) || false;\n    }\n\n    return false;\n  }\n\n  onClick(info, pickingEvent) {\n    if (this.props.onClick) {\n      return this.props.onClick(info, pickingEvent) || false;\n    }\n\n    return false;\n  }\n\n  nullPickingColor() {\n    return [0, 0, 0];\n  }\n\n  encodePickingColor(i, target = []) {\n    target[0] = i + 1 & 255;\n    target[1] = i + 1 >> 8 & 255;\n    target[2] = i + 1 >> 8 >> 8 & 255;\n    return target;\n  }\n\n  decodePickingColor(color) {\n    assert(color instanceof Uint8Array);\n    const [i1, i2, i3] = color;\n    const index = i1 + i2 * 256 + i3 * 65536 - 1;\n    return index;\n  }\n\n  getNumInstances() {\n    if (Number.isFinite(this.props.numInstances)) {\n      return this.props.numInstances;\n    }\n\n    if (this.state && this.state.numInstances !== undefined) {\n      return this.state.numInstances;\n    }\n\n    return count(this.props.data);\n  }\n\n  getStartIndices() {\n    if (this.props.startIndices) {\n      return this.props.startIndices;\n    }\n\n    if (this.state && this.state.startIndices) {\n      return this.state.startIndices;\n    }\n\n    return null;\n  }\n\n  getBounds() {\n    var _ref;\n\n    const attributeManager = this.getAttributeManager();\n    if (!attributeManager) return null;\n    const {\n      positions,\n      instancePositions\n    } = attributeManager.attributes;\n    return (_ref = positions || instancePositions) === null || _ref === void 0 ? void 0 : _ref.getBounds();\n  }\n\n  getShaders(shaders) {\n    for (const extension of this.props.extensions) {\n      shaders = mergeShaders(shaders, extension.getShaders.call(this, extension));\n    }\n\n    return shaders;\n  }\n\n  shouldUpdateState(params) {\n    return params.changeFlags.propsOrDataChanged;\n  }\n\n  updateState(params) {\n    const attributeManager = this.getAttributeManager();\n    const {\n      dataChanged\n    } = params.changeFlags;\n\n    if (dataChanged && attributeManager) {\n      if (Array.isArray(dataChanged)) {\n        for (const dataRange of dataChanged) {\n          attributeManager.invalidateAll(dataRange);\n        }\n      } else {\n        attributeManager.invalidateAll();\n      }\n    }\n\n    const {\n      props,\n      oldProps\n    } = params;\n    const neededPickingBuffer = Number.isInteger(oldProps.highlightedObjectIndex) || oldProps.pickable;\n    const needPickingBuffer = Number.isInteger(props.highlightedObjectIndex) || props.pickable;\n\n    if (neededPickingBuffer !== needPickingBuffer && attributeManager) {\n      const {\n        pickingColors,\n        instancePickingColors\n      } = attributeManager.attributes;\n      const pickingColorsAttribute = pickingColors || instancePickingColors;\n\n      if (pickingColorsAttribute) {\n        if (needPickingBuffer && pickingColorsAttribute.constant) {\n          pickingColorsAttribute.constant = false;\n          attributeManager.invalidate(pickingColorsAttribute.id);\n        }\n\n        if (!pickingColorsAttribute.value && !needPickingBuffer) {\n          pickingColorsAttribute.constant = true;\n          pickingColorsAttribute.value = [0, 0, 0];\n        }\n      }\n    }\n  }\n\n  finalizeState(context) {\n    for (const model of this.getModels()) {\n      model.delete();\n    }\n\n    const attributeManager = this.getAttributeManager();\n\n    if (attributeManager) {\n      attributeManager.finalize();\n    }\n\n    if (this.context) {\n      this.context.resourceManager.unsubscribe({\n        consumerId: this.id\n      });\n    }\n\n    if (this.internalState) {\n      this.internalState.uniformTransitions.clear();\n      this.internalState.finalize();\n    }\n  }\n\n  draw(opts) {\n    for (const model of this.getModels()) {\n      model.draw(opts);\n    }\n  }\n\n  getPickingInfo({\n    info,\n    mode,\n    sourceLayer\n  }) {\n    const {\n      index\n    } = info;\n\n    if (index >= 0) {\n      if (Array.isArray(this.props.data)) {\n        info.object = this.props.data[index];\n      }\n    }\n\n    return info;\n  }\n\n  raiseError(error, message) {\n    var _this$props$onError, _this$props;\n\n    if (message) {\n      error.message = \"\".concat(message, \": \").concat(error.message);\n    }\n\n    if (!((_this$props$onError = (_this$props = this.props).onError) !== null && _this$props$onError !== void 0 && _this$props$onError.call(_this$props, error))) {\n      var _this$context, _this$context$onError;\n\n      (_this$context = this.context) === null || _this$context === void 0 ? void 0 : (_this$context$onError = _this$context.onError) === null || _this$context$onError === void 0 ? void 0 : _this$context$onError.call(_this$context, error, this);\n    }\n  }\n\n  getNeedsRedraw(opts = {\n    clearRedrawFlags: false\n  }) {\n    return this._getNeedsRedraw(opts);\n  }\n\n  needsUpdate() {\n    if (!this.internalState) {\n      return false;\n    }\n\n    return this.internalState.needsUpdate || this.hasUniformTransition() || this.shouldUpdateState(this._getUpdateParams());\n  }\n\n  hasUniformTransition() {\n    var _this$internalState;\n\n    return ((_this$internalState = this.internalState) === null || _this$internalState === void 0 ? void 0 : _this$internalState.uniformTransitions.active) || false;\n  }\n\n  activateViewport(viewport) {\n    if (!this.internalState) {\n      return;\n    }\n\n    const oldViewport = this.internalState.viewport;\n    this.internalState.viewport = viewport;\n\n    if (!oldViewport || !areViewportsEqual({\n      oldViewport,\n      viewport\n    })) {\n      this.setChangeFlags({\n        viewportChanged: true\n      });\n\n      if (this.isComposite) {\n        if (this.needsUpdate()) {\n          this.setNeedsUpdate();\n        }\n      } else {\n        this._update();\n      }\n    }\n  }\n\n  invalidateAttribute(name = 'all') {\n    const attributeManager = this.getAttributeManager();\n\n    if (!attributeManager) {\n      return;\n    }\n\n    if (name === 'all') {\n      attributeManager.invalidateAll();\n    } else {\n      attributeManager.invalidate(name);\n    }\n  }\n\n  updateAttributes(changedAttributes) {\n    for (const model of this.getModels()) {\n      this._setModelAttributes(model, changedAttributes);\n    }\n  }\n\n  _updateAttributes() {\n    const attributeManager = this.getAttributeManager();\n\n    if (!attributeManager) {\n      return;\n    }\n\n    const props = this.props;\n    const numInstances = this.getNumInstances();\n    const startIndices = this.getStartIndices();\n    attributeManager.update({\n      data: props.data,\n      numInstances,\n      startIndices,\n      props,\n      transitions: props.transitions,\n      buffers: props.data.attributes,\n      context: this\n    });\n    const changedAttributes = attributeManager.getChangedAttributes({\n      clearChangedFlags: true\n    });\n    this.updateAttributes(changedAttributes);\n  }\n\n  _updateAttributeTransition() {\n    const attributeManager = this.getAttributeManager();\n\n    if (attributeManager) {\n      attributeManager.updateTransition();\n    }\n  }\n\n  _updateUniformTransition() {\n    const {\n      uniformTransitions\n    } = this.internalState;\n\n    if (uniformTransitions.active) {\n      const propsInTransition = uniformTransitions.update();\n      const props = Object.create(this.props);\n\n      for (const key in propsInTransition) {\n        Object.defineProperty(props, key, {\n          value: propsInTransition[key]\n        });\n      }\n\n      return props;\n    }\n\n    return this.props;\n  }\n\n  calculateInstancePickingColors(attribute, {\n    numInstances\n  }) {\n    if (attribute.constant) {\n      return;\n    }\n\n    const cacheSize = Math.floor(pickingColorCache.length / 3);\n    this.internalState.usesPickingColorCache = true;\n\n    if (cacheSize < numInstances) {\n      if (numInstances > MAX_PICKING_COLOR_CACHE_SIZE) {\n        log.warn('Layer has too many data objects. Picking might not be able to distinguish all objects.')();\n      }\n\n      pickingColorCache = typedArrayManager.allocate(pickingColorCache, numInstances, {\n        size: 3,\n        copy: true,\n        maxCount: Math.max(numInstances, MAX_PICKING_COLOR_CACHE_SIZE)\n      });\n      const newCacheSize = Math.floor(pickingColorCache.length / 3);\n      const pickingColor = [];\n\n      for (let i = cacheSize; i < newCacheSize; i++) {\n        this.encodePickingColor(i, pickingColor);\n        pickingColorCache[i * 3 + 0] = pickingColor[0];\n        pickingColorCache[i * 3 + 1] = pickingColor[1];\n        pickingColorCache[i * 3 + 2] = pickingColor[2];\n      }\n    }\n\n    attribute.value = pickingColorCache.subarray(0, numInstances * 3);\n  }\n\n  _setModelAttributes(model, changedAttributes) {\n    const attributeManager = this.getAttributeManager();\n    const excludeAttributes = model.userData.excludeAttributes || {};\n    const shaderAttributes = attributeManager.getShaderAttributes(changedAttributes, excludeAttributes);\n    model.setAttributes(shaderAttributes);\n  }\n\n  disablePickingIndex(objectIndex) {\n    this._disablePickingIndex(objectIndex);\n  }\n\n  _disablePickingIndex(objectIndex) {\n    const {\n      pickingColors,\n      instancePickingColors\n    } = this.getAttributeManager().attributes;\n    const colors = pickingColors || instancePickingColors;\n\n    if (!colors) {\n      return;\n    }\n\n    const start = colors.getVertexOffset(objectIndex);\n    const end = colors.getVertexOffset(objectIndex + 1);\n    colors.buffer.subData({\n      data: new Uint8Array(end - start),\n      offset: start\n    });\n  }\n\n  restorePickingColors() {\n    const {\n      pickingColors,\n      instancePickingColors\n    } = this.getAttributeManager().attributes;\n    const colors = pickingColors || instancePickingColors;\n\n    if (!colors) {\n      return;\n    }\n\n    if (this.internalState.usesPickingColorCache && colors.value.buffer !== pickingColorCache.buffer) {\n      colors.value = pickingColorCache.subarray(0, colors.value.length);\n    }\n\n    colors.updateSubBuffer({\n      startOffset: 0\n    });\n  }\n\n  _initialize() {\n    assert(!this.internalState);\n    assert(Number.isFinite(this.props.coordinateSystem));\n    debug(TRACE_INITIALIZE, this);\n\n    const attributeManager = this._getAttributeManager();\n\n    if (attributeManager) {\n      attributeManager.addInstanced({\n        instancePickingColors: {\n          type: 5121,\n          size: 3,\n          noAlloc: true,\n          update: this.calculateInstancePickingColors\n        }\n      });\n    }\n\n    this.internalState = new LayerState({\n      attributeManager,\n      layer: this\n    });\n\n    this._clearChangeFlags();\n\n    this.state = {};\n    Object.defineProperty(this.state, 'attributeManager', {\n      get: () => {\n        log.deprecated('layer.state.attributeManager', 'layer.getAttributeManager()')();\n        return attributeManager;\n      }\n    });\n    this.internalState.layer = this;\n    this.internalState.uniformTransitions = new UniformTransitionManager(this.context.timeline);\n    this.internalState.onAsyncPropUpdated = this._onAsyncPropUpdated.bind(this);\n    this.internalState.setAsyncProps(this.props);\n    this.initializeState(this.context);\n\n    for (const extension of this.props.extensions) {\n      extension.initializeState.call(this, this.context, extension);\n    }\n\n    this.setChangeFlags({\n      dataChanged: 'init',\n      propsChanged: 'init',\n      viewportChanged: true,\n      extensionsChanged: true\n    });\n\n    this._update();\n  }\n\n  _transferState(oldLayer) {\n    debug(TRACE_MATCHED, this, this === oldLayer);\n    const {\n      state,\n      internalState\n    } = oldLayer;\n\n    if (this === oldLayer) {\n      return;\n    }\n\n    this.internalState = internalState;\n    this.internalState.layer = this;\n    this.state = state;\n    this.internalState.setAsyncProps(this.props);\n\n    this._diffProps(this.props, this.internalState.getOldProps());\n  }\n\n  _update() {\n    const stateNeedsUpdate = this.needsUpdate();\n    debug(TRACE_UPDATE, this, stateNeedsUpdate);\n\n    if (!stateNeedsUpdate) {\n      return;\n    }\n\n    const currentProps = this.props;\n    const context = this.context;\n    const internalState = this.internalState;\n    const currentViewport = context.viewport;\n\n    const propsInTransition = this._updateUniformTransition();\n\n    internalState.propsInTransition = propsInTransition;\n    context.viewport = internalState.viewport || currentViewport;\n    this.props = propsInTransition;\n\n    try {\n      const updateParams = this._getUpdateParams();\n\n      const oldModels = this.getModels();\n\n      if (context.gl) {\n        this.updateState(updateParams);\n      } else {\n        try {\n          this.updateState(updateParams);\n        } catch (error) {}\n      }\n\n      for (const extension of this.props.extensions) {\n        extension.updateState.call(this, updateParams, extension);\n      }\n\n      const modelChanged = this.getModels()[0] !== oldModels[0];\n\n      this._postUpdate(updateParams, modelChanged);\n    } finally {\n      context.viewport = currentViewport;\n      this.props = currentProps;\n\n      this._clearChangeFlags();\n\n      internalState.needsUpdate = false;\n      internalState.resetOldProps();\n    }\n  }\n\n  _finalize() {\n    debug(TRACE_FINALIZE, this);\n    this.finalizeState(this.context);\n\n    for (const extension of this.props.extensions) {\n      extension.finalizeState.call(this, extension);\n    }\n  }\n\n  _drawLayer({\n    moduleParameters = null,\n    uniforms = {},\n    parameters = {}\n  }) {\n    this._updateAttributeTransition();\n\n    const currentProps = this.props;\n    const context = this.context;\n    this.props = this.internalState.propsInTransition || currentProps;\n    const opacity = this.props.opacity;\n    uniforms.opacity = Math.pow(opacity, 1 / 2.2);\n\n    try {\n      if (moduleParameters) {\n        this.setModuleParameters(moduleParameters);\n      }\n\n      const {\n        getPolygonOffset\n      } = this.props;\n      const offsets = getPolygonOffset && getPolygonOffset(uniforms) || [0, 0];\n      setParameters(context.gl, {\n        polygonOffset: offsets\n      });\n      withParameters(context.gl, parameters, () => {\n        const opts = {\n          moduleParameters,\n          uniforms,\n          parameters,\n          context\n        };\n\n        for (const extension of this.props.extensions) {\n          extension.draw.call(this, opts, extension);\n        }\n\n        this.draw(opts);\n      });\n    } finally {\n      this.props = currentProps;\n    }\n  }\n\n  getChangeFlags() {\n    var _this$internalState2;\n\n    return (_this$internalState2 = this.internalState) === null || _this$internalState2 === void 0 ? void 0 : _this$internalState2.changeFlags;\n  }\n\n  setChangeFlags(flags) {\n    if (!this.internalState) {\n      return;\n    }\n\n    const {\n      changeFlags\n    } = this.internalState;\n\n    for (const key in flags) {\n      if (flags[key]) {\n        let flagChanged = false;\n\n        switch (key) {\n          case 'dataChanged':\n            const dataChangedReason = flags[key];\n            const prevDataChangedReason = changeFlags[key];\n\n            if (dataChangedReason && Array.isArray(prevDataChangedReason)) {\n              changeFlags.dataChanged = Array.isArray(dataChangedReason) ? prevDataChangedReason.concat(dataChangedReason) : dataChangedReason;\n              flagChanged = true;\n            }\n\n          default:\n            if (!changeFlags[key]) {\n              changeFlags[key] = flags[key];\n              flagChanged = true;\n            }\n\n        }\n\n        if (flagChanged) {\n          debug(TRACE_CHANGE_FLAG, this, key, flags);\n        }\n      }\n    }\n\n    const propsOrDataChanged = Boolean(changeFlags.dataChanged || changeFlags.updateTriggersChanged || changeFlags.propsChanged || changeFlags.extensionsChanged);\n    changeFlags.propsOrDataChanged = propsOrDataChanged;\n    changeFlags.somethingChanged = propsOrDataChanged || changeFlags.viewportChanged || changeFlags.stateChanged;\n  }\n\n  _clearChangeFlags() {\n    this.internalState.changeFlags = {\n      dataChanged: false,\n      propsChanged: false,\n      updateTriggersChanged: false,\n      viewportChanged: false,\n      stateChanged: false,\n      extensionsChanged: false,\n      propsOrDataChanged: false,\n      somethingChanged: false\n    };\n  }\n\n  _diffProps(newProps, oldProps) {\n    const changeFlags = diffProps(newProps, oldProps);\n\n    if (changeFlags.updateTriggersChanged) {\n      for (const key in changeFlags.updateTriggersChanged) {\n        if (changeFlags.updateTriggersChanged[key]) {\n          this.invalidateAttribute(key);\n        }\n      }\n    }\n\n    if (changeFlags.transitionsChanged) {\n      for (const key in changeFlags.transitionsChanged) {\n        var _newProps$transitions;\n\n        this.internalState.uniformTransitions.add(key, oldProps[key], newProps[key], (_newProps$transitions = newProps.transitions) === null || _newProps$transitions === void 0 ? void 0 : _newProps$transitions[key]);\n      }\n    }\n\n    return this.setChangeFlags(changeFlags);\n  }\n\n  validateProps() {\n    validateProps(this.props);\n  }\n\n  updateAutoHighlight(info) {\n    if (this.props.autoHighlight && !Number.isInteger(this.props.highlightedObjectIndex)) {\n      this._updateAutoHighlight(info);\n    }\n  }\n\n  _updateAutoHighlight(info) {\n    const pickingModuleParameters = {\n      pickingSelectedColor: info.picked ? info.color : null\n    };\n    const {\n      highlightColor\n    } = this.props;\n\n    if (info.picked && typeof highlightColor === 'function') {\n      pickingModuleParameters.pickingHighlightColor = highlightColor(info);\n    }\n\n    this.setModuleParameters(pickingModuleParameters);\n    this.setNeedsRedraw();\n  }\n\n  _getAttributeManager() {\n    const context = this.context;\n    return new AttributeManager(context.gl, {\n      id: this.props.id,\n      stats: context.stats,\n      timeline: context.timeline\n    });\n  }\n\n  _postUpdate(updateParams, forceUpdate) {\n    const {\n      props,\n      oldProps\n    } = updateParams;\n    this.setNeedsRedraw();\n\n    this._updateAttributes();\n\n    const {\n      model\n    } = this.state;\n    model === null || model === void 0 ? void 0 : model.setInstanceCount(this.getNumInstances());\n    const {\n      autoHighlight,\n      highlightedObjectIndex,\n      highlightColor\n    } = props;\n\n    if (forceUpdate || oldProps.autoHighlight !== autoHighlight || oldProps.highlightedObjectIndex !== highlightedObjectIndex || oldProps.highlightColor !== highlightColor) {\n      const parameters = {};\n\n      if (!autoHighlight) {\n        parameters.pickingSelectedColor = null;\n      }\n\n      if (Array.isArray(highlightColor)) {\n        parameters.pickingHighlightColor = highlightColor;\n      }\n\n      if (Number.isInteger(highlightedObjectIndex)) {\n        parameters.pickingSelectedColor = Number.isFinite(highlightedObjectIndex) && highlightedObjectIndex >= 0 ? this.encodePickingColor(highlightedObjectIndex) : null;\n      }\n\n      this.setModuleParameters(parameters);\n    }\n  }\n\n  _getUpdateParams() {\n    return {\n      props: this.props,\n      oldProps: this.internalState.getOldProps(),\n      context: this.context,\n      changeFlags: this.internalState.changeFlags\n    };\n  }\n\n  _getNeedsRedraw(opts) {\n    if (!this.internalState) {\n      return false;\n    }\n\n    let redraw = false;\n    redraw = redraw || this.internalState.needsRedraw && this.id;\n    this.internalState.needsRedraw = this.internalState.needsRedraw && !opts.clearRedrawFlags;\n    const attributeManager = this.getAttributeManager();\n    const attributeManagerNeedsRedraw = attributeManager ? attributeManager.getNeedsRedraw(opts) : false;\n    redraw = redraw || attributeManagerNeedsRedraw;\n    return redraw;\n  }\n\n  _onAsyncPropUpdated() {\n    this._diffProps(this.props, this.internalState.getOldProps());\n\n    this.setNeedsUpdate();\n  }\n\n}\n\n_defineProperty(Layer, \"defaultProps\", defaultProps);\n\n_defineProperty(Layer, \"layerName\", 'Layer');\n//# sourceMappingURL=layer.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport Layer from './layer';\nimport debug from '../debug';\nimport { flatten } from '../utils/flatten';\nconst TRACE_RENDER_LAYERS = 'compositeLayer.renderLayers';\nexport default class CompositeLayer extends Layer {\n  get isComposite() {\n    return true;\n  }\n\n  get isLoaded() {\n    return super.isLoaded && this.getSubLayers().every(layer => layer.isLoaded);\n  }\n\n  getSubLayers() {\n    return this.internalState && this.internalState.subLayers || [];\n  }\n\n  initializeState(context) {}\n\n  setState(updateObject) {\n    super.setState(updateObject);\n    this.setNeedsUpdate();\n  }\n\n  getPickingInfo({\n    info\n  }) {\n    const {\n      object\n    } = info;\n    const isDataWrapped = object && object.__source && object.__source.parent && object.__source.parent.id === this.id;\n\n    if (!isDataWrapped) {\n      return info;\n    }\n\n    info.object = object.__source.object;\n    info.index = object.__source.index;\n    return info;\n  }\n\n  filterSubLayer(context) {\n    return true;\n  }\n\n  shouldRenderSubLayer(subLayerId, data) {\n    return data && data.length;\n  }\n\n  getSubLayerClass(subLayerId, DefaultLayerClass) {\n    const {\n      _subLayerProps: overridingProps\n    } = this.props;\n    return overridingProps && overridingProps[subLayerId] && overridingProps[subLayerId].type || DefaultLayerClass;\n  }\n\n  getSubLayerRow(row, sourceObject, sourceObjectIndex) {\n    row.__source = {\n      parent: this,\n      object: sourceObject,\n      index: sourceObjectIndex\n    };\n    return row;\n  }\n\n  getSubLayerAccessor(accessor) {\n    if (typeof accessor === 'function') {\n      const objectInfo = {\n        index: -1,\n        data: this.props.data,\n        target: []\n      };\n      return (x, i) => {\n        if (x && x.__source) {\n          objectInfo.index = x.__source.index;\n          return accessor(x.__source.object, objectInfo);\n        }\n\n        return accessor(x, i);\n      };\n    }\n\n    return accessor;\n  }\n\n  getSubLayerProps(sublayerProps = {}) {\n    var _this$props$updateTri;\n\n    const {\n      opacity,\n      pickable,\n      visible,\n      parameters,\n      getPolygonOffset,\n      highlightedObjectIndex,\n      autoHighlight,\n      highlightColor,\n      coordinateSystem,\n      coordinateOrigin,\n      wrapLongitude,\n      positionFormat,\n      modelMatrix,\n      extensions,\n      fetch,\n      operation,\n      _subLayerProps: overridingProps\n    } = this.props;\n    const newProps = {\n      id: '',\n      updateTriggers: {},\n      opacity,\n      pickable,\n      visible,\n      parameters,\n      getPolygonOffset,\n      highlightedObjectIndex,\n      autoHighlight,\n      highlightColor,\n      coordinateSystem,\n      coordinateOrigin,\n      wrapLongitude,\n      positionFormat,\n      modelMatrix,\n      extensions,\n      fetch,\n      operation\n    };\n    const overridingSublayerProps = overridingProps && sublayerProps.id && overridingProps[sublayerProps.id];\n    const overridingSublayerTriggers = overridingSublayerProps && overridingSublayerProps.updateTriggers;\n    const sublayerId = sublayerProps.id || 'sublayer';\n\n    if (overridingSublayerProps) {\n      const propTypes = this.constructor._propTypes;\n      const subLayerPropTypes = sublayerProps.type ? sublayerProps.type._propTypes : {};\n\n      for (const key in overridingSublayerProps) {\n        const propType = subLayerPropTypes[key] || propTypes[key];\n\n        if (propType && propType.type === 'accessor') {\n          overridingSublayerProps[key] = this.getSubLayerAccessor(overridingSublayerProps[key]);\n        }\n      }\n    }\n\n    Object.assign(newProps, sublayerProps, overridingSublayerProps);\n    newProps.id = \"\".concat(this.props.id, \"-\").concat(sublayerId);\n    newProps.updateTriggers = {\n      all: (_this$props$updateTri = this.props.updateTriggers) === null || _this$props$updateTri === void 0 ? void 0 : _this$props$updateTri.all,\n      ...sublayerProps.updateTriggers,\n      ...overridingSublayerTriggers\n    };\n\n    for (const extension of extensions) {\n      const passThroughProps = extension.getSubLayerProps.call(this, extension);\n\n      if (passThroughProps) {\n        Object.assign(newProps, passThroughProps, {\n          updateTriggers: Object.assign(newProps.updateTriggers, passThroughProps.updateTriggers)\n        });\n      }\n    }\n\n    return newProps;\n  }\n\n  _updateAutoHighlight(info) {\n    for (const layer of this.getSubLayers()) {\n      layer.updateAutoHighlight(info);\n    }\n  }\n\n  _getAttributeManager() {\n    return null;\n  }\n\n  _postUpdate(updateParams, forceUpdate) {\n    let subLayers = this.internalState.subLayers;\n    const shouldUpdate = !subLayers || this.needsUpdate();\n\n    if (shouldUpdate) {\n      const subLayersList = this.renderLayers();\n      subLayers = flatten(subLayersList, Boolean);\n      this.internalState.subLayers = subLayers;\n    }\n\n    debug(TRACE_RENDER_LAYERS, this, shouldUpdate, subLayers);\n\n    for (const layer of subLayers) {\n      layer.parent = this;\n    }\n  }\n\n}\n\n_defineProperty(CompositeLayer, \"layerName\", 'CompositeLayer');\n//# sourceMappingURL=composite-layer.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { Matrix4 } from '@math.gl/core';\nimport Viewport from './viewport';\nimport { PROJECTION_MODE } from '../lib/constants';\nimport * as vec3 from 'gl-matrix/vec3';\nimport * as vec4 from 'gl-matrix/vec4';\nconst DEGREES_TO_RADIANS = Math.PI / 180;\nconst RADIANS_TO_DEGREES = 180 / Math.PI;\nconst EARTH_RADIUS = 6370972;\nconst GLOBE_RADIUS = 256;\n\nfunction getDistanceScales() {\n  const unitsPerMeter = GLOBE_RADIUS / EARTH_RADIUS;\n  const unitsPerDegree = Math.PI / 180 * GLOBE_RADIUS;\n  return {\n    unitsPerMeter: [unitsPerMeter, unitsPerMeter, unitsPerMeter],\n    unitsPerMeter2: [0, 0, 0],\n    metersPerUnit: [1 / unitsPerMeter, 1 / unitsPerMeter, 1 / unitsPerMeter],\n    unitsPerDegree: [unitsPerDegree, unitsPerDegree, unitsPerMeter],\n    unitsPerDegree2: [0, 0, 0],\n    degreesPerUnit: [1 / unitsPerDegree, 1 / unitsPerDegree, 1 / unitsPerMeter]\n  };\n}\n\nexport default class GlobeViewport extends Viewport {\n  constructor(opts = {}) {\n    const {\n      latitude = 0,\n      longitude = 0,\n      zoom = 0,\n      nearZMultiplier = 0.1,\n      farZMultiplier = 2,\n      resolution = 10\n    } = opts;\n    let {\n      height,\n      altitude = 1.5\n    } = opts;\n    height = height || 1;\n    altitude = Math.max(0.75, altitude);\n    const viewMatrix = new Matrix4().lookAt({\n      eye: [0, -altitude, 0],\n      up: [0, 0, 1]\n    });\n    const scale = Math.pow(2, zoom);\n    viewMatrix.rotateX(latitude * DEGREES_TO_RADIANS);\n    viewMatrix.rotateZ(-longitude * DEGREES_TO_RADIANS);\n    viewMatrix.scale(scale / height);\n    const halfFov = Math.atan(0.5 / altitude);\n    const relativeScale = GLOBE_RADIUS * 2 * scale / height;\n    super({ ...opts,\n      height,\n      viewMatrix,\n      longitude,\n      latitude,\n      zoom,\n      distanceScales: getDistanceScales(),\n      fovyRadians: halfFov * 2,\n      focalDistance: altitude,\n      near: nearZMultiplier,\n      far: Math.min(2, 1 / relativeScale + 1) * altitude * farZMultiplier\n    });\n\n    _defineProperty(this, \"longitude\", void 0);\n\n    _defineProperty(this, \"latitude\", void 0);\n\n    _defineProperty(this, \"resolution\", void 0);\n\n    this.latitude = latitude;\n    this.longitude = longitude;\n    this.resolution = resolution;\n  }\n\n  get projectionMode() {\n    return PROJECTION_MODE.GLOBE;\n  }\n\n  getDistanceScales() {\n    return this.distanceScales;\n  }\n\n  getBounds(options = {}) {\n    const unprojectOption = {\n      targetZ: options.z || 0\n    };\n    const left = this.unproject([0, this.height / 2], unprojectOption);\n    const top = this.unproject([this.width / 2, 0], unprojectOption);\n    const right = this.unproject([this.width, this.height / 2], unprojectOption);\n    const bottom = this.unproject([this.width / 2, this.height], unprojectOption);\n    if (right[0] < this.longitude) right[0] += 360;\n    if (left[0] > this.longitude) left[0] -= 360;\n    return [Math.min(left[0], right[0], top[0], bottom[0]), Math.min(left[1], right[1], top[1], bottom[1]), Math.max(left[0], right[0], top[0], bottom[0]), Math.max(left[1], right[1], top[1], bottom[1])];\n  }\n\n  unproject(xyz, {\n    topLeft = true,\n    targetZ\n  } = {}) {\n    const [x, y, z] = xyz;\n    const y2 = topLeft ? y : this.height - y;\n    const {\n      pixelUnprojectionMatrix\n    } = this;\n    let coord;\n\n    if (Number.isFinite(z)) {\n      coord = transformVector(pixelUnprojectionMatrix, [x, y2, z, 1]);\n    } else {\n      const coord0 = transformVector(pixelUnprojectionMatrix, [x, y2, -1, 1]);\n      const coord1 = transformVector(pixelUnprojectionMatrix, [x, y2, 1, 1]);\n      const lt = ((targetZ || 0) / EARTH_RADIUS + 1) * GLOBE_RADIUS;\n      const lSqr = vec3.sqrLen(vec3.sub([], coord0, coord1));\n      const l0Sqr = vec3.sqrLen(coord0);\n      const l1Sqr = vec3.sqrLen(coord1);\n      const sSqr = (4 * l0Sqr * l1Sqr - (lSqr - l0Sqr - l1Sqr) ** 2) / 16;\n      const dSqr = 4 * sSqr / lSqr;\n      const r0 = Math.sqrt(l0Sqr - dSqr);\n      const dr = Math.sqrt(Math.max(0, lt * lt - dSqr));\n      const t = (r0 - dr) / Math.sqrt(lSqr);\n      coord = vec3.lerp([], coord0, coord1, t);\n    }\n\n    const [X, Y, Z] = this.unprojectPosition(coord);\n\n    if (Number.isFinite(z)) {\n      return [X, Y, Z];\n    }\n\n    return Number.isFinite(targetZ) ? [X, Y, targetZ] : [X, Y];\n  }\n\n  projectPosition(xyz) {\n    const [lng, lat, Z = 0] = xyz;\n    const lambda = lng * DEGREES_TO_RADIANS;\n    const phi = lat * DEGREES_TO_RADIANS;\n    const cosPhi = Math.cos(phi);\n    const D = (Z / EARTH_RADIUS + 1) * GLOBE_RADIUS;\n    return [Math.sin(lambda) * cosPhi * D, -Math.cos(lambda) * cosPhi * D, Math.sin(phi) * D];\n  }\n\n  unprojectPosition(xyz) {\n    const [x, y, z] = xyz;\n    const D = vec3.len(xyz);\n    const phi = Math.asin(z / D);\n    const lambda = Math.atan2(x, -y);\n    const lng = lambda * RADIANS_TO_DEGREES;\n    const lat = phi * RADIANS_TO_DEGREES;\n    const Z = (D / GLOBE_RADIUS - 1) * EARTH_RADIUS;\n    return [lng, lat, Z];\n  }\n\n  projectFlat(xyz) {\n    return xyz;\n  }\n\n  unprojectFlat(xyz) {\n    return xyz;\n  }\n\n  panByPosition(coords, pixel) {\n    const fromPosition = this.unproject(pixel);\n    return {\n      longitude: coords[0] - fromPosition[0] + this.longitude,\n      latitude: coords[1] - fromPosition[1] + this.latitude\n    };\n  }\n\n}\n\nfunction transformVector(matrix, vector) {\n  const result = vec4.transformMat4([], vector, matrix);\n  vec4.scale(result, result, 1 / result[3]);\n  return result;\n}\n//# sourceMappingURL=globe-viewport.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport Viewport from '../viewports/viewport';\nimport { Matrix4 } from '@math.gl/core';\nimport { pixelsToWorld, fovyToAltitude } from '@math.gl/web-mercator';\nconst DEGREES_TO_RADIANS = Math.PI / 180;\n\nfunction getViewMatrix({\n  height,\n  focalDistance,\n  orbitAxis,\n  rotationX,\n  rotationOrbit,\n  zoom\n}) {\n  const up = orbitAxis === 'Z' ? [0, 0, 1] : [0, 1, 0];\n  const eye = orbitAxis === 'Z' ? [0, -focalDistance, 0] : [0, 0, focalDistance];\n  const viewMatrix = new Matrix4().lookAt({\n    eye,\n    up\n  });\n  viewMatrix.rotateX(rotationX * DEGREES_TO_RADIANS);\n\n  if (orbitAxis === 'Z') {\n    viewMatrix.rotateZ(rotationOrbit * DEGREES_TO_RADIANS);\n  } else {\n    viewMatrix.rotateY(rotationOrbit * DEGREES_TO_RADIANS);\n  }\n\n  const projectionScale = Math.pow(2, zoom) / height;\n  viewMatrix.scale(projectionScale);\n  return viewMatrix;\n}\n\nexport default class OrbitViewport extends Viewport {\n  constructor(props) {\n    const {\n      height,\n      projectionMatrix,\n      fovy = 50,\n      orbitAxis = 'Z',\n      target = [0, 0, 0],\n      rotationX = 0,\n      rotationOrbit = 0,\n      zoom = 0\n    } = props;\n    const focalDistance = projectionMatrix ? projectionMatrix[5] / 2 : fovyToAltitude(fovy);\n    super({ ...props,\n      longitude: undefined,\n      viewMatrix: getViewMatrix({\n        height: height || 1,\n        focalDistance,\n        orbitAxis,\n        rotationX,\n        rotationOrbit,\n        zoom\n      }),\n      fovy,\n      focalDistance,\n      position: target,\n      zoom\n    });\n\n    _defineProperty(this, \"projectedCenter\", void 0);\n\n    this.projectedCenter = this.project(this.center);\n  }\n\n  unproject(xyz, {\n    topLeft = true\n  } = {}) {\n    const [x, y, z = this.projectedCenter[2]] = xyz;\n    const y2 = topLeft ? y : this.height - y;\n    const [X, Y, Z] = pixelsToWorld([x, y2, z], this.pixelUnprojectionMatrix);\n    return [X, Y, Z];\n  }\n\n  panByPosition(coords, pixel) {\n    const p0 = this.project(coords);\n    const nextCenter = [this.width / 2 + p0[0] - pixel[0], this.height / 2 + p0[1] - pixel[1], this.projectedCenter[2]];\n    return {\n      target: this.unproject(nextCenter)\n    };\n  }\n\n}\n//# sourceMappingURL=orbit-viewport.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport Viewport from '../viewports/viewport';\nimport { getMeterZoom } from '@math.gl/web-mercator';\nimport { Matrix4, _SphericalCoordinates as SphericalCoordinates } from '@math.gl/core';\nexport default class FirstPersonViewport extends Viewport {\n  constructor(props) {\n    const {\n      longitude,\n      latitude,\n      modelMatrix,\n      bearing = 0,\n      pitch = 0,\n      up = [0, 0, 1]\n    } = props;\n    const spherical = new SphericalCoordinates({\n      bearing,\n      pitch: pitch === -90 ? 0.0001 : 90 + pitch\n    });\n    const dir = spherical.toVector3().normalize();\n    const center = modelMatrix ? new Matrix4(modelMatrix).transformAsVector(dir) : dir;\n    const zoom = Number.isFinite(latitude) ? getMeterZoom({\n      latitude: latitude\n    }) : 0;\n    const scale = Math.pow(2, zoom);\n    const viewMatrix = new Matrix4().lookAt({\n      eye: [0, 0, 0],\n      center,\n      up\n    }).scale(scale);\n    super({ ...props,\n      zoom,\n      viewMatrix\n    });\n\n    _defineProperty(this, \"longitude\", void 0);\n\n    _defineProperty(this, \"latitude\", void 0);\n\n    this.latitude = latitude;\n    this.longitude = longitude;\n  }\n\n}\n//# sourceMappingURL=first-person-viewport.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport Controller from './controller';\nimport ViewState from './view-state';\nimport { mod } from '../utils/math-utils';\nimport LinearInterpolator from '../transitions/linear-interpolator';\nimport { Vector3, _SphericalCoordinates as SphericalCoordinates, clamp } from '@math.gl/core';\nconst MOVEMENT_SPEED = 20;\n\nclass FirstPersonState extends ViewState {\n  constructor(options) {\n    const {\n      width,\n      height,\n      position = [0, 0, 0],\n      bearing = 0,\n      pitch = 0,\n      longitude = null,\n      latitude = null,\n      maxPitch = 90,\n      minPitch = -90,\n      startRotatePos,\n      startBearing,\n      startPitch,\n      startZoomPosition\n    } = options;\n    super({\n      width,\n      height,\n      position,\n      bearing,\n      pitch,\n      longitude,\n      latitude,\n      maxPitch,\n      minPitch\n    }, {\n      startRotatePos,\n      startBearing,\n      startPitch,\n      startZoomPosition\n    });\n  }\n\n  panStart() {\n    return this;\n  }\n\n  pan() {\n    return this;\n  }\n\n  panEnd() {\n    return this;\n  }\n\n  rotateStart({\n    pos\n  }) {\n    return this._getUpdatedState({\n      startRotatePos: pos,\n      startBearing: this.getViewportProps().bearing,\n      startPitch: this.getViewportProps().pitch\n    });\n  }\n\n  rotate({\n    pos,\n    deltaAngleX = 0,\n    deltaAngleY = 0\n  }) {\n    const {\n      startRotatePos,\n      startBearing,\n      startPitch\n    } = this.getState();\n    const {\n      width,\n      height\n    } = this.getViewportProps();\n\n    if (!startRotatePos || startBearing === undefined || startPitch === undefined) {\n      return this;\n    }\n\n    let newRotation;\n\n    if (pos) {\n      const deltaScaleX = (pos[0] - startRotatePos[0]) / width;\n      const deltaScaleY = (pos[1] - startRotatePos[1]) / height;\n      newRotation = {\n        bearing: startBearing - deltaScaleX * 180,\n        pitch: startPitch - deltaScaleY * 90\n      };\n    } else {\n      newRotation = {\n        bearing: startBearing - deltaAngleX,\n        pitch: startPitch - deltaAngleY\n      };\n    }\n\n    return this._getUpdatedState(newRotation);\n  }\n\n  rotateEnd() {\n    return this._getUpdatedState({\n      startRotatePos: null,\n      startBearing: null,\n      startPitch: null\n    });\n  }\n\n  zoomStart() {\n    return this._getUpdatedState({\n      startZoomPosition: this.getViewportProps().position\n    });\n  }\n\n  zoom({\n    scale\n  }) {\n    let {\n      startZoomPosition\n    } = this.getState();\n\n    if (!startZoomPosition) {\n      startZoomPosition = this.getViewportProps().position;\n    }\n\n    const direction = this.getDirection();\n    return this._move(direction, Math.log2(scale) * MOVEMENT_SPEED, startZoomPosition);\n  }\n\n  zoomEnd() {\n    return this._getUpdatedState({\n      startZoomPosition: null\n    });\n  }\n\n  moveLeft(speed = MOVEMENT_SPEED) {\n    const direction = this.getDirection(true);\n    return this._move(direction.rotateZ({\n      radians: Math.PI / 2\n    }), speed);\n  }\n\n  moveRight(speed = MOVEMENT_SPEED) {\n    const direction = this.getDirection(true);\n    return this._move(direction.rotateZ({\n      radians: -Math.PI / 2\n    }), speed);\n  }\n\n  moveUp(speed = MOVEMENT_SPEED) {\n    const direction = this.getDirection(true);\n    return this._move(direction, speed);\n  }\n\n  moveDown(speed = MOVEMENT_SPEED) {\n    const direction = this.getDirection(true);\n    return this._move(direction.negate(), speed);\n  }\n\n  rotateLeft(speed = 15) {\n    return this._getUpdatedState({\n      bearing: this.getViewportProps().bearing - speed\n    });\n  }\n\n  rotateRight(speed = 15) {\n    return this._getUpdatedState({\n      bearing: this.getViewportProps().bearing + speed\n    });\n  }\n\n  rotateUp(speed = 10) {\n    return this._getUpdatedState({\n      pitch: this.getViewportProps().pitch + speed\n    });\n  }\n\n  rotateDown(speed = 10) {\n    return this._getUpdatedState({\n      pitch: this.getViewportProps().pitch - speed\n    });\n  }\n\n  zoomIn(speed = 2) {\n    return this.zoom({\n      scale: speed\n    });\n  }\n\n  zoomOut(speed = 2) {\n    return this.zoom({\n      scale: 1 / speed\n    });\n  }\n\n  shortestPathFrom(viewState) {\n    const fromProps = viewState.getViewportProps();\n    const props = { ...this.getViewportProps()\n    };\n    const {\n      bearing,\n      longitude\n    } = props;\n\n    if (Math.abs(bearing - fromProps.bearing) > 180) {\n      props.bearing = bearing < 0 ? bearing + 360 : bearing - 360;\n    }\n\n    if (longitude !== null && fromProps.longitude !== null && Math.abs(longitude - fromProps.longitude) > 180) {\n      props.longitude = longitude < 0 ? longitude + 360 : longitude - 360;\n    }\n\n    return props;\n  }\n\n  _move(direction, speed, fromPosition = this.getViewportProps().position) {\n    const delta = direction.scale(speed);\n    return this._getUpdatedState({\n      position: new Vector3(fromPosition).add(delta)\n    });\n  }\n\n  getDirection(use2D = false) {\n    const spherical = new SphericalCoordinates({\n      bearing: this.getViewportProps().bearing,\n      pitch: use2D ? 90 : 90 + this.getViewportProps().pitch\n    });\n    const direction = spherical.toVector3().normalize();\n    return direction;\n  }\n\n  _getUpdatedState(newProps) {\n    return new FirstPersonState({ ...this.getViewportProps(),\n      ...this.getState(),\n      ...newProps\n    });\n  }\n\n  applyConstraints(props) {\n    const {\n      pitch,\n      maxPitch,\n      minPitch,\n      longitude,\n      bearing\n    } = props;\n    props.pitch = clamp(pitch, minPitch, maxPitch);\n\n    if (longitude !== null && (longitude < -180 || longitude > 180)) {\n      props.longitude = mod(longitude + 180, 360) - 180;\n    }\n\n    if (bearing < -180 || bearing > 180) {\n      props.bearing = mod(bearing + 180, 360) - 180;\n    }\n\n    return props;\n  }\n\n}\n\nexport default class FirstPersonController extends Controller {\n  constructor(...args) {\n    super(...args);\n\n    _defineProperty(this, \"ControllerState\", FirstPersonState);\n\n    _defineProperty(this, \"transition\", {\n      transitionDuration: 300,\n      transitionInterpolator: new LinearInterpolator(['position', 'pitch', 'bearing'])\n    });\n  }\n\n}\n//# sourceMappingURL=first-person-controller.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport View from './view';\nimport FirstPersonViewport from '../viewports/first-person-viewport';\nimport FirstPersonController from '../controllers/first-person-controller';\nexport default class FirstPersonView extends View {\n  get ViewportType() {\n    return FirstPersonViewport;\n  }\n\n  get ControllerType() {\n    return FirstPersonController;\n  }\n\n}\n\n_defineProperty(FirstPersonView, \"displayName\", 'FirstPersonView');\n//# sourceMappingURL=first-person-view.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport View from './view';\nimport OrbitViewport from '../viewports/orbit-viewport';\nimport OrbitController from '../controllers/orbit-controller';\nexport default class OrbitView extends View {\n  constructor(props = {}) {\n    super(props);\n    this.props.orbitAxis = props.orbitAxis || 'Z';\n  }\n\n  get ViewportType() {\n    return OrbitViewport;\n  }\n\n  get ControllerType() {\n    return OrbitController;\n  }\n\n}\n\n_defineProperty(OrbitView, \"displayName\", 'OrbitView');\n//# sourceMappingURL=orbit-view.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { clamp } from '@math.gl/core';\nimport Controller from './controller';\nimport { MapState } from './map-controller';\nimport { mod } from '../utils/math-utils';\nimport LinearInterpolator from '../transitions/linear-interpolator';\n\nclass GlobeState extends MapState {\n  applyConstraints(props) {\n    const {\n      maxZoom,\n      minZoom,\n      zoom\n    } = props;\n    props.zoom = clamp(zoom, minZoom, maxZoom);\n    const {\n      longitude,\n      latitude\n    } = props;\n\n    if (longitude < -180 || longitude > 180) {\n      props.longitude = mod(longitude + 180, 360) - 180;\n    }\n\n    props.latitude = clamp(latitude, -89, 89);\n    return props;\n  }\n\n}\n\nexport default class GlobeController extends Controller {\n  constructor(...args) {\n    super(...args);\n\n    _defineProperty(this, \"ControllerState\", GlobeState);\n\n    _defineProperty(this, \"transition\", {\n      transitionDuration: 300,\n      transitionInterpolator: new LinearInterpolator(['longitude', 'latitude', 'zoom'])\n    });\n\n    _defineProperty(this, \"dragMode\", 'pan');\n  }\n\n  setProps(props) {\n    super.setProps(props);\n    this.dragRotate = false;\n    this.touchRotate = false;\n  }\n\n}\n//# sourceMappingURL=globe-controller.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport View from './view';\nimport GlobeViewport from '../viewports/globe-viewport';\nimport GlobeController from '../controllers/globe-controller';\nexport default class GlobeView extends View {\n  get ViewportType() {\n    return GlobeViewport;\n  }\n\n  get ControllerType() {\n    return GlobeController;\n  }\n\n}\n\n_defineProperty(GlobeView, \"displayName\", 'GlobeView');\n//# sourceMappingURL=globe-view.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { deepEqual } from '../utils/deep-equal';\nexport default class LayerExtension {\n  constructor(opts) {\n    _defineProperty(this, \"opts\", void 0);\n\n    if (opts) {\n      this.opts = opts;\n    }\n  }\n\n  equals(extension) {\n    if (this === extension) {\n      return true;\n    }\n\n    return this.constructor === extension.constructor && deepEqual(this.opts, extension.opts);\n  }\n\n  getShaders(extension) {\n    return null;\n  }\n\n  getSubLayerProps(extension) {\n    const {\n      defaultProps\n    } = extension.constructor;\n    const newProps = {\n      updateTriggers: {}\n    };\n\n    for (const key in defaultProps) {\n      if (key in this.props) {\n        const propDef = defaultProps[key];\n        const propValue = this.props[key];\n        newProps[key] = propValue;\n\n        if (propDef && propDef.type === 'accessor') {\n          newProps.updateTriggers[key] = this.props.updateTriggers[key];\n\n          if (typeof propValue === 'function') {\n            newProps[key] = this.getSubLayerAccessor(propValue);\n          }\n        }\n      }\n    }\n\n    return newProps;\n  }\n\n  initializeState(context, extension) {}\n\n  updateState(params, extension) {}\n\n  draw(params, extension) {}\n\n  finalizeState(context, extension) {}\n\n}\n\n_defineProperty(LayerExtension, \"defaultProps\", {});\n//# sourceMappingURL=layer-extension.js.map","import { WebMercatorViewport } from '@deck.gl/core/typed';\r\nimport { ViewState } from '../../types';\r\n\r\nexport const getDefaultViewState = (initialBounds: [[number, number], [number, number]], el: HTMLDivElement) => {\r\n  const { offsetWidth, offsetHeight } = el;\r\n\r\n  const viewport = new WebMercatorViewport({\r\n    width: offsetWidth,\r\n    height: offsetHeight\r\n  });\r\n\r\n  return viewport.fitBounds(initialBounds, {});\r\n}","import React, { useCallback, useEffect, useMemo, useRef, useState } from 'react';\r\nimport { Point } from 'mapbox-gl';\r\nimport ReactMapGL, { MapLayerMouseEvent, MapRef } from 'react-map-gl';\r\nimport { useRecoilState } from 'recoil';\r\nimport { mapViewState, isValidViewState, selectedState } from '../../../state';\r\nimport { MapHover } from '../../../types';\r\nimport { useDeviceState } from '../../../../device';\r\nimport { useGraph, useSearch } from '../../../../store';\r\nimport { PopupContainer, TooltipContainer } from '../..';\r\nimport { getDefaultViewState } from '../initialState';\r\n\r\nimport '../Map.css';\r\nimport 'maplibre-gl/dist/maplibre-gl.css';\r\n\r\ntype MapLibreProps = {\r\n\r\n  children: React.ReactElement\r\n\r\n  mapStyle: string,\r\n\r\n  defaultBounds: [[number, number], [number, number]]\r\n\r\n  tooltip: Function\r\n\r\n  popup: Function\r\n\r\n}\r\n\r\nexport const MapLibre = (props: MapLibreProps) => {\r\n\r\n  const ref = useRef<HTMLDivElement>(null);\r\n\r\n  const mapRef = useRef<MapRef>(null);\r\n\r\n  const device = useDeviceState();\r\n\r\n  const [ viewState, setViewState ] = useRecoilState(mapViewState);\r\n\r\n  const [ selected, setSelected ] = useRecoilState(selectedState);\r\n\r\n  const { search } = useSearch();\r\n\r\n  const graph = useGraph();\r\n\r\n  const [ hover, setHover ] = useState<MapHover | null>();\r\n\r\n  // Set initial view state on first render\r\n  useEffect(() => {\r\n    if (ref.current && !isValidViewState(viewState) ) {\r\n      const defaultState = getDefaultViewState(props.defaultBounds, ref.current);\r\n      setViewState(defaultState);\r\n    }\r\n  }, [ ref.current ]);\r\n\r\n  const data = useMemo(() => search?.status === 'OK' && search.result?.items.length ? {\r\n    type: 'FeatureCollection',\r\n    features: search.result.items.map(f => ({ ...f, properties: { id: f.id, ...f.properties }}))\r\n  } : null, [ search ]);\r\n\r\n  const layerIds = useMemo(() => React.Children.map(props.children, c => c.props.id) || [], [ props.children ]);\r\n\r\n  const getNodeAt = useCallback((point: Point) => {\r\n    if (!mapRef.current)\r\n      return;\r\n\r\n    const features = mapRef.current\r\n      .queryRenderedFeatures(point)\r\n      .filter(l => layerIds.find(id => l.layer.id.startsWith(id)));\r\n  \r\n    if (features.length > 0) {\r\n      const feature = features[0];\r\n      const node = graph.getNodeById(feature.properties?.id);\r\n\r\n      return { node, feature };\r\n    }\r\n  }, [props.children, graph, mapRef.current, layerIds])\r\n\r\n  const onMouseMove = useCallback((evt: MapLayerMouseEvent) => {\r\n    const { point } = evt;\r\n    const n = getNodeAt(point);\r\n\r\n    if (n) {\r\n      const { node, feature } = n;\r\n\r\n      const updated: MapHover = hover && (node?.id === hover?.node.id) ? {\r\n        ...hover, ...point // just update mouse position\r\n      } : {\r\n        node,\r\n        feature,\r\n        ...point\r\n      };\r\n\r\n      ref.current?.classList.add('hover');\r\n      setHover(updated);\r\n    } else {\r\n      ref.current?.classList.remove('hover');\r\n      setHover(undefined);\r\n    }\r\n  }, [ getNodeAt, hover ]);\r\n\r\n  const onClick = (evt: MapLayerMouseEvent) => {\r\n    const n = getNodeAt(evt.point);\r\n\r\n    if (n) {\r\n      const clone = JSON.parse(JSON.stringify(n));\r\n      setHover(null);\r\n      setSelected(clone);\r\n    } else {\r\n      setSelected(null);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div \r\n      ref={ref}\r\n      className='p6o-map-container'>\r\n\r\n      {isValidViewState(viewState) &&\r\n        <ReactMapGL\r\n          clickTolerance={device.isTouchDevice ? 10 : 3}\r\n          ref={mapRef}\r\n          initialViewState={viewState}\r\n          mapStyle={props.mapStyle}\r\n          onClick={onClick}\r\n          onMouseMove={onMouseMove}\r\n          onMove={evt => setViewState(evt.viewState)}>\r\n\r\n          {React.Children.map(props.children, c => React.cloneElement(c, { data }))}\r\n\r\n        </ReactMapGL>\r\n      }\r\n\r\n      {props.tooltip && hover && \r\n        <TooltipContainer \r\n          {...hover} \r\n          tooltip={props.tooltip} />}\r\n\r\n      {props.popup && mapRef.current && selected && \r\n        <PopupContainer \r\n          selected={selected} \r\n          viewState={viewState} \r\n          map={mapRef.current} \r\n          popup={props.popup} \r\n          onClose={() => setSelected(null)} /> }\r\n    </div>\r\n  )\r\n\r\n}","import { useEffect, useLayoutEffect } from 'react';\nconst useIsomorphicLayoutEffect = typeof window !== 'undefined' ? useLayoutEffect : useEffect;\nexport default useIsomorphicLayoutEffect;\n//# sourceMappingURL=use-isomorphic-layout-effect.js.map","export function inheritsFrom(Type, ParentType) {\n  while (Type) {\n    if (Type === ParentType) {\n      return true;\n    }\n\n    Type = Object.getPrototypeOf(Type);\n  }\n\n  return false;\n}\n//# sourceMappingURL=inherits-from.js.map","import { cloneElement } from 'react';\nconst MAP_STYLE = {\n  position: 'absolute',\n  zIndex: -1\n};\nexport default function evaluateChildren(children, childProps) {\n  if (typeof children === 'function') {\n    return children(childProps);\n  }\n\n  if (Array.isArray(children)) {\n    return children.map(child => evaluateChildren(child, childProps));\n  }\n\n  if (isComponent(children)) {\n    if (isReactMap(children)) {\n      childProps.style = MAP_STYLE;\n      return cloneElement(children, childProps);\n    }\n\n    if (needsDeckGLViewProps(children)) {\n      return cloneElement(children, childProps);\n    }\n  }\n\n  return children;\n}\nexport function isComponent(child) {\n  return child && typeof child === 'object' && 'type' in child || false;\n}\n\nfunction isReactMap(child) {\n  const componentClass = child.type;\n  const componentProps = componentClass && componentClass.defaultProps;\n  return componentProps && componentProps.mapStyle;\n}\n\nfunction needsDeckGLViewProps(child) {\n  const componentClass = child.type;\n  return componentClass && componentClass.deckGLViewProps;\n}\n//# sourceMappingURL=evaluate-children.js.map","import * as React from 'react';\nimport { createElement } from 'react';\nimport { inheritsFrom } from './inherits-from';\nimport { Layer, View } from '@deck.gl/core';\nimport { isComponent } from './evaluate-children';\n\nfunction wrapInView(node) {\n  if (typeof node === 'function') {\n    return createElement(View, {}, node);\n  }\n\n  if (Array.isArray(node)) {\n    return node.map(wrapInView);\n  }\n\n  if (isComponent(node)) {\n    if (node.type === React.Fragment) {\n      return wrapInView(node.props.children);\n    }\n\n    if (inheritsFrom(node.type, View)) {\n      return node;\n    }\n  }\n\n  return node;\n}\n\nexport default function extractJSXLayers({\n  children,\n  layers = [],\n  views = null\n}) {\n  const reactChildren = [];\n  const jsxLayers = [];\n  const jsxViews = {};\n  React.Children.forEach(wrapInView(children), reactElement => {\n    if (isComponent(reactElement)) {\n      const ElementType = reactElement.type;\n\n      if (inheritsFrom(ElementType, Layer)) {\n        const layer = createLayer(ElementType, reactElement.props);\n        jsxLayers.push(layer);\n      } else {\n        reactChildren.push(reactElement);\n      }\n\n      if (inheritsFrom(ElementType, View) && ElementType !== View && reactElement.props.id) {\n        const view = new ElementType(reactElement.props);\n        jsxViews[view.id] = view;\n      }\n    } else if (reactElement) {\n      reactChildren.push(reactElement);\n    }\n  });\n\n  if (Object.keys(jsxViews).length > 0) {\n    if (Array.isArray(views)) {\n      views.forEach(view => {\n        jsxViews[view.id] = view;\n      });\n    } else if (views) {\n      jsxViews[views.id] = views;\n    }\n\n    views = Object.values(jsxViews);\n  }\n\n  layers = jsxLayers.length > 0 ? [...jsxLayers, ...layers] : layers;\n  return {\n    layers,\n    children: reactChildren,\n    views\n  };\n}\n\nfunction createLayer(LayerType, reactProps) {\n  const props = {};\n  const defaultProps = LayerType.defaultProps || {};\n\n  for (const key in reactProps) {\n    if (defaultProps[key] !== reactProps[key]) {\n      props[key] = reactProps[key];\n    }\n  }\n\n  return new LayerType(props);\n}\n//# sourceMappingURL=extract-jsx-layers.js.map","import { createElement } from 'react';\nimport { View } from '@deck.gl/core';\nimport { inheritsFrom } from './inherits-from';\nimport evaluateChildren, { isComponent } from './evaluate-children';\nexport default function positionChildrenUnderViews({\n  children,\n  deck,\n  ContextProvider\n}) {\n  const {\n    viewManager\n  } = deck || {};\n\n  if (!viewManager || !viewManager.views.length) {\n    return [];\n  }\n\n  const views = {};\n  const defaultViewId = viewManager.views[0].id;\n\n  for (const child of children) {\n    let viewId = defaultViewId;\n    let viewChildren = child;\n\n    if (isComponent(child) && inheritsFrom(child.type, View)) {\n      viewId = child.props.id || defaultViewId;\n      viewChildren = child.props.children;\n    }\n\n    const viewport = viewManager.getViewport(viewId);\n    const viewState = viewManager.getViewState(viewId);\n\n    if (viewport) {\n      const {\n        x,\n        y,\n        width,\n        height\n      } = viewport;\n      viewChildren = evaluateChildren(viewChildren, {\n        x,\n        y,\n        width,\n        height,\n        viewport,\n        viewState\n      });\n\n      if (!views[viewId]) {\n        views[viewId] = {\n          viewport,\n          children: []\n        };\n      }\n\n      views[viewId].children.push(viewChildren);\n    }\n  }\n\n  return Object.keys(views).map(viewId => {\n    const {\n      viewport,\n      children: viewChildren\n    } = views[viewId];\n    const {\n      x,\n      y,\n      width,\n      height\n    } = viewport;\n    const style = {\n      position: 'absolute',\n      left: x,\n      top: y,\n      width,\n      height\n    };\n    const key = \"view-\".concat(viewId);\n    const viewElement = createElement('div', {\n      key,\n      id: key,\n      style\n    }, ...viewChildren);\n\n    if (ContextProvider) {\n      const contextValue = {\n        viewport,\n        container: deck.canvas.offsetParent,\n        eventManager: deck.eventManager,\n        onViewStateChange: params => {\n          params.viewId = viewId;\n\n          deck._onViewStateChange(params);\n        }\n      };\n      return createElement(ContextProvider, {\n        key,\n        value: contextValue\n      }, viewElement);\n    }\n\n    return viewElement;\n  });\n}\n//# sourceMappingURL=position-children-under-views.js.map","const CANVAS_ONLY_STYLES = {\n  mixBlendMode: null\n};\nexport default function extractStyles({\n  width,\n  height,\n  style\n}) {\n  const containerStyle = {\n    position: 'absolute',\n    zIndex: 0,\n    left: 0,\n    top: 0,\n    width,\n    height\n  };\n  const canvasStyle = {\n    left: 0,\n    top: 0\n  };\n\n  if (style) {\n    for (const key in style) {\n      if (key in CANVAS_ONLY_STYLES) {\n        canvasStyle[key] = style[key];\n      } else {\n        containerStyle[key] = style[key];\n      }\n    }\n  }\n\n  return {\n    containerStyle,\n    canvasStyle\n  };\n}\n//# sourceMappingURL=extract-styles.js.map","import { createElement, useRef, useState, useMemo, useEffect, useImperativeHandle, forwardRef } from 'react';\nimport { Deck } from '@deck.gl/core';\nimport useIsomorphicLayoutEffect from './utils/use-isomorphic-layout-effect';\nimport extractJSXLayers from './utils/extract-jsx-layers';\nimport positionChildrenUnderViews from './utils/position-children-under-views';\nimport extractStyles from './utils/extract-styles';\n\nfunction getRefHandles(thisRef) {\n  return {\n    get deck() {\n      return thisRef.deck;\n    },\n\n    pickObject: opts => thisRef.deck.pickObject(opts),\n    pickMultipleObjects: opts => thisRef.deck.pickMultipleObjects(opts),\n    pickObjects: opts => thisRef.deck.pickObjects(opts)\n  };\n}\n\nfunction redrawDeck(thisRef) {\n  if (thisRef.redrawReason) {\n    thisRef.deck._drawLayers(thisRef.redrawReason);\n\n    thisRef.redrawReason = null;\n  }\n}\n\nfunction createDeckInstance(thisRef, DeckClass, props) {\n  const deck = new DeckClass({ ...props,\n    _customRender: redrawReason => {\n      thisRef.redrawReason = redrawReason;\n      const viewports = deck.getViewports();\n\n      if (thisRef.lastRenderedViewports !== viewports) {\n        thisRef.forceUpdate();\n      } else {\n        redrawDeck(thisRef);\n      }\n    }\n  });\n  return deck;\n}\n\nconst DeckGL = forwardRef((props, ref) => {\n  const [version, setVersion] = useState(0);\n\n  const _thisRef = useRef({\n    control: null,\n    version,\n    forceUpdate: () => setVersion(v => v + 1)\n  });\n\n  const thisRef = _thisRef.current;\n  const containerRef = useRef(null);\n  const canvasRef = useRef(null);\n  const jsxProps = useMemo(() => extractJSXLayers(props), [props.layers, props.views, props.children]);\n  let inRender = true;\n\n  const handleViewStateChange = params => {\n    var _props$onViewStateCha;\n\n    if (inRender && props.viewState) {\n      thisRef.viewStateUpdateRequested = params;\n      return null;\n    }\n\n    thisRef.viewStateUpdateRequested = null;\n    return (_props$onViewStateCha = props.onViewStateChange) === null || _props$onViewStateCha === void 0 ? void 0 : _props$onViewStateCha.call(props, params);\n  };\n\n  const handleInteractionStateChange = params => {\n    if (inRender) {\n      thisRef.interactionStateUpdateRequested = params;\n    } else {\n      var _props$onInteractionS;\n\n      thisRef.interactionStateUpdateRequested = null;\n      (_props$onInteractionS = props.onInteractionStateChange) === null || _props$onInteractionS === void 0 ? void 0 : _props$onInteractionS.call(props, params);\n    }\n  };\n\n  const deckProps = useMemo(() => {\n    const forwardProps = { ...props,\n      style: null,\n      width: '100%',\n      height: '100%',\n      parent: containerRef.current,\n      canvas: canvasRef.current,\n      layers: jsxProps.layers,\n      views: jsxProps.views,\n      onViewStateChange: handleViewStateChange,\n      onInteractionStateChange: handleInteractionStateChange\n    };\n    delete forwardProps._customRender;\n\n    if (thisRef.deck) {\n      thisRef.deck.setProps(forwardProps);\n    }\n\n    return forwardProps;\n  }, [props]);\n  useEffect(() => {\n    const DeckClass = props.Deck || Deck;\n    thisRef.deck = createDeckInstance(thisRef, DeckClass, { ...deckProps,\n      parent: containerRef.current,\n      canvas: canvasRef.current\n    });\n    return () => {\n      var _thisRef$deck;\n\n      return (_thisRef$deck = thisRef.deck) === null || _thisRef$deck === void 0 ? void 0 : _thisRef$deck.finalize();\n    };\n  }, []);\n  useIsomorphicLayoutEffect(() => {\n    redrawDeck(thisRef);\n    const {\n      viewStateUpdateRequested,\n      interactionStateUpdateRequested\n    } = thisRef;\n\n    if (viewStateUpdateRequested) {\n      handleViewStateChange(viewStateUpdateRequested);\n    }\n\n    if (interactionStateUpdateRequested) {\n      handleInteractionStateChange(interactionStateUpdateRequested);\n    }\n  });\n  useImperativeHandle(ref, () => getRefHandles(thisRef), []);\n  const currentViewports = thisRef.deck && thisRef.deck.isInitialized ? thisRef.deck.getViewports() : undefined;\n  const {\n    ContextProvider,\n    width,\n    height,\n    id,\n    style\n  } = props;\n  const {\n    containerStyle,\n    canvasStyle\n  } = useMemo(() => extractStyles({\n    width,\n    height,\n    style\n  }), [width, height, style]);\n\n  if (!thisRef.viewStateUpdateRequested && thisRef.lastRenderedViewports === currentViewports || thisRef.version !== version) {\n    thisRef.lastRenderedViewports = currentViewports;\n    thisRef.version = version;\n    const childrenUnderViews = positionChildrenUnderViews({\n      children: jsxProps.children,\n      deck: thisRef.deck,\n      ContextProvider\n    });\n    const canvas = createElement('canvas', {\n      key: 'canvas',\n      id: id || 'deckgl-overlay',\n      ref: canvasRef,\n      style: canvasStyle\n    });\n    thisRef.control = createElement('div', {\n      id: \"\".concat(id || 'deckgl', \"-wrapper\"),\n      ref: containerRef,\n      style: containerStyle\n    }, [canvas, childrenUnderViews]);\n  }\n\n  inRender = false;\n  return thisRef.control;\n});\nDeckGL.defaultProps = Deck.defaultProps;\nexport default DeckGL;\n//# sourceMappingURL=deckgl.js.map","import React, { useCallback, useMemo, useRef } from 'react';\r\nimport ReactMapGL from 'react-map-gl';\r\nimport DeckGL from '@deck.gl/react/typed';\r\nimport { useSearch, useGraph } from '../../../../store';\r\nimport { DeckGLLayer, ViewState} from '../../../types';\r\n\r\nimport '../Map.css';\r\n\r\nimport 'maplibre-gl/dist/maplibre-gl.css';\r\n\r\ntype DeckGLMapProps = {\r\n\r\n  mapStyle: string,\r\n\r\n  initialViewState: ViewState\r\n\r\n  onViewStateChange: Function\r\n\r\n  layers?: DeckGLLayer[]\r\n\r\n  tooltip: Function\r\n\r\n  popup: Function\r\n\r\n  onClick: Function\r\n\r\n}\r\n\r\nexport const DeckGLMap = (props: DeckGLMapProps) => {\r\n\r\n  const deckRef = useRef(null);\r\n\r\n  const { search } = useSearch();\r\n\r\n  const graph = useGraph();\r\n\r\n  const data = useMemo(() => search?.result && search.status === 'OK' && search.result.items.length > 0 ?\r\n    search.result.items : null, [ search ]);\r\n\r\n  const layers = useMemo(() => props.layers && data ? props.layers.reduce((all, next) => {\r\n    const l = next(data, graph);\r\n    return Array.isArray(l) ?\r\n      [...all, ...l] : [...all, l];\r\n  }, [] as Object[]) : [], [ data, props.layers ]);\r\n\r\n  const onClick = useCallback((event: React.MouseEvent) => {\r\n    const { offsetX, offsetY } = event.nativeEvent;\r\n\r\n    const pickInfo = deckRef.current.pickObject({\r\n      x: offsetX,\r\n      y: offsetY,\r\n      radius: 3\r\n    });\r\n\r\n    if (pickInfo && props.onClick)\r\n      props.onClick(pickInfo);\r\n  }, [ props.onClick, deckRef ]);\r\n\r\n  return (\r\n    <div onClick={onClick}>\r\n      <DeckGL\r\n        ref={deckRef}\r\n        initialViewState={props.initialViewState}\r\n        controller={true} \r\n        // @ts-ignore\r\n        onViewStateChange={props.onViewStateChange}\r\n        layers={layers}\r\n        getTooltip={props.tooltip ? (feature: any) => props.tooltip({...feature, graph, search}) : null}>\r\n\r\n        <ReactMapGL\r\n          mapStyle={props.mapStyle} />\r\n      </DeckGL>    \r\n    </div>\r\n  )\r\n\r\n}","import React, { useEffect, useRef, useState } from 'react';\r\nimport { useDebounce } from 'use-debounce';\r\nimport { useRecoilState } from 'recoil';\r\nimport { mapViewState, isValidViewState } from '../../../state';\r\nimport { DeckGLLayer, ViewState} from '../../../types';\r\nimport { DeckGLMap } from './DeckGLMap';\r\nimport { getDefaultViewState } from '../initialState';\r\n\r\ntype DeckGLContainerProps = {\r\n\r\n  mapStyle: string,\r\n\r\n  defaultBounds: [[number, number], [number, number]]\r\n\r\n  layers?: DeckGLLayer[]\r\n\r\n  tooltip: Function\r\n\r\n  popup: Function\r\n\r\n  onClick: Function\r\n\r\n}\r\n\r\nexport const DeckGLContainer = (props: DeckGLContainerProps) => {\r\n  \r\n  const ref = useRef<HTMLDivElement>(null);\r\n\r\n  // Application-wide Recoil viewState \r\n  const [ globalViewState, setGlobalState ] = useRecoilState(mapViewState);\r\n\r\n  // initialViewState passed into DeckGl\r\n  const [ initialViewState, setInitialViewState ] = useState<ViewState>(isValidViewState(globalViewState) ? globalViewState : null);\r\n\r\n  // DeckGL's current viewState\r\n  const [ currentViewState, setCurrentViewState ] = useState<ViewState>();\r\n\r\n  // DeckGL's current viewState, debounced\r\n  const [ debouncedViewState ] = useDebounce(currentViewState, 200);\r\n\r\n  // Sync debounced state upwards, to global app state\r\n  useEffect(() => {\r\n    if (debouncedViewState)\r\n      setGlobalState(debouncedViewState)\r\n  }, [ debouncedViewState ]);\r\n  \r\n  // Set initial view state on first render\r\n  useEffect(() => {\r\n    if (ref.current && !initialViewState) {\r\n      const defaultState = getDefaultViewState(props.defaultBounds, ref.current);\r\n      setInitialViewState(defaultState);\r\n    }\r\n  }, [ ref.current ]);\r\n\r\n  // When global viewState changes from the outside (e.g.\r\n  // because the Zoom component modifies it), update\r\n  // the initialViewState, so that DeckGL syncs the map.\r\n  useEffect(() => {\r\n    if (ref.current) {\r\n      if (initialViewState && isValidViewState(globalViewState)) {\r\n        setInitialViewState(globalViewState);\r\n      }\r\n    }\r\n  }, [ globalViewState ]);\r\n\r\n  return (\r\n    <div \r\n      ref={ref}\r\n      className='p6o-map-container'>\r\n\r\n      {initialViewState && \r\n        <DeckGLMap \r\n          {...props}\r\n          initialViewState={initialViewState} \r\n          onViewStateChange={(e: { viewState: ViewState }) =>\r\n            setCurrentViewState(e.viewState)} /> \r\n      }\r\n    </div>\r\n  )\r\n\r\n}","import React from 'react';\r\nimport { Source, Layer } from 'react-map-gl';\r\nimport chroma from 'chroma-js';\r\nimport { useDeviceState } from '../../../../../device';\r\n\r\nconst DEFAULT_SCALE = [\r\n  0,\r\n  'rgba(49, 54, 149, 0)', \r\n  0.1,\r\n  '#313695',\r\n  0.2,\r\n  '#4575b4',\r\n  0.3,\r\n  '#74add1',\r\n  0.4,\r\n  '#abd9e9',\r\n  0.5,\r\n  '#e0f3f8',\r\n  0.6,\r\n  '#fee090',\r\n  0.7,\r\n  '#fdae61',\r\n  0.8,\r\n  '#f46d43',\r\n  0.9,\r\n  '#d73027',\r\n  1,\r\n  '#a50026'\r\n];\r\n\r\nconst coverageStyle = (scale: Array<number | string>) => ({\r\n  'type': 'heatmap',\r\n  'paint': {\r\n    'heatmap-weight': 1,\r\n    'heatmap-intensity': [\r\n      'interpolate',\r\n      ['linear'],\r\n      ['zoom'],\r\n      0,\r\n      0.2,\r\n      9,\r\n      2.5\r\n    ],\r\n    'heatmap-color': [\r\n      'interpolate',\r\n      ['linear'],\r\n      ['heatmap-density'],\r\n      ...scale\r\n    ],\r\n    'heatmap-radius': [\r\n      'interpolate',\r\n      ['linear'],\r\n      ['zoom'],\r\n      0,\r\n      1,\r\n      12,\r\n      28\r\n    ],\r\n    'heatmap-opacity': [\r\n      'interpolate',\r\n      ['linear'],\r\n      ['zoom'],\r\n      8,\r\n      1,\r\n      10,\r\n      0\r\n    ]\r\n  }\r\n});\r\n\r\nconst pointStyle = (color: string) => ({\r\n  'type': 'circle',\r\n  'paint': {\r\n    'circle-radius': [\r\n      'interpolate', \r\n      ['linear'],\r\n      ['number', ['get','count'], 0 ],\r\n      0, 5,\r\n      4000, 20\r\n    ],\r\n    'circle-color': [\r\n      'case', \r\n      ['==', ['get', 'is_centroid'], true], \r\n      '#808080', \r\n      color\r\n    ],\r\n    'circle-stroke-color': [\r\n      'case', \r\n      ['==', ['get', 'is_centroid'], true], \r\n      chroma('#808080').darken().hex(), \r\n      chroma(color).darken().hex()\r\n    ], \r\n    'circle-stroke-width': 1,\r\n    'circle-opacity': [\r\n      'interpolate',\r\n      ['linear'],\r\n      ['zoom'],\r\n      7,\r\n      0,\r\n      10,\r\n      ['case', ['==', ['get', 'is_centroid'], true], 0.5, 1]\r\n    ],\r\n    'circle-stroke-opacity': [\r\n      'interpolate',\r\n      ['linear'],\r\n      ['zoom'],\r\n      7,\r\n      0,\r\n      10,\r\n      ['case', ['==', ['get', 'is_centroid'], true], 0.5, 1]\r\n    ]\r\n  }\r\n});\r\n\r\nconst clickbufferStyle = (radius: number) => ({\r\n  'type': 'circle',\r\n  'paint': {\r\n    'circle-radius': radius,\r\n    'circle-color': 'transparent',\r\n    'circle-stroke-width': 0,\r\n    'circle-opacity': 0.5,\r\n    'circle-stroke-opacity': 0\r\n  }\r\n});\r\n\r\n\r\ntype HeatmapLayerProps = {\r\n\r\n  data: any\r\n  \r\n  id: string\r\n\r\n  color: string\r\n\r\n}\r\n\r\nexport const HeatmapLayer = (props: HeatmapLayerProps) => {\r\n\r\n  const device = useDeviceState();\r\n\r\n  const heatmap = coverageStyle(DEFAULT_SCALE);\r\n\r\n  const point = pointStyle(props.color);\r\n\r\n  const clickbuffer = device.isTouchDevice ? clickbufferStyle(15) : null;\r\n\r\n  return (\r\n    <Source type=\"geojson\" data={props.data}>\r\n      {/* @ts-ignore */}\r\n      {clickbuffer && <Layer id={`${props.id}-clickbuffer`} {...clickbuffer} /> }\r\n\r\n      {/* @ts-ignore */}\r\n      <Layer id={`${props.id}-ht`} {...heatmap} />\r\n\r\n      {/* @ts-ignore */}\r\n      <Layer id={`${props.id}-pt`} {...point} />\r\n    </Source>\r\n  )\r\n\r\n}","import { MapLibre } from './MapLibre/MapLibre';\r\nimport { DeckGLContainer } from './MapLibreDeckGL/DeckGLContainer';\r\n\r\nexport const Map = { MapLibre, MapLibreDeckGL: DeckGLContainer };\r\n\r\nexport * from './MapLibre/layers';","import React, { useEffect, useState } from 'react';\r\n\r\nexport const useAutoPosition = (\r\n  ref: React.RefObject<Element>, \r\n  x: number, \r\n  y: number, \r\n  padding: [number, number, number, number] = [15, 0, 0, 15]\r\n) => {\r\n\r\n  const [ left, setLeft ] = useState(x + padding[3]);\r\n\r\n  const [ top, setTop ] = useState(y + padding[0]);\r\n\r\n  useEffect(() => setLeft(x), [ x ]);\r\n\r\n  useEffect(() => setTop(y), [ y ]);\r\n\r\n  useEffect(() => {\r\n    if (ref.current) {\r\n      const elemBounds = \r\n        (ref.current.firstChild as Element)?.getBoundingClientRect();\r\n        \r\n      const mapBounds =\r\n        ref.current.closest('.p6o-map-container')?.getBoundingClientRect();\r\n\r\n      if (elemBounds && mapBounds) {\r\n        const exceedsRight = elemBounds.right + padding[1] > mapBounds.right;\r\n        const exceedsBottom = elemBounds.bottom + padding[2] > mapBounds.bottom;\r\n\r\n        if (exceedsRight) {\r\n          setLeft(mapBounds.right - elemBounds.width - padding[1] - padding[3]);\r\n        }\r\n\r\n        if (exceedsBottom) {\r\n          setTop(mapBounds.bottom - elemBounds.height - padding[0] - padding[2]);\r\n        }\r\n      }\r\n    }\r\n  }, [ ref.current?.getBoundingClientRect() ]);\r\n\r\n  return { top, left };\r\n\r\n}","import React, { useEffect, useMemo, useRef, useState } from 'react';\r\nimport { MapRef, LngLatLike } from 'react-map-gl';\r\nimport centroid from '@turf/centroid';\r\nimport { AllGeoJSON } from '@turf/helpers';\r\nimport { IoCloseOutline } from 'react-icons/io5';\r\nimport { MapSelection, ViewState } from '../types';\r\nimport { Size, useDeviceState } from '../../device';\r\n\r\nimport './PopupContainer.css';\r\nimport { useAutoPosition } from './useAutoPosition';\r\n\r\ntype PopupContainerProps = {\r\n\r\n  selected: MapSelection; \r\n  \r\n  viewState: ViewState; \r\n  \r\n  map: MapRef; \r\n  \r\n  popup: Function;\r\n\r\n  onClose: Function;\r\n\r\n}\r\n\r\nexport const PopupContainer = (props: PopupContainerProps) => {\r\n\r\n  const device = useDeviceState();\r\n  \r\n  const el = useRef<HTMLDivElement>(null);\r\n\r\n  const { selected, viewState, map, popup} = props;\r\n\r\n  const [ offset, setOffset ] = useState<{ left: number, top: number }>({ left: 0, top: 0 });\r\n\r\n  const { top, left } = device.size === Size.DESKTOP ?\r\n    useAutoPosition(el, offset.left, offset.top) : { top: 0, left: 0 };\r\n\r\n  useEffect(() => {\r\n    if (selected && device.size === Size.DESKTOP) {\r\n      const lonlat = centroid(selected.feature as AllGeoJSON)?.geometry.coordinates as LngLatLike;\r\n      const { x, y } = map.project(lonlat);\r\n      setOffset({ left: x, top: y });\r\n    } else if (selected) {\r\n      setOffset({ left: 0, top: 0 });\r\n    }\r\n  }, [ selected, viewState, device.size ]);\r\n\r\n  const renderedPopup = useMemo(() => \r\n    selected ? popup({ ...props, onClose: props.onClose }) : null, [ selected ]);\r\n\r\n  return renderedPopup && (\r\n    <div \r\n      className={device.size === Size.DESKTOP ? \"p6o-map-popup-container\" : \"p6o-map-popup-container-mobile\"}\r\n      style={{ zIndex: 9, position: 'absolute', top, left }}>\r\n\r\n      <button\r\n        className=\"p6o-map-popup-close\"\r\n        /* @ts-ignore */\r\n        onClick={props.onClose}>\r\n        <IoCloseOutline />\r\n      </button>\r\n\r\n      <main ref={el}>\r\n        {renderedPopup}\r\n      </main>\r\n    </div>\r\n  );\r\n\r\n}","import React, { useMemo, useRef } from 'react';\r\nimport { useAutoPosition } from './useAutoPosition';\r\n\r\ntype TooltipContainerProps = {\r\n\r\n  x: number\r\n  \r\n  y: number\r\n  \r\n  node: any\r\n\r\n  feature: any\r\n\r\n  tooltip: Function\r\n\r\n}\r\n\r\nexport const TooltipContainer = (props: TooltipContainerProps) => {\r\n\r\n  const el = useRef<HTMLDivElement>(null);\r\n\r\n  const { x, y, node, feature, tooltip } = props;\r\n\r\n  const { left, top } = useAutoPosition(el, x, y);\r\n\r\n  const renderedTooltip = useMemo(() => \r\n    node ? tooltip({ node, feature }) : null, [ node, feature ]);\r\n\r\n  return renderedTooltip && (\r\n    <div \r\n      ref={el}\r\n      className=\"p6o-map-tooltip-container\"\r\n      style={{left, top, zIndex: 1 }}>\r\n      {renderedTooltip}\r\n    </div>\r\n  );\r\n\r\n}","import { useMap as useOneOfManyMaps } from 'react-map-gl';\r\n\r\n// react-map-gl has a utility hook that supports\r\n// multiple child maps, and one parent map. We want\r\n// a simplified hook which assumes only a single\r\n// map inside the Peripleo tag.\r\nexport const useMap = () => {\r\n  const { current, ...maps } = useOneOfManyMaps();\r\n  return Object.values(maps)[0];\r\n}\r\n","import { useRecoilState } from 'recoil';\r\nimport { mapViewState } from '../state';\r\nimport { useMap } from './useMap';\r\n\r\nexport const useViewState = () => {\r\n\r\n  const map = useMap();\r\n\r\n  const [ viewState, setViewState ] = useRecoilState(mapViewState);\r\n\r\n  const getMapBounds = () => {\r\n    if (map)\r\n      return map.getBounds().toArray();\r\n  }\r\n\r\n  return { viewState, setViewState, getMapBounds };\r\n\r\n}","import React from 'react';\r\nimport { TbCurrentLocation } from 'react-icons/tb';\r\nimport { useMap, useViewState } from '../../map';\r\n\r\nimport './MyLocationControl.css';\r\n\r\nexport const MyLocationControl = () => {\r\n\r\n  const map = useMap();\r\n\r\n  const { setViewState } = useViewState();\r\n\r\n  const onSuccess = (position: GeolocationPosition) => {\r\n    const { latitude, longitude } = position.coords;\r\n\r\n    setViewState({ latitude, longitude, zoom: 12 });\r\n\r\n    map?.easeTo({ center: [ longitude, latitude ], zoom: 12 });\r\n  }\r\n\r\n  const onError = (error: GeolocationPositionError) =>\r\n    console.warn('Error fetching location: ' + error.message);\r\n\r\n  const onClick = () => \r\n    navigator.geolocation.getCurrentPosition(onSuccess, onError, {\r\n      enableHighAccuracy: true\r\n    });\r\n\r\n  return (\r\n    <button \r\n      className=\"p6o-controls-btn p6o-my-location\"\r\n      tabIndex={40}\r\n      aria-label=\"Go to my location\"\r\n      onClick={onClick}>\r\n      <TbCurrentLocation />\r\n    </button>\r\n  )\r\n\r\n}","import React from 'react';\r\n\r\nimport './Controls.css';\r\n\r\nexport const Controls = (props: { children: React.ReactElement }) => {\r\n\r\n  return (\r\n    <div className='p6o-controls-container'>\r\n      {props.children}\r\n    </div>\r\n  )\r\n\r\n}","import React from 'react';\r\n\r\nimport './Controls.css';\r\n\r\nexport const Scrollable = (props: { children: React.ReactElement }) => {\r\n\r\n  return (\r\n    <div className='p6o-scrollable-container'>\r\n      {props.children}\r\n    </div>\r\n  )\r\n\r\n}","import React from 'react';\r\nimport { useRecoilState } from 'recoil';\r\nimport { mapViewState } from '../../map';\r\nimport { useMap } from '../../map';\r\nimport { \r\n  FiPlus, \r\n  FiMinus \r\n} from 'react-icons/fi';\r\n\r\nimport './ZoomControl.css';\r\n\r\nexport const ZoomControl = () => {\r\n\r\n  const map = useMap();\r\n\r\n  const [ viewState, setViewState ] = useRecoilState(mapViewState);\r\n\r\n  const onZoom = (inc: number) => () => {\r\n    if (map)\r\n      setViewState({\r\n        ...viewState, \r\n        zoom: viewState.zoom + inc,\r\n        transitionDuration: 200\r\n      });\r\n    \r\n    map?.easeTo({ zoom:  map.getZoom() + inc });\r\n  }\r\n  \r\n  return (\r\n    <div className=\"p6o-zoom-container\">\r\n      <button \r\n        className=\"p6o-controls-btn p6o-zoom p6o-zoom-in\"\r\n        tabIndex={31}\r\n        aria-label=\"Zoom in\"\r\n        onClick={onZoom(1)}>\r\n        <FiPlus />\r\n      </button>\r\n\r\n      <button \r\n        className=\"p6o-controls-btn p6o-zoom p6o-zoom-out\"\r\n        tabIndex={32}\r\n        aria-label=\"Zoom out\"\r\n        onClick={onZoom(-1)}>\r\n        <FiMinus />\r\n      </button>\r\n    </div>\r\n  )\r\n\r\n}","// https://carbondesignsystem.com/data-visualization/color-palettes/#categorical-palettes\r\nexport const TYPE_COLORS = {\r\n  'ARCHIVE': '#7eb0d5',\r\n  'BOOK': '#ede15b',\r\n  'EPHEMERA': '#ef9b20',\r\n  'GENIZA MANUSCRIPT': '#8a3800',\r\n  'KETUBBA': '#b2e061',\r\n  'MANUSCRIPT': '#bdcf32',\r\n  'MAP': '#edbf33',\r\n  'MOVIE': '#b33dc6',\r\n  'MUSIC': '#f46a9b',\r\n  'NEWSPAPER': '#bd7ebe',\r\n  'ORAL': '#87bc45',\r\n  'PHOTOGRAPH': '#ea5545',\r\n  'PICTURE': '#fd7f6f',\r\n  'SCORE': '#27aeef'\r\n}\r\n","import React from 'react';\r\nimport { TYPE_COLORS } from '../../Colors';\r\n\r\nimport './ListPreviewCard.css';\r\n\r\nconst isRTL = str => /^[\\u04c7-\\u0591\\u05D0-\\u05EA\\u05F0-\\u05F4\\u0600-\\u06FF\\u0750-\\u077f]/.test(str);\r\n\r\nexport const ListPreviewCard = props => {\r\n\r\n  const { record } = props;\r\n\r\n  const { title, thumbnailURI, type } = record;\r\n\r\n  return (\r\n    <div \r\n      className=\"kima-listpreview-card\"\r\n      onClick={props.onClick}>\r\n\r\n      <h5 style={isRTL(title) ? { direction: 'rtl' } : null}>{title}</h5>\r\n      \r\n      {thumbnailURI && \r\n        <div \r\n          className=\"kima-listpreview-image-wrapper\"\r\n          style={{\r\n            backgroundImage: `url(${thumbnailURI})`,\r\n            borderColor: TYPE_COLORS[type.label] \r\n          }} />\r\n      }\r\n    \r\n    </div>\r\n  )\r\n\r\n}","import { useDeviceState } from '../../peripleo';\r\nimport { useEffect, useState } from 'react';\r\n\r\nconst PADDING = [ 45, 25 ];\r\n\r\nexport const useAutoPosition = (ref, x, y) => {\r\n\r\n  const device = useDeviceState();\r\n\r\n  const [ left, setLeft ] = useState(x);\r\n\r\n  const [ top, setTop ] = useState(y);\r\n\r\n  useEffect(() => setLeft(x), [ x ]);\r\n\r\n  useEffect(() => setTop(y), [ y ]);\r\n\r\n  useEffect(() => {\r\n    if (ref.current && device.size === 'DESKTOP') {\r\n      setTimeout(() => {\r\n        const elemBounds = \r\n          ref.current?.getBoundingClientRect();\r\n          \r\n        const mapBounds =\r\n          ref.current.closest('.p6o-map-container')?.getBoundingClientRect();\r\n\r\n        if (elemBounds && mapBounds) {\r\n          const exceedsRight = elemBounds.right > mapBounds.right;\r\n          const exceedsBottom = elemBounds.bottom > mapBounds.bottom;\r\n\r\n          if (exceedsRight) {\r\n            setLeft(mapBounds.right - elemBounds.width - PADDING[0]);\r\n          }\r\n\r\n          if (exceedsBottom) {\r\n            setTop(mapBounds.bottom - elemBounds.bottom - PADDING[1]);\r\n          }\r\n        }\r\n      }, 1);\r\n    }\r\n  }, [ ref.current?.getBoundingClientRect() ]);\r\n\r\n  return { top, left };\r\n\r\n}","import React from 'react';\r\nimport Lightbox from 'react-18-image-lightbox';\r\n\r\nimport 'react-18-image-lightbox/style.css'; \r\n\r\nexport const FullscreenImage = props => {\r\n\r\n  const { image } = props;\r\n\r\n  return (\r\n    <Lightbox \r\n      mainSrc={image}\r\n      onCloseRequest={props.onClose} />\r\n  )\r\n\r\n}","export const getDescription = record => {\r\n  if (!record.descriptions)\r\n    return;\r\n\r\n  if (!Array.isArray(record.descriptions))\r\n    return;\r\n\r\n  return record.descriptions[0].value;\r\n}","import { FaArchive, FaBook, FaMap } from 'react-icons/fa';\r\nimport { AiFillAudio } from 'react-icons/ai';\r\nimport { HiBookOpen, HiNewspaper } from 'react-icons/hi';\r\nimport { HiPhoto } from 'react-icons/hi2';\r\nimport { MdMail, MdPhotoCamera } from 'react-icons/md';\r\nimport { IoMusicalNotes } from 'react-icons/io5';\r\nimport { RiMovie2Line } from 'react-icons/ri';\r\n\r\nexport const TYPE_ICONS = {\r\n  'ARCHIVE': <FaArchive />,\r\n  'BOOK': <FaBook />,\r\n  'EPHEMERA': <MdMail />,\r\n  'GENIZA MANUSCRIPT': <HiBookOpen />,\r\n  'KETUBBA': <HiBookOpen />,\r\n  'MANUSCRIPT': <HiBookOpen />,\r\n  'MAP': <FaMap />,\r\n  'MOVIE': <RiMovie2Line />,\r\n  'MUSIC': <IoMusicalNotes />,\r\n  'NEWSPAPER': <HiNewspaper />,\r\n  'NEWSPAPER ARTICLE': <HiNewspaper />,\r\n  'ORAL': <AiFillAudio />,\r\n  'PHOTOGRAPH': <MdPhotoCamera />,\r\n  'PICTURE': <HiPhoto />,\r\n  'SCORE': <IoMusicalNotes />\r\n}","import { nanoid } from 'nanoid'; \r\n\r\nexport const SESSION_ID = nanoid();","// Original base URLs: https://kimanli.azurewebsites.net/api \r\n// and later: https://kimanli7.azurewebsites.net/api\r\n// \r\n// For local testing and CORS proxying, use /api (also used as default)\r\nconst metaApiBase = document.querySelector('meta[name=\"api.base\"]')?.getAttribute('content');\r\n\r\nexport const API_BASE = metaApiBase ? (\r\n    metaApiBase.endsWith('/') ? metaApiBase.slice(0, -1) : metaApiBase\r\n  ) :\r\n  // DEFAULT\r\n  '/api';\r\n\r\nconst metaMapKey = document.querySelector('meta[name=\"maptiler.key\"]')?.getAttribute('content');\r\n\r\nexport const MAP_STYLE = metaMapKey ? \r\n  `https://api.maptiler.com/maps/voyager/style.json?key=${metaMapKey}` : \r\n  'https://api.maptiler.com/maps/voyager/style.json?key=RFavxpVJ82EHyrN2kxsF';","import React, { useEffect, useMemo, useRef, useState } from 'react';\r\nimport { HiChevronRight } from 'react-icons/hi2';\r\nimport { CgArrowsExpandRight, CgSpinner } from 'react-icons/cg';\r\nimport { FiShare2 } from 'react-icons/fi';\r\nimport { InfoModal } from '../../peripleo';\r\nimport { useAutoPosition } from './useAutoPosition';\r\nimport { FullscreenImage } from '../FullscreenImage/FullscreenImage';\r\nimport { getDescription } from './utils';\r\nimport { TYPE_ICONS } from '../../Icons';\r\nimport { TYPE_COLORS } from '../../Colors';\r\nimport { SESSION_ID } from '../../session';\r\nimport { API_BASE } from '../../Config';\r\n\r\nimport './SelectedCard.css';\r\n\r\nconst isRTL = str => /^[\\u04c7-\\u0591\\u05D0-\\u05EA\\u05F0-\\u05F4\\u0600-\\u06FF\\u0750-\\u077f]/.test(str);\r\n\r\nexport const logRequestedAsset = (recordType, id) =>\r\n  fetch(`${API_BASE}/RequestedAsset`, {\r\n    headers: {\r\n      'Accept': 'application/json',\r\n      'Content-Type': 'application/json',\r\n      'X-Kima-Session-Key': SESSION_ID\r\n    },\r\n    method: 'POST',\r\n    body: JSON.stringify({\r\n      RecordType: recordType,\r\n      id: id\r\n    })\r\n  });\r\n\r\nexport const SelectedCard = props => {\r\n\r\n  const el = useRef();\r\n\r\n  const { record } = props;\r\n\r\n  const { id, presentationURI, thumbnailURI, title, type } = record;\r\n\r\n  const description = useMemo(() => getDescription(record), [ record ]);\r\n\r\n  const [ showLightbox, setShowLightbox ] = useState(false);\r\n\r\n  const [ showEasterEgg, setShowEasterEgg ] = useState(false);\r\n\r\n  const [ audioURL, setAudioURL ] = useState();\r\n\r\n  const isAudio = type?.label === 'ORAL' || type?.label === 'MUSIC';\r\n\r\n  const [ previewFailed, setPreviewFailed ] = useState(false);\r\n\r\n  const { top, left } = useAutoPosition(el, 10, -10);\r\n\r\n  useEffect(() => {\r\n    if (isAudio && presentationURI) {\r\n      fetch(`${API_BASE}/cors-proxy`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'X-Kima-Session-Key': SESSION_ID\r\n        },\r\n        body: presentationURI\r\n      }).then(res => res.text()).then(audioURL =>  {\r\n        console.log('proxy response', audioURL);\r\n        window.setTimeout(() => setAudioURL(audioURL), 2000);\r\n      });\r\n    }\r\n\r\n    if (presentationURI || thumbnailURI) {\r\n      const img = document.createElement('img');\r\n      img.onerror = () => setPreviewFailed(true);\r\n      img.src = presentationURI || thumbnailURI;\r\n    }\r\n  }, [ presentationURI ]);\r\n\r\n  useEffect(() => {\r\n    logRequestedAsset(type.label, id);\r\n  }, [ type.label, id ]);\r\n\r\n  return (\r\n    <div \r\n      className=\"kima-selected-card-wrapper\">\r\n      <div \r\n        ref={el}\r\n        className=\"kima-selected-card\"\r\n        style={{ top, left }}\r\n        onClick={props.onClick}>\r\n          \r\n        <header>\r\n          {(presentationURI || thumbnailURI) && !previewFailed ? (\r\n            (isAudio && audioURL) ? (\r\n              <audio controls crossOrigin=\"anonymous\">\r\n                <source src={audioURL} />\r\n              </audio>\r\n            ) : (\r\n              <>\r\n                <div className=\"kima-selected-preview-loading\">\r\n                  <CgSpinner />\r\n                </div>\r\n\r\n                <div className=\"kima-selected-preview\" style={{ backgroundImage: `url(\"${presentationURI || thumbnailURI}\")` }} />\r\n\r\n                {presentationURI && (\r\n                  <button \r\n                    className=\"kima-selected-fullscreen\"\r\n                    onClick={() => setShowLightbox(true) }>\r\n                    <CgArrowsExpandRight />\r\n                  </button>\r\n                )}\r\n              </>\r\n            )\r\n          ) : (\r\n            <div className=\"kima-selected-preview\">\r\n              {TYPE_ICONS[type.label]}\r\n            </div>\r\n          )}\r\n        </header>\r\n\r\n        <main>\r\n          <div style={isRTL(title) ? { direction: 'rtl' } : null}>\r\n            <h1>\r\n              {title}\r\n            </h1>\r\n            <h2 className=\"type\">\r\n              {TYPE_ICONS[type.label]}\r\n              <span className=\"label\">{type.label}</span>\r\n            </h2>\r\n          </div>\r\n          {description && <p style={isRTL(description) ? { direction: 'rtl' } : null}>{description}</p> }\r\n        </main>\r\n\r\n        <footer>\r\n          <a href={id} target=\"_blank\">\r\n            <section className=\"details\">\r\n              <span>Details</span>\r\n              <span>\r\n                <HiChevronRight />\r\n              </span>\r\n            </section>\r\n          </a>\r\n\r\n          <section className=\"close\" style={{ borderBottomColor: TYPE_COLORS[type.label] }}>\r\n            <button className=\"share\" onClick={() => setShowEasterEgg(true)}><FiShare2 /></button>\r\n            <button className=\"close\" onClick={props.onClose}>Close</button>\r\n          </section>\r\n        </footer>\r\n\r\n        {presentationURI && showLightbox && (\r\n          <FullscreenImage image={presentationURI} onClose={() => setShowLightbox(false)} />\r\n        )}\r\n\r\n        {showEasterEgg && (\r\n          <InfoModal \r\n            onClose={() => setShowEasterEgg(false)}>\r\n\r\n            <div className=\"easter-egg\">\r\n              <main>\r\n                <h1>Vote for us!</h1>\r\n                <p>\r\n                  If the NLI Heritage Browser makes it \r\n                  to the winner's podium, we will build lots of additional\r\n                  great features - such as the ability to share items\r\n                  and maps on social media.\r\n                </p>\r\n              </main>\r\n            </div>\r\n\r\n          </InfoModal>\r\n        )}\r\n      </div>\r\n    </div>\r\n  )\r\n\r\n}","import React, { useEffect, useState } from 'react';\r\nimport { SiWikidata } from 'react-icons/si';\r\nimport { useGraph } from '../../peripleo';\r\nimport { ListPreviewCard } from './ListPreviewCard';\r\nimport { SelectedCard } from './SelectedCard';\r\n\r\nexport const KimaPopup = props => {\r\n\r\n  const graph = useGraph();\r\n\r\n  const { node } = props.selected;\r\n\r\n  const [ records, setRecords ] = useState([]);\r\n\r\n  const [ expanded, setExpanded ] = useState();\r\n\r\n  const description = node.descriptions?.length > 0 ? node.descriptions[0].value : null;\r\n\r\n  useEffect(() => {\r\n    setExpanded(null);\r\n    \r\n    setRecords([]);\r\n\r\n    const onLazyLoad = data => {\r\n      const preLoadedRecords = new Set(preLoaded.map(r => r.id));\r\n      const fetchedRecords = data.records.filter(r => !preLoadedRecords.has(r.id));\r\n      if (fetchedRecords.length > 0)\r\n        setRecords([ ...preLoaded, ...fetchedRecords.slice(0, 500) ]);\r\n    }\r\n\r\n    const preLoaded = graph.getConnected(node.id, true, onLazyLoad);\r\n    setRecords(preLoaded);\r\n  }, [ node ]);\r\n   \r\n  return (\r\n    <div className=\"kima-popup-wrapper\">\r\n      <div className=\"kima-popup-expanded\">\r\n        {records.length === 1 &&\r\n          <SelectedCard \r\n            record={records[0]} \r\n            onClose={props.onClose} />\r\n        }\r\n\r\n        {expanded &&\r\n          <SelectedCard \r\n            record={expanded} \r\n            onClose={() => setExpanded(null)} />\r\n        }\r\n      </div>\r\n\r\n      {records.length > 1 &&\r\n        <div className=\"kima-popup-multilist\">\r\n          <header>\r\n            <h1>\r\n              <a href={node.id} target=\"_blank\" title=\"This place in KIMA\">{node.properties.title}</a>\r\n              {node.externalURI && (\r\n                <a href={node.externalURI} target=\"_blank\" title=\"This place in Wikidata\">\r\n                  <SiWikidata title=\"This place in Wikidata\" />\r\n                </a>\r\n              )}\r\n            </h1>\r\n            <p className=\"kima-description\">\r\n              {description}\r\n            </p>\r\n          </header>\r\n          <div className=\"kima-popup-multilist-list\">\r\n            {records.map(record => (\r\n              <ListPreviewCard \r\n                key={record.id}\r\n                record={record} \r\n                onClick={() => setExpanded(record)}/> ))\r\n            }\r\n          </div>\r\n        </div>\r\n      }\r\n    </div>\r\n  )\r\n\r\n}","import { SESSION_ID } from '../../session';\r\n\r\nconst POST = {\r\n  headers: {\r\n    'Accept': 'application/json',\r\n    'Content-Type': 'application/json',\r\n    'X-Kima-Session-Key': SESSION_ID\r\n  },\r\n  method: 'POST'\r\n};\r\n\r\nclass APIError extends Error {\r\n\r\n  constructor(message, status) {\r\n    super(message);\r\n\r\n    this.status = status;\r\n  }\r\n\r\n}\r\n\r\n// HTTP API response handler - delivers JSON\r\n// or throws exception in case of HTTP errors\r\nconst onResponse = res => {\r\n  if (res.status === 200)\r\n    return res.json();\r\n  else \r\n    throw new APIError('API Error', res.status);\r\n}\r\n\r\nexport const toFilterBody = filters => {\r\n  const payload = {};\r\n\r\n  filters.forEach(({ name, values }) => payload[name] = values);\r\n\r\n  return Object.keys(payload.length > 0) ?\r\n    payload : null;\r\n}\r\n\r\nexport const getPlaces = api => (bounds = null, filters = [], signal) => {\r\n  if (bounds) {\r\n    const [[ minLon, minLat ], [ maxLon, maxLat ]] = bounds;\r\n\r\n    if (filters.length > 0) {\r\n      return fetch(`${api}/BoxPlaces/${minLon}/${minLat}/${maxLon}/${maxLat}`, {\r\n        signal,\r\n        ...POST,\r\n        body: JSON.stringify(toFilterBody(filters))\r\n      }).then(onResponse);\r\n    } else {\r\n      return new Promise(resolve => setTimeout(resolve, 50))\r\n        .then(() => fetch(`${api}/BoxPlaces/${minLon}/${minLat}/${maxLon}/${maxLat}`, { \r\n          headers: {\r\n            'X-Kima-Session-Key': SESSION_ID\r\n          },\r\n          signal \r\n        })).then(onResponse);\r\n    }\r\n  } else {\r\n    return fetch(`${api}/Places`, { \r\n      headers: {\r\n        'X-Kima-Session-Key': SESSION_ID\r\n      },\r\n      signal\r\n    }).then(onResponse);\r\n  }\r\n}\r\n\r\nexport const getRecords = api => (bounds = null, filters = [], signal) => {\r\n  if (bounds) {\r\n    const [[ minLon, minLat ], [ maxLon, maxLat ]] = bounds;\r\n\r\n    if (filters.length > 0) {\r\n      return fetch(`${api}/BoxRecords/${minLon}/${minLat}/${maxLon}/${maxLat}`, {\r\n        signal,\r\n        ...POST,\r\n        body: JSON.stringify(toFilterBody(filters))\r\n      }).then(onResponse);\r\n      \r\n    } else {\r\n      return fetch(`${api}/BoxRecords/${minLon}/${minLat}/${maxLon}/${maxLat}`, { \r\n        headers: {\r\n          'X-Kima-Session-Key': SESSION_ID\r\n        },\r\n        signal\r\n      }).then(onResponse);\r\n    }\r\n  } else {\r\n    return fetch(`${api}/Records`, { \r\n      headers: {\r\n        'X-Kima-Session-Key': SESSION_ID\r\n      },\r\n      signal\r\n    }).then(onResponse);\r\n  }\r\n}\r\n","import { useEffect, useState } from 'react';\r\nimport { SearchStatus, useSearch } from '../../peripleo';\r\nimport { getPlaces, getRecords } from './KimaAPI';\r\n\r\nexport const KimaSearchHandler = props => {\r\n\r\n  const { search, setSearchState } = useSearch();\r\n\r\n  const [ pending, setPending] = useState();\r\n\r\n  const places = getPlaces(props.api);\r\n\r\n  const records = getRecords(props.api);\r\n\r\n  useEffect(() => {\r\n    if (search.status === SearchStatus.PENDING) {\r\n      props.onLoad();\r\n\r\n      if (pending)\r\n        pending.abort();\r\n\r\n      const controller = new AbortController();\r\n      setPending(controller);\r\n\r\n      // console.log('Running search');\r\n\r\n      const { signal } = controller;\r\n      \r\n      Promise.all([\r\n        places(props.bounds, search.args.filters, signal), \r\n        records(props.bounds, search.args.filters, signal)  \r\n      ]).then(([ placesResult, recordsResult ]) => {\r\n        // Clear pending abort controller\r\n        setPending(null);\r\n\r\n        // Debug log\r\n        // console.log('Places', placesResult);\r\n        // console.log('Records', recordsResult);\r\n\r\n        // Convert to Peripleo conventions\r\n        const total = placesResult.features.reduce((total, f) => \r\n          total + (f.properties.total_records || 1), 0);\r\n\r\n        const items = placesResult.features.map(feature => ({\r\n          ...feature,\r\n          properties: {\r\n            id: feature.id,\r\n            count: feature.properties.total_records,\r\n            ...feature.properties\r\n          }\r\n        }));\r\n\r\n        setSearchState({ \r\n          args: { \r\n            ...search.args\r\n          }, \r\n          status: SearchStatus.OK, \r\n          result: { \r\n            total, \r\n            items,\r\n            aggregations: Object.entries(recordsResult.facetsInfo).reduce((obj, [key, buckets]) => {\r\n              obj[key] = { buckets: buckets.map(b => ({ label: b.label, count: b.countFaceted })) };\r\n              return obj; \r\n            }, {})\r\n          }\r\n        });\r\n\r\n        props.onLoadDone();\r\n\r\n        props.onSearchResult({ places: placesResult, records: recordsResult });\r\n      }).catch(error => {\r\n        console.log(error);\r\n\r\n        if (error.status === 500)\r\n          setSearchState({ \r\n            ...search,\r\n            status: SearchStatus.FAILED\r\n          });\r\n      });\r\n    }\r\n  }, [ search ]);\r\n\r\n  useEffect(() => {\r\n    if (props.bounds) {\r\n      setSearchState({ args: search.args, status: SearchStatus.PENDING, result: search.result });\r\n    }\r\n  }, [ props.bounds ]);\r\n\r\n  return props.children;\r\n\r\n}","\r\nimport React, { useEffect, useMemo, useState } from 'react';\r\nimport { GraphContext, useSearch } from '../../peripleo';\r\nimport { toFilterBody } from './KimaAPI';\r\nimport { SESSION_ID } from '../../session';\r\n\r\nconst uriToId = uri =>\r\n  uri.substring(uri.lastIndexOf('=') + 1);\r\n\r\n// The cache is simply a map of place IDs -> records\r\nconst buildCache = data => {\r\n  const { records } = data;\r\n\r\n  const cache = {};\r\n\r\n  records.forEach(record => {\r\n    const { places } = record;\r\n\r\n    places.forEach(place => {\r\n      const placeId = uriToId(place.id);\r\n\r\n      if (cache[placeId]) {\r\n        cache[placeId].push(record);\r\n      } else {\r\n        cache[placeId] = [ record ];\r\n      }\r\n    });\r\n\r\n  });\r\n\r\n  return cache;\r\n}\r\n\r\nexport const KimaGraphProvider = props => {\r\n\r\n  const [ graph, setGraph ] = useState();\r\n\r\n  const { search } = useSearch();\r\n\r\n  const { api, results } = props;\r\n\r\n  const places = results?.places.features;\r\n\r\n  const records = results?.records;\r\n\r\n  const cache = useMemo(() => records ? buildCache(records) : null, [ props.results ]);\r\n\r\n  // Shorthand\r\n  const getConnectedFromCache = id => cache ? cache[id] || [] : [];\r\n\r\n  useEffect(() => {\r\n    const getNodeById = id =>\r\n      places?.find(i => i.id === id);\r\n    \r\n    const getConnected = (uri, fetchAll, fetchAllCallback) => {\r\n      const id = uriToId(uri);\r\n\r\n      // fetchAll is a Kima-specific quirk\r\n      if (fetchAll) {\r\n        const f = search.args.filters?.length > 0 ?\r\n          fetch(`${api}/Records/${id}`, {\r\n            headers: {\r\n              'Accept': 'application/json',\r\n              'Content-Type': 'application/json',\r\n              'X-Kima-Session-Key': SESSION_ID\r\n            },\r\n            method: 'POST',\r\n            body: JSON.stringify(toFilterBody(search.args.filters))\r\n          }) :\r\n\r\n          fetch(`${api}/Records/${id}`, {\r\n            headers: {\r\n              'X-Kima-Session-Key': SESSION_ID\r\n            }\r\n          });\r\n\r\n        f.then(res => res.json()).then(data => fetchAllCallback(data));\r\n        \r\n        return getConnectedFromCache(id);\r\n      } else {\r\n        return new Promise(resolve => resolve(getConnectedFromCache(id)));\r\n      }\r\n    };\r\n  \r\n    setGraph({ getNodeById, getConnected }); \r\n  }, [ props.results ]);\r\n\r\n  return (\r\n    <GraphContext.Provider value={graph}>\r\n      {props.children}\r\n    </GraphContext.Provider>\r\n  )\r\n  \r\n}","import React, { useMemo, useState } from 'react';\r\nimport { useDebounce } from 'use-debounce';\r\nimport { useMap, useViewState } from '../../peripleo';\r\nimport { KimaSearchHandler } from './KimaSearchHandler';\r\nimport { KimaGraphProvider } from './KimaGraphProvider';\r\n\r\nexport const isValidViewState = (viewState) => {\r\n  const { longitude, latitude, zoom } = viewState;\r\n  return !!(longitude && latitude && zoom);\r\n}\r\n\r\nexport const KimaStore = props => {\r\n\r\n  const { viewState, getMapBounds } = useViewState();\r\n\r\n  const [ debounced ] = useDebounce(viewState, 250);\r\n\r\n  // The viewstate is always defined, but only valid after \r\n  // the map is loaded. Make sure we handle slow connections,\r\n  // where the app loads faster than the map!\r\n  const map = useMap();\r\n\r\n  const bounds = useMemo(() => { \r\n    if (isValidViewState(debounced))\r\n      return getMapBounds();\r\n  }, [ map, debounced ]);\r\n\r\n  const [ results, setResults ] = useState();\r\n\r\n  return (    \r\n    <KimaSearchHandler \r\n      api={props.api} \r\n      bounds={bounds}\r\n      onLoad={props.onLoad}\r\n      onLoadDone={props.onLoadDone}\r\n      onSearchResult={results => setResults(results)}>\r\n\r\n      <KimaGraphProvider \r\n        api={props.api} \r\n        bounds={bounds}\r\n        results={results}>\r\n\r\n        {props.children}\r\n\r\n      </KimaGraphProvider>\r\n\r\n    </KimaSearchHandler>\r\n  )\r\n\r\n}","import React, { useEffect, useState } from 'react';\r\nimport { useGraph, useDeviceState } from '../../peripleo';\r\n\r\nexport const KimaTooltip = props => {\r\n  \r\n  const graph = useGraph();\r\n\r\n  const device = useDeviceState();\r\n\r\n  const [ connected, setConnected ] = useState([]);\r\n\r\n  const { node } = props;\r\n\r\n  useEffect(() => {\r\n    graph.getConnected(node.id, false).then(setConnected);\r\n  }, []);\r\n\r\n  const description = node.descriptions?.length > 0 ? node.descriptions[0].value : null;\r\n\r\n  const totalConnected = node.properties.total_records;\r\n  \r\n  return device.size === 'DESKTOP' ? (\r\n    <div dir=\"rtl\" className=\"kima-tooltip\">\r\n      <main>\r\n        <h1>\r\n          {node.properties.title}\r\n        </h1>\r\n        <p className=\"kima-description\">\r\n          {description}\r\n        </p>\r\n      </main>\r\n      {totalConnected === 1 && connected.length > 0 &&\r\n        <div className=\"kima-tooltip-footer kima-first-connected\">\r\n          {connected[0].title} {connected[0].type?.label && \r\n            <span>({connected[0].type.label})</span> \r\n          }\r\n        </div>\r\n      }\r\n      {totalConnected > 1 && connected.length > 0 &&\r\n        <div className=\"kima-tooltip-footer kima-connected-count\" dir=\"ltr\">\r\n          {totalConnected.toLocaleString()} Objects\r\n        </div>\r\n      }\r\n    </div>\r\n  ) : null;\r\n\r\n}","import { useDeviceState } from '../../peripleo';\r\nimport { CgSpinner } from 'react-icons/cg';\r\n\r\nimport './LoadIndicator.css';\r\n\r\nexport const LoadIndicator = props => {\r\n\r\n  const device = useDeviceState();\r\n\r\n  return (\r\n    <div \r\n      className={device.size === 'DESKTOP' ? \r\n        \"kima-load-indicator p6o-controls-btn\" : \"kima-load-indicator p6o-controls-btn mobile\"}>\r\n      <CgSpinner />\r\n    </div>\r\n  )\r\n\r\n}","import React, { useState } from 'react';\r\nimport ReactDOM from 'react-dom/client';\r\nimport { CgArrowsExpandRight } from 'react-icons/cg';\r\nimport { TbCurrentLocation } from 'react-icons/tb';\r\nimport { FiMenu } from 'react-icons/fi';\r\nimport Peripleo, { \r\n  AggregationsOverlay,\r\n  Controls,\r\n  Desktop,\r\n  InfoControl,\r\n  Map, \r\n  Mobile,\r\n  MobileMenu,\r\n  MyLocationControl,\r\n  HeatmapLayer,\r\n  Scrollable,\r\n  ZoomControl\r\n} from './peripleo';\r\nimport { QueryClient, QueryClientProvider } from '@tanstack/react-query';\r\nimport { KimaPopup, KimaStore, KimaTooltip, LoadIndicator } from './components';\r\nimport { TYPE_COLORS } from './Colors';\r\nimport { API_BASE, MAP_STYLE } from './Config';\r\n\r\nimport './index.css';\r\n\r\n// Needed for lightbox: https://stackoverflow.com/questions/72114775/vite-global-is-not-defined\r\nwindow.global ||= window;\r\n\r\nconst queryClient = new QueryClient();\r\n\r\nconst App = () => {\r\n\r\n  const [ loading, setLoading ] = useState(true);\r\n\r\n  return (\r\n    <QueryClientProvider client={queryClient}>\r\n      <Peripleo>    \r\n        <KimaStore \r\n          api={API_BASE}\r\n          onLoad={() => setLoading(true)}\r\n          onLoadDone={() => setLoading(false)}>\r\n  \r\n          <Map.MapLibre\r\n            mapStyle={MAP_STYLE}\r\n            defaultBounds={[[32.0, 27.1], [38.2, 35.7]]}\r\n            tooltip={props => <KimaTooltip {...props} />} \r\n            popup={props => <KimaPopup {...props} />}>\r\n\r\n            <HeatmapLayer \r\n              id=\"kima-layer-places\"\r\n              color=\"#9d00d1\" />\r\n            \r\n          </Map.MapLibre>\r\n\r\n          <Controls>\r\n            <Mobile>\r\n              <MobileMenu\r\n                items={[\r\n                  <AggregationsOverlay \r\n                    colors={TYPE_COLORS} \r\n                    fullscreen={true} \r\n                    displayFacets={['RecordTypes', 'RelationshipTypes']} \r\n                    facetLabels={['Record Types', 'Relationships']} />\r\n                  ]} />\r\n            </Mobile>\r\n\r\n            <Desktop>\r\n              <Scrollable>\r\n                <AggregationsOverlay\r\n                  colors={TYPE_COLORS} \r\n                  responsive={true} \r\n                  displayFacets={['RecordTypes', 'RelationshipTypes']} \r\n                  facetLabels={['Record Types', 'Relationships']} />\r\n              </Scrollable>\r\n            </Desktop>\r\n\r\n            <ZoomControl />\r\n            \r\n            <MyLocationControl />\r\n            \r\n            <InfoControl className=\"kima-welcome\">\r\n              <h1>Welcome to the Heritage Browser!</h1>\r\n\r\n              <p>\r\n                Discover the digitally available treasures of the National Library of Israel \r\n                displayed on a map according to where they were created or locations they describe.\r\n              </p>\r\n\r\n              <ul>\r\n                <li>\r\n                  Move the map around by dragging it and use the buttons on the right or your mouse to zoom in and out.\r\n                </li>\r\n                <li>\r\n                  Click on a place to see the number of items related to it, as well as links to wikidata \r\n                  and the Kima Gazetteer. Another click will open a list of related items. \r\n                </li>\r\n                <li>\r\n                  After opening an item, use the <CgArrowsExpandRight /> icon to enlarge the image. Click Details to view the \r\n                  item's details at the library's website.\r\n                </li>\r\n                <Desktop>\r\n                  <li>\r\n                    Use the left bar to filter the types of items that interest you, or change the bar \r\n                    from Record Types to Relationship Types to filter items according to their relation to the place.\r\n                  </li>\r\n                </Desktop>\r\n                <Mobile>\r\n                  <li> \r\n                    Click the <FiMenu /> icon to filter the types of items that interest you, or change the bar \r\n                    from Record Types to Relationship Types to filter items according to their relation to the place.\r\n                  </li>\r\n                </Mobile>\r\n                <li>\r\n                  The <TbCurrentLocation /> button on the right of the screen will focus the map on your current location. \r\n                </li>\r\n              </ul>\r\n\r\n              <p>\r\n                Created by <a href=\"mailto:sinai.rusinek@mail.huji.ac.il\">Sinai \r\n                Rusinek</a>, <a href=\"mailto:gil.shalit@gmail.com\">Gil Shalit</a> and <a href=\"mailto:hello@rainersimon.io\">Rainer \r\n                Simon</a> and was a finalist in the <a href=\"https://tarboot.org/\" target=\"_blank\">tarboot</a> competition's \r\n                general track.\r\n              </p>\r\n            </InfoControl>\r\n\r\n            {loading && \r\n              <LoadIndicator />\r\n            }\r\n          </Controls>\r\n        </KimaStore>\r\n      </Peripleo>\r\n    </QueryClientProvider>\r\n  )\r\n\r\n}\r\n\r\nwindow.onload = function() {\r\n\r\n  ReactDOM.createRoot(document.getElementById('app')).render(\r\n    <App />\r\n  )\r\n    \r\n}"],"names":["relList","link","processPreload","mutations","mutation","node","getFetchOpts","script","fetchOpts","Size","isTouchDevice","window","navigator","maxTouchPoints","msMaxTouchPoints","DeviceStateContext","createContext","size","DESKTOP","DeviceStateContextProvider","props","device","setDevice","useState","innerWidth","breakPoint","MOBILE","useLayoutEffect","onWindowResize","evt","w","addEventListener","removeEventListener","_jsx","Provider","value","children","useDeviceState","useContext","Peripleo","RecoilRoot","MapProvider","GraphContext","useGraph","SearchStatus","searchState","atom","useSearch","search","setSearchState","useRecoilState","runSearch","args","query","name","filter","updatedFilters","f","AggregationsCarousel","activeAggregation","aggregations","label","labels","indexOf","onChangeAggregation","inc","length","updatedIdx","className","tabIndex","onClick","HiOutlineChevronLeft","HiOutlineChevronRight","formatNumber","num","toFixed","AggregationValueList","buckets","map","count","filterValues","includes","onToggleFilterValue","style","backgroundColor","colors","borderColor","chroma","alpha","hex","AggregationsOverlay","setFilter","setActiveAggregation","result","Object","keys","displayed","displayFacets","filters","find","values","updated","str","fullscreen","facetLabels","Desktop","InfoModal","el","useRef","useEffect","onKeyDown","key","onClose","document","target","current","ReactDOM","createPortal","_jsxs","ref","IoCloseOutline","body","InfoControl","modalOpen","setModalOpen","_Fragment","IoInformation","Mobile","MobileMenu","open","setOpen","FiMenu","CSSTransition","in","classNames","timeout","unmountOnExit","items","mapViewState","isValidViewState","viewState","longitude","latitude","zoom","def","x","selectedState","assert","condition","message","isBrowser","matches","VERSION","isMobile","_typeof","o","toPrimitive","t","r","i","toPropertyKey","_defineProperty","obj","WorkerJob","jobName","workerThread","resolve","reject","type","payload","error","Worker","workerURLCache","getLoadableWorkerURL","workerURL","getLoadableWorkerURLFromURL","getLoadableWorkerURLFromSource","url","workerSource","buildScriptSource","blob","workerUrl","getTransferList","object","recursive","transfers","transfersSet","isTransferable","NOOP","WorkerThread","NodeWorker","source","data","transferList","event","worker","code","WorkerPool","onMessage","job","onError","startPromise","onStart","queuedJob","DEFAULT_PROPS","WorkerFarm","workerPool","options","NPM_TAG","getWorkerURL","workerOptions","workerFile","version","versionTag","validateWorkerVersion","coreVersion","workerVersion","canParseWithWorker","loader","parseWithWorker","context","parseOnMainThread","id","input","compareArrayBuffers","arrayBuffer1","arrayBuffer2","byteLength","array1","array2","concatenateArrayBuffers","_len","sources","_key","sourceArrays","source2","typedArray","offset","sourceArray","concatenateArrayBuffersAsync","asyncIterator","arrayBuffers","chunk","pathPrefix","fileAliases","resolvePath","filename","alias","replacement","isBuffer","toArrayBuffer","text","slashIndex","dirname","isBoolean","isFunction","isObject","isPureObject","isIterable","isAsyncIterable","isResponse","isBlob","isReadableDOMStream","isReadableNodeStream","isReadableStream","DATA_URL_PATTERN","MIME_TYPE_PATTERN","parseMIMEType","mimeString","parseMIMETypeFromURL","QUERY_STRING_PATTERN","extractQueryString","stripQueryString","getResourceUrl","resource","getResourceMIMEType","response","contentTypeHeader","noQueryUrl","getResourceContentLength","makeResponse","headers","contentLength","initialDataUrl","getInitialDataUrl","checkResponse","getResponseError","contentType","blobSlice","reader","_event$target","slice","base64","arrayBufferToBase64","buffer","binary","bytes","fetchFile","fetchOptions","isElectron","mockUserAgent","realUserAgent","userAgent","window_","process_","checkIfBrowser","getStorage","storage","LocalStorage","defaultConfig","configuration","serialized","serializedConfiguration","formatTime","ms","formatted","leftPad","string","padLength","formatImage","image","scale","maxWidth","imageUrl","width","height","COLOR","BACKGROUND_INCREMENT","getColor","color","addColor","background","colorCode","autobind","predefined","proto","propNames","getHiResTimestamp","timestamp","_window$performance","_window$performance$n","process","_process$hrtime","timeParts","originalConsole","DEFAULT_LOG_CONFIGURATION","noop","cache","ONCE","Log","newLevel","newPriority","enabled","level","setting","oldUsage","newUsage","logLevel","table","columns","getTableHeader","_ref","priority","logImageInBrowser","logImageInNode","opts","normalizeArguments","collapsed","func","normalizeLogLevel","method","tag","decorateMessage","resolvedLevel","messageType","time","_ref2","_ref3","img","element","title","probeLog","NullLog","ConsoleLog","_len2","_key2","_len3","_key3","_len4","_key4","DEFAULT_LOADER_OPTIONS","REMOVED_LOADER_OPTIONS","getGlobalLoaderState","loaders","getGlobalLoaderOptions","state","normalizeOptions","validateOptions","normalizeOptionsInternal","validateOptionsObject","idOptions","loaderOptions","deprecatedOptions","defaultOptions","loaderName","prefix","isSubOptions","isBaseUriOption","isWorkerUrlOption","suggestion","findSimilarOption","optionKey","lowerCaseOptionKey","bestSuggestion","lowerCaseKey","mergedOptions","addUrlOptions","mergeNestedFields","isLoaderObject","_loader","normalizeLoader","_loader2","_loader3","getGlobalLoaderRegistry","registerLoaders","loaderRegistry","normalizedLoader","registeredLoader","getRegisteredLoaders","log","EXT_PATTERN","selectLoader","validHTTPResponse","selectLoaderSync","getNoValidLoaderMessage","candidateLoaders","normalizeLoaders","selectLoaderInternal","testUrl","reason","findLoaderByMIMEType","findLoaderByUrl","findLoaderByInitialBytes","getFirstCharacters","path.filename","firstCharacters","match","extension","findLoaderByExtension","loaderExtension","mimeType","testDataAgainstText","testDataAgainstBinary","test","byteOffset","testBinary","magic","getMagicString","arrayBuffer","dataView","DEFAULT_CHUNK_SIZE","makeStringIterator","chunkSize","textEncoder","chunkLength","makeArrayBufferIterator","chunkByteLength","makeBlobIterator","end","makeStreamIterator","stream","makeBrowserStreamIterator","makeNodeStreamIterator","nextBatchPromise","currentBatchPromise","done","makeIterator","ERR_DATA","getArrayBufferOrStringFromDataSync","getArrayBufferOrStringFromData","isArrayBuffer","getFetchFunction","globalOptions","getLoaderContext","parentContext","newContext","baseUrl","path.dirname","getLoadersFromContext","contextLoaders","parse","parseWithLoader","ok","redirected","status","statusText","load","fetch","_parseImageNode","IMAGE_SUPPORTED","IMAGE_BITMAP_SUPPORTED","NODE_IMAGE_SUPPORTED","DATA_SUPPORTED","isImageTypeSupported","getDefaultImageType","getImageType","format","getImageTypeOrNull","getImageData","canvas","SVG_DATA_URL_PATTERN","SVG_URL_PATTERN","isSVG","getBlobOrSVGDataUrl","xmlText","getBlob","parseToImage","blobOrDataUrl","URL","objectUrl","loadToImage","err","EMPTY_OBJECT","imagebitmapOptionsSupported","parseToImageBitmap","imagebitmapOptions","safeCreateImageBitmap","isEmptyObject","getISOBMFFMediaType","checkString","decodeMajorBrand","getUTF8String","array","start","stringToBytes","character","header","headerBytes","BIG_ENDIAN","LITTLE_ENDIAN","getBinaryImageMetadata","binaryData","toDataView","getPngMetadata","getJpegMetadata","getGifMetadata","getBmpMetadata","getISOBMFFMetadata","mediaType","tableMarkers","sofMarkers","getJpegMarkers","marker","parseToNodeImage","parseImage","imageType","loadType","getLoadableImageType","EXTENSIONS","MIME_TYPES","DEFAULT_IMAGE_LOADER_OPTIONS","ImageLoader","globals","getBrowser","isMSIE","isTrident","DEFAULT_SETTINGS","log$2","loggers","register","handlers","debug","eventType","arg1","arg2","arg3","deckLog","isJSON","firstChar","lastChar","jsonLoader","existingVersion","deckGlobal","ERR_CONTEXT","ERR_WEBGL2","isWebGL","gl","isWebGL2","getWebGL2Context","assertWebGLContext","assertWebGL2Context","glErrorShadow","msg","synthesizeGLError","opt_msg","wrapGLError","WebGLVertexArrayObjectOES","ext","n","attrib","OESVertexArrayObject","self","original","pname","index","vao","indx","normalized","stride","ii","arrayObject","oldVAO","newVAO","currentBinding","maxAttrib","oldAttrib","bufferChanged","polyfillVertexArrayObject","original_getSupportedExtensions","list","original_getExtension","OES_element_index","WEBGL_draw_buffers","EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2","EXT_texture_filter_anisotropic","WEBGL_debug_renderer_info","GL_FRAGMENT_SHADER_DERIVATIVE_HINT","GL_DONT_CARE","GL_GPU_DISJOINT_EXT","GL_MAX_TEXTURE_MAX_ANISOTROPY_EXT","GL_UNMASKED_VENDOR_WEBGL","GL_UNMASKED_RENDERER_WEBGL","getWebGL2ValueOrZero","WEBGL_PARAMETERS","getParameter","getParameterPolyfill","originalGetParameter","limit","OES_vertex_array_object","ANGLE_instanced_arrays","ERR_VAO_NOT_SUPPORTED","getExtensionData","WEBGL2_CONTEXT_POLYFILLS","location","divisor","handle","WEBGL2_CONTEXT_OVERRIDES","originalFunc","attachment","webgl2","program","extensions","polyfillContext","luma","initializeExtensions","installPolyfills","installOverrides","target2","polyfill","polyfills","polyfillExtension","defaults","meta","suffix","extKey","GL_PARAMETER_DEFAULTS","enable","hint","pixelStorei","drawFramebuffer","readFramebuffer","isArray","GL_PARAMETER_SETTERS","framebuffer","mask","backMask","backFunc","backRef","sfail","dpfail","dppass","backSfail","backDpfail","backDppass","getValue","glEnum","GL_COMPOSITE_PARAMETER_SETTERS","GL_HOOKED_SETTERS","update","capability","g","b","a","mode","modeRGB","modeAlpha","src","dst","srcRGB","dstRGB","srcAlpha","dstAlpha","depth","s","zNear","zFar","face","factor","units","invert","y","fail","zfail","zpass","isEnabled","GL_PARAMETER_GETTERS","isObjectEmpty","deepArrayEqual","isArrayX","isArrayY","installGetterOverride","functionName","originalGetterFunc","installSetterSpy","setter","originalSetterFunc","params","valueChanged","oldValue","installProgramSpy","originalUseProgram","GLState","copyState","getParameters","oldValues","setParameters","cached","trackContextState","pushContextState","popContextState","compositeSetters","glConstant","compositeSetter","parameters","getter","parameterKeys","resetParameters","withParameters","nocatch","cssToDeviceRatio","cachedSize","clientWidth","cssToDevicePixels","cssPixel","yInvert","ratio","scalePixels","getDevicePixelRatio","useDevicePixels","windowRatio","pixel","scaleX","scaleY","xHigh","yHigh","getIsBrowser","isPage","CONTEXT_DEFAULTS","createGLContext","targetCanvas","getCanvas","createBrowserContext","instrumentGLContext","logInfo","getVersion","manageState","getContextDebugInfo","vendorMasked","rendererMasked","vendorUnmasked","rendererUnmasked","resizeGLContext","devicePixelRatio","setDevicePixelRatio","errorMessage","onCreateError","webgl1","webGL","info","driver","clientHeight","clampedPixelRatio","canvasWidth","canvasHeight","Stat","samples","Stats","fn","stat","STARTUP_MESSAGE","StatsManager","lumaStats","requestAnimationFrame","callback","cancelAnimationFrame","timerId","getKeyValue","number","getKey","uidCounters","uid","isPowerOfTwo","isEmpty","stubRemovedMethods","instance","methodNames","upgradeMessage","prototype","methodName","ERR_RESOURCE_METHOD_UNDEFINED","Resource","userData","deleteChildren","child","funcOrHandle","parameter","isWebgl2","webgl1Default","webgl2Default","PARAMETERS","stats","ERR_TYPE_DEDUCTION","getGLTypeFromTypedArray","arrayOrType","getTypedArrayFromGLType","glType","clamped","flipRows","bytesPerPixel","temp","bytesPerRow","topOffset","bottomOffset","newWidth","newHeight","newData","c","checkProps","propChecks","removedProps","deprecatedProps","replacedProps","propName","replacementProp","newProps","DEFAULT_ACCESSOR_VALUES","PROP_CHECKS","Accessor","accessor","accessors","DEBUG_DATA_LENGTH","DEPRECATED_PROPS","PROP_CHECKS_INITIALIZE","PROP_CHECKS_SET_PROPS","Buffer","srcOffset","sourceBuffer","readOffset","writeOffset","dstData","srcByteOffset","dstOffset","ArrayType","sourceAvailableElementCount","dstElementOffset","dstAvailableElementCount","dstElementCount","copyElementCount","usage","sourceElementOffset","TEXTURE_FORMATS","DATA_FORMAT_CHANNELS","TYPE_SIZES","isFormatSupported","isLinearFilteringSupported","NPOT_MIN_FILTERS","WebGLBuffer","Texture","linearFiltering","supported","resolvedImageData","isVideo","pixels","border","recreate","pixelStore","textureUnit","dataFormat","compressed","mipmaps","video","lastTime","dataType","gl2","compressedTextureSize","levelIndex","levelData","channels","channelSize","ndarray","textureFormat","param","loadImage","Texture2D","FACES","TextureCube","mipmapLevel","imageDataMap","resolvedFaces","facePixels","lodLevel","imageData","Texture3D","EXT_FLOAT_WEBGL2","RENDERBUFFER_FORMATS","formats","Renderbuffer","GL_DEPTH_BUFFER_BIT","GL_STENCIL_BUFFER_BIT","GL_COLOR_BUFFER_BIT","GL_COLOR","GL_DEPTH","GL_STENCIL","GL_DEPTH_STENCIL","ERR_ARGUMENTS","clear","stencil","clearFlags","clearBuffer","drawBuffer","glFormatToComponents","readPixelsToArray","sourceX","sourceY","sourceFormat","sourceAttachment","sourceWidth","sourceHeight","sourceType","deleteFramebuffer","getFramebuffer","attachments","getPixelArray","prevHandle","copyToDataUrl","targetMaxHeight","Framebuffer","toFramebuffer","pixelArray","components","FEATURES","checkFloat32ColorAttachment","testTexture","testFb","WEBGL_FEATURES$1","LOG_UNSUPPORTED_FEATURE","hasFeature","feature","hasFeatures","features","isFeatureSupported","getFeatures","cap","WEBGL_FEATURES","queryFeature","isSupported","featureDefinition","ERR_MULTIPLE_RENDERTARGETS","colorBufferFloat","colorBufferHalfFloat","check","readBuffer","drawBuffers","clearAttachments","resizeAttachments","attachmentPoint","newAttachments","descriptor","texture","layer","_getFrameBufferStatus","attachmentName","defaultAttachments","oldAttachment","_ref4","renderbuffer","_ref5","mapIndexToCubeMapFace","caps","FRAMEBUFFER_ATTACHMENT_PARAMETERS","cloneTextureFrom","refTexture","overrides","TextureType","textureOptions","getShaderName","shader","defaultName","SHADER_NAME_REGEXP","GL_FRAGMENT_SHADER","GL_VERTEX_SHADER","getShaderTypeName","parseGLSLCompilerError","errLog","shaderType","shaderName","errorStrings","errors","warnings","shaderDescription","errorString","segments","line","lines","addLineNumbers","formatErrors","column","padLeft","delim","maxDigits","lineNumber","digits","getShaderVersion","words","v","ERR_SOURCE","Shader","infoLog","VertexShader","FragmentShader","UNIFORM_SETTERS","getArraySetter","toFloatArray","setVectorUniform","toIntArray","setMatrixUniform","getSamplerSetter","toUIntArray","FLOAT_ARRAY","INT_ARRAY","UINT_ARRAY","toTypedArray","uniformLength","Type","getUniformSetter","parseUniformName","UNIFORM_NAME_REGEXP","checkUniformValues","uniforms","uniformMap","uniformName","checkUniformValue","checkUniformArray","copyUniform","dest","len","checkLength","toArray","uniformSetter","cacheLength","arrayValue","GL_BYTE","GL_UNSIGNED_BYTE","GL_SHORT","GL_UNSIGNED_SHORT","GL_POINTS","GL_LINES","GL_LINE_LOOP","GL_LINE_STRIP","GL_TRIANGLES","GL_TRIANGLE_STRIP","GL_TRIANGLE_FAN","GL_FLOAT","GL_FLOAT_VEC2","GL_FLOAT_VEC3","GL_FLOAT_VEC4","GL_INT","GL_INT_VEC2","GL_INT_VEC3","GL_INT_VEC4","GL_UNSIGNED_INT","GL_UNSIGNED_INT_VEC2","GL_UNSIGNED_INT_VEC3","GL_UNSIGNED_INT_VEC4","GL_BOOL","GL_BOOL_VEC2","GL_BOOL_VEC3","GL_BOOL_VEC4","GL_FLOAT_MAT2","GL_FLOAT_MAT3","GL_FLOAT_MAT4","GL_FLOAT_MAT2x3","GL_FLOAT_MAT2x4","GL_FLOAT_MAT3x2","GL_FLOAT_MAT3x4","GL_FLOAT_MAT4x2","GL_FLOAT_MAT4x3","COMPOSITE_GL_TYPES","getPrimitiveDrawMode","drawMode","decomposeCompositeGLType","compositeGLType","typeAndSize","getCompositeGLType","compType","compComponents","ProgramConfiguration","locationOrName","attributeInfo","varying","compositeType","LOG_PROGRAM_PERF_PRIORITY","GL_SEPARATE_ATTRIBS","V6_DEPRECATED_METHODS","Program","hash","vs","fs","varyings","bufferMode","logPriority","vertexCount","isIndexed","indexType","instanceCount","isInstanced","vertexArray","transformFeedback","samplers","fb","primitiveMode","uniform","textureUpdate","textureIndex","texturesRenderable","shaderHandles","shaderHandle","programName","l","uniformIndices","blockName","blockIndex","blockBinding","GL_QUERY_RESULT","GL_QUERY_RESULT_AVAILABLE","GL_TIME_ELAPSED_EXT","GL_TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN","GL_ANY_SAMPLES_PASSED","GL_ANY_SAMPLES_PASSED_CONSERVATIVE","Query","hasTimerQuery","conservative","resultAvailable","counter","poll","TransformFeedback","buffers","bufferName","bufferOrParams","byteSize","bufferIndex","getScratchArrayBuffer","getScratchArray","scratchArrayBuffer","fillArray","total","copied","ERR_ELEMENTS","VertexArrayObject","elementBuffer","integer","elementCount","constantValue","updateNeeded","v1","v2","ERR_ATTRIBUTE_TYPE","MULTI_LOCATION_ATTRIBUTE_REGEXP","DEPRECATIONS_V6","VertexArray","MAX_ATTRIBUTES","attributes","appAccessor","valueAccessor","INVALID_RESULT","accessInfo","currentAccessor","attributeName","multiLocation","locationOffset","constant","drawParams","formatArrayValue","maxElts","formatValue","terminator","EPSILON","isInteger","getDebugTableForUniforms","undefinedOnly","SHADER_MODULE_UNIFORM_REGEXP","PROJECT_MODULE_UNIFORM_REGEXP","uniformLocations","uniformNames","addUniformToTable","unusedCount","unusedTable","isDefined","isUniformDefined","getDebugTableForVertexArray","getDebugTableRow","attributeLocation","rowHeader","getGLSLDeclaration","attribute","verts","changed","instanced","typeAndName","getDebugTableForProgramConfiguration","config","glslDeclaration","varyingInfo","statIdCounter","AnimationLoop","onCreateContext","onAddHTML","onInitialize","onRender","onFinalize","glOptions","createFramebuffer","autoResizeViewport","autoResizeDrawingBuffer","appContext","timeline","defaultValue","renderFrame","display","animationFrameId","renderFrameCallback","aspect","wrapperDiv","div","html","e","VERTEX_SHADER","FRAGMENT_SHADER","TYPE_DEFINITIONS","propType","parsePropTypes","propDefs","propTypes","propDef","parsePropType","getTypeOf","ShaderModule","dependencies","getUniforms","deprecations","defines","inject","vertexShader","fragmentShader","normalizeInjections","moduleSource","shaderSource","injections","hook","injection","stage","resolveModules","modules","getShaderDependencies","instantiateModules","moduleMap","moduleDepth","getDependencyGraph","module","seen","isOldIE","GL_VENDOR","GL_RENDERER","GL_VERSION","GL_SHADING_LANGUAGE_VERSION","getContextInfo","vendor","renderer","identifyGPUVendor","compiledGlslExtensions","canCompileGLGSExtension","extensionName","behavior","canCompile","getFeature","getPlatformShaderDefines","getVersionDefines","glslVersion","isFragment","versionDefines","MODULE_INJECTORS_VS","MODULE_INJECTORS_FS","MODULE_INJECTORS","DECLARATION_INJECT_MARKER","REGEX_START_OF_MAIN","REGEX_END_OF_MAIN","fragments","injectShader","injectStandardStubs","isVertex","fragmentData","fragmentString","combineInjects","injects","testVariable","qualifier","ES300_REPLACEMENTS","ES300_VERTEX_REPLACEMENTS","ES300_FRAGMENT_REPLACEMENTS","ES100_REPLACEMENTS","ES100_VERTEX_REPLACEMENTS","ES100_FRAGMENT_REPLACEMENTS","ES100_FRAGMENT_OUTPUT_NAME","ES300_FRAGMENT_OUTPUT_REGEX","transpileShader","targetGLSLVersion","convertShader","convertFragmentShaderTo300","convertFragmentShaderTo100","replacements","pattern","outputMatch","outputName","INJECT_SHADER_DECLARATIONS","SHADER_TYPE","FRAGMENT_SHADER_PROLOGUE","assembleShaders","assembleShader","assembleGetUniforms","hookFunctions","transpileToGLSL100","prologue","sourceLines","versionLine","coreSource","allDefines","assembledSource","getShaderType","getApplicationDefines","hookFunctionMap","normalizeHookFunctions","hookInjections","declInjections","mainInjections","injectionType","getHookFunctions","moduleUniforms","sourceText","define","hookName","hookFunction","signature","FS100","FS_GLES","FS300","getQualifierDetails","qualifiers","definition","getPassthroughFS","inputType","output","outputValue","convertToVec4","typeToChannelSuffix","typeToChannelCount","variable","fp32shader","fp32","RADIANS_TO_DEGREES","DEGREES_TO_RADIANS","precision","round","radians","degrees","clamp","min","max","lerp","ai","equals","epsilon","oldEpsilon","duplicateArray","_extendableBuiltin","cls","ExtendableBuiltin","MathArray","targetArray","arrayOrObject","vector","minVector","maxVector","vectors","scalar","valid","validateVector","checkNumber","checkVector","callerName","Vector","mathArray","dist","product","ARRAY_TYPE","create","out","glMatrix.ARRAY_TYPE","add","negate","ax","ay","transformMat4","m","vec","arg","vec2_transformMat4AsVector","vec3_transformMat4AsVector","z","vec3_transformMat2","subtract","squaredLength","dot","cross","az","bx","by","bz","transformMat3","transformQuat","q","qx","qy","qz","qw","uvx","uvy","uvz","uuvx","uuvy","uuvz","w2","rotateX","rad","p","rotateY","rotateZ","angle","mag1","mag2","mag","cosine","sub","sqrLen","ORIGIN","ZERO","Vector3","vec3.angle","vec3.cross","origin","vec3.rotateX","vec3.rotateY","vec3.rotateZ","matrix4","vec3.transformMat4","matrix3","vec3.transformMat3","matrix2","quaternion","vec3.transformQuat","Matrix","row","col","columnIndex","firstIndex","columnVector","identity","transpose","a01","a02","a03","a12","a13","a23","a00","a10","a11","a20","a21","a22","a30","a31","a32","a33","b00","b01","b02","b03","b04","b05","b06","b07","b08","b09","b10","b11","det","determinant","multiply","b0","b1","b2","b3","translate","rotate","axis","b12","b20","b21","b22","glMatrix.EPSILON","fromQuat","x2","y2","z2","xx","yx","yy","zx","zy","zz","wx","wy","wz","frustum","left","right","bottom","top","near","far","rl","tb","nf","perspectiveNO","fovy","perspective","orthoNO","lr","bt","ortho","lookAt","eye","center","up","x0","x1","y0","y1","z0","z1","eyex","eyey","eyez","upx","upy","upz","centerx","centery","centerz","INDICES","DEFAULT_FOVY","DEFAULT_ASPECT","DEFAULT_NEAR","DEFAULT_FAR","IDENTITY_MATRIX","Matrix4","getIdentityMatrix","getZeroMatrix","m00","m10","m20","m30","m01","m11","m21","m31","m02","m12","m22","m32","m03","m13","m23","m33","mat4.fromQuat","view","computeInfinitePerspectiveOffCenter","mat4.frustum","mat4.lookAt","mat4.ortho","focalDistance","checkRadians","halfY","mat4.perspective","mat4.determinant","scaleResult","inverseScale0","inverseScale1","inverseScale2","mat4.transpose","mat4.invert","mat4.multiply","mat4.rotateX","mat4.rotateY","mat4.rotateZ","angleXYZ","mat4.rotate","mat4.scale","mat4.translate","vec4.transformMat4","vec2.transformMat4","IDENTITY","possiblyDegrees","column0Row0","column1Row1","column2Row0","column2Row1","column2Row2","column2Row3","column3Row2","EARTH_RADIUS_METERS","SphericalCoordinates","phi","theta","radius","bearing","pitch","altitude","radiusScale","printTypes","other","lng","lat","vec3.length","DEFAULT_HIGHLIGHT_COLOR","DEFAULT_MODULE_OPTIONS","selectedColor","picking","transform","ProgramManager","moduleName","vsHash","fsHash","moduleHashes","varyingHashes","defineKeys","injectKeys","defineHashes","injectHashes","assembled","appModules","GLTF_TO_LUMA_ATTRIBUTE_MAP","getBuffersFromGeometry","geometry","indices","remappedName","mapAttributeName","inferAttributeAccessor","attributeMap","category","LOG_DRAW_PRIORITY","LOG_DRAW_TIMEOUT","ERR_MODEL_PARAMS","DRAW_PARAMS","Model","normalizedAttributes","moduleSettings","indexOffset","vertexArrayInstanced","onBeforeRender","onAfterRender","didDraw","discard","feedbackBuffers","unbindModels","model","animationProps","logDrawTimeout","attributeTable","uniformTable","missingTable","missingCount","configTable","BufferTransform","binding","sourceBuffers","varyingName","sourceName","feedbackName","bufferOrRef","nextIndex","srcName","dstName","SAMPLER_UNIFORM_PREFIX","SIZE_UNIFORM_PREFIX","VS_POS_VARIABLE","updateForTextures","sourceTextureMap","targetTextureVarying","targetTexture","sourceCount","targetTextureType","samplerTextureMap","updatedVs","finalInject","vsLines","updateVsLines","processAttributeDefinition","updatedLine","getVaryingType","sizeName","uniformDeclaration","posInstructions","getSizeUniforms","textureName","getAttributeDefinition","getSamplerDeclerations","samplerName","uniformDeclerations","qualaiferDetails","textureMap","attributeData","sampleInstruction","SRC_TEX_PARAMETER_OVERRIDES","FS_OUTPUT_VARIABLE","TextureTransform","updatedModelProps","sourceTextures","sampler","sizeUniforms","packed","channelCount","packedPixels","packCount","j","_targetTextureVarying","_swapTexture","textureOrReference","_sourceTextures","_targetTexture","elementIds","_","combinedInject","transformModule","Transform","bufferTransform","textureTransform","clearRenderTarget","updatedOpts","swapped","resourceTransforms","resourceTransform","updatedProps","canCreateBufferTransform","canCreateTextureTransform","channelHandles","animationHandles","Timeline","delay","duration","rate","repeat","channel","animationHandle","animation","animations","animationData","channelHandle","engineTime","offsetTime","totalDuration","COORDINATE_SYSTEM","PROJECTION_MODE","UNIT","EVENTS","OPERATION","COORDINATE_SYSTEM_GLSL_CONSTANTS","PROJECTION_MODE_GLSL_CONSTANTS","UNIT_GLSL_CONSTANTS","projectShader","isEqual","memoize","compute","cachedArgs","cachedResult","ZERO_VECTOR","VECTOR_TO_POINT_MATRIX","DEFAULT_PIXELS_PER_UNIT2","DEFAULT_COORDINATE_ORIGIN","getMemoizedViewportUniforms","calculateViewportUniforms","getOffsetOrigin","viewport","coordinateSystem","coordinateOrigin","shaderCoordinateOrigin","geospatialOrigin","offsetMode","calculateMatrixAndOffset","viewMatrixUncentered","projectionMatrix","viewMatrix","viewProjectionMatrix","projectionCenter","originCommon","cameraPosCommon","getUniformsFromViewport","modelMatrix","autoWrapLongitude","distanceScales","viewportSize","distanceScalesAtOrigin","INITIAL_MODULE_OPTIONS","project","createMat4","transformVector","matrix","mod","modulus","ieLog2","log2","PI","PI_4","TILE_SIZE","EARTH_CIRCUMFERENCE","MAX_LATITUDE","DEFAULT_ALTITUDE","scaleToZoom","lngLatToWorld","lngLat","lambda2","phi2","worldToLngLat","xy","getMeterZoom","latCosine","getDistanceScales","highPrecision","worldSize","unitsPerDegreeX","unitsPerDegreeY","altUnitsPerMeter","latCosine2","unitsPerDegreeY2","altUnitsPerDegree2","altUnitsPerMeter2","addMetersToLngLat","lngLatZ","xyz","unitsPerMeter","unitsPerMeter2","worldspace","newLngLat","newZ","getViewMatrix","vm","relativeScale","vec3.negate","getProjectionParameters","nearZMultiplier","farZMultiplier","altitudeToFovy","fovRadians","pitchRadians","fovyToAltitude","cameraToSeaLevelDistance","fovAboveCenter","topHalfSurfaceDistance","furthestDistance","horizonDistance","farZ","worldToPixels","pixelProjectionMatrix","pixelsToWorld","pixelUnprojectionMatrix","targetZ","coord0","coord1","vec2.lerp","fitBounds","bounds","minExtent","maxZoom","west","south","east","north","padding","getPaddingObject","nw","se","targetSize","offsetX","offsetY","centerLngLat","getBounds","unproject","unprojectOps","bottomLeft","bottomRight","topLeft","topRight","halfFov","angleToGround","unprojectOnFarPlane","coord","normalizeViewportProps","minZoom","halfHeightPixels","minLatitude","maxLatitude","getMemoizedViewportCenterPosition","getViewportCenterPosition","getMemoizedViewProjectionMatrices","getViewProjectionMatrices","DEFAULT_SHADOW_COLOR","screenToCommonSpace","shadowMatrices","projectionMatrices","corners","shadowMatrix","positions","corner","position","createShadowUniforms","shadowEnabled","projectCenters","viewProjectionMatrices","viewProjectionMatrixCentered","shadow","DEFAULT_MODULES","SHADER_HOOKS","createProgramManager","programManager","shaderModule","shaderHook","DEFAULT_LIGHT_COLOR","DEFAULT_LIGHT_INTENSITY","idCount","AmbientLight","intensity","DEFAULT_LIGHT_DIRECTION","DirectionalLight","direction","_shadow","Pass","LayersPass","moduleParameters","viewports","views","onViewportActive","clearStack","clearCanvas","clearGLCanvas","renderStats","drawLayerParams","subViewports","subViewport","layers","pass","layerFilter","cullRect","effects","indexResolver","layerIndexResolver","drawContext","layerFilterCache","layerIndex","shouldDrawLayer","layerParam","globalModuleParameters","glViewport","getGLViewport","clearOpts","renderStatus","layerRenderIndex","layerParameters","parent","rootLayerId","_layer$internalState","effect","_effect$getModulePara","startIndex","layerIndices","resolvers","resolveLayerIndex","isDrawn","indexOverride","layerId","parentId","resolver","useTarget","pixelRatio","dimensions","ShadowPass","DEFAULT_AMBIENT_LIGHT_PROPS","DEFAULT_DIRECTIONAL_LIGHT_PROPS","LightingEffect","lightSource","light","directionalLight","pointLight","shadowPass","lightMatrices","ambientLight","pointLights","directionalLights","TypedArrayManager","copy","initialize","maxCount","newSize","maxSize","newArray","sizeToAllocate","pool","defaultTypedArrayManager","getCameraPosition","viewMatrixInverse","getFrustumPlanes","getFrustumPlane","scratchVector","d","L","fp64LowPart","scratchArray","toDoublePrecisionArray","endIndex","typedArrayManager","sourceIndex","targetIndex","DEFAULT_DISTANCE_SCALES","createProjectionMatrix","orthographic","fovyRadians","Viewport","worldPosition","targetZWorld","X","Y","Z","unprojectOption","coords","meterOffset","vpm","viewportMatrix","WebMercatorViewport","worldOffset","legacyMeterSizes","projectionParameters","minOffset","maxOffset","offsetViewport","fromLocation","toLocation","vec2.add","vec2.negate","newCenter","lngLatZToWorldPosition","normalizeParameters","fromCoordinateSystem","fromCoordinateOrigin","getWorldPosition","projectPosition","positionCommonSpace","vec3.sub","LIFECYCLE","COMPONENT_SYMBOL","ASYNC_DEFAULTS_SYMBOL","ASYNC_ORIGINAL_SYMBOL","ASYNC_RESOLVED_SYMBOL","flatten","flattenArray","consumer","forceUpdate","loadCount","subscriber","ResourceManager","protocol","resourceId","persistent","res","consumerId","requestId","request","onChange","resources","consumers","oldResource","TRACE_SET_LAYERS","TRACE_ACTIVATE_VIEWPORT","LayerManager","deck","_viewport","redraw","layerNeedsRedraw","layerIds","newLayers","flatLayers","oldLayers","oldLayerMap","oldLayer","generatedLayers","needsUpdate","newLayer","sublayers","deepEqual","aValue","bValue","ViewManager","controller","viewId","rect","viewMap","viewOrViewId","Controller","_this$getView","controllerProps","resolvedProps","oldControllers","invalidateControllers","oldController","hasController","newViews","oldViews","PERCENT_OR_PIXELS_REGEX","parsePosition","relative","getPosition","extent","View","viewportInstance","viewportDimensions","newViewState","Transition","settings","_this$settings$onStar","_this$settings","_this$settings$onEnd","_this$settings2","_this$settings$onInte","_this$settings3","_this$settings$onUpda","_this$settings4","TRANSITION_EVENTS","DEFAULT_EASING","DEFAULT_INTERRUPTION","TransitionManager","transition","interpolator","startProps","endProps","easing","nextProps","transitionTriggered","currentProps","interruption","transitionDuration","transitionInterpolator","startViewstate","endViewStateProps","initialProps","transitionSettings","TransitionInterpolator","compare","extract","required","startViewStateProps","DEFAULT_REQUIRED_PROPS","LinearInterpolator","transitionProps","normalizedOpts","makeViewport","around","startViewport","endViewport","aroundPosition","propsInTransition","NO_TRANSITION_PROPS","DEFAULT_INERTIA","INERTIA_EASING","EVENT_TYPES","pinchEventWorkaround","customEvents","eventName","_this$eventManager","eventStartBlocked","offsetCenter","pos","inside","srcEvent","timer","inertia","scrollZoom","dragPan","dragRotate","doubleClickZoom","touchZoom","touchRotate","keyboard","isInteractive","eventNames","newControllerState","extraProps","interactionState","oldViewState","newStates","alternateMode","endPos","speed","smooth","delta","rotation","_lastPinchEvent","velocityZ","endScale","isZoomOut","funcKey","zoomSpeed","moveSpeed","rotateSpeedX","rotateSpeedY","controllerState","ViewState","PITCH_MOUSE_THRESHOLD","PITCH_ACCEL","MapState","maxPitch","minPitch","startPanLngLat","startZoomLngLat","startRotatePos","startBearing","startPitch","startZoom","normalize","startPos","deltaAngleX","deltaAngleY","newRotation","zoomedViewport","fromProps","deltaX","deltaY","centerY","startY","deltaScaleX","deltaScaleY","MapController","oldProps","MapView","MaskPass","mapSize","colorMask","getProjectionMatrix","OrthographicViewport","flipY","zoomX","zoomY","zoom_","metersPerUnit","OrbitState","rotationX","rotationOrbit","minRotationX","maxRotationX","startPanPosition","startRotationX","startRotationOrbit","startZoomPosition","startPosition","newZoom","OrbitController","OrthographicState","deltaZoom","newZoomX","newZoomY","OrthographicController","OrthographicView","getMaskBounds","subLayerBounds","viewportBounds","paddedBounds","_doubleBounds","getMaskViewport","MaskEffect","maskLayers","channelMap","viewportChanged","maskId","channelInfo","oldChannelInfo","maskChanged","maskPass","maskMap","maskViewport","DEFAULT_LIGHTING_EFFECT","EffectManager","DrawLayersPass","PICKING_PARAMETERS","PickLayersPass","pickingFBO","pickZ","encodedColors","decodeColor","pickParameters","encodeColor","encoded","byLayer","byAlpha","entry","pickedColor","TRACE_RENDER_LAYERS","DeckRenderer","layerPass","outputBuffer","renderBuffers","lastPostProcessEffect","NO_PICKED_OBJECT","getClosestObject","pickedColors","decodePickingColor","deviceX","deviceY","deviceRadius","deviceRect","minSquareDistanceToCenter","closestPixelIndex","dy","dy2","dx","d2","pickedObject","getUniqueObjects","uniqueColors","colorKey","getEmptyPickingInfo","pickInfo","pickedViewport","getViewportFromCoordinates","coordinate","point","processPickInfo","lastPickedInfo","pickedLayer","pickedObjectIndex","affectedLayers","lastPickedPixelIndex","lastPickedLayerId","pickedLayerId","lastPickedLayer","baseInfo","infos","getLayerPickingInfo","rootLayer","sourceLayer","DeckPicker","lastPickedViewportId","_this$pickingFBO","_this$depthFBO","depthFBO","pickableLayers","unproject3D","devicePixelRange","devicePixel","pickedResult","maxObjects","leftTop","deviceLeft","deviceTop","rightBottom","deviceRight","deviceBottom","pickInfos","uniqueInfos","isMaxObjects","deviceWidth","deviceHeight","defaultStyle","Tooltip","canvasParent","displayInfo","exportName","undefined","VENDOR_PREFIXES","TEST_ELEMENT","TYPE_FUNCTION","abs","now","setTimeoutContext","bindFn","invokeArrayArg","each","iterator","deprecate","deprecationMessage","stack","assign","nextKey","extend","merge","inherit","base","properties","baseP","childP","boolOrFn","val","ifUndefined","val1","val2","addEventListeners","types","handler","splitStr","removeEventListeners","hasParent","inStr","inArray","findByKey","uniqueArray","sort","results","prefixed","property","prop","camelProp","_uniqueId","uniqueId","getWindowForElement","doc","MOBILE_REGEX","SUPPORT_TOUCH","SUPPORT_POINTER_EVENTS","SUPPORT_ONLY_TOUCH","INPUT_TYPE_TOUCH","INPUT_TYPE_PEN","INPUT_TYPE_MOUSE","INPUT_TYPE_KINECT","COMPUTE_INTERVAL","INPUT_START","INPUT_MOVE","INPUT_END","INPUT_CANCEL","DIRECTION_NONE","DIRECTION_LEFT","DIRECTION_RIGHT","DIRECTION_UP","DIRECTION_DOWN","DIRECTION_HORIZONTAL","DIRECTION_VERTICAL","DIRECTION_ALL","PROPS_XY","PROPS_CLIENT_XY","Input","manager","ev","createInputInstance","inputClass","PointerEventInput","TouchInput","TouchMouseInput","MouseInput","inputHandler","pointersLen","changedPointersLen","isFirst","isFinal","computeInputData","session","pointers","pointersLength","simpleCloneInputData","firstInput","firstMultiple","getCenter","getAngle","getDistance","computeDeltaXY","getDirection","overallVelocity","getVelocity","getScale","getRotation","computeIntervalInputData","prevDelta","prevInput","last","deltaTime","velocity","velocityX","velocityY","p1","p2","MOUSE_INPUT_MAP","MOUSE_ELEMENT_EVENTS","MOUSE_WINDOW_EVENTS","POINTER_INPUT_MAP","IE10_POINTER_TYPE_ENUM","POINTER_ELEMENT_EVENTS","POINTER_WINDOW_EVENTS","store","removePointer","eventTypeNormalized","pointerType","isTouch","storeIndex","SINGLE_TOUCH_INPUT_MAP","SINGLE_TOUCH_TARGET_EVENTS","SINGLE_TOUCH_WINDOW_EVENTS","SingleTouchInput","touches","normalizeSingleTouches","all","TOUCH_INPUT_MAP","TOUCH_TARGET_EVENTS","getTouches","allTouches","targetIds","targetTouches","changedTouches","changedTargetTouches","touch","DEDUP_TIMEOUT","DEDUP_DISTANCE","inputEvent","inputData","isMouse","recordTouches","isSyntheticEvent","eventData","setLastTouch","lastTouch","lts","removeLastTouch","PREFIXED_TOUCH_ACTION","NATIVE_TOUCH_ACTION","TOUCH_ACTION_COMPUTE","TOUCH_ACTION_AUTO","TOUCH_ACTION_MANIPULATION","TOUCH_ACTION_NONE","TOUCH_ACTION_PAN_X","TOUCH_ACTION_PAN_Y","TOUCH_ACTION_MAP","getTouchActionProps","TouchAction","actions","recognizer","cleanTouchActions","hasNone","hasPanY","hasPanX","isTapPointer","isTapMovement","isTapTouchTime","touchMap","cssSupports","STATE_POSSIBLE","STATE_BEGAN","STATE_CHANGED","STATE_ENDED","STATE_RECOGNIZED","STATE_CANCELLED","STATE_FAILED","Recognizer","otherRecognizer","simultaneous","getRecognizerByNameIfManager","requireFail","emit","stateStr","inputDataClone","directionStr","AttrRecognizer","optionPointers","isRecognized","isValid","PanRecognizer","hasMoved","distance","PinchRecognizer","inOut","PressRecognizer","validPointers","validMovement","validTime","RotateRecognizer","SwipeRecognizer","TapRecognizer","validTouchTime","validInterval","validMultiTap","tapCount","Hammer","Manager","STOP","FORCED_STOP","toggleCssProps","item","force","recognizers","curRecognizer","existing","events","triggerDomEvent","gestureEvent","freeGlobal","some","predict","enhancePointerEventInput","oldHandler","enhanceMouseInput","hammerjs.PointerEventInput","hammerjs.MouseInput","hammerjs.Manager","RECOGNIZERS","RECOGNIZER_COMPATIBLE_MAP","RECOGNIZER_FALLBACK_MAP","BASIC_EVENT_ALIASES","INPUT_EVENT_TYPES","EVENT_RECOGNIZER_MAP","GESTURE_EVENT_ALIASES","passiveSupported","firefox","WHEEL_EVENTS","EVENT_TYPE","WHEEL_DELTA_MAGIC_SCALER","WHEEL_DELTA_PER_LINE","SHIFT_MULTIPLIER","WheelInput","MOUSE_EVENTS","MOVE_EVENT_TYPE","OVER_EVENT_TYPE","OUT_EVENT_TYPE","ENTER_EVENT_TYPE","LEAVE_EVENT_TYPE","MoveInput","KEY_EVENTS","DOWN_EVENT_TYPE","UP_EVENT_TYPE","KeyInput","targetElement","ContextmenuInput","DOWN_EVENT","MOVE_EVENT","UP_EVENT","MOUSE_EVENT_WHICH_LEFT","MOUSE_EVENT_WHICH_MIDDLE","MOUSE_EVENT_WHICH_RIGHT","MOUSE_EVENT_BUTTON_LEFT","MOUSE_EVENT_BUTTON_MIDDLE","MOUSE_EVENT_BUTTON_RIGHT","MOUSE_EVENT_BUTTONS_LEFT_MASK","MOUSE_EVENT_BUTTONS_RIGHT_MASK","MOUSE_EVENT_BUTTONS_MIDDLE_MASK","whichButtons","buttons","button","which","leftButton","middleButton","rightButton","getOffsetPosition","rootElement","DEFAULT_OPTIONS","EventRegistrar","eventManager","mjolnirEvent","once","passive","handlersByElement","entries","insertPosition","srcElement","immediatePropagationStopped","stopPropagation","stopImmediatePropagation","entriesToRemove","EventManager","ManagerClass","otherName","recognizerName","recognizerOption","eventAlias","eventRegistrar","fallbackRecognizers","isRecognizerUsed","eh","getCursor","isDragging","defaultProps","Deck","_pickRequest","eventOptions","layerHandler","rootHandler","handled","pickedInfo","_this$layerManager","_this$viewManager","_this$effectManager","_this$deckRenderer","_this$deckPicker","_this$tooltip","_this$canvas$parentEl","viewManagerNeedsRedraw","layerManagerNeedsRedraw","effectManagerNeedsRedraw","deckRendererNeedsRedraw","redrawReason","resourceIds","statKey","cssWidth","_props$style","cssHeight","_this$viewManager2","emptyInfo","_info$layer","container","renderOptions","animationLoopStats","metrics","memoryStats","ShaderAttribute","dataColumn","glArrayFromType","getStride","resolveShaderAttribute","baseAccessor","shaderAttributeOptions","vertexOffset","elementOffset","resolveDoublePrecisionShaderAttributes","resolvedOptions","DataColumn","logicalType","doublePrecision","bufferType","defaultType","shaderAttributes","isBuffer64Bit","doubleShaderAttributeDefs","shaderAttributeDef","numInstances","requiredBufferSize","startOffset","endOffset","illegalArrayType","value1","value2","EMPTY_ARRAY","placeholderArray","createIterable","startRow","endRow","iterable","objectInfo","getAccessorFromBuffer","startIndices","nested","bytesPerElement","elementStride","EMPTY","FULL","rangeList","range","newRangeList","range0","padArrayChunk","getData","sourceLength","targetLength","datum","padArray","sourceStartIndices","targetStartIndices","getChunkData","nextSourceIndex","nextTargetIndex","DEFAULT_TRANSITION_SETTINGS","normalizeTransitionSettings","userSettings","layerSettings","getSourceBufferAttribute","getAttributeTypeFromSize","cycleBuffers","getAttributeBufferLength","multiplier","padBuffer","fromLength","fromStartIndices","precisionMultiplier","toStartIndices","hasStartIndices","toLength","isConstant","toData","getMissingData","Attribute","range.FULL","layout","clearChangedFlags","needsRedraw","dataRange","range.add","range.EMPTY","updateRanges","noAlloc","binaryValue","needsNormalize","shaderAttributeDefs","shaderAttributeName","accessorFunc","objectValue","numVertices","GPUInterpolationTransition","getTransform","bufferOpts","padBufferOpts","attributeType","GPUSpringTransition","getTexture","TRANSITION_TYPES","AttributeTransitionManager","transitions","animatedAttributes","isNew","TransitionType","TRACE_INVALIDATE","TRACE_UPDATE_START","TRACE_UPDATE_END","TRACE_ATTRIBUTE_UPDATE_START","TRACE_ATTRIBUTE_ALLOCATE","TRACE_ATTRIBUTE_UPDATE_END","AttributeManager","attributeNameArray","triggerName","invalidatedAttributes","accessorName","attributeTransitionManager","transitionUpdated","changedAttributes","excludeAttributes","triggers","updateTriggers","CPUInterpolationTransition","fromValue","toValue","updateSpringElement","prev","cur","damping","stiffness","spring","damper","updateSpring","next","distanceSquare","CPUSpringTransition","_prevValue","_currValue","nextValue","UniformTransitionManager","validateProps","getPropTypes","validate","diffProps","propsChangedReason","compareProps","dataChangedReason","diffDataProps","updateTriggersChangedReason","diffUpdateTriggers","diffExtensions","diffTransitions","comparePropValues","ignoreProps","newProp","oldProp","equal","dataChanged","dataComparator","_dataDiff","diffUpdateTrigger","oldExtensions","newTriggers","oldTriggers","LayerType","ERR_NOT_OBJECT","ERR_NOT_CONTAINER","isPlainObject","mergeShaders","mergedInjection","DEFAULT_TEXTURE_PARAMETERS","internalTextures","createTexture","specialTextureParameters","destroyTexture","arrayEqual","valueType","component","dataTransform","deprecated","normalizePropDefinition","createProps","propObjects","propsPrototype","getPropsPrototype","propsInstance","componentClass","getOwnProperty","createPropsPrototypeAndTypes","parentClass","parentDefaultProps","componentDefaultProps","componentPropDefs","createPropsPrototype","addAsyncPropsToPropPrototype","addDeprecatedPropsToPropPrototype","parentProps","getComponentName","newValue","nameStr","newPropName","hasOwnProperty","defaultValues","descriptors","getDescriptorForAsyncProp","componentName","Component","asyncProps","EMPTY_PROPS","ComponentState","asyncProp","resolvedValues","originalValues","promise","LayerState","attributeManager","onDataLoad","TRACE_CHANGE_FLAG","TRACE_INITIALIZE","TRACE_UPDATE","TRACE_FINALIZE","TRACE_MATCHED","MAX_PICKING_COLOR_CACHE_SIZE","areViewportsEqual","oldViewport","pickingColorCache","loadOptions","signal","resourceManager","_loadOptions","inResourceManager","Layer","partialState","pickingEvent","i1","i2","i3","instancePositions","shaders","neededPickingBuffer","needPickingBuffer","pickingColors","instancePickingColors","pickingColorsAttribute","_this$props$onError","_this$props","_this$context","_this$context$onError","_this$internalState","uniformTransitions","cacheSize","newCacheSize","pickingColor","objectIndex","internalState","stateNeedsUpdate","currentViewport","updateParams","oldModels","modelChanged","opacity","getPolygonOffset","offsets","_this$internalState2","flags","changeFlags","flagChanged","prevDataChangedReason","propsOrDataChanged","_newProps$transitions","pickingModuleParameters","highlightColor","autoHighlight","highlightedObjectIndex","attributeManagerNeedsRedraw","CompositeLayer","updateObject","subLayerId","DefaultLayerClass","overridingProps","sourceObject","sourceObjectIndex","sublayerProps","_this$props$updateTri","pickable","visible","wrapLongitude","positionFormat","operation","overridingSublayerProps","overridingSublayerTriggers","sublayerId","subLayerPropTypes","passThroughProps","subLayers","shouldUpdate","subLayersList","EARTH_RADIUS","GLOBE_RADIUS","unitsPerDegree","GlobeViewport","resolution","lt","lSqr","vec3.sqrLen","l0Sqr","l1Sqr","dSqr","r0","dr","vec3.lerp","lambda","cosPhi","D","vec3.len","fromPosition","vec4.scale","orbitAxis","projectionScale","OrbitViewport","p0","nextCenter","FirstPersonViewport","dir","MOVEMENT_SPEED","FirstPersonState","use2D","FirstPersonController","FirstPersonView","OrbitView","GlobeState","GlobeController","GlobeView","LayerExtension","propValue","getDefaultViewState","initialBounds","offsetWidth","offsetHeight","MapLibre","mapRef","setViewState","selected","setSelected","graph","hover","setHover","defaultState","defaultBounds","useMemo","React","Children","getNodeAt","useCallback","queryRenderedFeatures","startsWith","getNodeById","onMouseMove","classList","remove","clone","JSON","stringify","ReactMapGL","clickTolerance","initialViewState","mapStyle","onMove","cloneElement","tooltip","TooltipContainer","popup","PopupContainer","useIsomorphicLayoutEffect","inheritsFrom","ParentType","MAP_STYLE","evaluateChildren","childProps","isComponent","isReactMap","needsDeckGLViewProps","componentProps","wrapInView","createElement","Array","extractJSXLayers","reactChildren","jsxLayers","jsxViews","forEach","reactElement","ElementType","createLayer","push","reactProps","positionChildrenUnderViews","ContextProvider","viewManager","defaultViewId","viewChildren","viewElement","contextValue","CANVAS_ONLY_STYLES","extractStyles","containerStyle","canvasStyle","getRefHandles","thisRef","redrawDeck","createDeckInstance","DeckClass","DeckGL","forwardRef","setVersion","containerRef","canvasRef","jsxProps","inRender","handleViewStateChange","_props$onViewStateCha","handleInteractionStateChange","_props$onInteractionS","deckProps","forwardProps","_thisRef$deck","viewStateUpdateRequested","interactionStateUpdateRequested","useImperativeHandle","currentViewports","childrenUnderViews","DeckGLMap","deckRef","reduce","nativeEvent","pickObject","onViewStateChange","getTooltip","DeckGLContainer","globalViewState","setGlobalState","setInitialViewState","currentViewState","setCurrentViewState","debouncedViewState","useDebounce","DEFAULT_SCALE","coverageStyle","pointStyle","darken","clickbufferStyle","HeatmapLayer","heatmap","clickbuffer","Source","Map","useAutoPosition","setLeft","setTop","elemBounds","_a","mapBounds","_b","exceedsRight","exceedsBottom","setOffset","lonlat","centroid","coordinates","renderedPopup","zIndex","renderedTooltip","useMap","maps","useOneOfManyMaps","useViewState","MyLocationControl","onSuccess","easeTo","console","warn","geolocation","getCurrentPosition","enableHighAccuracy","TbCurrentLocation","Controls","Scrollable","ZoomControl","onZoom","getZoom","FiPlus","FiMinus","TYPE_COLORS","isRTL","ListPreviewCard","record","thumbnailURI","backgroundImage","PADDING","FullscreenImage","Lightbox","mainSrc","onCloseRequest","getDescription","TYPE_ICONS","FaArchive","FaBook","MdMail","HiBookOpen","FaMap","RiMovie2Line","IoMusicalNotes","HiNewspaper","AiFillAudio","MdPhotoCamera","HiPhoto","SESSION_ID","nanoid","metaApiBase","API_BASE","metaMapKey","logRequestedAsset","recordType","RecordType","SelectedCard","presentationURI","description","showLightbox","setShowLightbox","showEasterEgg","setShowEasterEgg","audioURL","setAudioURL","isAudio","previewFailed","setPreviewFailed","then","setTimeout","onerror","controls","crossOrigin","CgSpinner","CgArrowsExpandRight","href","HiChevronRight","borderBottomColor","FiShare2","KimaPopup","records","setRecords","expanded","setExpanded","descriptions","onLazyLoad","preLoadedRecords","Set","preLoaded","fetchedRecords","has","getConnected","externalURI","SiWikidata","POST","APIError","onResponse","toFilterBody","getPlaces","api","minLon","minLat","maxLon","maxLat","getRecords","KimaSearchHandler","pending","setPending","places","PENDING","onLoad","abort","AbortController","placesResult","recordsResult","total_records","OK","facetsInfo","countFaceted","onLoadDone","onSearchResult","catch","FAILED","uriToId","uri","substring","lastIndexOf","buildCache","place","placeId","KimaGraphProvider","setGraph","getConnectedFromCache","fetchAll","fetchAllCallback","json","Promise","KimaStore","getMapBounds","debounced","setResults","KimaTooltip","connected","setConnected","totalConnected","toLocaleString","LoadIndicator","global","queryClient","QueryClient","App","loading","setLoading","QueryClientProvider","client","responsive","onload","createRoot","getElementById","render"],"mappings":"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"}